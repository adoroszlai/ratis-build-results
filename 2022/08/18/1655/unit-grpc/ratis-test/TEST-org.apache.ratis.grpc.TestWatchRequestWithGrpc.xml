<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="50.857" tests="4" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.1/ratis-thirdparty-misc-1.0.1.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter1592162707080206233.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2022-08-18T15-48-37_334-jvmRun1 surefire1196168341173643496tmp surefire_94438556541452575495tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.1/ratis-thirdparty-misc-1.0.1.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter1592162707080206233.jar"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_332-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.4.0-1086-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="1.8.0_332"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.332-b09"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testWatchRequestAsyncChangeLeader" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="36.004">
    <error message="org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 &gt; nextToProcess = -1 will NEVER be processed; request = 27:null" type="java.util.concurrent.ExecutionException">java.util.concurrent.ExecutionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.WatchRequestTests.checkMajority(WatchRequestTests.java:270)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:356)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
</error>
    <system-out><![CDATA[2022-08-18 15:52:36,522 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-08-18 15:52:36,524 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-08-18 15:52:36,540 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.server.impl.WatchRequests log level to DEBUG
2022-08-18 15:52:36,541 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.server.RaftServer$Division log level to DEBUG
2022-08-18 15:52:36,543 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.grpc.client.GrpcClientRpc log level to ALL
2022-08-18 15:52:36,544 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.client.impl.UnorderedAsync log level to ALL
2022-08-18 15:52:36,544 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.client.RaftClient log level to ALL
2022-08-18 15:52:36,557 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(132)) - Running runWithNewCluster
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(303)) - new MiniRaftClusterWithGrpc with group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(336)) - .............................................................. 
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(337)) - ... 
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(338)) - ...     Starting MiniRaftClusterWithGrpc
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - ... 
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - .............................................................. 
2022-08-18 15:52:36,589 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(315)) - servers = {}
2022-08-18 15:52:36,595 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s0, group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER], format? true
2022-08-18 15:52:36,597 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0
2022-08-18 15:52:36,599 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0 does not exist.
2022-08-18 15:52:36,599 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0
2022-08-18 15:52:36,629 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-08-18 15:52:36,677 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,679 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 40891 (custom)
2022-08-18 15:52:36,680 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,680 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 33205 (custom)
2022-08-18 15:52:36,680 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-08-18 15:52:36,681 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 44275 (custom)
2022-08-18 15:52:36,681 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-08-18 15:52:36,683 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:36,686 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-08-18 15:52:36,689 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:36,711 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:36,716 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-08-18 15:52:36,718 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-08-18 15:52:36,878 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-08-18 15:52:36,881 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-08-18 15:52:36,882 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-08-18 15:52:36,882 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,882 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,890 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0] (custom)
2022-08-18 15:52:36,897 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s0: addNew group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] returns group-82CF0218057B:java.util.concurrent.CompletableFuture@1c22ff4f[Not completed]
2022-08-18 15:52:36,897 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s1, group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER], format? true
2022-08-18 15:52:36,897 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1
2022-08-18 15:52:36,897 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1 does not exist.
2022-08-18 15:52:36,897 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1
2022-08-18 15:52:36,898 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-08-18 15:52:36,898 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,898 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 37883 (custom)
2022-08-18 15:52:36,898 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,898 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 39963 (custom)
2022-08-18 15:52:36,899 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-08-18 15:52:36,899 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 46605 (custom)
2022-08-18 15:52:36,899 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-08-18 15:52:36,899 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:36,899 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-08-18 15:52:36,899 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:36,899 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:36,900 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-08-18 15:52:36,900 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,902 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1] (custom)
2022-08-18 15:52:36,904 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s1: addNew group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] returns group-82CF0218057B:java.util.concurrent.CompletableFuture@40ec8e6f[Not completed]
2022-08-18 15:52:36,904 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s2, group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER], format? true
2022-08-18 15:52:36,904 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2
2022-08-18 15:52:36,904 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2 does not exist.
2022-08-18 15:52:36,904 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2
2022-08-18 15:52:36,905 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-08-18 15:52:36,905 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,905 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 45157 (custom)
2022-08-18 15:52:36,906 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-08-18 15:52:36,906 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 33917 (custom)
2022-08-18 15:52:36,906 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-08-18 15:52:36,906 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 34519 (custom)
2022-08-18 15:52:36,906 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-08-18 15:52:36,906 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:36,906 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-08-18 15:52:36,907 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:36,907 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:36,907 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-08-18 15:52:36,907 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-08-18 15:52:36,908 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-08-18 15:52:36,908 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-08-18 15:52:36,911 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-08-18 15:52:36,911 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,912 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,912 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2] (custom)
2022-08-18 15:52:36,925 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:36,925 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:36,925 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:36,927 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:36,927 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:36,927 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:36,928 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s2: addNew group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] returns group-82CF0218057B:java.util.concurrent.CompletableFuture@7185ae00[Not completed]
2022-08-18 15:52:36,930 [pool-1-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s0: new RaftServerImpl for group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:36,931 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:36,931 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:36,931 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:36,931 [pool-3-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s2: new RaftServerImpl for group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:36,931 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-08-18 15:52:36,931 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:36,931 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-08-18 15:52:36,932 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:36,932 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-08-18 15:52:36,932 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,932 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,932 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-08-18 15:52:36,933 [pool-2-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s1: new RaftServerImpl for group-82CF0218057B:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:36,933 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-08-18 15:52:36,933 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:36,934 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-08-18 15:52:36,934 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,934 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,934 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-08-18 15:52:36,932 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-08-18 15:52:36,934 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-08-18 15:52:36,934 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-08-18 15:52:36,934 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-08-18 15:52:36,938 [pool-3-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s2@group-82CF0218057B: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-08-18 15:52:36,938 [pool-2-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s1@group-82CF0218057B: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-08-18 15:52:36,939 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1] (custom)
2022-08-18 15:52:36,938 [pool-1-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s0@group-82CF0218057B: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-08-18 15:52:36,941 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0] (custom)
2022-08-18 15:52:36,943 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-08-18 15:52:36,943 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-08-18 15:52:36,944 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-08-18 15:52:36,948 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-08-18 15:52:36,948 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-08-18 15:52:36,948 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-08-18 15:52:36,950 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-08-18 15:52:36,950 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-08-18 15:52:36,950 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2] (custom)
2022-08-18 15:52:36,950 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-08-18 15:52:36,950 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-08-18 15:52:36,950 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-08-18 15:52:36,951 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-08-18 15:52:36,951 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-08-18 15:52:36,952 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-08-18 15:52:36,952 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-08-18 15:52:36,973 [pool-2-thread-1] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-08-18 15:52:37,025 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:37,025 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:37,026 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-08-18 15:52:37,026 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-08-18 15:52:37,026 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-08-18 15:52:37,026 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-08-18 15:52:37,027 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:37,027 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-08-18 15:52:37,027 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-08-18 15:52:37,027 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-08-18 15:52:37,028 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-08-18 15:52:37,031 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-08-18 15:52:37,031 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-08-18 15:52:37,032 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-08-18 15:52:37,032 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-08-18 15:52:37,032 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b does not exist. Creating ...
2022-08-18 15:52:37,033 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,036 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/in_use.lock acquired by nodename 8973@fv-az35-811.xim1osirhgvujn4yg5hone0yza.gx.internal.cloudapp.net
2022-08-18 15:52:37,037 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current
2022-08-18 15:52:37,037 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/sm
2022-08-18 15:52:37,042 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b has been successfully formatted.
2022-08-18 15:52:37,043 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:37,044 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-08-18 15:52:37,045 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-08-18 15:52:37,050 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-08-18 15:52:37,050 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:37,051 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-08-18 15:52:37,052 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-08-18 15:52:37,053 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,056 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-08-18 15:52:37,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-08-18 15:52:37,060 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(191)) - new s0@group-82CF0218057B-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,060 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:37,061 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-08-18 15:52:37,061 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,062 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:37,062 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-08-18 15:52:37,062 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-08-18 15:52:37,063 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-08-18 15:52:37,064 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-08-18 15:52:37,069 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:37,070 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-08-18 15:52:37,070 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-08-18 15:52:37,071 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-08-18 15:52:37,075 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,075 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,076 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s0@group-82CF0218057B: start as a follower, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,076 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-08-18 15:52:37,077 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,079 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s0
2022-08-18 15:52:37,080 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-08-18 15:52:37,081 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-08-18 15:52:37,081 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-08-18 15:52:37,085 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(387)) - s0: start RPC server
2022-08-18 15:52:37,116 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s0: GrpcService started, listening on 33205
2022-08-18 15:52:37,117 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s0: GrpcService started, listening on 44275
2022-08-18 15:52:37,117 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s0: GrpcService started, listening on 40891
2022-08-18 15:52:37,119 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b does not exist. Creating ...
2022-08-18 15:52:37,119 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,119 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@52b60fec] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s0: Started
2022-08-18 15:52:37,120 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/in_use.lock acquired by nodename 8973@fv-az35-811.xim1osirhgvujn4yg5hone0yza.gx.internal.cloudapp.net
2022-08-18 15:52:37,120 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current
2022-08-18 15:52:37,120 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/sm
2022-08-18 15:52:37,121 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b has been successfully formatted.
2022-08-18 15:52:37,121 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-08-18 15:52:37,122 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(191)) - new s1@group-82CF0218057B-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-08-18 15:52:37,123 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,124 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,125 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s1@group-82CF0218057B: start as a follower, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,125 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-08-18 15:52:37,125 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,126 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s1
2022-08-18 15:52:37,126 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-08-18 15:52:37,126 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-08-18 15:52:37,126 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-08-18 15:52:37,127 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(387)) - s1: start RPC server
2022-08-18 15:52:37,127 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s1: GrpcService started, listening on 39963
2022-08-18 15:52:37,127 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s1: GrpcService started, listening on 46605
2022-08-18 15:52:37,128 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s1: GrpcService started, listening on 37883
2022-08-18 15:52:37,128 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@7f86158c] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s1: Started
2022-08-18 15:52:37,128 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b does not exist. Creating ...
2022-08-18 15:52:37,129 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,130 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/in_use.lock acquired by nodename 8973@fv-az35-811.xim1osirhgvujn4yg5hone0yza.gx.internal.cloudapp.net
2022-08-18 15:52:37,130 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current
2022-08-18 15:52:37,130 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/sm
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b has been successfully formatted.
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:37,131 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(191)) - new s2@group-82CF0218057B-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-08-18 15:52:37,132 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-08-18 15:52:37,133 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-08-18 15:52:37,133 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-08-18 15:52:37,133 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-08-18 15:52:37,133 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-08-18 15:52:37,133 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-08-18 15:52:37,134 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-08-18 15:52:37,134 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,134 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(136)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-08-18 15:52:37,137 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s2@group-82CF0218057B: start as a follower, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,137 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-08-18 15:52:37,137 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,140 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s2
2022-08-18 15:52:37,140 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-08-18 15:52:37,140 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-08-18 15:52:37,140 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-08-18 15:52:37,141 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(387)) - s2: start RPC server
2022-08-18 15:52:37,141 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s2: GrpcService started, listening on 33917
2022-08-18 15:52:37,142 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s2: GrpcService started, listening on 34519
2022-08-18 15:52:37,142 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(270)) - s2: GrpcService started, listening on 45157
2022-08-18 15:52:37,144 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@1dadacff] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s2: Started
2022-08-18 15:52:37,145 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:37,147 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:37,150 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:577)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:611)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:604)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:37,237 [s0@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:159809060ns, electionTimeout:153ms
2022-08-18 15:52:37,238 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,238 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-08-18 15:52:37,240 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:37,240 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-LeaderElection1
2022-08-18 15:52:37,275 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection1 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,291 [s0@group-82CF0218057B-LeaderElection1-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-08-18 15:52:37,291 [s0@group-82CF0218057B-LeaderElection1-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-08-18 15:52:37,347 [s1@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:221062269ns, electionTimeout:220ms
2022-08-18 15:52:37,347 [s1@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,347 [s1@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-08-18 15:52:37,348 [s1@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:37,348 [s1@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-LeaderElection2
2022-08-18 15:52:37,356 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-82CF0218057B-LeaderElection2 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,360 [s1@group-82CF0218057B-LeaderElection2-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-08-18 15:52:37,367 [s2@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:230051155ns, electionTimeout:226ms
2022-08-18 15:52:37,367 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,367 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-08-18 15:52:37,373 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:37,373 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-LeaderElection3
2022-08-18 15:52:37,373 [s1@group-82CF0218057B-LeaderElection2-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-08-18 15:52:37,375 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-82CF0218057B-LeaderElection3 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,376 [s2@group-82CF0218057B-LeaderElection3-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-08-18 15:52:37,385 [s2@group-82CF0218057B-LeaderElection3-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-08-18 15:52:37,500 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection1: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2022-08-18 15:52:37,500 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection1 PRE_VOTE round 0: result TIMEOUT
2022-08-18 15:52:37,501 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection1 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,534 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,535 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,537 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(PRE_VOTE, s1, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,537 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,538 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,539 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,539 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,541 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,541 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,541 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,541 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,542 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s1#0:OK-t0. Peer's state: s1@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,542 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,542 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,542 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,543 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,543 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,543 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-82CF0218057B:t0, leader=null, voted=, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,563 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-82CF0218057B-LeaderElection2: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,563 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s2#0:OK-t0
2022-08-18 15:52:37,563 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-82CF0218057B-LeaderElection2 PRE_VOTE round 0: result PASSED
2022-08-18 15:52:37,564 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection1: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,564 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s2#0:OK-t0
2022-08-18 15:52:37,564 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection1 PRE_VOTE round 1: result PASSED
2022-08-18 15:52:37,564 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,564 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(PRE_VOTE, s1, group-82CF0218057B, 0, (t:0, i:0))
2022-08-18 15:52:37,565 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-82CF0218057B-LeaderElection2 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,565 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection1 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,565 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,565 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s0#0:OK-t1. Peer's state: s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,566 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,566 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to PRE_VOTE vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,574 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(ELECTION, s1, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,575 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-CANDIDATE: reject ELECTION from s1: already has voted for s0 at current term 1
2022-08-18 15:52:37,575 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to ELECTION vote request: s1<-s0#0:FAIL-t1. Peer's state: s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,576 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-82CF0218057B-LeaderElection3: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,576 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s1#0:OK-t0
2022-08-18 15:52:37,576 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-82CF0218057B-LeaderElection3 PRE_VOTE round 0: result PASSED
2022-08-18 15:52:37,577 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-82CF0218057B-LeaderElection3 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,578 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(ELECTION, s1, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,578 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: reject ELECTION from s1: already has voted for s2 at current term 1
2022-08-18 15:52:37,578 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to ELECTION vote request: s1<-s2#0:FAIL-t1. Peer's state: s2@group-82CF0218057B:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,580 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,580 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-CANDIDATE: reject ELECTION from s0: already has voted for s1 at current term 1
2022-08-18 15:52:37,581 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to ELECTION vote request: s0<-s1#0:FAIL-t1. Peer's state: s1@group-82CF0218057B:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,581 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-82CF0218057B-LeaderElection2: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-08-18 15:52:37,581 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s0#0:FAIL-t1
2022-08-18 15:52:37,581 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 1: s1<-s2#0:FAIL-t1
2022-08-18 15:52:37,581 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-82CF0218057B-LeaderElection2 ELECTION round 0: result REJECTED
2022-08-18 15:52:37,582 [s1@group-82CF0218057B-LeaderElection2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-08-18 15:52:37,582 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-82CF0218057B-LeaderElection2
2022-08-18 15:52:37,582 [s1@group-82CF0218057B-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,582 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,583 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: reject ELECTION from s0: already has voted for s2 at current term 1
2022-08-18 15:52:37,583 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to ELECTION vote request: s0<-s2#0:FAIL-t1. Peer's state: s2@group-82CF0218057B:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,586 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(ELECTION, s2, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,586 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: reject ELECTION from s2: already has voted for s1 at current term 1
2022-08-18 15:52:37,586 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to ELECTION vote request: s2<-s1#0:FAIL-t1. Peer's state: s1@group-82CF0218057B:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection1: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:FAIL-t1
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 1: s0<-s2#0:FAIL-t1
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection1 ELECTION round 0: result REJECTED
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-82CF0218057B-LeaderElection1
2022-08-18 15:52:37,589 [s0@group-82CF0218057B-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,589 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(ELECTION, s2, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,591 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-FOLLOWER: reject ELECTION from s2: already has voted for s0 at current term 1
2022-08-18 15:52:37,591 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to ELECTION vote request: s2<-s0#0:FAIL-t1. Peer's state: s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-82CF0218057B-LeaderElection3: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:FAIL-t1
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 1: s2<-s1#0:FAIL-t1
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-82CF0218057B-LeaderElection3 ELECTION round 0: result REJECTED
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-82CF0218057B-LeaderElection3
2022-08-18 15:52:37,592 [s2@group-82CF0218057B-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,607 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #2/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:577)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:611)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:604)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:37,788 [s0@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:199524301ns, electionTimeout:198ms
2022-08-18 15:52:37,789 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,789 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-08-18 15:52:37,789 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:37,789 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-LeaderElection4
2022-08-18 15:52:37,789 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection4 PRE_VOTE round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,791 [s2@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:198852502ns, electionTimeout:198ms
2022-08-18 15:52:37,791 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,791 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-08-18 15:52:37,791 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:37,791 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-LeaderElection5
2022-08-18 15:52:37,794 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,794 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,795 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-82CF0218057B:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,798 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,799 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection4: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,799 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:OK-t1
2022-08-18 15:52:37,799 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection4 PRE_VOTE round 0: result PASSED
2022-08-18 15:52:37,799 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,800 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-82CF0218057B:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,800 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection4 ELECTION round 0: submit vote requests at term 2 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,800 [s2@group-82CF0218057B-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-82CF0218057B-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,803 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 2, (t:0, i:0))
2022-08-18 15:52:37,803 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,803 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s0
2022-08-18 15:52:37,803 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,804 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,805 [s1@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-82CF0218057B-FollowerState was interrupted
2022-08-18 15:52:37,806 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 2, (t:0, i:0))
2022-08-18 15:52:37,806 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to ELECTION vote request: s0<-s1#0:OK-t2. Peer's state: s1@group-82CF0218057B:t2, leader=null, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,809 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,809 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,809 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s0#0:OK-t2. Peer's state: s0@group-82CF0218057B:t2, leader=null, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,806 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-CANDIDATE: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,809 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from CANDIDATE to FOLLOWER at term 2 for candidate:s0
2022-08-18 15:52:37,809 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-82CF0218057B-LeaderElection5
2022-08-18 15:52:37,809 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:37,811 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection4: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,811 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:OK-t2
2022-08-18 15:52:37,813 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection4 ELECTION round 0: result PASSED
2022-08-18 15:52:37,813 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-82CF0218057B-LeaderElection4
2022-08-18 15:52:37,813 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-08-18 15:52:37,813 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-82CF0218057B: change Leader from null to s0 at term 2 for becomeLeader, leader elected after 865ms
2022-08-18 15:52:37,814 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to ELECTION vote request: s0<-s2#0:OK-t2. Peer's state: s2@group-82CF0218057B:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,815 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 1, (t:0, i:0))
2022-08-18 15:52:37,815 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:37,815 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s1#0:OK-t2. Peer's state: s1@group-82CF0218057B:t2, leader=null, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,817 [s2@group-82CF0218057B-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-82CF0218057B-LeaderElection5: PRE_VOTE DISCOVERED_A_NEW_TERM (term=2) received 1 response(s) and 0 exception(s):
2022-08-18 15:52:37,817 [s2@group-82CF0218057B-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t2
2022-08-18 15:52:37,817 [s2@group-82CF0218057B-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-82CF0218057B-LeaderElection5 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=2)
2022-08-18 15:52:37,817 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-08-18 15:52:37,821 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:37,821 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:37,825 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-08-18 15:52:37,825 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-08-18 15:52:37,825 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-08-18 15:52:37,829 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:37,831 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-08-18 15:52:37,837 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:37,837 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:37,837 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:37,839 [s0@group-82CF0218057B-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:37,839 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:37,839 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:37,839 [s0@group-82CF0218057B-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:37,841 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:37,842 [s0@group-82CF0218057B-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:37,845 [s0@group-82CF0218057B-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:52:37,856 [s0@group-82CF0218057B-LeaderElection4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(452)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: Starting segment from index:0
2022-08-18 15:52:37,879 [s0@group-82CF0218057B-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s0@group-82CF0218057B: set configuration 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,906 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-82CF0218057B: change Leader from null to s0 at term 2 for appendEntries, leader elected after 958ms
2022-08-18 15:52:37,910 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-82CF0218057B: change Leader from null to s0 at term 2 for appendEntries, leader elected after 959ms
2022-08-18 15:52:37,981 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0
2022-08-18 15:52:37,991 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 2, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:37,993 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s1@group-82CF0218057B: set configuration 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,993 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(452)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: Starting segment from index:0
2022-08-18 15:52:37,993 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 2, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:37,994 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s2@group-82CF0218057B: set configuration 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:37,994 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(452)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: Starting segment from index:0
2022-08-18 15:52:38,004 [s1@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0
2022-08-18 15:52:38,004 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0
2022-08-18 15:52:38,006 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2022-08-18 15:52:38,008 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s1#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=0,matchIndex=0
2022-08-18 15:52:38,059 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:38,061 [Time-limited test] DEBUG client.RaftClient (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-08-18 15:52:38,062 [Time-limited test] DEBUG client.GrpcClientRpc (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-08-18 15:52:38,067 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 1) numMessages=1, printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c-1, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:38,068 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s1
2022-08-18 15:52:38,068 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-08-18 15:52:38,068 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-08-18 15:52:38,105 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=0, seq=1*, Watch(0), Message:<EMPTY>)
2022-08-18 15:52:38,106 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=0, seq=1*, Watch(0), Message:<EMPTY>
2022-08-18 15:52:38,123 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=1, seq=2, RW, Message:6d30)
2022-08-18 15:52:38,134 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=1, seq=2, RW, Message:6d30, entry=(t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208
2022-08-18 15:52:38,136 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 2, (t:2, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:16, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208]
2022-08-18 15:52:38,136 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 2, (t:2, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:6, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208]
2022-08-18 15:52:38,137 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#16:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2022-08-18 15:52:38,139 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 0 to 1
2022-08-18 15:52:38,140 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208
2022-08-18 15:52:38,143 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=1
2022-08-18 15:52:38,143 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=2, seq=0, Watch(1), null
2022-08-18 15:52:38,146 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 2, (t:2, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:7, entries: [(t:2, i:2), METADATAENTRY(c:1)]
2022-08-18 15:52:38,149 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=2, seq=0, Watch(1), Message:<EMPTY>)
2022-08-18 15:52:38,149 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 2, (t:2, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:17, entries: [(t:2, i:2), METADATAENTRY(c:1)]
2022-08-18 15:52:38,149 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=2, seq=0, Watch(1), Message:<EMPTY>
2022-08-18 15:52:38,150 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#17:OK-t2,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2022-08-18 15:52:38,150 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208
2022-08-18 15:52:38,152 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 0 to 1
2022-08-18 15:52:38,152 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 1 to 2
2022-08-18 15:52:38,154 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), null
2022-08-18 15:52:38,155 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), null
2022-08-18 15:52:38,155 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-08-18 15:52:38,155 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=1, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c0]
2022-08-18 15:52:38,160 [Thread-67] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=2, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c1]
2022-08-18 15:52:38,160 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>)
2022-08-18 15:52:38,161 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>
2022-08-18 15:52:38,163 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), Message:<EMPTY>)
2022-08-18 15:52:38,163 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), Message:<EMPTY>
2022-08-18 15:52:38,163 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>)
2022-08-18 15:52:38,164 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>
2022-08-18 15:52:38,169 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(1) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=2, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c1]
2022-08-18 15:52:38,169 [Thread-68] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=4, SUCCESS, logIndex=1, commits[s0:c2, s1:c0, s2:c1]
2022-08-18 15:52:38,170 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(1) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=4, SUCCESS, logIndex=1, commits[s0:c2, s1:c0, s2:c1]
2022-08-18 15:52:38,230 [grpc-default-executor-3] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 1 to 2
2022-08-18 15:52:39,174 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:blockRequestor(49)) - Block requestor s0
2022-08-18 15:52:39,175 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,175 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,175 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,176 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #1/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,241 [s2-server-thread2] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s2: Block request from s0
2022-08-18 15:52:39,252 [s1-server-thread2] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s1: Block request from s0
2022-08-18 15:52:39,277 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,277 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,277 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,277 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #2/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,378 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,378 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,378 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,378 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #3/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,479 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,479 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,479 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,480 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #4/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,580 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,580 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,580 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,580 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #5/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:434898348ns, electionTimeout:226ms
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-LeaderElection6
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-82CF0218057B: change Leader from s0 to null at term 2 for PRE_VOTE
2022-08-18 15:52:39,599 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-82CF0218057B-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,601 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 2, (t:2, i:2))
2022-08-18 15:52:39,602 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:39,602 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s1#0:OK-t2. Peer's state: s1@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,605 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-82CF0218057B-LeaderElection6: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:39,605 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s1#0:OK-t2
2022-08-18 15:52:39,605 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-82CF0218057B-LeaderElection6 PRE_VOTE round 0: result PASSED
2022-08-18 15:52:39,606 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-82CF0218057B-LeaderElection6 ELECTION round 0: submit vote requests at term 3 for 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,609 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(PRE_VOTE, s2, group-82CF0218057B, 2, (t:2, i:2))
2022-08-18 15:52:39,610 [grpc-default-executor-0] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1020)) - s0@group-82CF0218057B-LeaderStateImpl: Lost leadership on term: 2. Election timeout: 300ms. In charge for: 1796ms. Conf: 0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,610 [grpc-default-executor-0] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1024)) - Follower s0@group-82CF0218057B->s1(c0,m0,n3, attendVote=true, lastRpcSendTime=20, lastRpcResponseTime=435)
2022-08-18 15:52:39,610 [grpc-default-executor-0] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1024)) - Follower s0@group-82CF0218057B->s2(c2,m2,n3, attendVote=true, lastRpcSendTime=31, lastRpcResponseTime=445)
2022-08-18 15:52:39,610 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from    LEADER to FOLLOWER at term 2 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-08-18 15:52:39,610 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:52:39,612 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-82CF0218057B: receive requestVote(ELECTION, s2, group-82CF0218057B, 3, (t:2, i:2))
2022-08-18 15:52:39,612 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#7-t2,previous=(t:2, i:1),leaderCommit=1,initializing? true,entries: size=1, first=(t:2, i:2), METADATAENTRY(c:1)
2022-08-18 15:52:39,613 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:39,614 [grpc-default-executor-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-82CF0218057B-PendingRequests: sendNotLeaderResponses
2022-08-18 15:52:39,615 [s0@group-82CF0218057B->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(191)) - s0@group-82CF0218057B->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-08-18 15:52:39,615 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=3, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c2, s1:c0, s2:c2]
2022-08-18 15:52:39,617 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s1: nextIndex: updateUnconditionally 3 -> 1
2022-08-18 15:52:39,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=5, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c2, s1:c0, s2:c2]
2022-08-18 15:52:39,618 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#17-t2,previous=(t:2, i:1),leaderCommit=1,initializing? true,entries: size=1, first=(t:2, i:2), METADATAENTRY(c:1)
2022-08-18 15:52:39,618 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,620 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s0
2022-08-18 15:52:39,620 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to PRE_VOTE vote request: s2<-s0#0:FAIL-t2. Peer's state: s0@group-82CF0218057B:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,620 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-82CF0218057B-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:39,620 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-82CF0218057B: change Leader from s0 to null at term 3 for updateCurrentTerm
2022-08-18 15:52:39,620 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s2
2022-08-18 15:52:39,620 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,621 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,622 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:39,622 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s2: nextIndex: updateUnconditionally 3 -> 2
2022-08-18 15:52:39,622 [Thread-75] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:39,623 [s0@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:shouldRun(117)) - s0@group-82CF0218057B-FollowerState: Stopping now (isRunning? false, role = FOLLOWER)
2022-08-18 15:52:39,623 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-82CF0218057B replies to ELECTION vote request: s2<-s0#0:OK-t3. Peer's state: s0@group-82CF0218057B:t3, leader=null, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,624 [Thread-75] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,624 [Thread-77] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:39,625 [Thread-77] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-82CF0218057B-LeaderElection6: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t3
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-82CF0218057B-LeaderElection6 ELECTION round 0: result PASSED
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-82CF0218057B-LeaderElection6
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-82CF0218057B: change Leader from null to s2 at term 3 for becomeLeader, leader elected after 26ms
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-08-18 15:52:39,626 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:39,627 [s2@group-82CF0218057B-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:52:39,628 [s2@group-82CF0218057B-LeaderElection6] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-08-18 15:52:39,629 [Thread-77] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,629 [Thread-77] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,630 [Thread-77] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:52:39,630 [Thread-77] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:39,631 [s2@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,631 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,635 [Thread-75] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,636 [Thread-75] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:39,636 [Thread-75] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:39,638 [Thread-75] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), null
2022-08-18 15:52:39,639 [Thread-77] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-08-18 15:52:39,639 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3
2022-08-18 15:52:39,641 [s2@group-82CF0218057B-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s2@group-82CF0218057B: set configuration 3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(ELECTION, s2, group-82CF0218057B, 3, (t:2, i:2))
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-82CF0218057B: change Leader from s0 to null at term 3 for updateCurrentTerm
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s2
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,642 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:39,642 [s1@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-82CF0218057B-FollowerState was interrupted
2022-08-18 15:52:39,645 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to ELECTION vote request: s2<-s1#0:OK-t3. Peer's state: s1@group-82CF0218057B:t3, leader=null, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,647 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-82CF0218057B: change Leader from null to s2 at term 3 for appendEntries, leader elected after 26ms
2022-08-18 15:52:39,648 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:2, i:2), 2, true, commits:[s2:c2, s0:c2, s1:c0], cId:1, entries: [(t:3, i:3), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:39,648 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s0@group-82CF0218057B: set configuration 3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,648 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-08-18 15:52:39,649 [s0@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,649 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,654 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 0 to 2
2022-08-18 15:52:39,654 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 0 to 2
2022-08-18 15:52:39,659 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-82CF0218057B: change Leader from null to s2 at term 3 for appendEntries, leader elected after 16ms
2022-08-18 15:52:39,659 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:2, i:2), 2, true, commits:[s2:c2, s0:c2, s1:c0], cId:1, entries: [(t:3, i:3), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:39,665 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s1@group-82CF0218057B: set configuration 3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:39,665 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-08-18 15:52:39,659 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3
2022-08-18 15:52:39,667 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#1:OK-t3,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2022-08-18 15:52:39,668 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 2 to 3
2022-08-18 15:52:39,670 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:3), 3, true, commits:[s2:c3, s0:c2, s1:c0], cId:2, entries: [(t:3, i:4), METADATAENTRY(c:3)]
2022-08-18 15:52:39,671 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:3), 3, true, commits:[s2:c3, s0:c2, s1:c0], cId:2, entries: [(t:3, i:4), METADATAENTRY(c:3)]
2022-08-18 15:52:39,673 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#2:OK-t3,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2022-08-18 15:52:39,673 [grpc-default-executor-1] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 2 to 3
2022-08-18 15:52:39,674 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 3 to 4
2022-08-18 15:52:39,681 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:39,681 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,681 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c0, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,681 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:lambda$changeLeader$6(435)) - Changed leader from s0 to s2
2022-08-18 15:52:39,681 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:unblockRequestor(54)) - UnBlock requestor s0
2022-08-18 15:52:39,681 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(141)) - unblock FLUSH_STATE_MACHINE_DATA
2022-08-18 15:52:39,682 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(366)) - unblock follower s1
2022-08-18 15:52:39,682 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 0: logIndex=1
2022-08-18 15:52:39,682 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s1#6:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2022-08-18 15:52:39,683 [s1@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,683 [s1@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_0-2
2022-08-18 15:52:39,683 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-58CC921A4208
2022-08-18 15:52:39,684 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s1#7:OK-t2,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2022-08-18 15:52:39,691 [s1@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3
2022-08-18 15:52:39,692 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#1:OK-t3,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2022-08-18 15:52:39,692 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#2:OK-t3,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2022-08-18 15:52:39,693 [grpc-default-executor-1] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 0 to 2
2022-08-18 15:52:39,693 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update ALL index from 0 to 3
2022-08-18 15:52:39,693 [grpc-default-executor-1] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 2 to 3
2022-08-18 15:52:39,693 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update ALL index from 3 to 4
2022-08-18 15:52:39,738 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), null
2022-08-18 15:52:39,739 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-08-18 15:52:39,743 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>)
2022-08-18 15:52:39,743 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>
2022-08-18 15:52:39,744 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>)
2022-08-18 15:52:39,744 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>
2022-08-18 15:52:39,747 [Thread-88] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=3, SUCCESS, logIndex=4, commits[s2:c4, s0:c3, s1:c3]
2022-08-18 15:52:39,747 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(1) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=3, SUCCESS, logIndex=4, commits[s2:c4, s0:c3, s1:c3]
2022-08-18 15:52:39,747 [Thread-89] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=5, SUCCESS, logIndex=3, commits[s2:c4, s0:c3, s1:c3]
2022-08-18 15:52:39,747 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(1) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=5, SUCCESS, logIndex=3, commits[s2:c4, s0:c3, s1:c3]
2022-08-18 15:52:39,748 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 10) numMessages=10, printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:39,748 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s1
2022-08-18 15:52:39,748 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-08-18 15:52:39,748 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-08-18 15:52:39,748 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 1: message=m1
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 2: message=m2
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 3: message=m3
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 4: message=m4
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 5: message=m5
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 6: message=m6
2022-08-18 15:52:39,749 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 7: message=m7
2022-08-18 15:52:39,750 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 8: message=m8
2022-08-18 15:52:39,750 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 9: message=m9
2022-08-18 15:52:39,752 [grpc-default-executor-1] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 3 to 4
2022-08-18 15:52:39,771 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 3 to 4
2022-08-18 15:52:39,841 [s2-server-thread2] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s2: unBlock request from s0
2022-08-18 15:52:39,842 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#39:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,842 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#40:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,843 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#41:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,844 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#42:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,844 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#43:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,845 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#44:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,846 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#45:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,846 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#46:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,848 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#47:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,849 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s2@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#48:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,849 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:52:39,850 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:39,850 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s2: nextIndex: updateUnconditionally 2 -> 1
2022-08-18 15:52:39,852 [s1-server-thread2] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s1: unBlock request from s0
2022-08-18 15:52:39,852 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#137:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,853 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#141:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,853 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#145:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,854 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#149:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,854 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#153:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,855 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#157:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,856 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#161:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,856 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#165:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,857 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#169:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,857 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s0 (term=2) as leader, state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#173:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-08-18 15:52:39,857 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:52:39,858 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:39,858 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s1: nextIndex: updateUnconditionally 1 -> 0
2022-08-18 15:52:42,749 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=6, seq=3, RW, m0 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #6 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,749 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,749 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=10, seq=7, RW, m4 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #10 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,750 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,750 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s1
2022-08-18 15:52:42,750 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:52:42,750 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=11, seq=8, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #11 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,750 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,750 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,749 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=9, seq=6, RW, m3 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #9 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,750 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,751 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,750 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=13, seq=10, RW, m7 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s2: Stream close: no reply for async request cid=13
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,751 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,751 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,751 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=14, seq=11, RW, m8 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s2: Stream close: no reply for async request cid=14
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,751 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,752 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,752 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=15, seq=12, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s2: Stream close: no reply for async request cid=15
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,752 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,752 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,750 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=7, seq=4, RW, m1 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #7 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,753 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,753 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,750 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=12, seq=9, RW, m6 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #12 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,753 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,753 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,749 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=8, seq=5, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s2 request #8 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,755 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:42,755 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s1, newLeader=null
2022-08-18 15:52:42,749 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:52:42,862 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=6, seq=3*, RW, Message:6d30)
2022-08-18 15:52:42,872 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s2. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=6, seq=3*, RW, m0 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:42,873 [grpc-default-executor-0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:42,873 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s2
2022-08-18 15:52:42,873 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s2 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:42,880 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=6, seq=3*, RW, Message:6d30)
2022-08-18 15:52:42,880 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=6, seq=3*, RW, Message:6d30, entry=(t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208
2022-08-18 15:52:42,885 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:4), 4, true, commits:[s2:c4, s0:c4, s1:c4], cId:54, entries: [(t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208]
2022-08-18 15:52:42,886 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:4), 4, true, commits:[s2:c4, s0:c4, s1:c4], cId:54, entries: [(t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208]
2022-08-18 15:52:42,886 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#54:OK-t3,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2022-08-18 15:52:42,887 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 4 to 5
2022-08-18 15:52:42,887 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208
2022-08-18 15:52:42,889 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:5), 5, true, commits:[s2:c5, s0:c4, s1:c4], cId:55, entries: [(t:3, i:6), METADATAENTRY(c:5)]
2022-08-18 15:52:42,889 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#55:OK-t3,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2022-08-18 15:52:42,889 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208
2022-08-18 15:52:42,893 [grpc-default-executor-3] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=5
2022-08-18 15:52:42,893 [grpc-default-executor-3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=16, seq=0, Watch(5), null
2022-08-18 15:52:42,894 [grpc-default-executor-3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), null
2022-08-18 15:52:42,894 [grpc-default-executor-3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), null
2022-08-18 15:52:42,894 [grpc-default-executor-3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-08-18 15:52:42,895 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=6, SUCCESS, logIndex=5, commits[s2:c5, s0:c4, s1:c4]
2022-08-18 15:52:42,895 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:5), 5, true, commits:[s2:c5, s0:c4, s1:c4], cId:55, entries: [(t:3, i:6), METADATAENTRY(c:5)]
2022-08-18 15:52:42,895 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 4 to 5
2022-08-18 15:52:42,895 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 5 to 6
2022-08-18 15:52:42,900 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=16, seq=0, Watch(5), Message:<EMPTY>)
2022-08-18 15:52:42,900 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=16, seq=0, Watch(5), Message:<EMPTY>
2022-08-18 15:52:42,900 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-08-18 15:52:42,900 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>
2022-08-18 15:52:42,901 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), Message:<EMPTY>)
2022-08-18 15:52:42,901 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), Message:<EMPTY>
2022-08-18 15:52:42,901 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-08-18 15:52:42,901 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>
2022-08-18 15:52:42,904 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=7, seq=4, RW, Message:6d31)
2022-08-18 15:52:42,904 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=7, seq=4, RW, Message:6d31, entry=(t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208
2022-08-18 15:52:42,905 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:6), 6, true, commits:[s2:c6, s0:c5, s1:c4], cId:58, entries: [(t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208]
2022-08-18 15:52:42,906 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:6), 6, true, commits:[s2:c6, s0:c5, s1:c4], cId:58, entries: [(t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208]
2022-08-18 15:52:42,906 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#58:OK-t3,SUCCESS,nextIndex=8,followerCommit=6,matchIndex=7
2022-08-18 15:52:42,907 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=8, seq=5, RW, Message:6d32)
2022-08-18 15:52:42,907 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 5 to 6
2022-08-18 15:52:42,907 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 6 to 7
2022-08-18 15:52:42,907 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208
2022-08-18 15:52:42,908 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:7), 7, true, commits:[s2:c7, s0:c6, s1:c4], cId:60, entries: [(t:3, i:8), METADATAENTRY(c:7)]
2022-08-18 15:52:42,909 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:7), 7, true, commits:[s2:c7, s0:c6, s1:c4], cId:59, entries: [(t:3, i:8), METADATAENTRY(c:7)]
2022-08-18 15:52:42,909 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=8, seq=5, RW, Message:6d32, entry=(t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208
2022-08-18 15:52:42,910 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#59:OK-t3,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2022-08-18 15:52:42,910 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208
2022-08-18 15:52:42,910 [grpc-default-executor-1] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 6 to 7
2022-08-18 15:52:42,910 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:8), 7, true, commits:[s2:c7, s0:c6, s1:c4], cId:60, entries: [(t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208]
2022-08-18 15:52:42,911 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 7 to 8
2022-08-18 15:52:42,911 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:8), 7, true, commits:[s2:c7, s0:c7, s1:c4], cId:61, entries: [(t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208]
2022-08-18 15:52:42,911 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#60:OK-t3,SUCCESS,nextIndex=10,followerCommit=7,matchIndex=9
2022-08-18 15:52:42,912 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m1, logIndex=7
2022-08-18 15:52:42,912 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=20, seq=0, Watch(7), null
2022-08-18 15:52:42,912 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 8 to 9
2022-08-18 15:52:42,912 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208
2022-08-18 15:52:42,913 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:9), 9, true, commits:[s2:c9, s0:c7, s1:c4], cId:63, entries: [(t:3, i:10), METADATAENTRY(c:9)]
2022-08-18 15:52:42,914 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:9), 9, true, commits:[s2:c9, s0:c7, s1:c4], cId:63, entries: [(t:3, i:10), METADATAENTRY(c:9)]
2022-08-18 15:52:42,914 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208
2022-08-18 15:52:42,914 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=9, seq=6, RW, Message:6d33)
2022-08-18 15:52:42,914 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#63:OK-t3,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2022-08-18 15:52:42,915 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 7 to 9
2022-08-18 15:52:42,916 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=9, seq=6, RW, Message:6d33, entry=(t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208
2022-08-18 15:52:42,916 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:10), 9, true, commits:[s2:c9, s0:c9, s1:c4], cId:64, entries: [(t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208]
2022-08-18 15:52:42,916 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:10), 9, true, commits:[s2:c9, s0:c9, s1:c4], cId:64, entries: [(t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208]
2022-08-18 15:52:42,916 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 9 to 10
2022-08-18 15:52:42,917 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#64:OK-t3,SUCCESS,nextIndex=12,followerCommit=9,matchIndex=11
2022-08-18 15:52:42,917 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 10 to 11
2022-08-18 15:52:42,917 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208
2022-08-18 15:52:42,918 [Thread-92] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=16, SUCCESS, logIndex=6, commits[s2:c6, s0:c5, s1:c4]
2022-08-18 15:52:42,918 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:11), 11, true, commits:[s2:c11, s0:c9, s1:c4], cId:66, entries: [(t:3, i:12), METADATAENTRY(c:11)]
2022-08-18 15:52:42,918 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:11), 11, true, commits:[s2:c11, s0:c9, s1:c4], cId:67, entries: [(t:3, i:12), METADATAENTRY(c:11)]
2022-08-18 15:52:42,918 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(5) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=16, SUCCESS, logIndex=6, commits[s2:c6, s0:c5, s1:c4]
2022-08-18 15:52:42,921 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), null
2022-08-18 15:52:42,922 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), null
2022-08-18 15:52:42,922 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-08-18 15:52:42,922 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208
2022-08-18 15:52:42,922 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=20, seq=0, Watch(7), Message:<EMPTY>)
2022-08-18 15:52:42,922 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#66:OK-t3,SUCCESS,nextIndex=13,followerCommit=11,matchIndex=12
2022-08-18 15:52:42,923 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=20, seq=0, Watch(7), Message:<EMPTY>
2022-08-18 15:52:42,923 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 9 to 11
2022-08-18 15:52:42,923 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 11 to 12
2022-08-18 15:52:42,922 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m2, logIndex=9
2022-08-18 15:52:42,924 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=24, seq=0, Watch(9), null
2022-08-18 15:52:42,924 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), null
2022-08-18 15:52:42,924 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), null
2022-08-18 15:52:42,924 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-08-18 15:52:42,923 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-08-18 15:52:42,924 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>
2022-08-18 15:52:42,925 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), Message:<EMPTY>)
2022-08-18 15:52:42,925 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), Message:<EMPTY>
2022-08-18 15:52:42,925 [Thread-93] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=18, SUCCESS, logIndex=5, commits[s2:c6, s0:c5, s1:c4]
2022-08-18 15:52:42,926 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m3, logIndex=11
2022-08-18 15:52:42,925 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>)
2022-08-18 15:52:42,926 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=28, seq=0, Watch(11), null
2022-08-18 15:52:42,926 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>
2022-08-18 15:52:42,926 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), null
2022-08-18 15:52:42,926 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=24, seq=0, Watch(9), Message:<EMPTY>)
2022-08-18 15:52:42,926 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=24, seq=0, Watch(9), Message:<EMPTY>
2022-08-18 15:52:42,926 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-08-18 15:52:42,926 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-08-18 15:52:42,927 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(5) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=18, SUCCESS, logIndex=5, commits[s2:c6, s0:c5, s1:c4]
2022-08-18 15:52:42,927 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 1: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=7, SUCCESS, logIndex=7, commits[s2:c7, s0:c6, s1:c4]
2022-08-18 15:52:42,927 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-08-18 15:52:42,927 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>
2022-08-18 15:52:42,927 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), Message:<EMPTY>)
2022-08-18 15:52:42,928 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), Message:<EMPTY>
2022-08-18 15:52:42,928 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>)
2022-08-18 15:52:42,928 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>
2022-08-18 15:52:42,928 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=28, seq=0, Watch(11), Message:<EMPTY>)
2022-08-18 15:52:42,928 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=28, seq=0, Watch(11), Message:<EMPTY>
2022-08-18 15:52:42,929 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-08-18 15:52:42,929 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>
2022-08-18 15:52:42,929 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>)
2022-08-18 15:52:42,929 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>
2022-08-18 15:52:42,930 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-08-18 15:52:42,930 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>
2022-08-18 15:52:42,933 [Thread-95] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=22, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,937 [Thread-94] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=20, SUCCESS, logIndex=11, commits[s2:c11, s0:c9, s1:c4]
2022-08-18 15:52:42,941 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(7) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=20, SUCCESS, logIndex=11, commits[s2:c11, s0:c9, s1:c4]
2022-08-18 15:52:42,941 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(7) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=22, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,937 [Thread-96] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=24, SUCCESS, logIndex=12, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,941 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 2: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=8, SUCCESS, logIndex=9, commits[s2:c9, s0:c7, s1:c4]
2022-08-18 15:52:42,941 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(9) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=24, SUCCESS, logIndex=12, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,944 [Thread-98] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=28, SUCCESS, logIndex=12, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,944 [Thread-97] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=26, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,944 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(9) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=26, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,944 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 3: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=9, SUCCESS, logIndex=11, commits[s2:c11, s0:c9, s1:c4]
2022-08-18 15:52:42,945 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(11) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=28, SUCCESS, logIndex=12, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,945 [Thread-99] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=30, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:42,945 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(11) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=30, SUCCESS, logIndex=11, commits[s2:c12, s0:c11, s1:c4]
2022-08-18 15:52:43,001 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 11 to 12
2022-08-18 15:52:45,753 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=89, target=localhost:33917}}. 
2022-08-18 15:52:45,755 [grpc-default-executor-2] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-08-18 15:52:45,858 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=10, seq=7, RW, Message:6d34)
2022-08-18 15:52:45,859 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=10, seq=7, RW, Message:6d34, entry=(t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208
2022-08-18 15:52:45,860 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=11, seq=8, RW, Message:6d35)
2022-08-18 15:52:45,861 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=11, seq=8, RW, Message:6d35, entry=(t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208
2022-08-18 15:52:45,861 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=12, seq=9, RW, Message:6d36)
2022-08-18 15:52:45,861 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=12, seq=9, RW, Message:6d36, entry=(t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208
2022-08-18 15:52:45,861 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=13, seq=10, RW, Message:6d37)
2022-08-18 15:52:45,862 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=13, seq=10, RW, Message:6d37, entry=(t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208
2022-08-18 15:52:45,862 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=14, seq=11, RW, Message:6d38)
2022-08-18 15:52:45,863 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=14, seq=11, RW, Message:6d38, entry=(t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208
2022-08-18 15:52:45,863 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=15, seq=12, RW, Message:6d39)
2022-08-18 15:52:45,863 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:12), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:416, entries: [(t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208]
2022-08-18 15:52:45,864 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:12), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:114, entries: [(t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208]
2022-08-18 15:52:45,864 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:13), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:417, entries: [(t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208]
2022-08-18 15:52:45,865 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s2@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=15, seq=12, RW, Message:6d39, entry=(t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208
2022-08-18 15:52:45,865 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#114:OK-t3,SUCCESS,nextIndex=14,followerCommit=12,matchIndex=13
2022-08-18 15:52:45,865 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:13), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:115, entries: [(t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208, (t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208]
2022-08-18 15:52:45,865 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:15), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:116, entries: [(t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208]
2022-08-18 15:52:45,866 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:16), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:117, entries: [(t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208]
2022-08-18 15:52:45,866 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#116:OK-t3,SUCCESS,nextIndex=17,followerCommit=12,matchIndex=16
2022-08-18 15:52:45,867 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#117:OK-t3,SUCCESS,nextIndex=18,followerCommit=12,matchIndex=17
2022-08-18 15:52:45,867 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#115:OK-t3,SUCCESS,nextIndex=16,followerCommit=12,matchIndex=15
2022-08-18 15:52:45,867 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 12 to 13
2022-08-18 15:52:45,868 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 13, m4 -> (t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208
2022-08-18 15:52:45,868 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:14), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:418, entries: [(t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208]
2022-08-18 15:52:45,868 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:17), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:118, entries: [(t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208]
2022-08-18 15:52:45,869 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#118:OK-t3,SUCCESS,nextIndex=19,followerCommit=12,matchIndex=18
2022-08-18 15:52:45,869 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 13 to 15
2022-08-18 15:52:45,870 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:15), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:419, entries: [(t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208]
2022-08-18 15:52:45,870 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 15 to 17
2022-08-18 15:52:45,870 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m4, logIndex=13
2022-08-18 15:52:45,871 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=32, seq=0, Watch(13), null
2022-08-18 15:52:45,871 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:16), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:420, entries: [(t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208]
2022-08-18 15:52:45,871 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), null
2022-08-18 15:52:45,871 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=34, seq=0, Watch-MAJORITY_COMMITTED(13), null
2022-08-18 15:52:45,871 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 14, m5 -> (t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208
2022-08-18 15:52:45,871 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), null
2022-08-18 15:52:45,871 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 15, m6 -> (t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208
2022-08-18 15:52:45,871 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 4: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=10, SUCCESS, logIndex=13, commits[s2:c13, s0:c12, s1:c4]
2022-08-18 15:52:45,871 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 16, m7 -> (t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208
2022-08-18 15:52:45,871 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 17, m8 -> (t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208
2022-08-18 15:52:45,872 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:18), 13, true, commits:[s2:c13, s0:c12, s1:c4], cId:119, entries: [(t:3, i:19), METADATAENTRY(c:13)]
2022-08-18 15:52:45,872 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:19), 15, true, commits:[s2:c15, s0:c12, s1:c4], cId:121, entries: [(t:3, i:20), METADATAENTRY(c:15)]
2022-08-18 15:52:45,873 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 13, m4 -> (t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208
2022-08-18 15:52:45,873 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#119:OK-t3,SUCCESS,nextIndex=20,followerCommit=13,matchIndex=19
2022-08-18 15:52:45,873 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 14, m5 -> (t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208
2022-08-18 15:52:45,874 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 15, m6 -> (t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208
2022-08-18 15:52:45,873 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#121:OK-t3,SUCCESS,nextIndex=21,followerCommit=15,matchIndex=20
2022-08-18 15:52:45,874 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 17 to 18
2022-08-18 15:52:45,875 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 18, m9 -> (t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208
2022-08-18 15:52:45,875 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=32, seq=0, Watch(13), Message:<EMPTY>)
2022-08-18 15:52:45,875 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=32, seq=0, Watch(13), Message:<EMPTY>
2022-08-18 15:52:45,875 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:20), 17, true, commits:[s2:c17, s0:c12, s1:c4], cId:124, entries: [(t:3, i:21), METADATAENTRY(c:17)]
2022-08-18 15:52:45,875 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:17), 12, true, commits:[s2:c12, s0:c12, s1:c4], cId:421, entries: [(t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208]
2022-08-18 15:52:45,876 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-08-18 15:52:45,876 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#124:OK-t3,SUCCESS,nextIndex=22,followerCommit=17,matchIndex=21
2022-08-18 15:52:45,876 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), Message:<EMPTY>
2022-08-18 15:52:45,876 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 16, m7 -> (t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208
2022-08-18 15:52:45,877 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 17, m8 -> (t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208
2022-08-18 15:52:45,877 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:21), 18, true, commits:[s2:c18, s0:c12, s1:c4], cId:125, entries: [(t:3, i:22), METADATAENTRY(c:18)]
2022-08-18 15:52:45,877 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=34, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>)
2022-08-18 15:52:45,877 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=34, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>
2022-08-18 15:52:45,877 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-08-18 15:52:45,877 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>
2022-08-18 15:52:45,878 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s0@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s0#125:OK-t3,SUCCESS,nextIndex=23,followerCommit=18,matchIndex=22
2022-08-18 15:52:45,878 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 18, m9 -> (t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208
2022-08-18 15:52:45,878 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 12 to 13
2022-08-18 15:52:45,878 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s2@group-82CF0218057B-WatchRequests: complete Watch-MAJORITY_COMMITTED(13)@9.683s?NOT_DONE
2022-08-18 15:52:45,879 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 18 to 19
2022-08-18 15:52:45,879 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:18), 13, true, commits:[s2:c13, s0:c12, s1:c4], cId:422, entries: [(t:3, i:19), METADATAENTRY(c:13)]
2022-08-18 15:52:45,879 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 13 to 15
2022-08-18 15:52:45,879 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 19 to 20
2022-08-18 15:52:45,879 [grpc-default-executor-0] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m5, logIndex=14
2022-08-18 15:52:45,880 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=36, seq=0, Watch(14), null
2022-08-18 15:52:45,880 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), null
2022-08-18 15:52:45,880 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=38, seq=0, Watch-MAJORITY_COMMITTED(14), null
2022-08-18 15:52:45,880 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), null
2022-08-18 15:52:45,880 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 15 to 17
2022-08-18 15:52:45,881 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 20 to 21
2022-08-18 15:52:45,881 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:19), 15, true, commits:[s2:c15, s0:c12, s1:c4], cId:423, entries: [(t:3, i:20), METADATAENTRY(c:15)]
2022-08-18 15:52:45,881 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=36, seq=0, Watch(14), Message:<EMPTY>)
2022-08-18 15:52:45,881 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=36, seq=0, Watch(14), Message:<EMPTY>
2022-08-18 15:52:45,881 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=54,entriesCount=1,lastEntry=(t:3, i:5)
2022-08-18 15:52:45,881 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-08-18 15:52:45,882 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), Message:<EMPTY>
2022-08-18 15:52:45,882 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=38, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>)
2022-08-18 15:52:45,882 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=38, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>
2022-08-18 15:52:45,882 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>)
2022-08-18 15:52:45,882 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>
2022-08-18 15:52:45,883 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m6, logIndex=15
2022-08-18 15:52:45,883 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=40, seq=0, Watch(15), null
2022-08-18 15:52:45,883 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), null
2022-08-18 15:52:45,883 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=42, seq=0, Watch-MAJORITY_COMMITTED(15), null
2022-08-18 15:52:45,883 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), null
2022-08-18 15:52:45,883 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 17 to 18
2022-08-18 15:52:45,884 [s2@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY index from 21 to 22
2022-08-18 15:52:45,884 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:20), 17, true, commits:[s2:c17, s0:c12, s1:c4], cId:424, entries: [(t:3, i:21), METADATAENTRY(c:17)]
2022-08-18 15:52:45,884 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=40, seq=0, Watch(15), Message:<EMPTY>)
2022-08-18 15:52:45,884 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=40, seq=0, Watch(15), Message:<EMPTY>
2022-08-18 15:52:45,884 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-08-18 15:52:45,884 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), Message:<EMPTY>
2022-08-18 15:52:45,885 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=42, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>)
2022-08-18 15:52:45,885 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=42, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>
2022-08-18 15:52:45,885 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>)
2022-08-18 15:52:45,885 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>
2022-08-18 15:52:45,885 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m7, logIndex=16
2022-08-18 15:52:45,886 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=44, seq=0, Watch(16), null
2022-08-18 15:52:45,886 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), null
2022-08-18 15:52:45,886 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=46, seq=0, Watch-MAJORITY_COMMITTED(16), null
2022-08-18 15:52:45,886 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), null
2022-08-18 15:52:45,886 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s2, 3, (t:3, i:21), 18, true, commits:[s2:c18, s0:c12, s1:c4], cId:425, entries: [(t:3, i:22), METADATAENTRY(c:18)]
2022-08-18 15:52:45,886 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=44, seq=0, Watch(16), Message:<EMPTY>)
2022-08-18 15:52:45,887 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=44, seq=0, Watch(16), Message:<EMPTY>
2022-08-18 15:52:45,887 [Thread-100] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=32, SUCCESS, logIndex=18, commits[s2:c18, s0:c12, s1:c4]
2022-08-18 15:52:45,888 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=55,entriesCount=1,lastEntry=(t:3, i:6)
2022-08-18 15:52:45,888 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), Message:<EMPTY>)
2022-08-18 15:52:45,888 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(13) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=32, SUCCESS, logIndex=18, commits[s2:c18, s0:c12, s1:c4]
2022-08-18 15:52:45,889 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), Message:<EMPTY>
2022-08-18 15:52:45,889 [grpc-default-executor-0] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m8, logIndex=17
2022-08-18 15:52:45,889 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=46, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>)
2022-08-18 15:52:45,889 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=48, seq=0, Watch(17), null
2022-08-18 15:52:45,889 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=46, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>
2022-08-18 15:52:45,890 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), null
2022-08-18 15:52:45,890 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=50, seq=0, Watch-MAJORITY_COMMITTED(17), null
2022-08-18 15:52:45,890 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), null
2022-08-18 15:52:45,890 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>)
2022-08-18 15:52:45,890 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>
2022-08-18 15:52:45,891 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=48, seq=0, Watch(17), Message:<EMPTY>)
2022-08-18 15:52:45,891 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=48, seq=0, Watch(17), Message:<EMPTY>
2022-08-18 15:52:45,892 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), Message:<EMPTY>)
2022-08-18 15:52:45,892 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), Message:<EMPTY>
2022-08-18 15:52:45,892 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=50, seq=0, Watch-MAJORITY_COMMITTED(17), Message:<EMPTY>)
2022-08-18 15:52:45,892 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=50, seq=0, Watch-MAJORITY_COMMITTED(17), Message:<EMPTY>
2022-08-18 15:52:45,892 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>)
2022-08-18 15:52:45,893 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>
2022-08-18 15:52:45,893 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m9, logIndex=18
2022-08-18 15:52:45,893 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=52, seq=0, Watch(18), null
2022-08-18 15:52:45,893 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), null
2022-08-18 15:52:45,893 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=54, seq=0, Watch-MAJORITY_COMMITTED(18), null
2022-08-18 15:52:45,893 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), null
2022-08-18 15:52:45,894 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=52, seq=0, Watch(18), Message:<EMPTY>)
2022-08-18 15:52:45,894 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=52, seq=0, Watch(18), Message:<EMPTY>
2022-08-18 15:52:45,894 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), Message:<EMPTY>)
2022-08-18 15:52:45,895 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), Message:<EMPTY>
2022-08-18 15:52:45,895 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=54, seq=0, Watch-MAJORITY_COMMITTED(18), Message:<EMPTY>)
2022-08-18 15:52:45,895 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=54, seq=0, Watch-MAJORITY_COMMITTED(18), Message:<EMPTY>
2022-08-18 15:52:45,895 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), Message:<EMPTY>)
2022-08-18 15:52:45,895 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s2@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), Message:<EMPTY>
2022-08-18 15:52:45,896 [Thread-101] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=34, SUCCESS, logIndex=13, commits[s2:c18, s0:c13, s1:c4]
2022-08-18 15:52:45,896 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(13) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=34, SUCCESS, logIndex=13, commits[s2:c18, s0:c13, s1:c4]
2022-08-18 15:52:45,899 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 5: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=11, SUCCESS, logIndex=14, commits[s2:c17, s0:c12, s1:c4]
2022-08-18 15:52:45,899 [Thread-102] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=36, SUCCESS, logIndex=21, commits[s2:c21, s0:c17, s1:c4]
2022-08-18 15:52:45,899 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(14) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=36, SUCCESS, logIndex=21, commits[s2:c21, s0:c17, s1:c4]
2022-08-18 15:52:45,900 [Thread-103] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=38, SUCCESS, logIndex=17, commits[s2:c21, s0:c17, s1:c4]
2022-08-18 15:52:45,900 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(14) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=38, SUCCESS, logIndex=17, commits[s2:c21, s0:c17, s1:c4]
2022-08-18 15:52:45,900 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 6: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=12, SUCCESS, logIndex=15, commits[s2:c17, s0:c12, s1:c4]
2022-08-18 15:52:45,906 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=58,entriesCount=1,lastEntry=(t:3, i:7)
2022-08-18 15:52:45,906 [Thread-105] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=42, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,906 [Thread-104] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=40, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,906 [Thread-106] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=44, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,908 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=60,entriesCount=1,lastEntry=(t:3, i:8)
2022-08-18 15:52:45,914 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=61,entriesCount=1,lastEntry=(t:3, i:9)
2022-08-18 15:52:45,914 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(15) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=40, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,914 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(15) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=42, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,914 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 7: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=13, SUCCESS, logIndex=16, commits[s2:c17, s0:c12, s1:c4]
2022-08-18 15:52:45,914 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(16) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=44, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,915 [Thread-108] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=48, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,915 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=64,entriesCount=1,lastEntry=(t:3, i:11)
2022-08-18 15:52:45,915 [Thread-107] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=46, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,916 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(16) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=46, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,916 [Thread-109] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=50, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,916 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 8: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=14, SUCCESS, logIndex=17, commits[s2:c17, s0:c12, s1:c4]
2022-08-18 15:52:45,916 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(17) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=48, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,916 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(17) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=50, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,916 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 9: receive RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=15, SUCCESS, logIndex=18, commits[s2:c18, s0:c12, s1:c4]
2022-08-18 15:52:45,917 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=63,entriesCount=1,lastEntry=(t:3, i:10)
2022-08-18 15:52:45,917 [Thread-111] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=54, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,917 [Thread-110] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=52, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,918 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(18) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=52, SUCCESS, logIndex=22, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,918 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(18) returns RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=54, SUCCESS, logIndex=18, commits[s2:c22, s0:c18, s1:c4]
2022-08-18 15:52:45,919 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s2@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=67,entriesCount=1,lastEntry=(t:3, i:12)
2022-08-18 15:52:45,960 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s2@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 18 to 22
2022-08-18 15:52:46,918 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:blockRequestor(49)) - Block requestor s2
2022-08-18 15:52:46,918 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:46,919 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:46,919 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:46,919 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #1/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:46,936 [s1-server-thread4] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s1: Block request from s2
2022-08-18 15:52:46,958 [s0-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s0: Block request from s2
2022-08-18 15:52:47,019 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:47,019 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,020 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,020 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #2/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,120 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:47,121 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,121 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,121 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #3/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s2
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,144 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,166 [s0@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-82CF0218057B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:284960072ns, electionTimeout:250ms
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-82CF0218057B-FollowerState
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-LeaderElection7
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-82CF0218057B: change Leader from s2 to null at term 3 for PRE_VOTE
2022-08-18 15:52:47,167 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection7 PRE_VOTE round 0: submit vote requests at term 3 for 3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,169 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 3, (t:3, i:22))
2022-08-18 15:52:47,169 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-LEADER: reject PRE_VOTE from s0: this server is the leader and still has leadership
2022-08-18 15:52:47,170 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s2#0:FAIL-t3. Peer's state: s2@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,174 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(PRE_VOTE, s0, group-82CF0218057B, 3, (t:3, i:22))
2022-08-18 15:52:47,174 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:47,174 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to PRE_VOTE vote request: s0<-s1#0:OK-t3. Peer's state: s1@group-82CF0218057B:t3, leader=s2, voted=s2, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,175 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection7: PRE_VOTE PASSED received 2 response(s) and 0 exception(s):
2022-08-18 15:52:47,176 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:OK-t3
2022-08-18 15:52:47,176 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 1: s0<-s2#0:FAIL-t3
2022-08-18 15:52:47,176 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection7 PRE_VOTE round 0: result PASSED
2022-08-18 15:52:47,177 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-82CF0218057B-LeaderElection7 ELECTION round 0: submit vote requests at term 4 for 3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 4, (t:3, i:22))
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-82CF0218057B-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-82CF0218057B: change Leader from s2 to null at term 4 for updateCurrentTerm
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-82CF0218057B: changes role from  FOLLOWER to FOLLOWER at term 4 for candidate:s0
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:47,179 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-82CF0218057B-FollowerState
2022-08-18 15:52:47,179 [s1@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-82CF0218057B-FollowerState was interrupted
2022-08-18 15:52:47,181 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-82CF0218057B replies to ELECTION vote request: s0<-s1#0:OK-t4. Peer's state: s1@group-82CF0218057B:t4, leader=null, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-82CF0218057B-LeaderElection7: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:OK-t4
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-82CF0218057B-LeaderElection7 ELECTION round 0: result PASSED
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-82CF0218057B-LeaderElection7
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-82CF0218057B: changes role from CANDIDATE to LEADER at term 4 for changeToLeader
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-82CF0218057B: change Leader from null to s0 at term 4 for becomeLeader, leader elected after 15ms
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-08-18 15:52:47,182 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:47,183 [s0@group-82CF0218057B-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:52:47,184 [s0@group-82CF0218057B-LeaderElection7] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-08-18 15:52:47,185 [s0@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,200 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,200 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-82CF0218057B: receive requestVote(ELECTION, s0, group-82CF0218057B, 4, (t:3, i:22))
2022-08-18 15:52:47,201 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-82CF0218057B-LEADER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-08-18 15:52:47,201 [grpc-default-executor-6] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-82CF0218057B: change Leader from s2 to null at term 4 for updateCurrentTerm
2022-08-18 15:52:47,201 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-82CF0218057B: changes role from    LEADER to FOLLOWER at term 4 for candidate:s0
2022-08-18 15:52:47,201 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s2: shutdown s2@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:52:47,201 [grpc-default-executor-6] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s2@group-82CF0218057B-PendingRequests: sendNotLeaderResponses
2022-08-18 15:52:47,202 [s2@group-82CF0218057B->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(191)) - s2@group-82CF0218057B->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-08-18 15:52:47,200 [s0@group-82CF0218057B-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s0@group-82CF0218057B: set configuration 23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,200 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:3, i:22), 22, true, commits:[s0:c22, s1:c4, s2:c22], cId:1, entries: [(t:4, i:23), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:47,196 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-82CF0218057B: change Leader from null to s0 at term 4 for appendEntries, leader elected after 16ms
2022-08-18 15:52:47,205 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-82CF0218057B-FollowerState
2022-08-18 15:52:47,203 [s2@group-82CF0218057B->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(191)) - s2@group-82CF0218057B->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-08-18 15:52:47,203 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:3, i:22), 22, true, commits:[s0:c22, s1:c4, s2:c22], cId:1, entries: [(t:4, i:23), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:44275"
dataStreamAddress: "localhost:37075"
clientAddress: "localhost:33205"
adminAddress: "localhost:40891"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46605"
dataStreamAddress: "localhost:40033"
clientAddress: "localhost:39963"
adminAddress: "localhost:37883"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34519"
dataStreamAddress: "localhost:34383"
clientAddress: "localhost:33917"
adminAddress: "localhost:45157"
startupRole: FOLLOWER
, old:)]
2022-08-18 15:52:47,202 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=17, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,208 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s1@group-82CF0218057B: set configuration 23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,222 [s1-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-08-18 15:52:47,222 [Thread-122] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,233 [Thread-122] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,221 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-08-18 15:52:47,234 [grpc-default-executor-8] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 0 to 4
2022-08-18 15:52:47,234 [grpc-default-executor-8] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 0 to 22
2022-08-18 15:52:47,234 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=null, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,234 [Thread-141] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,217 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: s2->s0#125-t3,previous=(t:3, i:21),leaderCommit=18,initializing? true,entries: size=1, first=(t:3, i:22), METADATAENTRY(c:18)
2022-08-18 15:52:47,212 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s0@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s0/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_23
2022-08-18 15:52:47,210 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=21, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,235 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=25, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,236 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s2@group-82CF0218057B->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:47,235 [Thread-122] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,237 [Thread-122] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,237 [Thread-122] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:52:47,237 [Thread-122] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:47,239 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-82CF0218057B->s0: nextIndex: updateUnconditionally 23 -> 22
2022-08-18 15:52:47,234 [Thread-141] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,234 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: Leader: s0@group-82CF0218057B not ready, sleep 450ms and then retry.
java.lang.IllegalStateException: Leader: s0@group-82CF0218057B not ready
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:114)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:431)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,233 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s2@group-82CF0218057B replies to ELECTION vote request: s0<-s2#0:OK-t4. Peer's state: s2@group-82CF0218057B:t4, leader=null, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,233 [Thread-140] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,240 [Thread-140] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,240 [Thread-140] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,240 [Thread-140] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,240 [Thread-140] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,240 [Thread-140] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), null
2022-08-18 15:52:47,233 [Thread-139] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,241 [Thread-139] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-138] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,241 [Thread-138] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-137] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,241 [Thread-137] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-136] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,241 [Thread-136] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-135] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-135] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-134] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-134] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-133] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-133] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,230 [Thread-132] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-132] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,229 [Thread-131] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-131] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,229 [Thread-130] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-130] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,229 [Thread-129] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-129] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,229 [Thread-128] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-128] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,228 [Thread-127] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-127] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,228 [Thread-126] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,242 [Thread-126] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,228 [Thread-125] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,243 [Thread-125] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,228 [Thread-124] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,243 [Thread-124] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,228 [Thread-123] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:47,228 [grpc-default-executor-9] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: s2->s1#425-t3,previous=(t:3, i:21),leaderCommit=18,initializing? true,entries: size=1, first=(t:3, i:22), METADATAENTRY(c:18)
2022-08-18 15:52:47,243 [Thread-123] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,240 [s2-server-thread4] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-82CF0218057B: change Leader from null to s0 at term 4 for appendEntries, leader elected after 38ms
2022-08-18 15:52:47,236 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=29, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,243 [s2-server-thread4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s2@group-82CF0218057B: set configuration 23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-08-18 15:52:47,244 [s2-server-thread4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(457)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-08-18 15:52:47,244 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=33, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,249 [Thread-123] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-123] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-123] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,249 [Thread-123] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-08-18 15:52:47,249 [Thread-124] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-125] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,250 [Thread-125] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,250 [Thread-125] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,250 [Thread-125] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-08-18 15:52:47,249 [Thread-126] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,250 [Thread-126] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,250 [Thread-126] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,250 [Thread-126] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), null
2022-08-18 15:52:47,249 [Thread-127] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-127] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-127] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,251 [Thread-127] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-08-18 15:52:47,249 [Thread-128] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-128] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-128] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,249 [Thread-129] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-129] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,251 [Thread-129] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,251 [Thread-129] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-08-18 15:52:47,249 [Thread-130] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,252 [Thread-130] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,252 [Thread-130] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,252 [Thread-130] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), null
2022-08-18 15:52:47,249 [Thread-131] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,252 [Thread-131] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,253 [Thread-131] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,249 [Thread-132] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-133] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,253 [Thread-133] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,253 [Thread-133] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,253 [Thread-133] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), null
2022-08-18 15:52:47,244 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s2@group-82CF0218057B->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:47,249 [Thread-134] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,253 [Thread-134] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-136] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-136] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-135] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-137] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-137] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,249 [Thread-138] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-138] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-138] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,254 [Thread-138] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), null
2022-08-18 15:52:47,249 [Thread-139] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-139] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-139] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,249 [Thread-141] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,245 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 0 to 4
2022-08-18 15:52:47,244 [s2@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,256 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,256 [Thread-141] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,256 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 4 to 22
2022-08-18 15:52:47,254 [Thread-139] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), null
2022-08-18 15:52:47,254 [Thread-137] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,254 [Thread-135] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,254 [Thread-136] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,260 [Thread-136] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), null
2022-08-18 15:52:47,253 [Thread-134] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,253 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-82CF0218057B->s1: nextIndex: updateUnconditionally 23 -> 5
2022-08-18 15:52:47,253 [Thread-132] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,253 [Thread-131] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), null
2022-08-18 15:52:47,251 [Thread-128] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), null
2022-08-18 15:52:47,250 [Thread-124] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:47,261 [Thread-124] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,261 [Thread-124] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), null
2022-08-18 15:52:47,250 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=37, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,262 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=41, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,261 [Thread-132] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,260 [Thread-134] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), null
2022-08-18 15:52:47,260 [Thread-135] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,262 [Thread-135] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), null
2022-08-18 15:52:47,260 [Thread-137] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), null
2022-08-18 15:52:47,256 [Thread-141] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s0, newLeader=null
2022-08-18 15:52:47,262 [Thread-132] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), null
2022-08-18 15:52:47,262 [Thread-141] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), null
2022-08-18 15:52:47,265 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=45, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,265 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=49, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,265 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=53, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,265 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=19, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=23, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=27, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=31, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=35, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=39, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,266 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=43, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,267 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=47, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,267 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=51, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,267 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s2@group-82CF0218057B, cid=55, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader, logIndex=0, commits[s2:c22, s0:c22, s1:c4]
2022-08-18 15:52:47,268 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s2@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s2/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_23
2022-08-18 15:52:47,269 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#1:OK-t4,SUCCESS,nextIndex=24,followerCommit=22,matchIndex=23
2022-08-18 15:52:47,270 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:23), 23, true, commits:[s0:c23, s1:c4, s2:c22], cId:6, entries: [(t:4, i:24), METADATAENTRY(c:23)]
2022-08-18 15:52:47,270 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:23), 23, true, commits:[s0:c23, s1:c4, s2:c22], cId:3, entries: [(t:4, i:24), METADATAENTRY(c:23)]
2022-08-18 15:52:47,273 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#3:OK-t4,SUCCESS,nextIndex=25,followerCommit=23,matchIndex=24
2022-08-18 15:52:47,273 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 22 to 23
2022-08-18 15:52:47,273 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 22 to 23
2022-08-18 15:52:47,277 [Thread-122] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), null
2022-08-18 15:52:47,277 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 23 to 24
2022-08-18 15:52:47,340 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), null
2022-08-18 15:52:47,345 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), Message:<EMPTY>)
2022-08-18 15:52:47,345 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=53, seq=0, Watch-ALL(18), Message:<EMPTY>
2022-08-18 15:52:47,349 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-08-18 15:52:47,350 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-08-18 15:52:47,350 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>
2022-08-18 15:52:47,350 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-08-18 15:52:47,350 [grpc-default-executor-5] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 23 to 24
2022-08-18 15:52:47,351 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), null
2022-08-18 15:52:47,351 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-08-18 15:52:47,351 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>)
2022-08-18 15:52:47,351 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>
2022-08-18 15:52:47,352 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>)
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>
2022-08-18 15:52:47,352 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), null
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-08-18 15:52:47,352 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>
2022-08-18 15:52:47,353 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-08-18 15:52:47,353 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=33, seq=0, Watch-ALL(13), Message:<EMPTY>
2022-08-18 15:52:47,353 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), null
2022-08-18 15:52:47,354 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>)
2022-08-18 15:52:47,354 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=39, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>
2022-08-18 15:52:47,354 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), null
2022-08-18 15:52:47,354 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), Message:<EMPTY>)
2022-08-18 15:52:47,354 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=49, seq=0, Watch-ALL(17), Message:<EMPTY>
2022-08-18 15:52:47,360 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), null
2022-08-18 15:52:47,361 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), null
2022-08-18 15:52:47,361 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), null
2022-08-18 15:52:47,361 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), null
2022-08-18 15:52:47,361 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), Message:<EMPTY>)
2022-08-18 15:52:47,362 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), null
2022-08-18 15:52:47,362 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), null
2022-08-18 15:52:47,362 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), null
2022-08-18 15:52:47,362 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=45, seq=0, Watch-ALL(16), Message:<EMPTY>
2022-08-18 15:52:47,362 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), null
2022-08-18 15:52:47,362 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), null
2022-08-18 15:52:47,362 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>)
2022-08-18 15:52:47,363 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=51, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>
2022-08-18 15:52:47,363 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), null
2022-08-18 15:52:47,363 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-08-18 15:52:47,363 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>
2022-08-18 15:52:47,363 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-08-18 15:52:47,363 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=35, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), Message:<EMPTY>)
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=55, seq=0, Watch-ALL_COMMITTED(18), Message:<EMPTY>
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=41, seq=0, Watch-ALL(15), Message:<EMPTY>
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-08-18 15:52:47,364 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=37, seq=0, Watch-ALL(14), Message:<EMPTY>
2022-08-18 15:52:47,365 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>)
2022-08-18 15:52:47,365 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=47, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>
2022-08-18 15:52:47,365 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>)
2022-08-18 15:52:47,365 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=43, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>
2022-08-18 15:52:47,377 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), null
2022-08-18 15:52:47,377 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-08-18 15:52:47,377 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>
2022-08-18 15:52:47,690 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c4, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,690 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:lambda$changeLeader$6(435)) - Changed leader from s2 to s0
2022-08-18 15:52:47,690 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:unblockRequestor(54)) - UnBlock requestor s2
2022-08-18 15:52:47,690 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(141)) - unblock FLUSH_STATE_MACHINE_DATA
2022-08-18 15:52:47,690 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(366)) - unblock follower s1
2022-08-18 15:52:47,690 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 0: logIndex=5
2022-08-18 15:52:47,691 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#54:OK-t3,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2022-08-18 15:52:47,692 [s1@group-82CF0218057B-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,692 [s1@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(613)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_3-22
2022-08-18 15:52:47,693 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#58:OK-t3,SUCCESS,nextIndex=8,followerCommit=6,matchIndex=7
2022-08-18 15:52:47,693 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#60:OK-t3,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2022-08-18 15:52:47,693 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-58CC921A4208
2022-08-18 15:52:47,693 [s1-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#61:OK-t3,SUCCESS,nextIndex=10,followerCommit=9,matchIndex=9
2022-08-18 15:52:47,698 [s1-server-thread6] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#64:OK-t3,SUCCESS,nextIndex=12,followerCommit=9,matchIndex=11
2022-08-18 15:52:47,698 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-58CC921A4208
2022-08-18 15:52:47,698 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-58CC921A4208
2022-08-18 15:52:47,693 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#63:OK-t3,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2022-08-18 15:52:47,698 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#418:OK-t3,SUCCESS,nextIndex=16,followerCommit=12,matchIndex=15
2022-08-18 15:52:47,693 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#55:OK-t3,SUCCESS,nextIndex=7,followerCommit=7,matchIndex=6
2022-08-18 15:52:47,699 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-58CC921A4208
2022-08-18 15:52:47,700 [s1-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#417:OK-t3,SUCCESS,nextIndex=15,followerCommit=12,matchIndex=14
2022-08-18 15:52:47,700 [s1-server-thread6] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#416:OK-t3,SUCCESS,nextIndex=14,followerCommit=12,matchIndex=13
2022-08-18 15:52:47,700 [s1-server-thread8] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#67:OK-t3,SUCCESS,nextIndex=13,followerCommit=12,matchIndex=12
2022-08-18 15:52:47,700 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 13, m4 -> (t:3, i:13), STATEMACHINELOGENTRY, 10@client-58CC921A4208
2022-08-18 15:52:47,700 [s1-server-thread6] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#420:OK-t3,SUCCESS,nextIndex=18,followerCommit=17,matchIndex=17
2022-08-18 15:52:47,701 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 14, m5 -> (t:3, i:14), STATEMACHINELOGENTRY, 11@client-58CC921A4208
2022-08-18 15:52:47,701 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 15, m6 -> (t:3, i:15), STATEMACHINELOGENTRY, 12@client-58CC921A4208
2022-08-18 15:52:47,701 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 16, m7 -> (t:3, i:16), STATEMACHINELOGENTRY, 13@client-58CC921A4208
2022-08-18 15:52:47,701 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 17, m8 -> (t:3, i:17), STATEMACHINELOGENTRY, 14@client-58CC921A4208
2022-08-18 15:52:47,700 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#423:OK-t3,SUCCESS,nextIndex=21,followerCommit=15,matchIndex=20
2022-08-18 15:52:47,700 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#424:OK-t3,SUCCESS,nextIndex=22,followerCommit=17,matchIndex=21
2022-08-18 15:52:47,700 [s1-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#421:OK-t3,SUCCESS,nextIndex=19,followerCommit=15,matchIndex=18
2022-08-18 15:52:47,700 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#422:OK-t3,SUCCESS,nextIndex=20,followerCommit=15,matchIndex=19
2022-08-18 15:52:47,701 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 4 to 17
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(5)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(7)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(9)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(11)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(13)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(14)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(15)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(16)@10.683s?NOT_DONE
2022-08-18 15:52:47,703 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(17)@10.683s?NOT_DONE
2022-08-18 15:52:47,700 [s1-server-thread9] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#419:OK-t3,SUCCESS,nextIndex=17,followerCommit=17,matchIndex=16
2022-08-18 15:52:47,709 [Thread-156] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=51, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,710 [s1@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(656)) - s1@group-82CF0218057B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b8d22ea4/MiniRaftClusterWithGrpcbf934d3/s1/51984aaf-0627-473c-9e4c-82cf0218057b/current/log_inprogress_23
2022-08-18 15:52:47,710 [s1-server-thread10] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s2<-s1#425:OK-t3,SUCCESS,nextIndex=23,followerCommit=18,matchIndex=22
2022-08-18 15:52:47,709 [Thread-155] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=47, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,710 [s1@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 18, m9 -> (t:3, i:18), STATEMACHINELOGENTRY, 15@client-58CC921A4208
2022-08-18 15:52:47,709 [Thread-154] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=43, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,708 [Thread-153] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=39, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,708 [Thread-152] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=35, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,710 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s1#6:OK-t4,SUCCESS,nextIndex=25,followerCommit=23,matchIndex=24
2022-08-18 15:52:47,708 [Thread-151] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=31, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,708 [Thread-150] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=27, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,707 [Thread-149] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=23, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,707 [Thread-148] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=19, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,711 [s1-server-thread9] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s1#1:OK-t4,SUCCESS,nextIndex=24,followerCommit=23,matchIndex=23
2022-08-18 15:52:47,712 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 17 to 23
2022-08-18 15:52:47,712 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL_COMMITTED(18)@10.683s?NOT_DONE
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL index from 0 to 23
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(5)@10.683s?NOT_DONE
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(7)@10.683s?NOT_DONE
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(9)@10.683s?NOT_DONE
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(11)@10.683s?NOT_DONE
2022-08-18 15:52:47,712 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(13)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(14)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(15)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(16)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(17)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s0@group-82CF0218057B-WatchRequests: complete Watch-ALL(18)@10.683s?NOT_DONE
2022-08-18 15:52:47,713 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL index from 23 to 24
2022-08-18 15:52:47,714 [Thread-157] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=55, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,714 [Thread-158] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=17, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,715 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(5) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=17, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,715 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(5) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=19, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,715 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 1: logIndex=7
2022-08-18 15:52:47,716 [Thread-159] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=21, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(7) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=21, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(7) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=23, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 2: logIndex=9
2022-08-18 15:52:47,716 [Thread-160] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=25, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(9) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=25, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(9) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=27, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,716 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 3: logIndex=11
2022-08-18 15:52:47,717 [Thread-161] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=29, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,717 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(11) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=29, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,717 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(11) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=31, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,717 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 4: logIndex=13
2022-08-18 15:52:47,717 [Thread-162] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=33, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(13) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=33, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(13) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=35, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 5: logIndex=14
2022-08-18 15:52:47,718 [Thread-163] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=37, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(14) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=37, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(14) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=39, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,718 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 6: logIndex=15
2022-08-18 15:52:47,719 [Thread-164] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=41, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,719 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(15) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=41, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,719 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(15) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=43, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,719 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 7: logIndex=16
2022-08-18 15:52:47,720 [Thread-165] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=45, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,720 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(16) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=45, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,720 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(16) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=47, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,720 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 8: logIndex=17
2022-08-18 15:52:47,720 [Thread-166] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=49, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,720 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(17) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=49, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(17) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=51, SUCCESS, logIndex=17, commits[s0:c24, s1:c17, s2:c24]
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 9: logIndex=18
2022-08-18 15:52:47,721 [Thread-167] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=53, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(18) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=53, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(18) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=55, SUCCESS, logIndex=23, commits[s0:c24, s1:c23, s2:c24]
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 20) numMessages=20, printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s1
2022-08-18 15:52:47,721 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-08-18 15:52:47,721 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-08-18 15:52:47,722 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 1: message=m1
2022-08-18 15:52:47,722 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 2: message=m2
2022-08-18 15:52:47,722 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 3: message=m3
2022-08-18 15:52:47,722 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 4: message=m4
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 5: message=m5
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 6: message=m6
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 7: message=m7
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 8: message=m8
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 9: message=m9
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 10: message=m10
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 11: message=m11
2022-08-18 15:52:47,723 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 12: message=m12
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 13: message=m13
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 14: message=m14
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 15: message=m15
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 16: message=m16
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 17: message=m17
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 18: message=m18
2022-08-18 15:52:47,724 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 19: message=m19
2022-08-18 15:52:47,790 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update ALL_COMMITTED index from 23 to 24
2022-08-18 15:52:47,836 [s1-server-thread4] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s1: unBlock request from s2
2022-08-18 15:52:47,837 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#556:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,837 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#560:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,837 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#564:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,838 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#568:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,838 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#572:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,838 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#576:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,839 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#580:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,839 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s1@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s1#584:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,839 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:52:47,841 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s2@group-82CF0218057B->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:47,841 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-82CF0218057B->s1: nextIndex: updateUnconditionally 5 -> 4
2022-08-18 15:52:47,858 [s0-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s0: unBlock request from s2
2022-08-18 15:52:47,859 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#154:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,859 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#155:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,859 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#156:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,860 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#157:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,860 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#158:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,860 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#159:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,861 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1367)) - s0@group-82CF0218057B: Not recognize s2 (term=3) as leader, state: s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s2<-s0#160:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-08-18 15:52:47,861 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:52:47,861 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s2@group-82CF0218057B->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:52:47,862 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-82CF0218057B->s0: nextIndex: updateUnconditionally 22 -> 21
2022-08-18 15:52:50,722 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=57, seq=14, RW, m1 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #57 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,723 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,723 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:52:50,723 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:52:50,723 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=58, seq=15, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #58 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,723 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,723 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,723 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=56, seq=13, RW, m0 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #56 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,722 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=59, seq=16, RW, m3 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #59 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #64 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=60, seq=17, RW, m4 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #60 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,724 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,725 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,724 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #66 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,725 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,725 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=65
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,725 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,726 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,726 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=67
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,726 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,726 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,726 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=68
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,727 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,724 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #62 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,724 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #63 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,724 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #61 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,728 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,724 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,725 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,728 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,728 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,729 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,729 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,729 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,729 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,729 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,730 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,730 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,730 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,730 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,730 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,730 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,731 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,731 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,731 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,731 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,731 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,731 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,732 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,737 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:50,737 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:50,830 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=56, seq=13*, RW, Message:6d30)
2022-08-18 15:52:50,831 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=56, seq=13*, RW, m0 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:50,831 [grpc-default-executor-2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:50,832 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:52:50,832 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:50,837 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=56, seq=13*, RW, Message:6d30)
2022-08-18 15:52:50,838 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=56, seq=13*, RW, Message:6d30, entry=(t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208
2022-08-18 15:52:50,839 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:24), 24, true, commits:[s0:c24, s1:c24, s2:c24], cId:58, entries: [(t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208]
2022-08-18 15:52:50,839 [s1-server-thread10] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:24), 24, true, commits:[s0:c24, s1:c24, s2:c24], cId:109, entries: [(t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208]
2022-08-18 15:52:50,840 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#58:OK-t4,SUCCESS,nextIndex=26,followerCommit=24,matchIndex=25
2022-08-18 15:52:50,840 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 25, m0 -> (t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208
2022-08-18 15:52:50,841 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 24 to 25
2022-08-18 15:52:50,841 [s1-server-thread10] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:25), 25, true, commits:[s0:c25, s1:c24, s2:c24], cId:110, entries: [(t:4, i:26), METADATAENTRY(c:25)]
2022-08-18 15:52:50,842 [grpc-default-executor-4] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=25
2022-08-18 15:52:50,842 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=76, seq=0, Watch(25), null
2022-08-18 15:52:50,842 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:52:50,842 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), null
2022-08-18 15:52:50,842 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:52:50,843 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=56, SUCCESS, logIndex=25, commits[s0:c25, s1:c24, s2:c24]
2022-08-18 15:52:50,843 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=76, seq=0, Watch(25), Message:<EMPTY>)
2022-08-18 15:52:50,843 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=76, seq=0, Watch(25), Message:<EMPTY>
2022-08-18 15:52:50,843 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:25), 25, true, commits:[s0:c25, s1:c24, s2:c24], cId:59, entries: [(t:4, i:26), METADATAENTRY(c:25)]
2022-08-18 15:52:50,844 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:52:50,844 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:52:50,845 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#59:OK-t4,SUCCESS,nextIndex=27,followerCommit=25,matchIndex=26
2022-08-18 15:52:50,845 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 25, m0 -> (t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208
2022-08-18 15:52:50,845 [Thread-168] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=76, SUCCESS, logIndex=25, commits[s0:c25, s1:c24, s2:c24]
2022-08-18 15:52:50,845 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(25) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=76, SUCCESS, logIndex=25, commits[s0:c25, s1:c24, s2:c24]
2022-08-18 15:52:50,845 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 24 to 25
2022-08-18 15:52:50,846 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 25 to 26
2022-08-18 15:52:50,845 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:52:50,846 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:52:50,846 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:52:50,846 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:52:50,850 [Thread-169] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=78, SUCCESS, logIndex=25, commits[s0:c26, s1:c24, s2:c25]
2022-08-18 15:52:50,850 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(25) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=78, SUCCESS, logIndex=25, commits[s0:c26, s1:c24, s2:c25]
2022-08-18 15:52:50,922 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 25 to 26
2022-08-18 15:52:53,739 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=110, target=localhost:33205}}. 
2022-08-18 15:52:53,838 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=109,entriesCount=1,lastEntry=(t:4, i:25)
2022-08-18 15:52:53,841 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=110,entriesCount=1,lastEntry=(t:4, i:26)
2022-08-18 15:52:53,841 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=57, seq=14, RW, Message:6d31)
2022-08-18 15:52:53,842 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=57, seq=14, RW, Message:6d31, entry=(t:4, i:27), STATEMACHINELOGENTRY, 57@client-58CC921A4208
2022-08-18 15:52:53,842 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=58, seq=15, RW, Message:6d32)
2022-08-18 15:52:53,842 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=58, seq=15, RW, Message:6d32, entry=(t:4, i:28), STATEMACHINELOGENTRY, 58@client-58CC921A4208
2022-08-18 15:52:53,843 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=59, seq=16, RW, Message:6d33)
2022-08-18 15:52:53,843 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=59, seq=16, RW, Message:6d33, entry=(t:4, i:29), STATEMACHINELOGENTRY, 59@client-58CC921A4208
2022-08-18 15:52:53,843 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=60, seq=17, RW, Message:6d34)
2022-08-18 15:52:53,844 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=60, seq=17, RW, Message:6d34, entry=(t:4, i:30), STATEMACHINELOGENTRY, 60@client-58CC921A4208
2022-08-18 15:52:53,844 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=58, seq=15, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #58 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,844 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, Message:6d35)
2022-08-18 15:52:53,844 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=60, seq=17, RW, m4 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #60 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,845 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,845 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-08-18 15:52:53,845 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:52:53,845 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, Message:6d35, entry=(t:4, i:31), STATEMACHINELOGENTRY, 61@client-58CC921A4208
2022-08-18 15:52:53,845 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:26), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:466, entries: [(t:4, i:27), STATEMACHINELOGENTRY, 57@client-58CC921A4208]
2022-08-18 15:52:53,845 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, Message:6d36)
2022-08-18 15:52:53,845 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #62 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,847 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,847 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,847 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:26), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:107, entries: [(t:4, i:27), STATEMACHINELOGENTRY, 57@client-58CC921A4208, (t:4, i:28), STATEMACHINELOGENTRY, 58@client-58CC921A4208, (t:4, i:29), STATEMACHINELOGENTRY, 59@client-58CC921A4208]
2022-08-18 15:52:53,848 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:27), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:467, entries: [(t:4, i:28), STATEMACHINELOGENTRY, 58@client-58CC921A4208, (t:4, i:29), STATEMACHINELOGENTRY, 59@client-58CC921A4208]
2022-08-18 15:52:53,848 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#107:OK-t4,SUCCESS,nextIndex=30,followerCommit=26,matchIndex=29
2022-08-18 15:52:53,844 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,848 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,846 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=64
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,848 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,848 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,848 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=65
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,849 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,849 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,849 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=66
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,849 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,849 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,849 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=67
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,849 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,850 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,850 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=68
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,850 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,850 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,850 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,850 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,846 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #63 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,858 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,858 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,858 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,859 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,861 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,862 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,862 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,845 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, Message:6d36, entry=(t:4, i:32), STATEMACHINELOGENTRY, 62@client-58CC921A4208
2022-08-18 15:52:53,845 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=59, seq=16, RW, m3 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #59 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,862 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,862 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,862 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,845 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #61 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,863 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,863 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,863 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,863 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 26 to 29
2022-08-18 15:52:53,862 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 27, m1 -> (t:4, i:27), STATEMACHINELOGENTRY, 57@client-58CC921A4208
2022-08-18 15:52:53,864 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 28, m2 -> (t:4, i:28), STATEMACHINELOGENTRY, 58@client-58CC921A4208
2022-08-18 15:52:53,864 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 29, m3 -> (t:4, i:29), STATEMACHINELOGENTRY, 59@client-58CC921A4208
2022-08-18 15:52:53,862 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, Message:6d37)
2022-08-18 15:52:53,850 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:29), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:108, entries: [(t:4, i:30), STATEMACHINELOGENTRY, 60@client-58CC921A4208, (t:4, i:31), STATEMACHINELOGENTRY, 61@client-58CC921A4208, (t:4, i:32), STATEMACHINELOGENTRY, 62@client-58CC921A4208]
2022-08-18 15:52:53,848 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:29), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:468, entries: [(t:4, i:30), STATEMACHINELOGENTRY, 60@client-58CC921A4208]
2022-08-18 15:52:53,865 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,865 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,865 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,865 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,866 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,866 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,866 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:30), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:469, entries: [(t:4, i:31), STATEMACHINELOGENTRY, 61@client-58CC921A4208]
2022-08-18 15:52:53,866 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,866 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,866 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,866 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#108:OK-t4,SUCCESS,nextIndex=33,followerCommit=26,matchIndex=32
2022-08-18 15:52:53,866 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,867 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,867 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,867 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=57, seq=14, RW, m1 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=57
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,867 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,867 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,866 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:31), 26, true, commits:[s0:c26, s1:c24, s2:c26], cId:470, entries: [(t:4, i:32), STATEMACHINELOGENTRY, 62@client-58CC921A4208]
2022-08-18 15:52:53,867 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:32), 29, true, commits:[s0:c29, s1:c24, s2:c26], cId:109, entries: [(t:4, i:33), METADATAENTRY(c:29)]
2022-08-18 15:52:53,868 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:32), 29, true, commits:[s0:c29, s1:c24, s2:c26], cId:472, entries: [(t:4, i:33), METADATAENTRY(c:29)]
2022-08-18 15:52:53,868 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#109:OK-t4,SUCCESS,nextIndex=34,followerCommit=29,matchIndex=33
2022-08-18 15:52:53,868 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 27, m1 -> (t:4, i:27), STATEMACHINELOGENTRY, 57@client-58CC921A4208
2022-08-18 15:52:53,868 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 28, m2 -> (t:4, i:28), STATEMACHINELOGENTRY, 58@client-58CC921A4208
2022-08-18 15:52:53,868 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 29, m3 -> (t:4, i:29), STATEMACHINELOGENTRY, 59@client-58CC921A4208
2022-08-18 15:52:53,869 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:33), 29, true, commits:[s0:c29, s1:c24, s2:c26], cId:111, entries: [(t:4, i:34), STATEMACHINELOGENTRY, 63@client-58CC921A4208]
2022-08-18 15:52:53,869 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 26 to 29
2022-08-18 15:52:53,870 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#111:OK-t4,SUCCESS,nextIndex=35,followerCommit=29,matchIndex=34
2022-08-18 15:52:53,870 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:33), 29, true, commits:[s0:c29, s1:c24, s2:c29], cId:474, entries: [(t:4, i:34), STATEMACHINELOGENTRY, 63@client-58CC921A4208]
2022-08-18 15:52:53,870 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, Message:6d37, entry=(t:4, i:34), STATEMACHINELOGENTRY, 63@client-58CC921A4208
2022-08-18 15:52:53,870 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 29 to 34
2022-08-18 15:52:53,871 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 30, m4 -> (t:4, i:30), STATEMACHINELOGENTRY, 60@client-58CC921A4208
2022-08-18 15:52:53,871 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 31, m5 -> (t:4, i:31), STATEMACHINELOGENTRY, 61@client-58CC921A4208
2022-08-18 15:52:53,871 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 32, m6 -> (t:4, i:32), STATEMACHINELOGENTRY, 62@client-58CC921A4208
2022-08-18 15:52:53,871 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:34), 34, true, commits:[s0:c34, s1:c24, s2:c29], cId:112, entries: [(t:4, i:35), METADATAENTRY(c:34)]
2022-08-18 15:52:53,871 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 34, m7 -> (t:4, i:34), STATEMACHINELOGENTRY, 63@client-58CC921A4208
2022-08-18 15:52:53,871 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:34), 34, true, commits:[s0:c34, s1:c24, s2:c29], cId:476, entries: [(t:4, i:35), METADATAENTRY(c:34)]
2022-08-18 15:52:53,871 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, Message:6d38)
2022-08-18 15:52:53,872 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#112:OK-t4,SUCCESS,nextIndex=36,followerCommit=34,matchIndex=35
2022-08-18 15:52:53,872 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 30, m4 -> (t:4, i:30), STATEMACHINELOGENTRY, 60@client-58CC921A4208
2022-08-18 15:52:53,872 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 31, m5 -> (t:4, i:31), STATEMACHINELOGENTRY, 61@client-58CC921A4208
2022-08-18 15:52:53,872 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 29 to 34
2022-08-18 15:52:53,872 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 32, m6 -> (t:4, i:32), STATEMACHINELOGENTRY, 62@client-58CC921A4208
2022-08-18 15:52:53,873 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 34, m7 -> (t:4, i:34), STATEMACHINELOGENTRY, 63@client-58CC921A4208
2022-08-18 15:52:53,873 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, Message:6d38, entry=(t:4, i:36), STATEMACHINELOGENTRY, 64@client-58CC921A4208
2022-08-18 15:52:53,873 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:35), 34, true, commits:[s0:c34, s1:c24, s2:c34], cId:477, entries: [(t:4, i:36), STATEMACHINELOGENTRY, 64@client-58CC921A4208]
2022-08-18 15:52:53,874 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 34 to 35
2022-08-18 15:52:53,874 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:35), 34, true, commits:[s0:c34, s1:c24, s2:c34], cId:113, entries: [(t:4, i:36), STATEMACHINELOGENTRY, 64@client-58CC921A4208]
2022-08-18 15:52:53,874 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#113:OK-t4,SUCCESS,nextIndex=37,followerCommit=34,matchIndex=36
2022-08-18 15:52:53,875 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 36, m8 -> (t:4, i:36), STATEMACHINELOGENTRY, 64@client-58CC921A4208
2022-08-18 15:52:53,875 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 35 to 36
2022-08-18 15:52:53,875 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:36), 36, true, commits:[s0:c36, s1:c24, s2:c34], cId:480, entries: [(t:4, i:37), METADATAENTRY(c:36)]
2022-08-18 15:52:53,875 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:36), 36, true, commits:[s0:c36, s1:c24, s2:c34], cId:116, entries: [(t:4, i:37), METADATAENTRY(c:36)]
2022-08-18 15:52:53,876 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#116:OK-t4,SUCCESS,nextIndex=38,followerCommit=36,matchIndex=37
2022-08-18 15:52:53,876 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 36, m8 -> (t:4, i:36), STATEMACHINELOGENTRY, 64@client-58CC921A4208
2022-08-18 15:52:53,877 [grpc-default-executor-5] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 34 to 36
2022-08-18 15:52:53,877 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 36 to 37
2022-08-18 15:52:53,885 [Thread-171] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:53,885 [Thread-171] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,887 [Thread-171] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,888 [Thread-171] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:53,888 [Thread-171] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,887 [Thread-172] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:53,887 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, Message:6d39)
2022-08-18 15:52:53,888 [Thread-172] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,888 [Thread-172] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:53,889 [Thread-172] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:53,889 [Thread-172] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:53,889 [Thread-172] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:52:53,888 [Thread-171] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:52:53,889 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, Message:6d39, entry=(t:4, i:38), STATEMACHINELOGENTRY, 65@client-58CC921A4208
2022-08-18 15:52:53,890 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:37), 37, true, commits:[s0:c37, s1:c24, s2:c36], cId:485, entries: [(t:4, i:38), STATEMACHINELOGENTRY, 65@client-58CC921A4208]
2022-08-18 15:52:53,890 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, Message:6d3130)
2022-08-18 15:52:53,890 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:37), 37, true, commits:[s0:c37, s1:c24, s2:c36], cId:119, entries: [(t:4, i:38), STATEMACHINELOGENTRY, 65@client-58CC921A4208]
2022-08-18 15:52:53,891 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#119:OK-t4,SUCCESS,nextIndex=39,followerCommit=37,matchIndex=38
2022-08-18 15:52:53,891 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 36 to 37
2022-08-18 15:52:53,891 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, Message:6d3130, entry=(t:4, i:39), STATEMACHINELOGENTRY, 66@client-58CC921A4208
2022-08-18 15:52:53,892 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:38), 37, true, commits:[s0:c37, s1:c24, s2:c37], cId:486, entries: [(t:4, i:39), STATEMACHINELOGENTRY, 66@client-58CC921A4208]
2022-08-18 15:52:53,892 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 37 to 38
2022-08-18 15:52:53,892 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 38, m9 -> (t:4, i:38), STATEMACHINELOGENTRY, 65@client-58CC921A4208
2022-08-18 15:52:53,892 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:39), 38, true, commits:[s0:c38, s1:c24, s2:c37], cId:487, entries: [(t:4, i:40), METADATAENTRY(c:38)]
2022-08-18 15:52:53,892 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:38), 37, true, commits:[s0:c37, s1:c24, s2:c37], cId:120, entries: [(t:4, i:39), STATEMACHINELOGENTRY, 66@client-58CC921A4208]
2022-08-18 15:52:53,893 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24, RW, Message:6d3131)
2022-08-18 15:52:53,893 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24, RW, Message:6d3131, entry=(t:4, i:41), STATEMACHINELOGENTRY, 67@client-58CC921A4208
2022-08-18 15:52:53,893 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:39), 38, true, commits:[s0:c38, s1:c24, s2:c37], cId:121, entries: [(t:4, i:40), METADATAENTRY(c:38)]
2022-08-18 15:52:53,893 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#120:OK-t4,SUCCESS,nextIndex=40,followerCommit=37,matchIndex=39
2022-08-18 15:52:53,894 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 39, m10 -> (t:4, i:39), STATEMACHINELOGENTRY, 66@client-58CC921A4208
2022-08-18 15:52:53,894 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:40), 38, true, commits:[s0:c38, s1:c24, s2:c37], cId:122, entries: [(t:4, i:41), STATEMACHINELOGENTRY, 67@client-58CC921A4208]
2022-08-18 15:52:53,895 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, Message:6d3132)
2022-08-18 15:52:53,895 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#121:OK-t4,SUCCESS,nextIndex=41,followerCommit=38,matchIndex=40
2022-08-18 15:52:53,895 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 38, m9 -> (t:4, i:38), STATEMACHINELOGENTRY, 65@client-58CC921A4208
2022-08-18 15:52:53,894 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 38 to 39
2022-08-18 15:52:53,895 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#122:OK-t4,SUCCESS,nextIndex=42,followerCommit=38,matchIndex=41
2022-08-18 15:52:53,895 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, Message:6d3132, entry=(t:4, i:43), STATEMACHINELOGENTRY, 68@client-58CC921A4208
2022-08-18 15:52:53,896 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 37 to 38
2022-08-18 15:52:53,896 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 39 to 40
2022-08-18 15:52:53,897 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:41), 39, true, commits:[s0:c39, s1:c24, s2:c37], cId:124, entries: [(t:4, i:42), METADATAENTRY(c:39)]
2022-08-18 15:52:53,897 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:40), 39, true, commits:[s0:c39, s1:c24, s2:c37], cId:488, entries: [(t:4, i:41), STATEMACHINELOGENTRY, 67@client-58CC921A4208, (t:4, i:42), METADATAENTRY(c:39)]
2022-08-18 15:52:53,897 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, Message:6d3133)
2022-08-18 15:52:53,898 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, Message:6d3133, entry=(t:4, i:44), STATEMACHINELOGENTRY, 69@client-58CC921A4208
2022-08-18 15:52:53,898 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#124:OK-t4,SUCCESS,nextIndex=43,followerCommit=39,matchIndex=42
2022-08-18 15:52:53,898 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 39, m10 -> (t:4, i:39), STATEMACHINELOGENTRY, 66@client-58CC921A4208
2022-08-18 15:52:53,899 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 41, m11 -> (t:4, i:41), STATEMACHINELOGENTRY, 67@client-58CC921A4208
2022-08-18 15:52:53,899 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 40 to 41
2022-08-18 15:52:53,899 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:42), 39, true, commits:[s0:c39, s1:c24, s2:c37], cId:125, entries: [(t:4, i:43), STATEMACHINELOGENTRY, 68@client-58CC921A4208]
2022-08-18 15:52:53,900 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:42), 39, true, commits:[s0:c39, s1:c24, s2:c37], cId:490, entries: [(t:4, i:43), STATEMACHINELOGENTRY, 68@client-58CC921A4208]
2022-08-18 15:52:53,900 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 38 to 39
2022-08-18 15:52:53,900 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:43), 40, true, commits:[s0:c40, s1:c24, s2:c38], cId:127, entries: [(t:4, i:44), STATEMACHINELOGENTRY, 69@client-58CC921A4208]
2022-08-18 15:52:53,900 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 41 to 42
2022-08-18 15:52:53,901 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#125:OK-t4,SUCCESS,nextIndex=44,followerCommit=39,matchIndex=43
2022-08-18 15:52:53,901 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#127:OK-t4,SUCCESS,nextIndex=45,followerCommit=40,matchIndex=44
2022-08-18 15:52:53,901 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 42 to 43
2022-08-18 15:52:53,901 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 43, m12 -> (t:4, i:43), STATEMACHINELOGENTRY, 68@client-58CC921A4208
2022-08-18 15:52:53,902 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, Message:6d3134)
2022-08-18 15:52:53,902 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, Message:6d3134, entry=(t:4, i:47), STATEMACHINELOGENTRY, 70@client-58CC921A4208
2022-08-18 15:52:53,902 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:44), 41, true, commits:[s0:c41, s1:c24, s2:c38], cId:128, entries: [(t:4, i:45), METADATAENTRY(c:41)]
2022-08-18 15:52:53,903 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 39 to 40
2022-08-18 15:52:53,903 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:43), 40, true, commits:[s0:c40, s1:c24, s2:c38], cId:492, entries: [(t:4, i:44), STATEMACHINELOGENTRY, 69@client-58CC921A4208]
2022-08-18 15:52:53,903 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:45), 43, true, commits:[s0:c43, s1:c24, s2:c39], cId:133, entries: [(t:4, i:46), METADATAENTRY(c:43)]
2022-08-18 15:52:53,904 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 44, m13 -> (t:4, i:44), STATEMACHINELOGENTRY, 69@client-58CC921A4208
2022-08-18 15:52:53,904 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 43 to 44
2022-08-18 15:52:53,904 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#133:OK-t4,SUCCESS,nextIndex=47,followerCommit=43,matchIndex=46
2022-08-18 15:52:53,904 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 41, m11 -> (t:4, i:41), STATEMACHINELOGENTRY, 67@client-58CC921A4208
2022-08-18 15:52:53,904 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#128:OK-t4,SUCCESS,nextIndex=46,followerCommit=43,matchIndex=45
2022-08-18 15:52:53,904 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 43, m12 -> (t:4, i:43), STATEMACHINELOGENTRY, 68@client-58CC921A4208
2022-08-18 15:52:53,905 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 40 to 43
2022-08-18 15:52:53,905 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:44), 41, true, commits:[s0:c41, s1:c24, s2:c38], cId:493, entries: [(t:4, i:45), METADATAENTRY(c:41)]
2022-08-18 15:52:53,905 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 44 to 45
2022-08-18 15:52:53,905 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:46), 43, true, commits:[s0:c43, s1:c24, s2:c39], cId:134, entries: [(t:4, i:47), STATEMACHINELOGENTRY, 70@client-58CC921A4208]
2022-08-18 15:52:53,906 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, Message:6d3135)
2022-08-18 15:52:53,906 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, Message:6d3135, entry=(t:4, i:49), STATEMACHINELOGENTRY, 71@client-58CC921A4208
2022-08-18 15:52:53,907 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:47), 44, true, commits:[s0:c44, s1:c24, s2:c40], cId:136, entries: [(t:4, i:48), METADATAENTRY(c:44)]
2022-08-18 15:52:53,907 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 45 to 46
2022-08-18 15:52:53,907 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:45), 43, true, commits:[s0:c43, s1:c24, s2:c39], cId:497, entries: [(t:4, i:46), METADATAENTRY(c:43)]
2022-08-18 15:52:53,907 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#136:OK-t4,SUCCESS,nextIndex=49,followerCommit=44,matchIndex=48
2022-08-18 15:52:53,907 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#134:OK-t4,SUCCESS,nextIndex=48,followerCommit=44,matchIndex=47
2022-08-18 15:52:53,907 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 44, m13 -> (t:4, i:44), STATEMACHINELOGENTRY, 69@client-58CC921A4208
2022-08-18 15:52:53,908 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:48), 45, true, commits:[s0:c45, s1:c24, s2:c43], cId:139, entries: [(t:4, i:49), STATEMACHINELOGENTRY, 71@client-58CC921A4208]
2022-08-18 15:52:53,908 [grpc-default-executor-5] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 43 to 44
2022-08-18 15:52:53,908 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 46 to 47
2022-08-18 15:52:53,908 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 47, m14 -> (t:4, i:47), STATEMACHINELOGENTRY, 70@client-58CC921A4208
2022-08-18 15:52:53,909 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:46), 43, true, commits:[s0:c43, s1:c24, s2:c39], cId:498, entries: [(t:4, i:47), STATEMACHINELOGENTRY, 70@client-58CC921A4208]
2022-08-18 15:52:53,909 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#139:OK-t4,SUCCESS,nextIndex=50,followerCommit=45,matchIndex=49
2022-08-18 15:52:53,909 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, Message:6d3136)
2022-08-18 15:52:53,909 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, Message:6d3136, entry=(t:4, i:51), STATEMACHINELOGENTRY, 72@client-58CC921A4208
2022-08-18 15:52:53,909 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, Message:6d3137)
2022-08-18 15:52:53,910 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, Message:6d3137, entry=(t:4, i:52), STATEMACHINELOGENTRY, 73@client-58CC921A4208
2022-08-18 15:52:53,910 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, Message:6d3138)
2022-08-18 15:52:53,910 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 47 to 48
2022-08-18 15:52:53,910 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:49), 47, true, commits:[s0:c47, s1:c24, s2:c44], cId:143, entries: [(t:4, i:50), METADATAENTRY(c:47)]
2022-08-18 15:52:53,911 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, Message:6d3138, entry=(t:4, i:53), STATEMACHINELOGENTRY, 74@client-58CC921A4208
2022-08-18 15:52:53,911 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, Message:6d3139)
2022-08-18 15:52:53,911 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(401)) - s0@group-82CF0218057B-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, Message:6d3139, entry=(t:4, i:54), STATEMACHINELOGENTRY, 75@client-58CC921A4208
2022-08-18 15:52:53,911 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#143:OK-t4,SUCCESS,nextIndex=51,followerCommit=47,matchIndex=50
2022-08-18 15:52:53,912 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 44 to 45
2022-08-18 15:52:53,912 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 47, m14 -> (t:4, i:47), STATEMACHINELOGENTRY, 70@client-58CC921A4208
2022-08-18 15:52:53,912 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 48 to 49
2022-08-18 15:52:53,912 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 49, m15 -> (t:4, i:49), STATEMACHINELOGENTRY, 71@client-58CC921A4208
2022-08-18 15:52:53,913 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:47), 44, true, commits:[s0:c44, s1:c24, s2:c40], cId:500, entries: [(t:4, i:48), METADATAENTRY(c:44)]
2022-08-18 15:52:53,913 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:50), 47, true, commits:[s0:c47, s1:c24, s2:c44], cId:144, entries: [(t:4, i:51), STATEMACHINELOGENTRY, 72@client-58CC921A4208, (t:4, i:52), STATEMACHINELOGENTRY, 73@client-58CC921A4208]
2022-08-18 15:52:53,913 [grpc-default-executor-0] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 45 to 47
2022-08-18 15:52:53,914 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#144:OK-t4,SUCCESS,nextIndex=53,followerCommit=47,matchIndex=52
2022-08-18 15:52:53,914 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 49 to 50
2022-08-18 15:52:53,914 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:48), 45, true, commits:[s0:c45, s1:c24, s2:c43], cId:503, entries: [(t:4, i:49), STATEMACHINELOGENTRY, 71@client-58CC921A4208]
2022-08-18 15:52:53,914 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:52), 48, true, commits:[s0:c48, s1:c24, s2:c44], cId:146, entries: [(t:4, i:53), STATEMACHINELOGENTRY, 74@client-58CC921A4208]
2022-08-18 15:52:53,914 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#146:OK-t4,SUCCESS,nextIndex=54,followerCommit=48,matchIndex=53
2022-08-18 15:52:53,915 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:49), 47, true, commits:[s0:c47, s1:c24, s2:c44], cId:506, entries: [(t:4, i:50), METADATAENTRY(c:47)]
2022-08-18 15:52:53,915 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:53), 48, true, commits:[s0:c48, s1:c24, s2:c44], cId:147, entries: [(t:4, i:54), STATEMACHINELOGENTRY, 75@client-58CC921A4208]
2022-08-18 15:52:53,915 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#147:OK-t4,SUCCESS,nextIndex=55,followerCommit=48,matchIndex=54
2022-08-18 15:52:53,916 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:50), 47, true, commits:[s0:c47, s1:c24, s2:c44], cId:507, entries: [(t:4, i:51), STATEMACHINELOGENTRY, 72@client-58CC921A4208]
2022-08-18 15:52:53,916 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:54), 49, true, commits:[s0:c49, s1:c24, s2:c45], cId:149, entries: [(t:4, i:55), METADATAENTRY(c:49)]
2022-08-18 15:52:53,916 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 51, m16 -> (t:4, i:51), STATEMACHINELOGENTRY, 72@client-58CC921A4208
2022-08-18 15:52:53,916 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#149:OK-t4,SUCCESS,nextIndex=56,followerCommit=49,matchIndex=55
2022-08-18 15:52:53,917 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 49, m15 -> (t:4, i:49), STATEMACHINELOGENTRY, 71@client-58CC921A4208
2022-08-18 15:52:53,917 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 50 to 52
2022-08-18 15:52:53,917 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 52, m17 -> (t:4, i:52), STATEMACHINELOGENTRY, 73@client-58CC921A4208
2022-08-18 15:52:53,917 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 47 to 48
2022-08-18 15:52:53,917 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 52 to 53
2022-08-18 15:52:53,918 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 53, m18 -> (t:4, i:53), STATEMACHINELOGENTRY, 74@client-58CC921A4208
2022-08-18 15:52:53,918 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:51), 47, true, commits:[s0:c47, s1:c24, s2:c44], cId:508, entries: [(t:4, i:52), STATEMACHINELOGENTRY, 73@client-58CC921A4208]
2022-08-18 15:52:53,919 [s0@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 54, m19 -> (t:4, i:54), STATEMACHINELOGENTRY, 75@client-58CC921A4208
2022-08-18 15:52:53,919 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 53 to 54
2022-08-18 15:52:53,919 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:55), 52, true, commits:[s0:c52, s1:c24, s2:c48], cId:153, entries: [(t:4, i:56), METADATAENTRY(c:52)]
2022-08-18 15:52:53,919 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:52), 48, true, commits:[s0:c48, s1:c24, s2:c44], cId:510, entries: [(t:4, i:53), STATEMACHINELOGENTRY, 74@client-58CC921A4208]
2022-08-18 15:52:53,920 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#153:OK-t4,SUCCESS,nextIndex=57,followerCommit=52,matchIndex=56
2022-08-18 15:52:53,920 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 51, m16 -> (t:4, i:51), STATEMACHINELOGENTRY, 72@client-58CC921A4208
2022-08-18 15:52:53,920 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 48 to 49
2022-08-18 15:52:53,920 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 52, m17 -> (t:4, i:52), STATEMACHINELOGENTRY, 73@client-58CC921A4208
2022-08-18 15:52:53,921 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:53), 48, true, commits:[s0:c48, s1:c24, s2:c44], cId:511, entries: [(t:4, i:54), STATEMACHINELOGENTRY, 75@client-58CC921A4208]
2022-08-18 15:52:53,921 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:56), 53, true, commits:[s0:c53, s1:c24, s2:c48], cId:154, entries: [(t:4, i:57), METADATAENTRY(c:53)]
2022-08-18 15:52:53,921 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:54), 49, true, commits:[s0:c49, s1:c24, s2:c45], cId:513, entries: [(t:4, i:55), METADATAENTRY(c:49)]
2022-08-18 15:52:53,921 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#154:OK-t4,SUCCESS,nextIndex=58,followerCommit=53,matchIndex=57
2022-08-18 15:52:53,922 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 54 to 55
2022-08-18 15:52:53,922 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 53, m18 -> (t:4, i:53), STATEMACHINELOGENTRY, 74@client-58CC921A4208
2022-08-18 15:52:53,922 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:55), 52, true, commits:[s0:c52, s1:c24, s2:c48], cId:516, entries: [(t:4, i:56), METADATAENTRY(c:52)]
2022-08-18 15:52:53,923 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:57), 54, true, commits:[s0:c54, s1:c24, s2:c48], cId:156, entries: [(t:4, i:58), METADATAENTRY(c:54)]
2022-08-18 15:52:53,923 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:56), 53, true, commits:[s0:c53, s1:c24, s2:c48], cId:517, entries: [(t:4, i:57), METADATAENTRY(c:53)]
2022-08-18 15:52:53,923 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 49 to 52
2022-08-18 15:52:53,923 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s2@group-82CF0218057B: succeeded to handle AppendEntries. Reply: s0<-s2#156:OK-t4,SUCCESS,nextIndex=59,followerCommit=54,matchIndex=58
2022-08-18 15:52:53,923 [s2@group-82CF0218057B-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 54, m19 -> (t:4, i:54), STATEMACHINELOGENTRY, 75@client-58CC921A4208
2022-08-18 15:52:53,924 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 55 to 56
2022-08-18 15:52:53,924 [s1-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1304)) - s1@group-82CF0218057B: receive appendEntries(s0, 4, (t:4, i:57), 54, true, commits:[s0:c54, s1:c24, s2:c48], cId:518, entries: [(t:4, i:58), METADATAENTRY(c:54)]
2022-08-18 15:52:53,924 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 52 to 53
2022-08-18 15:52:53,924 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 56 to 57
2022-08-18 15:52:53,924 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 53 to 54
2022-08-18 15:52:53,924 [s0@group-82CF0218057B-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY index from 57 to 58
2022-08-18 15:52:53,971 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=57, seq=14*, RW, Message:6d31)
2022-08-18 15:52:53,973 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=57, seq=14*, RW, m1 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:53,973 [grpc-default-executor-0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:53,973 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-08-18 15:52:53,973 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:53,979 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=57, seq=14*, RW, Message:6d31)
2022-08-18 15:52:53,982 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m1, logIndex=27
2022-08-18 15:52:53,982 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=80, seq=0, Watch(27), null
2022-08-18 15:52:53,982 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:52:53,982 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), null
2022-08-18 15:52:53,982 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:52:53,983 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 1: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=57, SUCCESS, logIndex=27, commits[s0:c29, s1:c24, s2:c26]
2022-08-18 15:52:53,986 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=58, seq=15, RW, Message:6d32)
2022-08-18 15:52:53,986 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=80, seq=0, Watch(27), Message:<EMPTY>)
2022-08-18 15:52:53,986 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=80, seq=0, Watch(27), Message:<EMPTY>
2022-08-18 15:52:53,986 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=59, seq=16, RW, Message:6d33)
2022-08-18 15:52:53,986 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:52:53,986 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m2, logIndex=28
2022-08-18 15:52:53,986 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:52:53,987 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=84, seq=0, Watch(28), null
2022-08-18 15:52:53,987 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:52:53,987 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:52:53,988 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:52:53,988 [Thread-173] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=80, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,988 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:52:53,988 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:52:53,988 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), null
2022-08-18 15:52:53,988 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(27) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=80, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,989 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=84, seq=0, Watch(28), Message:<EMPTY>)
2022-08-18 15:52:53,989 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=84, seq=0, Watch(28), Message:<EMPTY>
2022-08-18 15:52:53,988 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:52:53,989 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:52:53,989 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:52:53,989 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:52:53,990 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:52:53,990 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:52:53,990 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:52:53,990 [grpc-default-executor-0] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m3, logIndex=29
2022-08-18 15:52:53,990 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:52:53,991 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=88, seq=0, Watch(29), null
2022-08-18 15:52:53,991 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:52:53,995 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:52:53,995 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), null
2022-08-18 15:52:53,995 [grpc-default-executor-0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:52:53,995 [Thread-174] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=82, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,995 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(27) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=82, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,996 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 2: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=58, SUCCESS, logIndex=28, commits[s0:c29, s1:c24, s2:c26]
2022-08-18 15:52:53,996 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:52:53,996 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:52:53,996 [Thread-175] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=84, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,996 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=88, seq=0, Watch(29), Message:<EMPTY>)
2022-08-18 15:52:53,996 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(28) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=84, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,996 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=88, seq=0, Watch(29), Message:<EMPTY>
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:52:53,997 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:52:53,998 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:52:53,998 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:52:53,998 [Thread-176] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=86, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,998 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(28) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=86, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,999 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 3: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=59, SUCCESS, logIndex=29, commits[s0:c29, s1:c24, s2:c26]
2022-08-18 15:52:53,999 [Thread-177] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=88, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,999 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(29) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=88, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,999 [Thread-178] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=90, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:53,999 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(29) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=90, SUCCESS, logIndex=54, commits[s0:c58, s1:c24, s2:c54]
2022-08-18 15:52:54,000 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-82CF0218057B-WatchRequests: update MAJORITY_COMMITTED index from 54 to 58
2022-08-18 15:52:56,842 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=466,entriesCount=1,lastEntry=(t:4, i:27)
2022-08-18 15:52:56,843 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=467,entriesCount=2,lastEntry=(t:4, i:29)
2022-08-18 15:52:56,844 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=468,entriesCount=1,lastEntry=(t:4, i:30)
2022-08-18 15:52:56,845 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=469,entriesCount=1,lastEntry=(t:4, i:31)
2022-08-18 15:52:56,869 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=474,entriesCount=1,lastEntry=(t:4, i:34)
2022-08-18 15:52:56,871 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=476,entriesCount=1,lastEntry=(t:4, i:35)
2022-08-18 15:52:56,873 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=477,entriesCount=1,lastEntry=(t:4, i:36)
2022-08-18 15:52:56,875 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=480,entriesCount=1,lastEntry=(t:4, i:37)
2022-08-18 15:52:56,885 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=124, target=localhost:33205}}. 
2022-08-18 15:52:56,887 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=470,entriesCount=1,lastEntry=(t:4, i:32)
2022-08-18 15:52:56,887 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=472,entriesCount=1,lastEntry=(t:4, i:33)
2022-08-18 15:52:56,890 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=485,entriesCount=1,lastEntry=(t:4, i:38)
2022-08-18 15:52:56,891 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=486,entriesCount=1,lastEntry=(t:4, i:39)
2022-08-18 15:52:56,892 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=487,entriesCount=1,lastEntry=(t:4, i:40)
2022-08-18 15:52:56,894 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=488,entriesCount=2,lastEntry=(t:4, i:42)
2022-08-18 15:52:56,896 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=490,entriesCount=1,lastEntry=(t:4, i:43)
2022-08-18 15:52:56,898 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=492,entriesCount=1,lastEntry=(t:4, i:44)
2022-08-18 15:52:56,899 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=493,entriesCount=1,lastEntry=(t:4, i:45)
2022-08-18 15:52:56,901 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=497,entriesCount=1,lastEntry=(t:4, i:46)
2022-08-18 15:52:56,902 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=498,entriesCount=1,lastEntry=(t:4, i:47)
2022-08-18 15:52:56,904 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=500,entriesCount=1,lastEntry=(t:4, i:48)
2022-08-18 15:52:56,906 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=503,entriesCount=1,lastEntry=(t:4, i:49)
2022-08-18 15:52:56,908 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=506,entriesCount=1,lastEntry=(t:4, i:50)
2022-08-18 15:52:56,910 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=508,entriesCount=1,lastEntry=(t:4, i:52)
2022-08-18 15:52:56,911 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=507,entriesCount=1,lastEntry=(t:4, i:51)
2022-08-18 15:52:56,911 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=510,entriesCount=1,lastEntry=(t:4, i:53)
2022-08-18 15:52:56,912 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=511,entriesCount=1,lastEntry=(t:4, i:54)
2022-08-18 15:52:56,914 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=513,entriesCount=1,lastEntry=(t:4, i:55)
2022-08-18 15:52:56,917 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=516,entriesCount=1,lastEntry=(t:4, i:56)
2022-08-18 15:52:56,919 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=517,entriesCount=1,lastEntry=(t:4, i:57)
2022-08-18 15:52:56,919 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(301)) - s0@group-82CF0218057B->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=518,entriesCount=1,lastEntry=(t:4, i:58)
2022-08-18 15:52:56,983 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #67 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,983 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,983 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:52:56,983 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:52:56,983 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #68 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,983 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #62 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,984 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #65 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,984 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #64 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,984 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #66 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,983 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #61 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,985 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,985 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,984 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,986 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,986 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,986 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,987 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,987 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,987 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,987 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,990 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,990 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,990 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,990 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,990 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,990 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,991 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,991 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=63
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,991 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:56,991 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:56,997 [Thread-179] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:52:57,000 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=60, seq=17*, RW, Message:6d34)
2022-08-18 15:52:57,002 [Thread-179] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,008 [Thread-179] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,009 [Thread-179] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,009 [Thread-179] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:57,009 [Thread-179] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:52:57,009 [Thread-180] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:52:57,009 [Thread-180] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,010 [Thread-180] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,010 [Thread-180] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,010 [Thread-180] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:52:57,009 [grpc-default-executor-4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=60, seq=17*, RW, m4 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,010 [grpc-default-executor-4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,010 [grpc-default-executor-4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:52:57,010 [grpc-default-executor-4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:57,011 [Thread-181] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,011 [Thread-181] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,016 [Thread-181] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,016 [Thread-181] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,010 [Thread-180] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:52:57,016 [Thread-181] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-08-18 15:52:57,016 [Thread-181] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-08-18 15:52:57,017 [Thread-181] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:52:57,015 [Thread-186] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,017 [Thread-186] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,017 [Thread-186] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,021 [Thread-186] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,021 [Thread-186] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:57,022 [Thread-186] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:52:57,013 [Thread-182] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,022 [Thread-182] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,022 [Thread-182] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,022 [Thread-182] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,022 [Thread-182] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:57,022 [Thread-182] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:52:57,013 [Thread-185] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,013 [Thread-184] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,026 [Thread-184] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,026 [Thread-184] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,026 [Thread-184] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,026 [Thread-184] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:57,026 [Thread-184] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:52:57,012 [Thread-183] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:52:57,026 [Thread-183] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,027 [Thread-183] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,027 [Thread-183] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,027 [Thread-183] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:57,026 [Thread-185] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,027 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=60, seq=17*, RW, Message:6d34)
2022-08-18 15:52:57,027 [Thread-183] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:52:57,027 [Thread-185] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:52:57,027 [Thread-185] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,027 [Thread-185] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:52:57,028 [Thread-185] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:52:57,029 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=60, seq=17*, RW, m4 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,029 [grpc-default-executor-2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:52:57,029 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-08-18 15:52:57,029 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:52:57,035 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=60, seq=17*, RW, Message:6d34)
2022-08-18 15:52:57,037 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m4, logIndex=30
2022-08-18 15:52:57,038 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=92, seq=0, Watch(30), null
2022-08-18 15:52:57,038 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:52:57,038 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), null
2022-08-18 15:52:57,038 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:52:57,038 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 4: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=60, SUCCESS, logIndex=30, commits[s0:c34, s1:c24, s2:c29]
2022-08-18 15:52:57,038 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=92, seq=0, Watch(30), Message:<EMPTY>)
2022-08-18 15:52:57,039 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=92, seq=0, Watch(30), Message:<EMPTY>
2022-08-18 15:52:57,040 [Thread-187] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=92, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:52:57,040 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(30) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=92, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:52:57,040 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-08-18 15:52:57,040 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:52:57,040 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), Message:<EMPTY>)
2022-08-18 15:52:57,040 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:52:57,041 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-08-18 15:52:57,041 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:52:57,045 [Thread-188] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=94, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:52:57,045 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(30) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=94, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:52:57,109 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:52:57,110 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:52:57,110 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:52:57,116 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:52:57,116 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:52:57,116 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:52:57,122 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:52:57,122 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:52:57,123 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:52:57,123 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:52:57,123 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:52:57,123 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:52:57,126 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:52:57,126 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:52:57,126 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:52:57,127 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:52:57,127 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:52:57,128 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:52:57,128 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:52:57,128 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:52:57,128 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:52:57,144 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:53:00,013 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=138, target=localhost:33205}}. 
2022-08-18 15:53:00,016 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:00,016 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=61, seq=18, RW, Message:6d35)
2022-08-18 15:53:00,018 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:53:00,019 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:00,019 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=62, seq=19, RW, Message:6d36)
2022-08-18 15:53:00,019 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=63, seq=20, RW, Message:6d37)
2022-08-18 15:53:00,019 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=64, seq=21, RW, Message:6d38)
2022-08-18 15:53:00,019 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=65, seq=22, RW, Message:6d39)
2022-08-18 15:53:00,020 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=66, seq=23, RW, Message:6d3130)
2022-08-18 15:53:00,021 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m5, logIndex=31
2022-08-18 15:53:00,021 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=96, seq=0, Watch(31), null
2022-08-18 15:53:00,021 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:00,021 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
2022-08-18 15:53:00,021 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:00,021 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 5: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=61, SUCCESS, logIndex=31, commits[s0:c34, s1:c24, s2:c29]
2022-08-18 15:53:00,022 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m6, logIndex=32
2022-08-18 15:53:00,022 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=100, seq=0, Watch(32), null
2022-08-18 15:53:00,022 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=96, seq=0, Watch(31), Message:<EMPTY>)
2022-08-18 15:53:00,022 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=96, seq=0, Watch(31), Message:<EMPTY>
2022-08-18 15:53:00,022 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:00,023 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=102, seq=0, Watch-MAJORITY_COMMITTED(32), null
2022-08-18 15:53:00,023 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:00,023 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m7, logIndex=34
2022-08-18 15:53:00,023 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=104, seq=0, Watch(34), null
2022-08-18 15:53:00,023 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:00,024 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=106, seq=0, Watch-MAJORITY_COMMITTED(34), null
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:00,024 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:00,024 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:00,025 [Thread-189] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=96, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,025 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(31) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=96, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,029 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m8, logIndex=36
2022-08-18 15:53:00,029 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=100, seq=0, Watch(32), Message:<EMPTY>)
2022-08-18 15:53:00,029 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=100, seq=0, Watch(32), Message:<EMPTY>
2022-08-18 15:53:00,029 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>)
2022-08-18 15:53:00,029 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:00,030 [Thread-190] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=98, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,029 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=108, seq=0, Watch(36), null
2022-08-18 15:53:00,030 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(31) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=98, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,030 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=102, seq=0, Watch-MAJORITY_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:00,030 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 6: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=62, SUCCESS, logIndex=32, commits[s0:c34, s1:c24, s2:c29]
2022-08-18 15:53:00,030 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=102, seq=0, Watch-MAJORITY_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:00,031 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:00,031 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:00,031 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:00,031 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=110, seq=0, Watch-MAJORITY_COMMITTED(36), null
2022-08-18 15:53:00,031 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:00,031 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=104, seq=0, Watch(34), Message:<EMPTY>)
2022-08-18 15:53:00,031 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=104, seq=0, Watch(34), Message:<EMPTY>
2022-08-18 15:53:00,032 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m9, logIndex=38
2022-08-18 15:53:00,032 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=112, seq=0, Watch(38), null
2022-08-18 15:53:00,032 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:00,032 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=114, seq=0, Watch-MAJORITY_COMMITTED(38), null
2022-08-18 15:53:00,032 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:00,032 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>)
2022-08-18 15:53:00,032 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:00,033 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=106, seq=0, Watch-MAJORITY_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:00,033 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=106, seq=0, Watch-MAJORITY_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:00,033 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:00,033 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:00,033 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=108, seq=0, Watch(36), Message:<EMPTY>)
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=108, seq=0, Watch(36), Message:<EMPTY>
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>)
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=110, seq=0, Watch-MAJORITY_COMMITTED(36), Message:<EMPTY>)
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=110, seq=0, Watch-MAJORITY_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:00,034 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>)
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=112, seq=0, Watch(38), Message:<EMPTY>)
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=112, seq=0, Watch(38), Message:<EMPTY>
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>)
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:00,035 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m10, logIndex=39
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=114, seq=0, Watch-MAJORITY_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:00,035 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=116, seq=0, Watch(39), null
2022-08-18 15:53:00,035 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=114, seq=0, Watch-MAJORITY_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:00,036 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:00,036 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:00,036 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:00,036 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=118, seq=0, Watch-MAJORITY_COMMITTED(39), null
2022-08-18 15:53:00,036 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=116, seq=0, Watch(39), Message:<EMPTY>)
2022-08-18 15:53:00,037 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=116, seq=0, Watch(39), Message:<EMPTY>
2022-08-18 15:53:00,037 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:00,037 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>)
2022-08-18 15:53:00,037 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>
2022-08-18 15:53:00,037 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=118, seq=0, Watch-MAJORITY_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:00,037 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=118, seq=0, Watch-MAJORITY_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:00,038 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:00,038 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:00,038 [Thread-191] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=100, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(32) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=100, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,039 [Thread-192] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=102, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(32) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=102, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 7: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=63, SUCCESS, logIndex=34, commits[s0:c34, s1:c24, s2:c29]
2022-08-18 15:53:00,039 [Thread-193] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=104, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(34) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=104, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,040 [Thread-194] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=106, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,040 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(34) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=106, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,040 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 8: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=64, SUCCESS, logIndex=36, commits[s0:c36, s1:c24, s2:c34]
2022-08-18 15:53:00,040 [Thread-195] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=108, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,041 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(36) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=108, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,041 [Thread-196] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=110, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,042 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(36) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=110, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,042 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 9: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=65, SUCCESS, logIndex=38, commits[s0:c38, s1:c24, s2:c37]
2022-08-18 15:53:00,042 [Thread-197] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=112, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,042 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(38) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=112, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,043 [Thread-198] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=114, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,043 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(38) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=114, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,043 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 10: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=66, SUCCESS, logIndex=39, commits[s0:c39, s1:c24, s2:c37]
2022-08-18 15:53:00,044 [Thread-199] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=116, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,044 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(39) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=116, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,045 [Thread-200] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=118, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,045 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(39) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=118, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,085 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #68 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,086 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,086 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:53:00,086 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:53:00,086 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,086 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,086 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,086 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,087 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,087 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,087 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,091 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,092 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,092 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,092 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,092 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,092 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,092 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,093 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,093 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,095 [Thread-201] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:00,095 [Thread-201] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,095 [Thread-201] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,095 [Thread-201] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,095 [Thread-201] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,095 [Thread-201] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:00,095 [Thread-202] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:00,095 [Thread-202] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,095 [Thread-202] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,096 [Thread-202] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,096 [Thread-202] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,096 [Thread-202] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:00,101 [Thread-203] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,101 [Thread-203] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,101 [Thread-203] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,101 [Thread-203] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,101 [Thread-203] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,101 [Thread-203] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:00,101 [Thread-204] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,101 [Thread-204] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,101 [Thread-204] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,101 [Thread-204] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,101 [Thread-204] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,101 [Thread-204] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:00,102 [Thread-205] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,102 [Thread-205] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,102 [Thread-205] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,102 [Thread-205] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,102 [Thread-205] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,102 [Thread-205] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:00,102 [Thread-206] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,102 [Thread-206] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,102 [Thread-206] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,103 [Thread-206] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,103 [Thread-206] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,103 [Thread-206] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:00,103 [Thread-207] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,104 [Thread-207] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,104 [Thread-207] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,104 [Thread-207] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,104 [Thread-207] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,104 [Thread-207] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:00,105 [Thread-208] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:00,105 [Thread-208] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,105 [Thread-208] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,105 [Thread-208] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,105 [Thread-208] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,105 [Thread-208] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:00,105 [Thread-209] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,105 [Thread-209] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,106 [Thread-209] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,106 [Thread-209] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,106 [Thread-209] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,106 [Thread-209] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:00,106 [Thread-210] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,106 [Thread-210] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,107 [Thread-210] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,107 [Thread-210] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,107 [Thread-210] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,107 [Thread-210] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:00,107 [Thread-211] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,107 [Thread-211] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,107 [Thread-211] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,107 [Thread-211] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,107 [Thread-211] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,107 [Thread-211] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:00,107 [Thread-212] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,107 [Thread-212] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,108 [Thread-212] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,108 [Thread-212] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,108 [Thread-212] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,108 [Thread-212] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:00,112 [Thread-213] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,113 [Thread-213] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,113 [Thread-213] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,113 [Thread-213] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,113 [Thread-213] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,113 [Thread-213] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:00,113 [Thread-214] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,113 [Thread-214] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,113 [Thread-214] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,114 [Thread-214] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,114 [Thread-214] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,114 [Thread-214] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:00,114 [Thread-215] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,114 [Thread-215] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,114 [Thread-215] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,114 [Thread-215] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,114 [Thread-215] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,114 [Thread-215] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:00,114 [Thread-216] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,114 [Thread-216] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,115 [Thread-216] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,115 [Thread-216] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,115 [Thread-216] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,115 [Thread-216] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:00,115 [Thread-217] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,115 [Thread-217] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,115 [Thread-217] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,115 [Thread-217] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,115 [Thread-217] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,115 [Thread-217] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:00,118 [Thread-219] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,118 [Thread-219] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,120 [Thread-220] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,120 [Thread-220] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,120 [Thread-220] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,120 [Thread-220] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,120 [Thread-220] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,120 [Thread-220] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:00,120 [Thread-218] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,120 [Thread-218] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,120 [Thread-218] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,120 [Thread-218] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,120 [Thread-218] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,120 [Thread-218] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:00,120 [Thread-219] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,121 [Thread-219] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,121 [Thread-219] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,121 [Thread-219] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:00,124 [Thread-221] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,124 [Thread-221] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,124 [Thread-221] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,124 [Thread-221] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,124 [Thread-221] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,124 [Thread-221] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:00,130 [Thread-222] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:00,130 [Thread-222] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,130 [Thread-222] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:00,130 [Thread-222] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,130 [Thread-222] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:00,130 [Thread-222] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:00,133 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=67, seq=24*, RW, Message:6d3131)
2022-08-18 15:53:00,134 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=67, seq=24*, RW, m11 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,134 [grpc-default-executor-9] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:00,134 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:53:00,134 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:53:00,140 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=67, seq=24*, RW, Message:6d3131)
2022-08-18 15:53:00,141 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m11, logIndex=41
2022-08-18 15:53:00,141 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=120, seq=0, Watch(41), null
2022-08-18 15:53:00,141 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:00,141 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=122, seq=0, Watch-MAJORITY_COMMITTED(41), null
2022-08-18 15:53:00,142 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:00,142 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=120, seq=0, Watch(41), Message:<EMPTY>)
2022-08-18 15:53:00,142 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 11: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=67, SUCCESS, logIndex=41, commits[s0:c41, s1:c24, s2:c38]
2022-08-18 15:53:00,142 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=120, seq=0, Watch(41), Message:<EMPTY>
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>)
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=122, seq=0, Watch-MAJORITY_COMMITTED(41), Message:<EMPTY>)
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=122, seq=0, Watch-MAJORITY_COMMITTED(41), Message:<EMPTY>
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>)
2022-08-18 15:53:00,143 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>
2022-08-18 15:53:00,144 [Thread-223] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=120, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,145 [Thread-224] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=122, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,146 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(41) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=120, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,146 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(41) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=122, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:00,195 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:00,196 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:00,197 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:53:00,197 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:00,197 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:53:00,197 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:00,201 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:00,201 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:00,201 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:53:00,201 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:00,202 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:00,202 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:53:00,202 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:00,202 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:53:00,202 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:00,203 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:00,204 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:53:00,204 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:00,206 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:00,206 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:53:00,206 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:00,206 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:00,206 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-08-18 15:53:00,207 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:53:00,207 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:00,207 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-08-18 15:53:00,207 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:53:00,207 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:00,207 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-08-18 15:53:00,208 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:00,208 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:00,209 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:00,209 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:00,213 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:00,213 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>)
2022-08-18 15:53:00,213 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:00,214 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:00,215 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:00,215 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:00,215 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:00,215 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:00,215 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:00,215 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:00,216 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>)
2022-08-18 15:53:00,216 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:00,220 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:00,220 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:00,220 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:00,220 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:00,220 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>)
2022-08-18 15:53:00,220 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:00,224 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:00,224 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>)
2022-08-18 15:53:00,224 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>
2022-08-18 15:53:00,230 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:00,230 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:00,230 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:00,840 [s1@group-82CF0218057B-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(93)) - Timeout 0/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s1@group-82CF0218057B-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:90)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:381)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:62)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:571)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:319)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1784)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 6 more
2022-08-18 15:53:01,614 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:01,614 [timer5] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(25)@14.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:01,615 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(25)@14.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:01,624 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:03,124 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=159, target=localhost:33205}}. 
2022-08-18 15:53:03,127 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:03,127 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:03,127 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:03,127 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:53:03,128 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:03,128 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>)
2022-08-18 15:53:03,129 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:03,130 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>)
2022-08-18 15:53:03,130 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:03,187 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #69 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,187 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,187 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:53:03,187 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:53:03,188 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,188 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,188 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,190 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,193 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,194 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,194 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,194 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,195 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,195 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,195 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,195 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,195 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,198 [Thread-225] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:03,198 [Thread-225] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,198 [Thread-225] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,198 [Thread-225] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,198 [Thread-225] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,198 [Thread-225] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:03,202 [Thread-226] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:03,202 [Thread-226] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,203 [Thread-226] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,203 [Thread-226] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,203 [Thread-226] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,203 [Thread-226] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:03,203 [Thread-227] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,203 [Thread-227] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,203 [Thread-227] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,203 [Thread-227] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,204 [Thread-227] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,204 [Thread-227] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:03,204 [Thread-228] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,204 [Thread-228] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,204 [Thread-228] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,204 [Thread-228] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,204 [Thread-228] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,204 [Thread-228] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:03,206 [Thread-229] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,207 [Thread-229] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,207 [Thread-229] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,207 [Thread-229] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,207 [Thread-229] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,207 [Thread-229] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:03,213 [Thread-230] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,213 [Thread-230] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,213 [Thread-230] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,213 [Thread-230] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,213 [Thread-230] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,213 [Thread-230] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:03,214 [Thread-231] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,214 [Thread-231] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,214 [Thread-231] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,214 [Thread-231] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,214 [Thread-231] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,214 [Thread-231] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:03,215 [Thread-232] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:03,215 [Thread-232] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,215 [Thread-232] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,215 [Thread-232] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,215 [Thread-232] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,215 [Thread-232] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:03,216 [Thread-233] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,216 [Thread-233] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,216 [Thread-233] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,216 [Thread-233] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,216 [Thread-233] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,217 [Thread-233] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:03,217 [Thread-234] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,217 [Thread-234] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,217 [Thread-234] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,217 [Thread-234] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,217 [Thread-234] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,218 [Thread-234] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:03,218 [Thread-235] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,218 [Thread-235] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,218 [Thread-235] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,218 [Thread-235] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,219 [Thread-235] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,219 [Thread-235] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:03,220 [Thread-236] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,220 [Thread-236] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,220 [Thread-236] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,221 [Thread-236] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,221 [Thread-236] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,221 [Thread-236] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:03,221 [Thread-237] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,221 [Thread-237] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,221 [Thread-237] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,221 [Thread-237] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,221 [Thread-237] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,221 [Thread-237] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:03,222 [Thread-238] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,222 [Thread-238] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,222 [Thread-238] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,222 [Thread-238] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,223 [Thread-238] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,223 [Thread-238] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:03,223 [Thread-239] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,223 [Thread-239] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,223 [Thread-239] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,224 [Thread-239] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,224 [Thread-239] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,224 [Thread-239] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:03,224 [Thread-240] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,224 [Thread-240] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,224 [Thread-240] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,224 [Thread-240] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,224 [Thread-240] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,224 [Thread-240] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:03,225 [Thread-241] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,225 [Thread-241] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,225 [Thread-241] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,225 [Thread-241] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,225 [Thread-241] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,225 [Thread-241] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:03,225 [Thread-242] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,225 [Thread-242] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,225 [Thread-242] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,226 [Thread-242] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,226 [Thread-242] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,226 [Thread-242] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:03,226 [Thread-243] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,226 [Thread-243] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,226 [Thread-243] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,226 [Thread-243] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,226 [Thread-243] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,226 [Thread-243] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:03,229 [Thread-244] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,229 [Thread-244] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,229 [Thread-244] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,229 [Thread-244] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,229 [Thread-244] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,229 [Thread-244] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:03,233 [Thread-245] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,233 [Thread-245] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,233 [Thread-245] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,233 [Thread-245] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,233 [Thread-245] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,233 [Thread-245] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:03,234 [Thread-246] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:03,235 [Thread-246] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,235 [Thread-246] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,235 [Thread-246] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,235 [Thread-246] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,235 [Thread-246] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:03,235 [Thread-247] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:03,235 [Thread-247] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=121
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,235 [Thread-247] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=121
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,235 [Thread-247] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,235 [Thread-247] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:03,235 [Thread-247] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:03,237 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s2@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=68, seq=25*, RW, Message:6d3132)
2022-08-18 15:53:03,238 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s2@group-82CF0218057B, cid=68, seq=25*, RW, m12 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,239 [grpc-default-executor-9] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,239 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-08-18 15:53:03,239 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:53:03,245 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=68, seq=25*, RW, Message:6d3132)
2022-08-18 15:53:03,246 [grpc-default-executor-5] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m12, logIndex=43
2022-08-18 15:53:03,246 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=124, seq=0, Watch(43), null
2022-08-18 15:53:03,246 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:03,246 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=126, seq=0, Watch-MAJORITY_COMMITTED(43), null
2022-08-18 15:53:03,247 [grpc-default-executor-5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:03,247 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 12: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=68, SUCCESS, logIndex=43, commits[s0:c43, s1:c24, s2:c39]
2022-08-18 15:53:03,247 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=124, seq=0, Watch(43), Message:<EMPTY>)
2022-08-18 15:53:03,247 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=124, seq=0, Watch(43), Message:<EMPTY>
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>)
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=126, seq=0, Watch-MAJORITY_COMMITTED(43), Message:<EMPTY>)
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=126, seq=0, Watch-MAJORITY_COMMITTED(43), Message:<EMPTY>
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>)
2022-08-18 15:53:03,248 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>
2022-08-18 15:53:03,253 [Thread-249] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=124, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:03,253 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(43) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=124, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:03,253 [Thread-248] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:03,253 [Thread-248] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=123
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,253 [Thread-248] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=123
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:03,253 [Thread-248] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,253 [Thread-248] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-08-18 15:53:03,253 [Thread-248] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-08-18 15:53:03,263 [Thread-251] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:03,263 [Thread-251] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=125
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,263 [Thread-251] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=125
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,263 [Thread-251] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,263 [Thread-251] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:03,264 [Thread-251] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:03,264 [Thread-250] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=126, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:03,264 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(43) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=126, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:03,264 [Thread-252] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:03,264 [Thread-252] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=127
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,264 [Thread-252] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=127
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,265 [Thread-252] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,265 [Thread-252] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:03,265 [Thread-252] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:03,298 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:03,299 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:53:03,300 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s1@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c24, s0:c58, s2:c58]
2022-08-18 15:53:03,301 [Thread-253] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:03,301 [Thread-253] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,302 [Thread-253] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,302 [Thread-253] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:03,302 [Thread-253] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-08-18 15:53:03,302 [Thread-253] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:53:03,303 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:03,305 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:03,306 [grpc-default-executor-9] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(175)) - Failed to send request, message=m14
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at org.apache.ratis.client.impl.RaftClientImpl.handleRaftException(RaftClientImpl.java:321)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$send$3(OrderedAsync.java:172)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	... 5 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:03,307 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:03,307 [grpc-default-executor-9] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(175)) - Failed to send request, message=m16
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 29 > nextToProcess = -1 will NEVER be processed; request = 29:null
	at org.apache.ratis.client.impl.RaftClientImpl.handleRaftException(RaftClientImpl.java:321)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$send$3(OrderedAsync.java:172)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 29 > nextToProcess = -1 will NEVER be processed; request = 29:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	... 5 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 29 > nextToProcess = -1 will NEVER be processed; request = 29:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:03,308 [grpc-default-executor-9] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(175)) - Failed to send request, message=m17
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 30 > nextToProcess = -1 will NEVER be processed; request = 30:null
	at org.apache.ratis.client.impl.RaftClientImpl.handleRaftException(RaftClientImpl.java:321)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$send$3(OrderedAsync.java:172)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 30 > nextToProcess = -1 will NEVER be processed; request = 30:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	... 5 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 30 > nextToProcess = -1 will NEVER be processed; request = 30:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:03,308 [grpc-default-executor-9] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(175)) - Failed to send request, message=m18
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 31 > nextToProcess = -1 will NEVER be processed; request = 31:null
	at org.apache.ratis.client.impl.RaftClientImpl.handleRaftException(RaftClientImpl.java:321)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$send$3(OrderedAsync.java:172)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 31 > nextToProcess = -1 will NEVER be processed; request = 31:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	... 5 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 31 > nextToProcess = -1 will NEVER be processed; request = 31:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:03,311 [grpc-default-executor-9] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(175)) - Failed to send request, message=m19
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 32 > nextToProcess = -1 will NEVER be processed; request = 32:null
	at org.apache.ratis.client.impl.RaftClientImpl.handleRaftException(RaftClientImpl.java:321)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$send$3(OrderedAsync.java:172)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 32 > nextToProcess = -1 will NEVER be processed; request = 32:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	... 5 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 32 > nextToProcess = -1 will NEVER be processed; request = 32:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:03,313 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:53:03,313 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:03,313 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:53:03,314 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:03,314 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:53:03,314 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:03,315 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:03,315 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:03,315 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:53:03,315 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:03,316 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:53:03,316 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:03,317 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:03,317 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-08-18 15:53:03,317 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:53:03,318 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:03,319 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-08-18 15:53:03,319 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:53:03,319 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:03,319 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-08-18 15:53:03,319 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:03,321 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:03,321 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>)
2022-08-18 15:53:03,321 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:03,321 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:03,322 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:03,322 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:03,324 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:03,324 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>)
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:03,325 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>)
2022-08-18 15:53:03,325 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:03,326 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:03,326 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>)
2022-08-18 15:53:03,326 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:03,326 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:03,326 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>)
2022-08-18 15:53:03,326 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:03,331 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:03,331 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:03,331 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:03,333 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:03,333 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>)
2022-08-18 15:53:03,334 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>
2022-08-18 15:53:03,335 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:03,336 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>)
2022-08-18 15:53:03,336 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>
2022-08-18 15:53:03,364 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:03,364 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>)
2022-08-18 15:53:03,364 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>
2022-08-18 15:53:03,365 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:03,366 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>)
2022-08-18 15:53:03,366 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>
2022-08-18 15:53:04,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(28)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:04,614 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:04,614 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(25)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:04,614 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(28)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:04,615 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(29)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:04,614 [timer4] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(27)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:04,615 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:04,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(29)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:04,615 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, logIndex=29, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:04,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:04,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:04,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, logIndex=29, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:06,236 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=173, target=localhost:33205}}. 
2022-08-18 15:53:06,239 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:06,239 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:06,239 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:06,239 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:06,239 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(25)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:06,240 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(27)@17.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:06,240 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:06,240 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:06,243 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:53:06,244 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:06,244 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:53:06,244 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:06,244 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:06,244 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:06,248 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:06,248 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:06,264 [Thread-248] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=187, target=localhost:33205}}. 
2022-08-18 15:53:06,265 [Thread-248] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:06,322 [Thread-253] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=194, target=localhost:39963}}. 
2022-08-18 15:53:06,323 [Thread-253] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:06,324 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:06,324 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:53:06,324 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:06,365 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:06,365 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>)
2022-08-18 15:53:06,366 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>
2022-08-18 15:53:07,145 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:53:07,614 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(25)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:07,614 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,614 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(28)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:07,615 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(30)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:53:07,614 [timer5] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(28)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:07,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(29)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:07,616 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(30)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:53:07,614 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(25)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:07,614 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(27)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:07,614 [timer4] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(29)@20.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:07,615 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, logIndex=29, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, logIndex=29, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, logIndex=30, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:07,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, logIndex=30, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:09,239 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-58CC921A4208->s0 request #71 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,239 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,239 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-08-18 15:53:09,239 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-08-18 15:53:09,240 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,240 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,240 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,241 [Thread-254] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:09,244 [Thread-261] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,249 [Thread-261] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,249 [Thread-261] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,249 [Thread-261] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,249 [Thread-261] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,249 [Thread-261] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:09,244 [Thread-260] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,249 [Thread-260] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,249 [Thread-260] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,249 [Thread-260] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,249 [Thread-260] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,249 [Thread-260] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:09,243 [Thread-259] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,249 [Thread-259] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-259] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-259] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,250 [Thread-259] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,250 [Thread-259] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:09,243 [Thread-258] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,250 [Thread-258] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-258] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-258] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,250 [Thread-258] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,250 [Thread-258] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:09,243 [Thread-257] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,250 [Thread-257] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-257] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-257] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,250 [Thread-257] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,250 [Thread-257] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:09,243 [Thread-256] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,250 [Thread-256] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,250 [Thread-256] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,251 [Thread-256] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,251 [Thread-256] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,251 [Thread-256] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:09,243 [Thread-255] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,248 [Thread-254] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,251 [Thread-254] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,251 [Thread-254] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,251 [Thread-254] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,251 [Thread-254] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:09,251 [Thread-255] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,251 [Thread-255] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,251 [Thread-255] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,251 [Thread-255] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,251 [Thread-255] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:09,252 [Thread-263] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,252 [Thread-263] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,252 [Thread-263] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,252 [Thread-263] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,252 [Thread-263] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,252 [Thread-263] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:09,252 [Thread-265] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,252 [Thread-265] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,253 [Thread-265] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,253 [Thread-265] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,253 [Thread-265] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,253 [Thread-265] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:09,253 [Thread-264] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,253 [Thread-264] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,253 [Thread-264] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,253 [Thread-264] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,253 [Thread-264] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,253 [Thread-264] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:09,253 [Thread-266] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,254 [Thread-266] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,254 [Thread-266] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,254 [Thread-266] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,254 [Thread-266] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,254 [Thread-266] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:09,254 [Thread-267] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,254 [Thread-267] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,254 [Thread-267] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,254 [Thread-267] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,254 [Thread-267] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,255 [Thread-267] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:09,260 [Thread-268] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,260 [Thread-268] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,260 [Thread-268] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,260 [Thread-268] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,260 [Thread-268] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,260 [Thread-268] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:09,260 [Thread-269] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,260 [Thread-269] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,261 [Thread-269] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,261 [Thread-269] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,261 [Thread-269] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,261 [Thread-269] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:09,261 [Thread-270] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,261 [Thread-270] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,261 [Thread-270] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,261 [Thread-270] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,261 [Thread-270] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,261 [Thread-270] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:09,262 [Thread-271] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,262 [Thread-271] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,262 [Thread-271] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=111
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,262 [Thread-271] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,262 [Thread-271] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,262 [Thread-271] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:09,262 [Thread-272] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,262 [Thread-272] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,262 [Thread-272] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,262 [Thread-272] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,263 [Thread-272] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,263 [Thread-272] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:09,263 [Thread-273] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,263 [Thread-273] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,263 [Thread-273] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,263 [Thread-273] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,263 [Thread-273] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,263 [Thread-273] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:09,269 [Thread-274] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,269 [Thread-274] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,269 [Thread-274] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=117
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,269 [Thread-274] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,269 [Thread-274] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,269 [Thread-274] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:09,269 [Thread-275] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,269 [Thread-275] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,270 [Thread-275] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=119
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,270 [Thread-275] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,270 [Thread-275] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,270 [Thread-275] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:09,270 [Thread-276] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:09,270 [Thread-276] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=121
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,270 [Thread-276] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=121
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,270 [Thread-276] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,270 [Thread-276] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,270 [Thread-276] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:09,271 [Thread-277] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:09,271 [Thread-277] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=123
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,271 [Thread-277] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=123
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,271 [Thread-277] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,271 [Thread-277] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,271 [Thread-277] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:09,271 [Thread-278] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:09,271 [Thread-278] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=125
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,271 [Thread-278] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=125
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,272 [Thread-278] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,272 [Thread-278] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,272 [Thread-278] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:09,272 [Thread-262] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,272 [Thread-262] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,272 [Thread-262] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=93
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,272 [Thread-262] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,272 [Thread-262] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,272 [Thread-262] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:09,273 [Thread-279] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:09,273 [Thread-279] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=127
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,273 [Thread-279] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=127
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,273 [Thread-279] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,274 [Thread-279] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,274 [Thread-279] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:09,345 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=69, seq=26*, RW, Message:6d3133)
2022-08-18 15:53:09,346 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=69, seq=26*, RW, m13 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,346 [grpc-default-executor-9] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,346 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-08-18 15:53:09,346 [grpc-default-executor-9] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:53:09,349 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:09,349 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:09,350 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:09,351 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:09,351 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:09,351 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:09,351 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #7 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:09,352 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:09,353 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:09,353 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:09,354 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=69, seq=26*, RW, Message:6d3133)
2022-08-18 15:53:09,354 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:09,355 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:09,355 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:53:09,355 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:09,355 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:53:09,355 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:53:09,356 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:09,357 [grpc-default-executor-9] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m13, logIndex=44
2022-08-18 15:53:09,357 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=128, seq=0, Watch(44), null
2022-08-18 15:53:09,357 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
2022-08-18 15:53:09,357 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=130, seq=0, Watch-MAJORITY_COMMITTED(44), null
2022-08-18 15:53:09,357 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #1 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
2022-08-18 15:53:09,357 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 13: receive RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=69, SUCCESS, logIndex=44, commits[s0:c44, s1:c24, s2:c40]
2022-08-18 15:53:09,357 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:09,358 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>)
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=128, seq=0, Watch(44), Message:<EMPTY>)
2022-08-18 15:53:09,359 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=128, seq=0, Watch(44), Message:<EMPTY>
2022-08-18 15:53:09,360 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>)
2022-08-18 15:53:09,360 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>
2022-08-18 15:53:09,360 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=130, seq=0, Watch-MAJORITY_COMMITTED(44), Message:<EMPTY>)
2022-08-18 15:53:09,360 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=130, seq=0, Watch-MAJORITY_COMMITTED(44), Message:<EMPTY>
2022-08-18 15:53:09,360 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:09,361 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>)
2022-08-18 15:53:09,361 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:09,361 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>
2022-08-18 15:53:09,361 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>)
2022-08-18 15:53:09,361 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:09,361 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:09,362 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>)
2022-08-18 15:53:09,362 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:09,362 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:09,362 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:09,362 [Thread-280] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=128, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:09,362 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(44) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=128, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:09,363 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:09,363 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:09,363 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:09,363 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:09,363 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>)
2022-08-18 15:53:09,363 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:09,366 [Thread-281] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=130, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:09,366 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(44) returns RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=130, SUCCESS, logIndex=58, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:09,372 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:09,372 [timer4] ERROR client.GrpcClientRpc (GrpcClientRpc.java:sendRequestAsyncUnordered(85)) - client-58CC921A4208: Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,374 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:09,374 [timer6] ERROR client.GrpcClientRpc (GrpcClientRpc.java:sendRequestAsyncUnordered(85)) - client-58CC921A4208: Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,377 [Thread-282] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,377 [Thread-282] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,377 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,377 [Thread-282] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,377 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-08-18 15:53:09,377 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-08-18 15:53:09,377 [Thread-282] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:09,378 [Thread-285] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:09,378 [Thread-285] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=129
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,378 [Thread-285] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=129
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,378 [Thread-285] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-285] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,378 [Thread-286] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,379 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:09,379 [Thread-288] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,379 [Thread-288] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-288] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=101
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-288] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-288] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,379 [Thread-288] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:09,379 [Thread-286] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-286] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-286] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,379 [Thread-286] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,379 [Thread-286] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:09,379 [Thread-285] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
2022-08-18 15:53:09,380 [Thread-289] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,380 [Thread-289] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,381 [Thread-289] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=103
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,381 [Thread-289] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,382 [Thread-289] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,382 [Thread-289] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:09,378 [Thread-287] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #1 receive~ null
2022-08-18 15:53:09,382 [Thread-287] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #1 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=131
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,382 [Thread-287] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=131
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,382 [Thread-287] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,382 [Thread-287] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,383 [Thread-287] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
2022-08-18 15:53:09,383 [Thread-290] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,383 [Thread-290] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,383 [Thread-290] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=105
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,383 [Thread-290] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,383 [Thread-290] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,383 [Thread-290] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:09,383 [Thread-291] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,383 [Thread-291] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,383 [Thread-291] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=107
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,383 [Thread-291] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,384 [Thread-291] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,384 [Thread-291] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:09,385 [Thread-292] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #7 receive~ null
2022-08-18 15:53:09,385 [Thread-292] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #7 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,385 [Thread-292] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,385 [Thread-292] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,385 [Thread-292] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,385 [Thread-292] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #7, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:09,386 [Thread-293] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,386 [Thread-293] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,386 [Thread-293] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=109
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,386 [Thread-293] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,386 [Thread-293] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,386 [Thread-293] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:09,387 [Thread-294] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:09,387 [Thread-294] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,387 [Thread-294] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,387 [Thread-294] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,387 [Thread-294] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,387 [Thread-294] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:09,388 [Thread-295] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,388 [Thread-295] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-295] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-295] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-295] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,388 [Thread-295] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:09,388 [Thread-296] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,388 [Thread-296] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-296] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=113
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-296] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,388 [Thread-296] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,388 [Thread-296] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:09,389 [Thread-297] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,389 [Thread-297] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,389 [Thread-297] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,389 [Thread-297] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,389 [Thread-297] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,389 [Thread-297] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:09,389 [Thread-298] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,389 [Thread-298] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,389 [Thread-298] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=115
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,390 [Thread-298] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,390 [Thread-298] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,390 [Thread-298] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:09,390 [Thread-299] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,390 [Thread-299] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,390 [Thread-299] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,390 [Thread-299] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,390 [Thread-299] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,390 [Thread-299] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:09,390 [Thread-300] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,390 [Thread-300] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-300] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-300] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-300] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,391 [Thread-300] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:09,391 [Thread-301] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,391 [Thread-301] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-301] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-301] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,391 [Thread-301] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,391 [Thread-301] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:09,391 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #3 send~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:09,391 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:09,391 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:09,392 [Thread-302] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:09,392 [Thread-302] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,392 [Thread-302] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$null$3(PeerProxyMap.java:169)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3566)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:650)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:151)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,392 [Thread-302] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,392 [Thread-302] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,392 [Thread-302] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:09,393 [Thread-284] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,393 [Thread-284] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,393 [Thread-284] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,395 [Thread-284] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,395 [Thread-284] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,395 [Thread-284] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:09,395 [Thread-283] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,395 [Thread-283] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,395 [Thread-283] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$null$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2022-08-18 15:53:09,395 [Thread-283] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,395 [Thread-283] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s1, newLeader=null
2022-08-18 15:53:09,395 [Thread-283] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:09,396 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>)
2022-08-18 15:53:09,397 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s1@group-82CF0218057B, cid=123, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c24, s0:c58, s2:c58]
2022-08-18 15:53:09,397 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>)
2022-08-18 15:53:09,397 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s1@group-82CF0218057B, cid=121, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c24, s0:c58, s2:c58]
2022-08-18 15:53:09,398 [Thread-303] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,397 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:09,405 [Thread-304] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:09,405 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s1@group-82CF0218057B, cid=119, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c24, s0:c58, s2:c58]
2022-08-18 15:53:09,406 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s1@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>)
2022-08-18 15:53:09,406 [Thread-304] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,410 [Thread-304] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,411 [Thread-304] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,411 [Thread-304] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-08-18 15:53:09,411 [Thread-304] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-08-18 15:53:09,401 [Thread-305] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,398 [Thread-303] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,412 [Thread-303] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,412 [Thread-303] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,412 [Thread-303] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-08-18 15:53:09,412 [Thread-303] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:09,412 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:09,416 [Thread-306] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #3 receive~ null
2022-08-18 15:53:09,416 [Thread-306] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,417 [Thread-306] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,417 [Thread-306] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,417 [Thread-306] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-08-18 15:53:09,417 [Thread-306] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:09,416 [Thread-305] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #3 failed~ RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,416 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s1@group-82CF0218057B, cid=117, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c24, s0:c58, s2:c58]
2022-08-18 15:53:09,418 [Thread-305] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: s0. Failed RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-82CF0218057B is not the leader s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,419 [Thread-305] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:09,419 [Thread-305] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-08-18 15:53:09,419 [Thread-305] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:09,419 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:09,419 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:09,423 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>)
2022-08-18 15:53:09,423 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>
2022-08-18 15:53:09,424 [Thread-304] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s1@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:09,426 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>)
2022-08-18 15:53:09,426 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>
2022-08-18 15:53:09,426 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>)
2022-08-18 15:53:09,426 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>
2022-08-18 15:53:09,477 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:09,478 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-08-18 15:53:09,478 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:09,479 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:09,479 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:09,480 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>)
2022-08-18 15:53:09,480 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:09,480 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-08-18 15:53:09,480 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:09,480 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
2022-08-18 15:53:09,481 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>)
2022-08-18 15:53:09,481 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>
2022-08-18 15:53:09,482 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:09,482 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>)
2022-08-18 15:53:09,482 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:09,483 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:09,483 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>)
2022-08-18 15:53:09,483 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:09,484 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:09,485 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>)
2022-08-18 15:53:09,485 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:09,486 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #8 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:09,486 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-08-18 15:53:09,486 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:09,487 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:09,487 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>)
2022-08-18 15:53:09,487 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #7 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:09,487 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:09,487 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-08-18 15:53:09,487 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:09,488 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:09,488 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:09,488 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>)
2022-08-18 15:53:09,488 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:09,488 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-08-18 15:53:09,488 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:09,490 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:09,490 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:09,490 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-08-18 15:53:09,490 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:09,490 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>)
2022-08-18 15:53:09,490 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:09,491 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:09,491 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:09,491 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-08-18 15:53:09,491 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:09,491 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-08-18 15:53:09,491 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-08-18 15:53:09,492 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:09,492 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-08-18 15:53:09,492 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:09,495 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:09,495 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:09,495 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>)
2022-08-18 15:53:09,496 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>
2022-08-18 15:53:09,496 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>)
2022-08-18 15:53:09,496 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>
2022-08-18 15:53:10,614 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(41)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 123 and log index 41 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>
2022-08-18 15:53:10,614 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=123, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 123 and log index 41 is not yet replicated to ALL_COMMITTED, logIndex=41, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(41)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 121 and log index 41 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>
2022-08-18 15:53:10,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(30)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:53:10,614 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(34)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 105 and log index 34 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>
2022-08-18 15:53:10,614 [timer4] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(38)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 113 and log index 38 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer4] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(28)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(30)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(34)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 107 and log index 34 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(32)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 103 and log index 32 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(27)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(25)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-08-18 15:53:10,614 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(38)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 115 and log index 38 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(29)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(39)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 117 and log index 39 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(36)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 109 and log index 36 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(25)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(27)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(31)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(36)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 111 and log index 36 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:10,615 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(39)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 119 and log index 39 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:10,615 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=115, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 115 and log index 38 is not yet replicated to ALL_COMMITTED, logIndex=38, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,616 [timer7] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL(32)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 101 and log index 32 is not yet replicated to ALL, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>
2022-08-18 15:53:10,616 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=115, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 115 and log index 38 is not yet replicated to ALL_COMMITTED, logIndex=38, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=121, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 121 and log index 41 is not yet replicated to ALL, logIndex=41, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, logIndex=30, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=105, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 105 and log index 34 is not yet replicated to ALL, logIndex=34, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=113, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 113 and log index 38 is not yet replicated to ALL, logIndex=38, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, logIndex=30, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=107, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 107 and log index 34 is not yet replicated to ALL_COMMITTED, logIndex=34, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=107, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 107 and log index 34 is not yet replicated to ALL_COMMITTED, logIndex=34, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=103, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 103 and log index 32 is not yet replicated to ALL_COMMITTED, logIndex=32, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=103, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 103 and log index 32 is not yet replicated to ALL_COMMITTED, logIndex=32, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,617 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, logIndex=27, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=117, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 117 and log index 39 is not yet replicated to ALL, logIndex=39, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=117, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 117 and log index 39 is not yet replicated to ALL, logIndex=39, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 91 and log index 29 is not yet replicated to ALL_COMMITTED, logIndex=29, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=109, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 109 and log index 36 is not yet replicated to ALL, logIndex=36, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=109, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 109 and log index 36 is not yet replicated to ALL, logIndex=36, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, logIndex=31, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, logIndex=31, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,618 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=111, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 111 and log index 36 is not yet replicated to ALL_COMMITTED, logIndex=36, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,619 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=111, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 111 and log index 36 is not yet replicated to ALL_COMMITTED, logIndex=36, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,619 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=119, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 119 and log index 39 is not yet replicated to ALL_COMMITTED, logIndex=39, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,619 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=119, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 119 and log index 39 is not yet replicated to ALL_COMMITTED, logIndex=39, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,619 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=101, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 101 and log index 32 is not yet replicated to ALL, logIndex=32, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,619 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=101, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 101 and log index 32 is not yet replicated to ALL, logIndex=32, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:10,840 [s1@group-82CF0218057B-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(93)) - Timeout 1/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s1@group-82CF0218057B-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:90)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:381)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:62)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:571)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:319)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1784)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 6 more
2022-08-18 15:53:12,272 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=201, target=localhost:33205}}. 
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #4 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #5 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:12,274 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #2 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
2022-08-18 15:53:12,274 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-58CC921A4208: attempt #6 send~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:12,274 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-08-18 15:53:12,275 [timer5] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(31)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 99 and log index 31 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-08-18 15:53:12,275 [timer5] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-82CF0218057B-WatchRequests: timeout Watch-ALL_COMMITTED(28)@23.683s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-08-18 15:53:12,275 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 99 and log index 31 is not yet replicated to ALL_COMMITTED, logIndex=31, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:12,275 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 99 and log index 31 is not yet replicated to ALL_COMMITTED, logIndex=31, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:12,275 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, logIndex=28, commits[s0:c58, s1:c24, s2:c58]
2022-08-18 15:53:12,275 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>)
2022-08-18 15:53:12,275 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>
2022-08-18 15:53:12,275 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-08-18 15:53:12,275 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>)
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>)
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(803)) - s0@group-82CF0218057B: receive client request(RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-08-18 15:53:12,276 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(419)) - s0@group-82CF0218057B-LeaderStateImpl: addWatchRequest RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-08-18 15:53:12,391 [Time-limited test] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=215, target=localhost:33205}}. 
2022-08-18 15:53:12,394 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(140)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:53:12,394 [Time-limited test] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(141)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
java.util.concurrent.ExecutionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.WatchRequestTests.checkMajority(WatchRequestTests.java:270)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:356)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at org.apache.ratis.util.SlidingWindow$RequestMap.endOfRequests(SlidingWindow.java:156)
	at org.apache.ratis.util.SlidingWindow$Server.endOfRequests(SlidingWindow.java:499)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:340)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: SlidingWindow$Server:3-OrderedRequestStreamObserver3 is closing: seq = 27 > nextToProcess = -1 will NEVER be processed; request = 27:null
	at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:452)
	at org.apache.ratis.client.impl.ClientProtoUtils.toAlreadyClosedException(ClientProtoUtils.java:438)
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:390)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	... 5 more
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(827)) - ************************************************************** 
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(828)) - *** 
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(829)) - ***     Stopping MiniRaftClusterWithGrpc
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(830)) - *** 
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2022-08-18 15:53:12,395 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-82CF0218057B-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-82CF0218057B:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-82CF0218057B-SegmentedRaftLog:OPENED:c58, conf=23: peers:[s0|rpc:localhost:44275|admin:localhost:40891|client:localhost:33205|dataStream:localhost:37075|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46605|admin:localhost:37883|client:localhost:39963|dataStream:localhost:40033|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34519|admin:localhost:45157|client:localhost:33917|dataStream:localhost:34383|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-08-18 15:53:12,397 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(403)) - s2: close
2022-08-18 15:53:12,398 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s2@group-82CF0218057B: shutdown
2022-08-18 15:53:12,398 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s2
2022-08-18 15:53:12,398 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-82CF0218057B-FollowerState
2022-08-18 15:53:12,398 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s2@group-82CF0218057B-StateMachineUpdater: set stopIndex = 58
2022-08-18 15:53:12,398 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-08-18 15:53:12,398 [s2@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-82CF0218057B-FollowerState was interrupted
2022-08-18 15:53:12,399 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s2@group-82CF0218057B: closes. applyIndex: 58
2022-08-18 15:53:12,399 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(403)) - s1: close
2022-08-18 15:53:12,400 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-08-18 15:53:12,399 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(403)) - s0: close
2022-08-18 15:53:12,400 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s1@group-82CF0218057B: shutdown
2022-08-18 15:53:12,401 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s1
2022-08-18 15:53:12,401 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-82CF0218057B-FollowerState
2022-08-18 15:53:12,401 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s1@group-82CF0218057B-StateMachineUpdater: set stopIndex = 24
2022-08-18 15:53:12,401 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s1@group-82CF0218057B: closes. applyIndex: 24
2022-08-18 15:53:12,401 [s1@group-82CF0218057B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-82CF0218057B-FollowerState was interrupted
2022-08-18 15:53:12,401 [s2@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(345)) - s2@group-82CF0218057B-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-08-18 15:53:12,402 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s0@group-82CF0218057B: shutdown
2022-08-18 15:53:12,402 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-82CF0218057B,id=s0
2022-08-18 15:53:12,402 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-82CF0218057B-LeaderStateImpl
2022-08-18 15:53:12,402 [s1-server-thread4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#109-t4,previous=(t:4, i:24),leaderCommit=24,initializing? true,entries: size=1, first=(t:4, i:25), STATEMACHINELOGENTRY, 56@client-58CC921A4208
java.util.concurrent.CompletionException: java.io.InterruptedIOException: s1@group-82CF0218057B-SegmentedRaftLogWorker-flushStateMachineData interrupted.
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.biRelay(CompletableFuture.java:1298)
	at java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1284)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:104)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:328)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.InterruptedIOException: s1@group-82CF0218057B-SegmentedRaftLogWorker-flushStateMachineData interrupted.
	at org.apache.ratis.util.IOUtils.toInterruptedIOException(IOUtils.java:49)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:83)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:90)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:381)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:62)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:571)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:319)
	... 1 more
Caused by: java.lang.InterruptedException
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:347)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 6 more
2022-08-18 15:53:12,408 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(255)) - s2@group-82CF0218057B-SegmentedRaftLogWorker close()
2022-08-18 15:53:12,403 [s0@group-82CF0218057B->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(191)) - s0@group-82CF0218057B->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-08-18 15:53:12,403 [s0@group-82CF0218057B->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(191)) - s0@group-82CF0218057B->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-08-18 15:53:12,413 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:53:12,403 [s0-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-82CF0218057B-PendingRequests: sendNotLeaderResponses
2022-08-18 15:53:12,413 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#156-t4,previous=(t:4, i:57),leaderCommit=54,initializing? true,entries: size=1, first=(t:4, i:58), METADATAENTRY(c:54)
2022-08-18 15:53:12,413 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:53:12,413 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s2: nextIndex: updateUnconditionally 59 -> 58
2022-08-18 15:53:12,414 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-08-18 15:53:12,417 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,417 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,418 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=101, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=101, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=101, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=105, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=105, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=105, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=105, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=109, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=109, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=109, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,419 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=113, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=113, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=113, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=113, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=117, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=117, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=121, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=121, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=125, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=125, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,420 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=125, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,421 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:53:12,421 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s2: nextIndex: updateUnconditionally 58 -> 57
2022-08-18 15:53:12,421 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=129, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=129, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,426 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,427 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,427 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,427 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,436 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,437 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-58CC921A4208->s0: Stream completed: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onCompleted(GrpcClientProtocolClient.java:346)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:477)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,437 [grpc-default-executor-0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onCompleted(GrpcClientProtocolClient.java:346)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:477)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,437 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-08-18 15:53:12,437 [grpc-default-executor-0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-82CF0218057B client-58CC921A4208: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-08-18 15:53:12,428 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(402)) - s0@group-82CF0218057B->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-08-18 15:53:12,438 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-82CF0218057B->s1: nextIndex: updateUnconditionally 59 -> 25
2022-08-18 15:53:12,436 [Thread-337] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,435 [Thread-336] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,444 [Thread-336] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-336] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-336] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-336] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,445 [Thread-336] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=125, seq=0, Watch-ALL(43), null
2022-08-18 15:53:12,435 [Thread-335] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,445 [Thread-335] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-335] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-335] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-335] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,445 [Thread-335] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), null
2022-08-18 15:53:12,435 [Thread-334] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,445 [Thread-334] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-334] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-334] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,445 [Thread-334] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,445 [Thread-334] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=121, seq=0, Watch-ALL(41), null
2022-08-18 15:53:12,435 [Thread-333] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,445 [Thread-333] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,446 [Thread-333] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,446 [Thread-333] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,446 [Thread-333] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,446 [Thread-333] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), null
2022-08-18 15:53:12,435 [Thread-332] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,446 [Thread-332] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,435 [Thread-331] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,446 [Thread-331] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-331] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-331] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-331] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,452 [Thread-331] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), null
2022-08-18 15:53:12,434 [Thread-330] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,452 [Thread-330] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-330] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-330] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,452 [Thread-330] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,453 [Thread-330] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=113, seq=0, Watch-ALL(38), null
2022-08-18 15:53:12,434 [Thread-329] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,453 [Thread-329] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-329] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-329] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-329] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,453 [Thread-329] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), null
2022-08-18 15:53:12,434 [Thread-328] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,453 [Thread-328] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-328] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-328] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-328] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,453 [Thread-328] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=109, seq=0, Watch-ALL(36), null
2022-08-18 15:53:12,434 [Thread-327] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,453 [Thread-327] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-327] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-327] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,453 [Thread-327] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,453 [Thread-327] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), null
2022-08-18 15:53:12,434 [Thread-326] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,453 [Thread-326] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-326] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-326] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-326] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,454 [Thread-326] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=105, seq=0, Watch-ALL(34), null
2022-08-18 15:53:12,434 [Thread-325] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,454 [Thread-325] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-325] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-325] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-325] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,454 [Thread-325] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), null
2022-08-18 15:53:12,434 [Thread-324] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,454 [Thread-324] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-324] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-324] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-324] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,454 [Thread-324] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=101, seq=0, Watch-ALL(32), null
2022-08-18 15:53:12,434 [Thread-323] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,454 [Thread-323] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-323] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-323] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-323] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,454 [Thread-323] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-08-18 15:53:12,434 [Thread-322] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #5 receive~ null
2022-08-18 15:53:12,454 [Thread-322] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #5 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,454 [Thread-322] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-322] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-322] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,455 [Thread-322] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=97, seq=0, Watch-ALL(31), null
2022-08-18 15:53:12,434 [Thread-321] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,455 [Thread-321] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-321] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-321] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-321] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,455 [Thread-321] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-08-18 15:53:12,434 [Thread-320] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #4 receive~ null
2022-08-18 15:53:12,455 [Thread-320] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-320] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-320] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-320] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,455 [Thread-320] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=93, seq=0, Watch-ALL(30), null
2022-08-18 15:53:12,434 [Thread-319] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,455 [Thread-319] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-319] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-319] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-319] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,455 [Thread-319] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-08-18 15:53:12,434 [Thread-318] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,455 [Thread-318] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-318] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,455 [Thread-318] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,456 [Thread-318] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,456 [Thread-318] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=89, seq=0, Watch-ALL(29), null
2022-08-18 15:53:12,433 [Thread-317] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,456 [Thread-317] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,456 [Thread-317] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,456 [Thread-317] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,456 [Thread-317] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,456 [Thread-317] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-08-18 15:53:12,433 [Thread-316] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,456 [Thread-316] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,456 [Thread-316] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-316] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-316] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,457 [Thread-316] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=85, seq=0, Watch-ALL(28), null
2022-08-18 15:53:12,432 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(391)) - s0@group-82CF0218057B->s1-GrpcLogAppender is already stopped
2022-08-18 15:53:12,431 [Thread-315] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,457 [Thread-315] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-315] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-315] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-315] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,457 [Thread-315] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-08-18 15:53:12,430 [Thread-314] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #6 receive~ null
2022-08-18 15:53:12,457 [Thread-314] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #6 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-314] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-314] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,457 [Thread-314] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,457 [Thread-314] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=81, seq=0, Watch-ALL(27), null
2022-08-18 15:53:12,430 [Thread-313] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #7 receive~ null
2022-08-18 15:53:12,458 [Thread-313] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #7 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-313] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-313] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-313] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,458 [Thread-313] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #7, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-08-18 15:53:12,430 [Thread-312] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #8 receive~ null
2022-08-18 15:53:12,458 [Thread-312] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #8 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-312] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-312] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-312] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,458 [Thread-312] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #8, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=77, seq=0, Watch-ALL(25), null
2022-08-18 15:53:12,430 [Thread-311] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:12,458 [Thread-311] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-311] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-311] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-311] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,458 [Thread-311] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), null
2022-08-18 15:53:12,430 [Thread-310] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-58CC921A4208: attempt #2 receive~ null
2022-08-18 15:53:12,458 [Thread-310] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #2 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,428 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(255)) - s1@group-82CF0218057B-SegmentedRaftLogWorker close()
2022-08-18 15:53:12,458 [Thread-310] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,458 [Thread-310] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,459 [Thread-310] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,459 [Thread-310] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=129, seq=0, Watch-ALL(44), null
2022-08-18 15:53:12,452 [Thread-332] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,459 [Thread-332] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,459 [Thread-332] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,459 [Thread-332] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=117, seq=0, Watch-ALL(39), null
2022-08-18 15:53:12,444 [Thread-337] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-58CC921A4208: attempt #4 failed~ RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,439 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s1 Close channels
2022-08-18 15:53:12,439 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s0 Close channels
2022-08-18 15:53:12,437 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,460 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,460 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,437 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s0@group-82CF0218057B-StateMachineUpdater: set stopIndex = 58
2022-08-18 15:53:12,461 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s0@group-82CF0218057B: closes. applyIndex: 58
2022-08-18 15:53:12,461 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=103, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=103, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=103, seq=0, Watch-ALL_COMMITTED(32), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=103, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=107, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=107, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=107, seq=0, Watch-ALL_COMMITTED(34), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=107, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=111, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=111, seq=0, Watch-ALL_COMMITTED(36), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=111, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=115, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=115, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=115, seq=0, Watch-ALL_COMMITTED(38), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=115, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=119, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,462 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=119, seq=0, Watch-ALL_COMMITTED(39), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=119, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=123, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=123, seq=0, Watch-ALL_COMMITTED(41), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=123, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=127, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=127, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=127, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=131, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,463 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=131, seq=0, Watch-ALL_COMMITTED(44), Message:<EMPTY>, reply=RaftClientReply:client-58CC921A4208->s0@group-82CF0218057B, cid=131, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader, logIndex=0, commits[s0:c58]
2022-08-18 15:53:12,437 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s0 Close channels
2022-08-18 15:53:12,463 [s0@group-82CF0218057B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(345)) - s0@group-82CF0218057B-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-08-18 15:53:12,463 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s1 Close channels
2022-08-18 15:53:12,463 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s2 Close channels
2022-08-18 15:53:12,463 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s2 Close channels
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s1: shutdown server GrpcServerProtocolService now
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s2: shutdown server GrpcServerProtocolService now
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s1: shutdown server GrpcServerProtocolService successfully
2022-08-18 15:53:12,464 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-08-18 15:53:12,465 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-08-18 15:53:12,465 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s0: shutdown server GrpcServerProtocolService now
2022-08-18 15:53:12,465 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(255)) - s0@group-82CF0218057B-SegmentedRaftLogWorker close()
2022-08-18 15:53:12,466 [java.util.concurrent.ThreadPoolExecutor$Worker@68680266[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-08-18 15:53:12,466 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s2: shutdown server GrpcServerProtocolService successfully
2022-08-18 15:53:12,466 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-08-18 15:53:12,467 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s0: shutdown server GrpcServerProtocolService successfully
2022-08-18 15:53:12,467 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(279)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-08-18 15:53:12,468 [java.util.concurrent.ThreadPoolExecutor$Worker@1cfd3ee[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-08-18 15:53:12,468 [java.util.concurrent.ThreadPoolExecutor$Worker@5169d813[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(288)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-08-18 15:53:12,468 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@7f86158c] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s1: Stopped
2022-08-18 15:53:12,470 [Thread-337] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-58CC921A4208: suggested new leader: null. Failed RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-82CF0218057B is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:447)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,470 [Thread-337] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.lang.Thread.run(Thread.java:750)
2022-08-18 15:53:12,470 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@52b60fec] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s0: Stopped
2022-08-18 15:53:12,470 [Thread-337] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-58CC921A4208: oldLeader=s0,  curLeader=s2, newLeader=null
2022-08-18 15:53:12,470 [Thread-337] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-58CC921A4208->s0@group-82CF0218057B, cid=127, seq=0, Watch-ALL_COMMITTED(43), null
2022-08-18 15:53:12,471 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$307/2465301@1dadacff] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s2: Stopped
2022-08-18 15:53:12,472 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(850)) - MiniRaftClusterWithGrpc shutdown completed
]]></system-out>
    <system-err><![CDATA[SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
]]></system-err>
  </testcase>
  <testcase name="testWatchRequestAsync" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="7.008"/>
  <testcase name="testWatchRequestTimeout" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="4.205"/>
  <testcase name="testWatchRequestClientTimeout" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="3.576"/>
</testsuite>