-------------------------------------------------------------------------------
Test set: org.apache.ratis.datastream.TestDataStreamSslWithRpcTypeGrpcAndDataStreamTypeNetty
-------------------------------------------------------------------------------
Tests run: 4, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 3.773 s <<< FAILURE! - in org.apache.ratis.datastream.TestDataStreamSslWithRpcTypeGrpcAndDataStreamTypeNetty
testMultipleStreamsSingleServer(org.apache.ratis.datastream.TestDataStreamSslWithRpcTypeGrpcAndDataStreamTypeNetty)  Time elapsed: 3.564 s  <<< ERROR!
java.util.concurrent.CompletionException: java.lang.AssertionError: expected same:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=0,SUCCESS,bytesWritten=0> was not:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=152,SUCCESS,bytesWritten=0>
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedStreamAsync$DataStreamWindowRequest.setReply(OrderedStreamAsync.java:82)
	at org.apache.ratis.client.impl.OrderedStreamAsync$DataStreamWindowRequest.setReply(OrderedStreamAsync.java:48)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:316)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequestToNetwork$4(OrderedStreamAsync.java:155)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:268)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:327)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:299)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1372)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.decodeNonJdkCompatible(SslHandler.java:1246)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1286)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:510)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:449)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:279)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.AssertionError: expected same:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=0,SUCCESS,bytesWritten=0> was not:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=152,SUCCESS,bytesWritten=0>
	at org.junit.Assert.fail(Assert.java:89)
	at org.junit.Assert.failNotSame(Assert.java:829)
	at org.junit.Assert.assertSame(Assert.java:772)
	at org.junit.Assert.assertSame(Assert.java:783)
	at org.apache.ratis.datastream.DataStreamTestUtils.assertCloseReply(DataStreamTestUtils.java:347)
	at org.apache.ratis.datastream.DataStreamTestUtils.lambda$writeAndCloseAndAssertReplies$0(DataStreamTestUtils.java:323)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:966)
	... 42 more

