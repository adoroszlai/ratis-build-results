2022-06-20 14:54:55,762 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-06-20 14:54:55,764 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-06-20 14:54:55,774 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.netty.NettyUtils log level to DEBUG
2022-06-20 14:54:55,777 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(119)) - Running runWithNewCluster
2022-06-20 14:54:55,779 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:newServerTlsConfig(45)) - newServerTlsConfig: mutualAuthn? true
2022-06-20 14:54:55,781 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/server.pem: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/server.pem
2022-06-20 14:54:55,781 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/server.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/server.crt
2022-06-20 14:54:55,781 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/client.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.crt
2022-06-20 14:54:55,784 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (NettyConfigKeys.java:setTlsConf(130)) - setTlsConf TlsConf0-server
2022-06-20 14:54:55,786 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:newClientTlsConfig(56)) - newClientTlsConfig: mutualAuthn? true
2022-06-20 14:54:55,786 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/client.pem: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.pem
2022-06-20 14:54:55,786 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/client.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.crt
2022-06-20 14:54:55,786 [Time-limited test] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(40)) - Getting resource ssl/ca.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/ca.crt
2022-06-20 14:54:55,790 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (NettyConfigKeys.java:setTlsConf(86)) - setTlsConf TlsConf1-client
2022-06-20 14:54:55,837 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(272)) - new MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty with group-AE84EB7C6EA2:[s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0]
2022-06-20 14:54:55,838 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(315)) - .............................................................. 
2022-06-20 14:54:55,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(316)) - ... 
2022-06-20 14:54:55,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(317)) - ...     Starting MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2022-06-20 14:54:55,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(318)) - ... 
2022-06-20 14:54:55,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(319)) - .............................................................. 
2022-06-20 14:54:55,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(284)) - servers = {}
2022-06-20 14:54:55,845 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(358)) - newRaftServer: s0, group-AE84EB7C6EA2:[s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], format? true
2022-06-20 14:54:55,846 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0
2022-06-20 14:54:55,849 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0 does not exist.
2022-06-20 14:54:55,849 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(363)) - Formatted directory target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0
2022-06-20 14:54:55,875 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-06-20 14:54:55,922 [Time-limited test] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-06-20 14:54:55,926 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 41239 (custom)
2022-06-20 14:54:55,927 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 39865 (custom)
2022-06-20 14:54:55,927 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 37345 (custom)
2022-06-20 14:54:55,928 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-06-20 14:54:55,930 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-06-20 14:54:55,931 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-06-20 14:54:55,934 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-06-20 14:54:55,954 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-06-20 14:54:55,954 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-06-20 14:54:56,133 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:56,138 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = TlsConf0-server (custom)
2022-06-20 14:54:56,144 [Time-limited test] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-06-20 14:54:56,196 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-06-20 14:54:56,197 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-06-20 14:54:56,197 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-06-20 14:54:56,198 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-06-20 14:54:56,200 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-06-20 14:54:56,200 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-06-20 14:54:56,205 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-06-20 14:54:56,400 [Time-limited test] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for server from TlsConf0-server returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslServerContext
2022-06-20 14:54:56,400 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 34841 (custom)
2022-06-20 14:54:56,469 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-06-20 14:54:56,470 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-06-20 14:54:56,470 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-06-20 14:54:56,470 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-06-20 14:54:56,476 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0] (custom)
2022-06-20 14:54:56,486 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6] REGISTERED
2022-06-20 14:54:56,487 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6] BIND: 0.0.0.0/0.0.0.0:34841
2022-06-20 14:54:56,488 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] ACTIVE
2022-06-20 14:54:56,492 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s0: addNew group-AE84EB7C6EA2:[s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0] returns group-AE84EB7C6EA2:java.util.concurrent.CompletableFuture@4e708dcf[Not completed]
2022-06-20 14:54:56,500 [pool-2-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(190)) - s0: new RaftServerImpl for group-AE84EB7C6EA2:[s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0] with MultiDataStreamStateMachine:uninitialized
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-06-20 14:54:56,502 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-06-20 14:54:56,507 [pool-2-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(107)) - s0@group-AE84EB7C6EA2: ConfigurationManager, init=-1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null, confs=<EMPTY_MAP>
2022-06-20 14:54:56,508 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0] (custom)
2022-06-20 14:54:56,513 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-06-20 14:54:56,513 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-06-20 14:54:56,516 [pool-2-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2 does not exist. Creating ...
2022-06-20 14:54:56,517 [pool-2-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2
2022-06-20 14:54:56,520 [pool-2-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2/in_use.lock acquired by nodename 25279@fv-az223-267.yvdtcyk4fxruhab3fij3c3d4ph.cx.internal.cloudapp.net
2022-06-20 14:54:56,521 [pool-2-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2/current
2022-06-20 14:54:56,521 [pool-2-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2/sm
2022-06-20 14:54:56,528 [pool-2-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(79)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2 has been successfully formatted.
2022-06-20 14:54:56,530 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-06-20 14:54:56,535 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-06-20 14:54:56,543 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-06-20 14:54:56,546 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-06-20 14:54:56,547 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-06-20 14:54:56,549 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-06-20 14:54:56,555 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-06-20 14:54:56,556 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-06-20 14:54:56,559 [pool-2-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2
2022-06-20 14:54:56,560 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-06-20 14:54:56,560 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-06-20 14:54:56,561 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-06-20 14:54:56,561 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-06-20 14:54:56,562 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-06-20 14:54:56,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-06-20 14:54:56,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-06-20 14:54:56,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-06-20 14:54:56,572 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-06-20 14:54:56,573 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-06-20 14:54:56,573 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-06-20 14:54:56,579 [pool-2-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-06-20 14:54:56,579 [pool-2-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-06-20 14:54:56,583 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-06-20 14:54:56,583 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-06-20 14:54:56,584 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-06-20 14:54:56,585 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-06-20 14:54:56,585 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-06-20 14:54:56,612 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-06-20 14:54:56,612 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-06-20 14:54:56,612 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-06-20 14:54:56,613 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-06-20 14:54:56,613 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-06-20 14:54:56,614 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(310)) - s0@group-AE84EB7C6EA2: start as a follower, conf=-1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null
2022-06-20 14:54:56,615 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-AE84EB7C6EA2: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-06-20 14:54:56,616 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-AE84EB7C6EA2-FollowerState
2022-06-20 14:54:56,617 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-AE84EB7C6EA2,id=s0
2022-06-20 14:54:56,621 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$6(382)) - s0: start RPC server
2022-06-20 14:54:56,632 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 37345
2022-06-20 14:54:56,632 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 41239
2022-06-20 14:54:56,633 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 39865
2022-06-20 14:54:56,634 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$280/1421047657@439bfb51] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s0: Started
2022-06-20 14:54:56,638 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-06-20 14:54:56,640 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-AE84EB7C6EA2:t0, leader=null, voted=, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING
2022-06-20 14:54:56,643 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(172)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-AE84EB7C6EA2:t0, leader=null, voted=, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-AE84EB7C6EA2:t0, leader=null, voted=, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:533)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:567)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:560)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:166)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:152)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:90)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:86)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:125)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:113)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsSingleServer(DataStreamAsyncClusterTests.java:58)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:56,859 [s0@group-AE84EB7C6EA2-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-AE84EB7C6EA2-FollowerState: change to CANDIDATE, lastRpcElapsedTime:243509826ns, electionTimeout:237ms
2022-06-20 14:54:56,861 [s0@group-AE84EB7C6EA2-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-AE84EB7C6EA2-FollowerState
2022-06-20 14:54:56,861 [s0@group-AE84EB7C6EA2-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-AE84EB7C6EA2: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-06-20 14:54:56,864 [s0@group-AE84EB7C6EA2-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-06-20 14:54:56,864 [s0@group-AE84EB7C6EA2-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-AE84EB7C6EA2-LeaderElection1
2022-06-20 14:54:56,867 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-AE84EB7C6EA2-LeaderElection1 PRE_VOTE round 0: submit vote requests at term 0 for -1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null
2022-06-20 14:54:56,868 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-AE84EB7C6EA2-LeaderElection1 PRE_VOTE round 0: result PASSED (term=0)
2022-06-20 14:54:56,870 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-AE84EB7C6EA2-LeaderElection1 ELECTION round 0: submit vote requests at term 1 for -1: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null
2022-06-20 14:54:56,870 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-AE84EB7C6EA2-LeaderElection1 ELECTION round 0: result PASSED (term=1)
2022-06-20 14:54:56,870 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-AE84EB7C6EA2-LeaderElection1
2022-06-20 14:54:56,871 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-AE84EB7C6EA2: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2022-06-20 14:54:56,871 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServer$Division (ServerState.java:setLeader(291)) - s0@group-AE84EB7C6EA2: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 340ms
2022-06-20 14:54:56,875 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-06-20 14:54:56,878 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-06-20 14:54:56,879 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-06-20 14:54:56,884 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-06-20 14:54:56,884 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-06-20 14:54:56,885 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-06-20 14:54:56,891 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-06-20 14:54:56,894 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-06-20 14:54:56,896 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-AE84EB7C6EA2-LeaderStateImpl
2022-06-20 14:54:56,914 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker: Starting segment from index:0
2022-06-20 14:54:56,939 [s0@group-AE84EB7C6EA2-LeaderElection1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(397)) - s0@group-AE84EB7C6EA2: set configuration 0: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null
2022-06-20 14:54:57,007 [s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/fb975dab/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNettyb98ffda9/s0/564098b2-f63e-4e24-85c4-ae84eb7c6ea2/current/log_inprogress_0
2022-06-20 14:54:57,098 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-AE84EB7C6EA2:t1, leader=s0, voted=s0, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c0, conf=0: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING
2022-06-20 14:54:57,122 [pool-1-thread-7] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,123 [pool-1-thread-5] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,123 [pool-1-thread-4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,123 [pool-1-thread-3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,123 [pool-1-thread-6] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,124 [pool-1-thread-8] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,124 [pool-1-thread-9] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-06-20 14:54:57,124 [pool-1-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,125 [pool-1-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,124 [pool-1-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,125 [pool-1-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,124 [pool-1-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,126 [pool-1-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,124 [pool-1-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,130 [pool-1-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,124 [pool-1-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,124 [pool-1-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,134 [pool-1-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,134 [pool-1-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,146 [pool-1-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = TlsConf1-client (custom)
2022-06-20 14:54:57,146 [pool-1-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-06-20 14:54:57,161 [pool-1-thread-7] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,161 [pool-1-thread-8] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,162 [pool-1-thread-6] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,166 [pool-1-thread-5] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,163 [pool-1-thread-4] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,162 [pool-1-thread-3] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,169 [pool-1-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,169 [pool-1-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,169 [pool-1-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,169 [pool-1-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,169 [pool-1-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,170 [pool-1-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,170 [pool-1-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,171 [pool-1-thread-9] DEBUG netty.NettyUtils (NettyUtils.java:buildSslContext(126)) - buildSslContext for client from TlsConf1-client returns org.apache.ratis.thirdparty.io.netty.handler.ssl.OpenSslClientContext
2022-06-20 14:54:57,173 [pool-1-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,173 [pool-1-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,167 [pool-1-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,170 [pool-1-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,174 [pool-1-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,175 [pool-1-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-06-20 14:54:57,175 [pool-1-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-06-20 14:54:57,246 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0xf16998d2, L:/127.0.0.1:34841 - R:/127.0.0.1:37622]
2022-06-20 14:54:57,264 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ COMPLETE
2022-06-20 14:54:57,264 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0x8b7a166d, L:/127.0.0.1:34841 - R:/127.0.0.1:37624]
2022-06-20 14:54:57,267 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0x8ba1c1c4, L:/127.0.0.1:34841 - R:/127.0.0.1:37626]
2022-06-20 14:54:57,270 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0x4bf8d492, L:/127.0.0.1:34841 - R:/127.0.0.1:37628]
2022-06-20 14:54:57,271 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0x768edaca, L:/127.0.0.1:34841 - R:/127.0.0.1:37630]
2022-06-20 14:54:57,271 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ COMPLETE
2022-06-20 14:54:57,275 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0xd3fc735e, L:/127.0.0.1:34841 - R:/127.0.0.1:37632]
2022-06-20 14:54:57,275 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ COMPLETE
2022-06-20 14:54:57,284 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ: [id: 0xabf16c30, L:/127.0.0.1:34841 - R:/127.0.0.1:37634]
2022-06-20 14:54:57,284 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] READ COMPLETE
2022-06-20 14:54:57,301 [pool-1-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream4
2022-06-20 14:54:57,313 [pool-1-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream3
2022-06-20 14:54:57,327 [pool-1-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream2
2022-06-20 14:54:57,343 [pool-1-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream1
2022-06-20 14:54:57,349 [pool-1-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream0
2022-06-20 14:54:57,356 [pool-1-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream5
2022-06-20 14:54:57,362 [pool-1-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream6
2022-06-20 14:54:58,146 [pool-1-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream3: bytesWritten=7514901
2022-06-20 14:54:58,149 [pool-1-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream5: bytesWritten=7406460
2022-06-20 14:54:58,153 [pool-1-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream4: bytesWritten=7163347
2022-06-20 14:54:58,191 [pool-1-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream6: bytesWritten=7604356
2022-06-20 14:54:58,204 [pool-1-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream1: bytesWritten=8571263
2022-06-20 14:54:58,813 [s0-client-thread4] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-91301E8C56B5->s0@group-AE84EB7C6EA2, cid=5, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-06-20 14:54:58,816 [s0-client-thread5] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-F994E0115ABC->s0@group-AE84EB7C6EA2, cid=3, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-06-20 14:54:58,824 [s0-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-0B6125F9A244->s0@group-AE84EB7C6EA2, cid=6, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-06-20 14:54:58,826 [s0-client-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-9D15E672E4B7->s0@group-AE84EB7C6EA2, cid=1, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-06-20 14:54:58,826 [pool-1-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream7
2022-06-20 14:54:58,830 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-C9DBFF796CFA->s0@group-AE84EB7C6EA2, cid=4, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-06-20 14:54:58,845 [pool-1-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream8
2022-06-20 14:54:58,884 [pool-1-thread-8] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream9
2022-06-20 14:54:58,887 [pool-1-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream10
2022-06-20 14:54:58,891 [pool-1-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream11
2022-06-20 14:54:58,893 [pool-1-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream12
2022-06-20 14:54:58,893 [pool-1-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream13
2022-06-20 14:54:58,915 [pool-1-thread-6] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream14
2022-06-20 14:54:58,933 [pool-1-thread-10] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4001874,length=732789
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4001874,length=732789
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4001874,length=732789
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,935 [pool-1-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream15
2022-06-20 14:54:58,936 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream16
2022-06-20 14:54:58,936 [pool-1-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream17
2022-06-20 14:54:58,938 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=0,length=616760
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=0,length=616760
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=0,length=616760
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,940 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=616760,length=558361
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=616760,length=558361
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=616760,length=558361
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,941 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(127)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-AE84EB7C6EA2:t1, leader=s0, voted=s0, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c9, conf=0: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING
2022-06-20 14:54:58,941 [Time-limited test] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(128)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:113)
java.util.concurrent.CompletionException: java.lang.AssertionError: expected same:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=0,SUCCESS,bytesWritten=0> was not:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=152,SUCCESS,bytesWritten=0>
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.client.impl.OrderedStreamAsync$DataStreamWindowRequest.setReply(OrderedStreamAsync.java:82)
	at org.apache.ratis.client.impl.OrderedStreamAsync$DataStreamWindowRequest.setReply(OrderedStreamAsync.java:48)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:316)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequestToNetwork$4(OrderedStreamAsync.java:155)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:616)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1975)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:268)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:327)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:299)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1372)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.decodeNonJdkCompatible(SslHandler.java:1246)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1286)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:510)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:449)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:279)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.AssertionError: expected same:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=0,SUCCESS,bytesWritten=0> was not:<DataStreamReplyByteBuffer:clientId=client-0B6125F9A244,type=STREAM_DATA,id=6,offset=7604356,length=152,SUCCESS,bytesWritten=0>
	at org.junit.Assert.fail(Assert.java:89)
	at org.junit.Assert.failNotSame(Assert.java:829)
	at org.junit.Assert.assertSame(Assert.java:772)
	at org.junit.Assert.assertSame(Assert.java:783)
	at org.apache.ratis.datastream.DataStreamTestUtils.assertCloseReply(DataStreamTestUtils.java:347)
	at org.apache.ratis.datastream.DataStreamTestUtils.lambda$writeAndCloseAndAssertReplies$0(DataStreamTestUtils.java:323)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:966)
	... 42 more
2022-06-20 14:54:58,942 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(760)) - ************************************************************** 
2022-06-20 14:54:58,942 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(761)) - *** 
2022-06-20 14:54:58,942 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(762)) - ***     Stopping MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2022-06-20 14:54:58,942 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(763)) - *** 
2022-06-20 14:54:58,942 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(764)) - ************************************************************** 
2022-06-20 14:54:58,943 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=887443,length=979339
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=887443,length=979339
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=887443,length=979339
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,945 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=1866782,length=524619
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=1866782,length=524619
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=1866782,length=524619
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,946 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=2487231,length=589967
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=2487231,length=589967
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=2487231,length=589967
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,949 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3077198,length=911651
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3077198,length=911651
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3077198,length=911651
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,950 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=708722,length=825416
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=708722,length=825416
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=708722,length=825416
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,953 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=1534138,length=833081
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=1534138,length=833081
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=1534138,length=833081
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,954 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=0,length=639147
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=0,length=639147
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=0,length=639147
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,956 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=0,length=560070
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=0,length=560070
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=0,length=560070
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,957 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=639147,length=820903
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=639147,length=820903
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=639147,length=820903
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,958 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=560070,length=597166
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=560070,length=597166
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=560070,length=597166
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,959 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(765)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-AE84EB7C6EA2:t1, leader=s0, voted=s0, raftlog=s0@group-AE84EB7C6EA2-SegmentedRaftLog:OPENED:c9, conf=0: [s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0], old=null RUNNING
2022-06-20 14:54:58,960 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=0,length=745913
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=0,length=745913
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=0,length=745913
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,962 [pool-1-thread-10] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4734663,length=526604
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4734663,length=526604
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=4734663,length=526604
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,964 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1175121,length=742108
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1175121,length=742108
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1175121,length=742108
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,963 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1157236,length=781852
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1157236,length=781852
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1157236,length=781852
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,965 [pool-1-thread-10] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=5261267,length=889991
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=5261267,length=889991
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=5261267,length=889991
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,993 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=896647,length=538275
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=896647,length=538275
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=896647,length=538275
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,995 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1917229,length=784068
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1917229,length=784068
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=1917229,length=784068
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:58,996 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=1434922,length=852612
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=1434922,length=852612
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=1434922,length=852612
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,009 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2287534,length=673183
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2287534,length=673183
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2287534,length=673183
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,010 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=935723,length=852061
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=935723,length=852061
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=935723,length=852061
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,010 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=2701297,length=928176
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=2701297,length=928176
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=2701297,length=928176
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,001 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1939088,length=825440
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1939088,length=825440
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=1939088,length=825440
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,027 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=2764528,length=654010
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=2764528,length=654010
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=2764528,length=654010
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,027 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=3629473,length=767135
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=3629473,length=767135
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=3629473,length=767135
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,015 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(398)) - s0: close
2022-06-20 14:54:59,012 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=1787784,length=804203
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=1787784,length=804203
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=1787784,length=804203
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,033 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=534761,length=852382
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=534761,length=852382
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=534761,length=852382
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,036 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=2391401,length=689896
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=2391401,length=689896
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=2391401,length=689896
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,038 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3081297,length=611071
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3081297,length=611071
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3081297,length=611071
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,040 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3988849,length=873208
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3988849,length=873208
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=3988849,length=873208
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,041 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=4396608,length=886271
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=4396608,length=886271
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=4396608,length=886271
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,042 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=1460050,length=786289
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=1460050,length=786289
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=1460050,length=786289
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,045 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=2246339,length=959516
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=2246339,length=959516
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=2246339,length=959516
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,046 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2367219,length=610451
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2367219,length=610451
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2367219,length=610451
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,048 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=5282879,length=856486
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=5282879,length=856486
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=5282879,length=856486
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,029 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=3418538,length=681336
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=3418538,length=681336
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=3418538,length=681336
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,054 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(434)) - s0@group-AE84EB7C6EA2: shutdown
2022-06-20 14:54:59,071 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-AE84EB7C6EA2,id=s0
2022-06-20 14:54:59,071 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-AE84EB7C6EA2-LeaderStateImpl
2022-06-20 14:54:59,071 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-AE84EB7C6EA2-PendingRequests: sendNotLeaderResponses
2022-06-20 14:54:59,072 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s0@group-AE84EB7C6EA2-StateMachineUpdater: set stopIndex = 9
2022-06-20 14:54:59,073 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(433)) - s0@group-AE84EB7C6EA2: closes. applyIndex: 9
2022-06-20 14:54:59,048 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2977670,length=618619
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2977670,length=618619
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=2977670,length=618619
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,076 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=3596289,length=885158
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=3596289,length=885158
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=3596289,length=885158
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,078 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=745913,length=811546
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=745913,length=811546
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=745913,length=811546
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,081 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=1557459,length=931106
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=1557459,length=931106
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=1557459,length=931106
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,082 [pool-1-thread-10] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=6151258,length=987287
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=6151258,length=987287
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=6151258,length=987287
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,082 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=6139365,length=989113
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=6139365,length=989113
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=6139365,length=989113
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,084 [pool-1-thread-10] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=7138545,length=643693
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=7138545,length=643693
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=7,offset=7138545,length=643693
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,087 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2960717,length=689254
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2960717,length=689254
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=2960717,length=689254
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,089 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=3649971,length=626863
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=3649971,length=626863
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=3649971,length=626863
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,086 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=7128478,length=536205
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=7128478,length=536205
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=17,offset=7128478,length=536205
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,085 [s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-06-20 14:54:59,090 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=1387143,length=710481
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=1387143,length=710481
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=1387143,length=710481
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,098 [pool-1-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream18
2022-06-20 14:54:59,099 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=2591987,length=594743
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=2591987,length=594743
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=2591987,length=594743
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,099 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=4862057,length=876254
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=4862057,length=876254
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=4862057,length=876254
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,101 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=5738311,length=512638
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=5738311,length=512638
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=5738311,length=512638
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,102 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2097624,length=719937
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2097624,length=719937
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2097624,length=719937
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,108 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s0@group-AE84EB7C6EA2-SegmentedRaftLogWorker close()
2022-06-20 14:54:59,103 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=0,length=598892
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=0,length=598892
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=0,length=598892
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,110 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 37345 now
2022-06-20 14:54:59,114 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2817561,length=944778
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2817561,length=944778
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=2817561,length=944778
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,116 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 37345 successfully
2022-06-20 14:54:59,117 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 41239 now
2022-06-20 14:54:59,117 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3692368,length=739958
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3692368,length=739958
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=3692368,length=739958
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,119 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=4432326,length=587108
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=4432326,length=587108
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=4432326,length=587108
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,120 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3205855,length=551593
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3205855,length=551593
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3205855,length=551593
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,125 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=598892,length=667605
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=598892,length=667605
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=598892,length=667605
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,128 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 41239 successfully
2022-06-20 14:54:59,126 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4099874,length=772955
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4099874,length=772955
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4099874,length=772955
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,140 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1266497,length=674325
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1266497,length=674325
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1266497,length=674325
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,125 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3757448,length=665038
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3757448,length=665038
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=3757448,length=665038
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,144 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=4422486,length=651547
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=4422486,length=651547
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=4422486,length=651547
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,146 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=2488565,length=635453
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=2488565,length=635453
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=2488565,length=635453
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,146 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=4276834,length=850144
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=4276834,length=850144
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=4276834,length=850144
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,148 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3124018,length=633871
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3124018,length=633871
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3124018,length=633871
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,148 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=4481447,length=528488
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=4481447,length=528488
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=4481447,length=528488
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,150 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3186730,length=618193
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3186730,length=618193
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3186730,length=618193
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,151 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5074033,length=634957
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5074033,length=634957
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5074033,length=634957
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,150 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4872829,length=704733
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4872829,length=704733
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=4872829,length=704733
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,153 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3804923,length=950509
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3804923,length=950509
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=3804923,length=950509
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,154 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6250949,length=536462
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6250949,length=536462
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6250949,length=536462
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,155 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=3762339,length=853163
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=3762339,length=853163
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=3762339,length=853163
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,155 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5019434,length=840644
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5019434,length=840644
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5019434,length=840644
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,157 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5860078,length=538959
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5860078,length=538959
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=5860078,length=538959
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,157 [pool-1-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6787411,length=955627
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6787411,length=955627
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=8,offset=6787411,length=955627
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,158 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5009935,length=622310
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5009935,length=622310
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5009935,length=622310
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,158 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5126978,length=570366
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5126978,length=570366
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5126978,length=570366
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,160 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5632245,length=666694
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5632245,length=666694
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=5632245,length=666694
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,161 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5697344,length=715345
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5697344,length=715345
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=5697344,length=715345
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,163 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=4755432,length=562391
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=4755432,length=562391
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=4755432,length=562391
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,164 [pool-1-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=6399037,length=958547
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=6399037,length=958547
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=12,offset=6399037,length=958547
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,164 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3757889,length=669942
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3757889,length=669942
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=3757889,length=669942
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,165 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5317823,length=646599
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5317823,length=646599
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5317823,length=646599
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,167 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=4427831,length=685840
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=4427831,length=685840
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=4427831,length=685840
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,176 [pool-1-thread-15] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=6298939,length=742412
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=6298939,length=742412
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=13,offset=6298939,length=742412
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,175 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 39865 now
2022-06-20 14:54:59,171 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=5577562,length=867452
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=5577562,length=867452
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=5577562,length=867452
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,180 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=4615502,length=719906
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=4615502,length=719906
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=4615502,length=719906
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,182 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1940822,length=887749
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1940822,length=887749
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=1940822,length=887749
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,182 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5708990,length=677182
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5708990,length=677182
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=5708990,length=677182
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,185 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=2828571,length=864690
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=2828571,length=864690
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=2828571,length=864690
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,185 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=6386172,length=934522
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=6386172,length=934522
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=14,offset=6386172,length=934522
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,199 [pool-1-thread-12] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=6412689,length=905120
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=6412689,length=905120
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=11,offset=6412689,length=905120
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,199 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5113671,length=641830
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5113671,length=641830
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5113671,length=641830
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,192 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=6445014,length=896732
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=6445014,length=896732
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=16,offset=6445014,length=896732
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,201 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream19
2022-06-20 14:54:59,201 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5964422,length=827123
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5964422,length=827123
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=5964422,length=827123
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,202 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=0,length=555733
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=0,length=555733
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=0,length=555733
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,204 [pool-1-thread-16] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=6791545,length=663521
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=6791545,length=663521
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=10,offset=6791545,length=663521
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,206 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=5335408,length=870111
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=5335408,length=870111
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=5335408,length=870111
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,207 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=3693261,length=794605
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=3693261,length=794605
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=3693261,length=794605
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,204 [pool-1-thread-6] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream20
2022-06-20 14:54:59,210 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=0,length=717386
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=0,length=717386
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=0,length=717386
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,212 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5755501,length=652349
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5755501,length=652349
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=5755501,length=652349
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,219 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=6407850,length=543640
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=6407850,length=543640
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=15,offset=6407850,length=543640
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,220 [pool-1-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream21
2022-06-20 14:54:59,223 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=0,length=686099
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=0,length=686099
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=0,length=686099
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,221 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=6205519,length=860772
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=6205519,length=860772
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=6205519,length=860772
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,229 [pool-1-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=7066291,length=619591
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=7066291,length=619591
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C9DBFF796CFA,type=STREAM_DATA,id=9,offset=7066291,length=619591
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,226 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=717386,length=711803
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=717386,length=711803
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=717386,length=711803
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,232 [java.util.concurrent.ThreadPoolExecutor$Worker@618360ac[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 39865 successfully
2022-06-20 14:54:59,233 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:/0.0.0.0:34841] CLOSE
2022-06-20 14:54:59,233 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:0.0.0.0/0.0.0.0:34841] INACTIVE
2022-06-20 14:54:59,233 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x69b935b6, L:0.0.0.0/0.0.0.0:34841] UNREGISTERED
2022-06-20 14:54:59,236 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1429189,length=524146
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1429189,length=524146
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1429189,length=524146
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,241 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1953335,length=650601
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1953335,length=650601
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=1953335,length=650601
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,238 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=686099,length=758331
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=686099,length=758331
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=686099,length=758331
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,243 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=4487866,length=776440
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=4487866,length=776440
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=4487866,length=776440
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,237 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=555733,length=591380
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=555733,length=591380
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=555733,length=591380
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,249 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=2603936,length=937095
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=2603936,length=937095
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=2603936,length=937095
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,251 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=5264306,length=933178
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=5264306,length=933178
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=5264306,length=933178
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,250 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=1444430,length=688415
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=1444430,length=688415
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=1444430,length=688415
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,254 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=6197484,length=969409
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=6197484,length=969409
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=6197484,length=969409
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,250 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1147113,length=635853
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1147113,length=635853
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1147113,length=635853
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,259 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$280/1421047657@439bfb51] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s0: Stopped
2022-06-20 14:54:59,261 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(783)) - MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty shutdown completed
2022-06-20 14:54:59,262 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1782966,length=748306
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1782966,length=748306
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=1782966,length=748306
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,259 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=3541031,length=810476
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=3541031,length=810476
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=3541031,length=810476
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,257 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=2132845,length=936929
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=2132845,length=936929
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=2132845,length=936929
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,268 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-06-20 14:54:59,268 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-06-20 14:54:59,268 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3069774,length=616985
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3069774,length=616985
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3069774,length=616985
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,256 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:exceptionCaught(290)) - NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: exceptionCaught
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:59,270 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1171321,length=562
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,271 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1171883,length=510
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,271 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1172393,length=566
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,271 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1172959,length=825
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,272 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1173784,length=694
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,272 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1174478,length=933
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,272 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1175411,length=949
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,273 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1176360,length=679
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,255 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C633CBB4A508,type=STREAM_DATA,id=0,offset=1061722,length=669
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.safeFail(ChannelOutboundBuffer.java:723)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.remove0(ChannelOutboundBuffer.java:308)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.failFlushed(ChannelOutboundBuffer.java:660)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:735)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.handleWriteError(AbstractChannel.java:950)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:933)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.forceFlush(SslHandler.java:2136)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:802)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:51)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:470)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:408)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	... 22 more
2022-06-20 14:54:59,274 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-C633CBB4A508,type=STREAM_DATA,id=0,offset=1061722,length=669
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C633CBB4A508,type=STREAM_DATA,id=0,offset=1061722,length=669
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.safeFail(ChannelOutboundBuffer.java:723)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.remove0(ChannelOutboundBuffer.java:308)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.failFlushed(ChannelOutboundBuffer.java:660)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:735)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.handleWriteError(AbstractChannel.java:950)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:933)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.forceFlush(SslHandler.java:2136)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:802)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-C633CBB4A508,type=STREAM_DATA,id=0,offset=1061722,length=669
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 55 more
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:51)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:470)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:408)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	... 22 more
2022-06-20 14:54:59,275 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:34841: channel is inactive; schedule reconnecting to localhost/127.0.0.1:34841 in 100ms
2022-06-20 14:54:59,276 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1177039,length=765
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,272 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=7166893,length=746885
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=7166893,length=746885
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=18,offset=7166893,length=746885
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,268 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.netty.NettyUtils log level to DEBUG
2022-06-20 14:54:59,278 [pool-1-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream22
2022-06-20 14:54:59,278 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=4351507,length=679450
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=4351507,length=679450
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=4351507,length=679450
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,280 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=0,length=521197
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=0,length=521197
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=0,length=521197
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,278 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1177804,length=836
java.util.concurrent.CompletionException: java.io.IOException: Connection reset by peer
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$exceptionCaught$4(NettyClientStreamRpc.java:295)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.exceptionCaught(NettyClientStreamRpc.java:295)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.exceptionCaught(SslHandler.java:1104)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1377)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:302)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:281)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:907)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:177)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	... 7 more
2022-06-20 14:54:59,281 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:exceptionCaught(297)) - NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: exceptionCaught
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBuf.setBytes(PooledByteBuf.java:258)
	at org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1132)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:151)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:59,282 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1171883,length=510
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,283 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1172393,length=566
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,284 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1172959,length=825
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,284 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1173784,length=694
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,278 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3686759,length=665285
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3686759,length=665285
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=3686759,length=665285
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,284 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5030957,length=587638
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5030957,length=587638
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5030957,length=587638
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,289 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5618595,length=745754
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5618595,length=745754
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=5618595,length=745754
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,282 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=521197,length=553818
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=521197,length=553818
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=521197,length=553818
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,279 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=2531272,length=786907
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=2531272,length=786907
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=2531272,length=786907
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,292 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3318179,length=505698
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3318179,length=505698
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3318179,length=505698
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,293 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1075015,length=808172
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1075015,length=808172
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1075015,length=808172
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,290 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1174478,length=933
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,295 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1175411,length=949
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,296 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1176360,length=679
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,297 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1177039,length=765
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,287 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4352044,length=571315
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4352044,length=571315
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4352044,length=571315
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,299 [pool-1-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream23
2022-06-20 14:54:59,297 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3823877,length=797918
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3823877,length=797918
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=3823877,length=797918
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,301 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=0,length=655631
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=0,length=655631
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=0,length=655631
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,295 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-06-20 14:54:59,303 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-06-20 14:54:59,303 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.netty.NettyUtils log level to DEBUG
2022-06-20 14:54:59,302 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1177804,length=836
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,305 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1178640,length=834
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,305 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1178640,length=834
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1178640,length=834
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1178640,length=834
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,306 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1179474,length=614
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,304 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:34841: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@7e419cf5 failed; schedule reconnecting to localhost/127.0.0.1:34841 in 100ms
2022-06-20 14:54:59,308 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:34841
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:59,308 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1179474,length=614
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1179474,length=614
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1179474,length=614
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,309 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180088,length=787
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,309 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180088,length=787
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180088,length=787
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180088,length=787
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,310 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180875,length=868
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,310 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180875,length=868
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180875,length=868
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1180875,length=868
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,308 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=4621795,length=966275
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=4621795,length=966275
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=4621795,length=966275
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,308 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4923359,length=879667
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4923359,length=879667
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=4923359,length=879667
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,310 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1883187,length=918118
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1883187,length=918118
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=1883187,length=918118
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,310 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=655631,length=515540
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=655631,length=515540
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=655631,length=515540
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,313 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=5803026,length=590206
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=5803026,length=590206
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=5803026,length=590206
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,314 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1171171,length=786289
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1171171,length=786289
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1171171,length=786289
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,310 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=6364349,length=679197
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=6364349,length=679197
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=20,offset=6364349,length=679197
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,315 [pool-1-thread-6] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream24
2022-06-20 14:54:59,317 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1957460,length=652858
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1957460,length=652858
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=1957460,length=652858
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,318 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=0,length=559690
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=0,length=559690
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=0,length=559690
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,320 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=2801305,length=701446
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=2801305,length=701446
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=2801305,length=701446
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,322 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=6393232,length=831904
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=6393232,length=831904
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=21,offset=6393232,length=831904
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,323 [pool-1-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream25
2022-06-20 14:54:59,319 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=5588070,length=577481
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=5588070,length=577481
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=5588070,length=577481
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,325 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=6165551,length=671267
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=6165551,length=671267
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=19,offset=6165551,length=671267
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,327 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream27
2022-06-20 14:54:59,327 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream28
2022-06-20 14:54:59,327 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream29
2022-06-20 14:54:59,323 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=559690,length=705874
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=559690,length=705874
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=559690,length=705874
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,322 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1181743,length=755
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,330 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1181743,length=755
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1181743,length=755
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1181743,length=755
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,330 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1182498,length=509
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,331 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1182498,length=509
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1182498,length=509
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1182498,length=509
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,332 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183007,length=852
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,332 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183007,length=852
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183007,length=852
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183007,length=852
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,333 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183859,length=518
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,333 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183859,length=518
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183859,length=518
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1183859,length=518
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,322 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=3502751,length=547813
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=3502751,length=547813
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=3502751,length=547813
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,335 [pool-1-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream31
2022-06-20 14:54:59,335 [pool-1-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream32
2022-06-20 14:54:59,335 [pool-1-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream33
2022-06-20 14:54:59,335 [pool-1-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream35
2022-06-20 14:54:59,335 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1184377,length=862
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,334 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-06-20 14:54:59,338 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-06-20 14:54:59,339 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.netty.NettyUtils log level to DEBUG
2022-06-20 14:54:59,333 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream30
2022-06-20 14:54:59,327 [NettyClientStreamRpc-workerGroup--thread2] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:34841: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@678697b0 failed; schedule reconnecting to localhost/127.0.0.1:34841 in 100ms
2022-06-20 14:54:59,339 [NettyClientStreamRpc-workerGroup--thread2] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:34841
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:59,327 [pool-1-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream26
2022-06-20 14:54:59,339 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1184377,length=862
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1184377,length=862
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1184377,length=862
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,340 [pool-1-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream36
2022-06-20 14:54:59,342 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1185239,length=677
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,343 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1185239,length=677
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1185239,length=677
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:571)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:550)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:57)
	at org.apache.ratis.thirdparty.io.netty.channel.DelegatingChannelPromiseNotifier.operationComplete(DelegatingChannelPromiseNotifier.java:31)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndCompleteAll(AbstractCoalescingBufferQueue.java:350)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractCoalescingBufferQueue.releaseAndFailAll(AbstractCoalescingBufferQueue.java:208)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:862)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrapAndFlush(SslHandler.java:798)
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.flush(SslHandler.java:779)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-0A059DC7DC5F,type=STREAM_DATA,id=2,offset=1185239,length=677
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 47 more
Caused by: org.apache.ratis.thirdparty.io.netty.handler.ssl.SslClosedEngineException: SSLEngine closed already
	at org.apache.ratis.thirdparty.io.netty.handler.ssl.SslHandler.wrap(SslHandler.java:859)
	... 15 more
2022-06-20 14:54:59,343 [pool-1-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream37
2022-06-20 14:54:59,345 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:34841: channel is inactive; schedule reconnecting to localhost/127.0.0.1:34841 in 100ms
2022-06-20 14:54:59,345 [pool-1-thread-5] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream38
2022-06-20 14:54:59,348 [pool-1-thread-2] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream39
2022-06-20 14:54:59,351 [pool-1-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream40
2022-06-20 14:54:59,352 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=0,length=546770
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=0,length=546770
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=0,length=546770
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,353 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=0,length=916118
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=0,length=916118
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=0,length=916118
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,354 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=546770,length=577567
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=546770,length=577567
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=546770,length=577567
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,354 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=0,length=709051
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=0,length=709051
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=0,length=709051
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,356 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1124337,length=759817
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1124337,length=759817
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1124337,length=759817
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,357 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=709051,length=752379
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=709051,length=752379
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=709051,length=752379
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,358 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=0,length=971591
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=0,length=971591
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=0,length=971591
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,358 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4050564,length=555970
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4050564,length=555970
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4050564,length=555970
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,361 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=971591,length=919419
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=971591,length=919419
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=971591,length=919419
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,362 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4606534,length=739503
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4606534,length=739503
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=4606534,length=739503
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,358 [pool-1-thread-5] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=0,length=895476
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=0,length=895476
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=0,length=895476
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,358 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=2610318,length=955898
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=2610318,length=955898
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=2610318,length=955898
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,363 [pool-1-thread-2] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=0,length=624191
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=0,length=624191
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=0,length=624191
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,362 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1265564,length=644155
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1265564,length=644155
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1265564,length=644155
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,365 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=3566216,length=741856
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=3566216,length=741856
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=3566216,length=741856
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,367 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1909719,length=851195
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1909719,length=851195
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=1909719,length=851195
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,369 [pool-1-thread-5] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=895476,length=848433
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=895476,length=848433
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=895476,length=848433
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,371 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=916118,length=565964
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=916118,length=565964
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=916118,length=565964
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,375 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1884154,length=963757
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1884154,length=963757
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=1884154,length=963757
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,374 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=1461430,length=804660
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=1461430,length=804660
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=1461430,length=804660
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,378 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=1482082,length=884736
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=1482082,length=884736
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=1482082,length=884736
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,371 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5346037,length=526080
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5346037,length=526080
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5346037,length=526080
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,383 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5872117,length=523587
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5872117,length=523587
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=22,offset=5872117,length=523587
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,384 [pool-1-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream41
2022-06-20 14:54:59,384 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=2847911,length=788112
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=2847911,length=788112
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=2847911,length=788112
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,387 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=3636023,length=879680
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=3636023,length=879680
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=3636023,length=879680
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,374 [pool-1-thread-5] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=1743909,length=854000
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=1743909,length=854000
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=1743909,length=854000
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,373 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=1891010,length=564496
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=1891010,length=564496
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=1891010,length=564496
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,389 [pool-1-thread-5] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=2597909,length=602830
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=2597909,length=602830
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=2597909,length=602830
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,390 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=2455506,length=643906
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=2455506,length=643906
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=2455506,length=643906
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,373 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=2760914,length=831567
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=2760914,length=831567
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=2760914,length=831567
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,372 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4308072,length=520507
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4308072,length=520507
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4308072,length=520507
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,392 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=3592481,length=739246
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=3592481,length=739246
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=3592481,length=739246
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,393 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4828579,length=781141
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4828579,length=781141
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=4828579,length=781141
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,371 [pool-1-thread-2] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=624191,length=759583
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=624191,length=759583
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=624191,length=759583
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,397 [pool-1-thread-2] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=1383774,length=860892
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=1383774,length=860892
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=1383774,length=860892
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,398 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=0,length=808251
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=0,length=808251
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=0,length=808251
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,382 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=2366818,length=858636
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=2366818,length=858636
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=2366818,length=858636
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,401 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=5609720,length=934164
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=5609720,length=934164
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=5609720,length=934164
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,401 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=3225454,length=807052
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=3225454,length=807052
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=3225454,length=807052
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,379 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:34841: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@46603fce failed; schedule reconnecting to localhost/127.0.0.1:34841 in 100ms
2022-06-20 14:54:59,402 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
java.lang.IllegalStateException: executor not accepting a task
	at org.apache.ratis.thirdparty.io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:194)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:180)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:166)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:605)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:104)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:503)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-06-20 14:54:59,379 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2266090,length=701364
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2266090,length=701364
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2266090,length=701364
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,405 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2967454,length=605334
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2967454,length=605334
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=2967454,length=605334
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,406 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=808251,length=760687
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=808251,length=760687
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=808251,length=760687
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,410 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=6543884,length=552547
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=6543884,length=552547
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=23,offset=6543884,length=552547
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,411 [pool-1-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream42
2022-06-20 14:54:59,415 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3099412,length=737345
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3099412,length=737345
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3099412,length=737345
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,417 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3836757,length=629897
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3836757,length=629897
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=3836757,length=629897
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,425 [pool-1-thread-9] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=4466654,length=564408
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=4466654,length=564408
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=35,offset=4466654,length=564408
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,425 [pool-1-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=1568938,length=681216
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=1568938,length=681216
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=41,offset=1568938,length=681216
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,423 [pool-1-thread-13] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=4515703,length=766744
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=4515703,length=766744
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=37,offset=4515703,length=766744
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,422 [pool-1-thread-4] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=4032506,length=959513
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=4032506,length=959513
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=40,offset=4032506,length=959513
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,420 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=4331727,length=868601
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=4331727,length=868601
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=4331727,length=868601
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,419 [pool-1-thread-11] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=42,offset=0,length=638293
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=42,offset=0,length=638293
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=42,offset=0,length=638293
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,418 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=3572788,length=645301
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=3572788,length=645301
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=3572788,length=645301
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,419 [pool-1-thread-2] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2244666,length=592627
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2244666,length=592627
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2244666,length=592627
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,429 [pool-1-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=4218089,length=755484
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=4218089,length=755484
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=36,offset=4218089,length=755484
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,430 [pool-1-thread-2] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2837293,length=880373
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2837293,length=880373
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=39,offset=2837293,length=880373
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,431 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5200328,length=536916
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5200328,length=536916
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5200328,length=536916
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,418 [pool-1-thread-5] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=3200739,length=745803
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=3200739,length=745803
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-9D15E672E4B7,type=STREAM_DATA,id=38,offset=3200739,length=745803
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-06-20 14:54:59,437 [pool-1-thread-6] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5737244,length=951111
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5737244,length=951111
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:131)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:143)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:154)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:37345|admin:localhost:41239|client:localhost:39865|dataStream:localhost:34841|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-F994E0115ABC,type=STREAM_DATA,id=24,offset=5737244,length=951111
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
