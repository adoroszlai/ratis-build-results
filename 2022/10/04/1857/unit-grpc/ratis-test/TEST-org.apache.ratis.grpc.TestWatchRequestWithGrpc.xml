<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="55.365" tests="4" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="java.specification.version" value="11"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.2/ratis-thirdparty-misc-1.0.2.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="java.vm.vendor" value="Eclipse Adoptium"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="11"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-11-jdk-amd64/lib"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter14321841534571450574.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2022-10-04T05-45-39_742-jvmRun1 surefire4481622854552324137tmp surefire_55722478977078315207tmp"/>
    <property name="jdk.debug" value="release"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.2/ratis-thirdparty-misc-1.0.2.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.version.date" value="2022-08-12"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-11-jdk-amd64"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="java.vm.compressedOopsMode" value="32-bit"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter14321841534571450574.jar"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="11.0.16.1+1"/>
    <property name="user.name" value="runner"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.15.0-1020-azure"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.version" value="Temurin-11.0.16.1+1"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="11.0.16.1"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Eclipse Adoptium"/>
    <property name="java.vm.version" value="11.0.16.1+1"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="55.0"/>
  </properties>
  <testcase name="testWatchRequestAsyncChangeLeader" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="40.338">
    <error type="java.util.concurrent.TimeoutException">java.util.concurrent.TimeoutException
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1886)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2021)
	at org.apache.ratis.WatchRequestTests$WatchReplies.get(WatchRequestTests.java:205)
	at org.apache.ratis.WatchRequestTests$WatchReplies.getMajorityCommitted(WatchRequestTests.java:191)
	at org.apache.ratis.WatchRequestTests.checkMajority(WatchRequestTests.java:279)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:356)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
</error>
    <system-out><![CDATA[2022-10-04 05:48:23,954 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-10-04 05:48:23,957 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-10-04 05:48:23,972 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.server.impl.WatchRequests log level to DEBUG
2022-10-04 05:48:23,972 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.server.RaftServer$Division log level to DEBUG
2022-10-04 05:48:23,974 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.grpc.client.GrpcClientRpc log level to ALL
2022-10-04 05:48:23,976 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.client.impl.UnorderedAsync log level to ALL
2022-10-04 05:48:23,976 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.client.RaftClient log level to ALL
2022-10-04 05:48:23,995 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2022-10-04 05:48:24,029 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithGrpc with group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithGrpc
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2022-10-04 05:48:24,030 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2022-10-04 05:48:24,034 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER], format? true
2022-10-04 05:48:24,038 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(168)) - deleteFully target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0
2022-10-04 05:48:24,040 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(184)) - deleteFully: target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0 does not exist.
2022-10-04 05:48:24,040 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0
2022-10-04 05:48:24,072 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-10-04 05:48:24,148 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,150 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 40429 (custom)
2022-10-04 05:48:24,150 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,151 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 33335 (custom)
2022-10-04 05:48:24,151 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-10-04 05:48:24,151 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 40977 (custom)
2022-10-04 05:48:24,152 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-10-04 05:48:24,154 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,155 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-10-04 05:48:24,158 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:24,172 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:24,175 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-10-04 05:48:24,176 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-10-04 05:48:24,339 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-10-04 05:48:24,341 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-10-04 05:48:24,342 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-10-04 05:48:24,342 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,343 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,345 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0] (custom)
2022-10-04 05:48:24,351 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s0: addNew group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] returns group-FB6BB5C9A9B3:java.util.concurrent.CompletableFuture@23409446[Not completed]
2022-10-04 05:48:24,351 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER], format? true
2022-10-04 05:48:24,352 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(168)) - deleteFully target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1
2022-10-04 05:48:24,352 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(184)) - deleteFully: target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1 does not exist.
2022-10-04 05:48:24,352 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1
2022-10-04 05:48:24,352 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 35421 (custom)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 42417 (custom)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-10-04 05:48:24,353 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 46653 (custom)
2022-10-04 05:48:24,354 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-10-04 05:48:24,354 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-10-04 05:48:24,358 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-10-04 05:48:24,358 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-10-04 05:48:24,362 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-10-04 05:48:24,362 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,362 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,362 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1] (custom)
2022-10-04 05:48:24,379 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s1: addNew group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] returns group-FB6BB5C9A9B3:java.util.concurrent.CompletableFuture@530d5172[Not completed]
2022-10-04 05:48:24,379 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER], format? true
2022-10-04 05:48:24,379 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(168)) - deleteFully target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2
2022-10-04 05:48:24,379 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(184)) - deleteFully: target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2 does not exist.
2022-10-04 05:48:24,380 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2
2022-10-04 05:48:24,380 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-10-04 05:48:24,380 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,380 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 35395 (custom)
2022-10-04 05:48:24,380 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-10-04 05:48:24,381 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 36881 (custom)
2022-10-04 05:48:24,381 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-10-04 05:48:24,381 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 32897 (custom)
2022-10-04 05:48:24,381 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-10-04 05:48:24,381 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,382 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-10-04 05:48:24,382 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:24,382 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:24,382 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-10-04 05:48:24,382 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-10-04 05:48:24,384 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-10-04 05:48:24,384 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-10-04 05:48:24,384 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-10-04 05:48:24,385 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,385 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,385 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2] (custom)
2022-10-04 05:48:24,385 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,389 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,389 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,375 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,393 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,393 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,392 [pool-2-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(197)) - s1: new RaftServerImpl for group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,396 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s2: addNew group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] returns group-FB6BB5C9A9B3:java.util.concurrent.CompletableFuture@65b66076[Not completed]
2022-10-04 05:48:24,393 [pool-1-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(197)) - s0: new RaftServerImpl for group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-10-04 05:48:24,403 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-10-04 05:48:24,403 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:24,403 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-10-04 05:48:24,403 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,404 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,404 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-10-04 05:48:24,423 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,424 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,424 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,424 [pool-3-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(197)) - s2: new RaftServerImpl for group-FB6BB5C9A9B3:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER] with SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-10-04 05:48:24,425 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-10-04 05:48:24,426 [pool-1-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-FB6BB5C9A9B3: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-10-04 05:48:24,426 [pool-2-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-FB6BB5C9A9B3: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-10-04 05:48:24,431 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-10-04 05:48:24,434 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-10-04 05:48:24,436 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-10-04 05:48:24,436 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-10-04 05:48:24,426 [pool-3-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-FB6BB5C9A9B3: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-10-04 05:48:24,439 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-10-04 05:48:24,439 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-10-04 05:48:24,439 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-10-04 05:48:24,439 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-10-04 05:48:24,438 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-10-04 05:48:24,440 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-10-04 05:48:24,444 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-10-04 05:48:24,444 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-10-04 05:48:24,454 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-10-04 05:48:24,454 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-10-04 05:48:24,454 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-10-04 05:48:24,464 [pool-3-thread-1] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-10-04 05:48:24,561 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:24,562 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-10-04 05:48:24,562 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-10-04 05:48:24,562 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-10-04 05:48:24,563 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-10-04 05:48:24,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:24,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-10-04 05:48:24,563 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-10-04 05:48:24,564 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-10-04 05:48:24,564 [pool-2-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-10-04 05:48:24,564 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:24,564 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-10-04 05:48:24,564 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-10-04 05:48:24,564 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-10-04 05:48:24,565 [pool-3-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-10-04 05:48:24,566 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-10-04 05:48:24,566 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-10-04 05:48:24,566 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0] (custom)
2022-10-04 05:48:24,573 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 does not exist. Creating ...
2022-10-04 05:48:24,575 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,579 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/in_use.lock acquired by nodename 4949@fv-az204-790
2022-10-04 05:48:24,579 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current
2022-10-04 05:48:24,580 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/sm
2022-10-04 05:48:24,591 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 has been successfully formatted.
2022-10-04 05:48:24,592 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,593 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-10-04 05:48:24,595 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-10-04 05:48:24,600 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-10-04 05:48:24,600 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,601 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-10-04 05:48:24,602 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-10-04 05:48:24,604 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,608 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-10-04 05:48:24,608 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-10-04 05:48:24,611 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(183)) - new s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,611 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:24,612 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-10-04 05:48:24,613 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,613 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,613 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-10-04 05:48:24,614 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-10-04 05:48:24,614 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-10-04 05:48:24,614 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-10-04 05:48:24,616 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,616 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-10-04 05:48:24,617 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-10-04 05:48:24,617 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-10-04 05:48:24,621 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,621 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,623 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(337)) - s0@group-FB6BB5C9A9B3: start as a follower, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:24,623 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-10-04 05:48:24,624 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:24,627 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:24,629 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:24,631 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s0
2022-10-04 05:48:24,633 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-10-04 05:48:24,633 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-10-04 05:48:24,634 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-10-04 05:48:24,636 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s0: start RPC server
2022-10-04 05:48:24,672 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s0: GrpcService started, listening on 33335
2022-10-04 05:48:24,673 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s0: GrpcService started, listening on 40977
2022-10-04 05:48:24,674 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s0: GrpcService started, listening on 40429
2022-10-04 05:48:24,679 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-10-04 05:48:24,679 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-10-04 05:48:24,679 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1] (custom)
2022-10-04 05:48:24,680 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 does not exist. Creating ...
2022-10-04 05:48:24,680 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,679 [JvmPauseMonitor0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s0: Started
2022-10-04 05:48:24,681 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/in_use.lock acquired by nodename 4949@fv-az204-790
2022-10-04 05:48:24,682 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current
2022-10-04 05:48:24,682 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/sm
2022-10-04 05:48:24,684 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 has been successfully formatted.
2022-10-04 05:48:24,684 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-10-04 05:48:24,685 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-10-04 05:48:24,686 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(183)) - new s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-10-04 05:48:24,687 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-10-04 05:48:24,688 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-10-04 05:48:24,689 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,689 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,690 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(337)) - s1@group-FB6BB5C9A9B3: start as a follower, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:24,690 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-10-04 05:48:24,691 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:24,691 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:24,691 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s1
2022-10-04 05:48:24,692 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-10-04 05:48:24,692 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-10-04 05:48:24,692 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-10-04 05:48:24,692 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s1: start RPC server
2022-10-04 05:48:24,692 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:24,694 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s1: GrpcService started, listening on 42417
2022-10-04 05:48:24,695 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s1: GrpcService started, listening on 46653
2022-10-04 05:48:24,695 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s1: GrpcService started, listening on 35421
2022-10-04 05:48:24,697 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-10-04 05:48:24,697 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-10-04 05:48:24,697 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2] (custom)
2022-10-04 05:48:24,698 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 does not exist. Creating ...
2022-10-04 05:48:24,698 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,700 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/in_use.lock acquired by nodename 4949@fv-az204-790
2022-10-04 05:48:24,699 [JvmPauseMonitor1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s1: Started
2022-10-04 05:48:24,700 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current
2022-10-04 05:48:24,701 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/sm
2022-10-04 05:48:24,705 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3 has been successfully formatted.
2022-10-04 05:48:24,705 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing SimpleStateMachine4Testing:uninitialized
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-10-04 05:48:24,706 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-10-04 05:48:24,707 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,708 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-10-04 05:48:24,708 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-10-04 05:48:24,709 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(183)) - new s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3
2022-10-04 05:48:24,709 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:24,709 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-10-04 05:48:24,710 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-10-04 05:48:24,710 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-10-04 05:48:24,710 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-10-04 05:48:24,710 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-10-04 05:48:24,710 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-10-04 05:48:24,711 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-10-04 05:48:24,711 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-10-04 05:48:24,712 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-10-04 05:48:24,715 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-10-04 05:48:24,718 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-10-04 05:48:24,721 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,722 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-10-04 05:48:24,722 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(337)) - s2@group-FB6BB5C9A9B3: start as a follower, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:24,722 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-10-04 05:48:24,723 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:24,723 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s2
2022-10-04 05:48:24,723 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-10-04 05:48:24,723 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-10-04 05:48:24,723 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-10-04 05:48:24,724 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s2: start RPC server
2022-10-04 05:48:24,725 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s2: GrpcService started, listening on 36881
2022-10-04 05:48:24,726 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s2: GrpcService started, listening on 32897
2022-10-04 05:48:24,727 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(310)) - s2: GrpcService started, listening on 35395
2022-10-04 05:48:24,728 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:24,728 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:24,728 [JvmPauseMonitor2] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s2: Started
2022-10-04 05:48:24,730 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:24,731 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:24,735 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:24,849 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:158006943ns, electionTimeout:155ms
2022-10-04 05:48:24,849 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:24,849 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-10-04 05:48:24,852 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:24,852 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-LeaderElection1
2022-10-04 05:48:24,858 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-FB6BB5C9A9B3-LeaderElection1 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:24,873 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:24,873 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:24,879 [s1@group-FB6BB5C9A9B3-LeaderElection1-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-10-04 05:48:24,879 [s1@group-FB6BB5C9A9B3-LeaderElection1-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-10-04 05:48:24,898 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:274709468ns, electionTimeout:269ms
2022-10-04 05:48:24,898 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:24,899 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-10-04 05:48:24,902 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:24,902 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-LeaderElection2
2022-10-04 05:48:24,915 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection2 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:24,925 [s0@group-FB6BB5C9A9B3-LeaderElection2-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-10-04 05:48:24,939 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:24,942 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:24,944 [s0@group-FB6BB5C9A9B3-LeaderElection2-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-10-04 05:48:25,015 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:292323274ns, electionTimeout:287ms
2022-10-04 05:48:25,015 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,015 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-10-04 05:48:25,016 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:25,016 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-LeaderElection3
2022-10-04 05:48:25,023 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-FB6BB5C9A9B3-LeaderElection3 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,027 [s2@group-FB6BB5C9A9B3-LeaderElection3-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-10-04 05:48:25,029 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,032 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,037 [s2@group-FB6BB5C9A9B3-LeaderElection3-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-10-04 05:48:25,155 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection2: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2022-10-04 05:48:25,155 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection2 PRE_VOTE round 0: result TIMEOUT
2022-10-04 05:48:25,155 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection2 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,157 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,157 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,158 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-FB6BB5C9A9B3-LeaderElection1: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2022-10-04 05:48:25,168 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-FB6BB5C9A9B3-LeaderElection1 PRE_VOTE round 0: result TIMEOUT
2022-10-04 05:48:25,168 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-FB6BB5C9A9B3-LeaderElection1 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,170 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,170 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,192 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #2/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING CANDIDATE s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING CANDIDATE s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING CANDIDATE s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING CANDIDATE s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:25,226 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s2, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,227 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,231 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,239 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,231 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,240 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,233 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s2<-s0#0:OK-t0. Peer's state: s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,231 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,245 [grpc-default-executor-8] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,249 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s2, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,247 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,250 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,239 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,251 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,247 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,245 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 0, (t:0, i:0))
2022-10-04 05:48:25,251 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,252 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,253 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,253 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,253 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,253 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,250 [grpc-default-executor-7] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,256 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,250 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-FB6BB5C9A9B3-LeaderElection3: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:25,256 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t0
2022-10-04 05:48:25,257 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-FB6BB5C9A9B3-LeaderElection3 PRE_VOTE round 0: result PASSED
2022-10-04 05:48:25,256 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,258 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,254 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,260 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,259 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,259 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-FB6BB5C9A9B3-LeaderElection3 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,261 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s2<-s1#0:OK-t0. Peer's state: s1@group-FB6BB5C9A9B3:t0, leader=null, voted=, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,261 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,263 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,267 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-FB6BB5C9A9B3-LeaderElection1: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:25,268 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t0
2022-10-04 05:48:25,268 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-FB6BB5C9A9B3-LeaderElection1 PRE_VOTE round 1: result PASSED
2022-10-04 05:48:25,270 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-FB6BB5C9A9B3-LeaderElection1 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,270 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,274 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection2: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:25,275 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s2#0:OK-t0
2022-10-04 05:48:25,276 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection2 PRE_VOTE round 1: result PASSED
2022-10-04 05:48:25,274 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,278 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection2 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,279 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,279 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,287 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s2, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,288 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-CANDIDATE: reject ELECTION from s2: already has voted for s0 at current term 1
2022-10-04 05:48:25,288 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to ELECTION vote request: s2<-s0#0:FAIL-t1. Peer's state: s0@group-FB6BB5C9A9B3:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,289 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s1, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,289 [grpc-default-executor-8] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-CANDIDATE: reject ELECTION from s1: already has voted for s0 at current term 1
2022-10-04 05:48:25,289 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to ELECTION vote request: s1<-s0#0:FAIL-t1. Peer's state: s0@group-FB6BB5C9A9B3:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,290 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s1, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,290 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-CANDIDATE: reject ELECTION from s1: already has voted for s2 at current term 1
2022-10-04 05:48:25,290 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to ELECTION vote request: s1<-s2#0:FAIL-t1. Peer's state: s2@group-FB6BB5C9A9B3:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,293 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s2, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,294 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-CANDIDATE: reject ELECTION from s2: already has voted for s1 at current term 1
2022-10-04 05:48:25,294 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to ELECTION vote request: s2<-s1#0:FAIL-t1. Peer's state: s1@group-FB6BB5C9A9B3:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,295 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,295 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-CANDIDATE: reject ELECTION from s0: already has voted for s1 at current term 1
2022-10-04 05:48:25,295 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s1#0:FAIL-t1. Peer's state: s1@group-FB6BB5C9A9B3:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,297 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-FB6BB5C9A9B3-LeaderElection3: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-10-04 05:48:25,299 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t1
2022-10-04 05:48:25,299 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s2<-s1#0:FAIL-t1
2022-10-04 05:48:25,299 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-FB6BB5C9A9B3-LeaderElection3 ELECTION round 0: result REJECTED
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-FB6BB5C9A9B3-LeaderElection1: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:FAIL-t1
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s1<-s2#0:FAIL-t1
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-FB6BB5C9A9B3-LeaderElection1 ELECTION round 0: result REJECTED
2022-10-04 05:48:25,300 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-10-04 05:48:25,300 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-FB6BB5C9A9B3-LeaderElection3
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-10-04 05:48:25,300 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-FB6BB5C9A9B3-LeaderElection1
2022-10-04 05:48:25,301 [s2@group-FB6BB5C9A9B3-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,301 [s1@group-FB6BB5C9A9B3-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,307 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,307 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,309 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,309 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,310 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,310 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: reject ELECTION from s0: already has voted for s2 at current term 1
2022-10-04 05:48:25,310 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s2#0:FAIL-t1. Peer's state: s2@group-FB6BB5C9A9B3:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection2: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:FAIL-t1
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:FAIL-t1
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection2 ELECTION round 0: result REJECTED
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-FB6BB5C9A9B3-LeaderElection2
2022-10-04 05:48:25,311 [s0@group-FB6BB5C9A9B3-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,312 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,313 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,526 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:214687327ns, electionTimeout:213ms
2022-10-04 05:48:25,526 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,527 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-10-04 05:48:25,527 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:25,527 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-LeaderElection4
2022-10-04 05:48:25,530 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection4 PRE_VOTE round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,534 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,534 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,536 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,536 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,538 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-FB6BB5C9A9B3:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,543 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection4: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:25,543 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t1
2022-10-04 05:48:25,543 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection4 PRE_VOTE round 0: result PASSED
2022-10-04 05:48:25,544 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 1, (t:0, i:0))
2022-10-04 05:48:25,545 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,545 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-FB6BB5C9A9B3:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,547 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection4 ELECTION round 0: submit vote requests at term 2 for -1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,548 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,554 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,554 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 2, (t:0, i:0))
2022-10-04 05:48:25,554 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,554 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s0
2022-10-04 05:48:25,554 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,554 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,555 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:48:25,555 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,555 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,555 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,555 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,557 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 2, (t:0, i:0))
2022-10-04 05:48:25,557 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:25,557 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s0
2022-10-04 05:48:25,557 [grpc-default-executor-9] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,557 [grpc-default-executor-9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:25,558 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:48:25,558 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-10-04 05:48:25,558 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-10-04 05:48:25,558 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s1#0:OK-t2. Peer's state: s1@group-FB6BB5C9A9B3:t2, leader=null, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,559 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s2#0:OK-t2. Peer's state: s2@group-FB6BB5C9A9B3:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,560 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection4: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:25,560 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t2
2022-10-04 05:48:25,560 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection4 ELECTION round 0: result PASSED
2022-10-04 05:48:25,560 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-FB6BB5C9A9B3-LeaderElection4
2022-10-04 05:48:25,560 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-10-04 05:48:25,561 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s0@group-FB6BB5C9A9B3: change Leader from null to s0 at term 2 for becomeLeader, leader elected after 1124ms
2022-10-04 05:48:25,565 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-10-04 05:48:25,568 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:25,569 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:25,571 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-10-04 05:48:25,571 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-10-04 05:48:25,571 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-10-04 05:48:25,583 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:25,584 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-10-04 05:48:25,591 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:25,591 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:25,592 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:25,594 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:25,595 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:25,595 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:25,595 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:25,595 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:25,598 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:25,598 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:25,599 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:25,601 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:48:25,613 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(427)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Starting segment from index:0
2022-10-04 05:48:25,644 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #3/100: java.lang.IllegalStateException: Leader: s0@group-FB6BB5C9A9B3 not ready, sleep 450ms and then retry.
java.lang.IllegalStateException: Leader: s0@group-FB6BB5C9A9B3 not ready
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:114)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:25,670 [s0@group-FB6BB5C9A9B3-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s0@group-FB6BB5C9A9B3: set configuration 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,706 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s1@group-FB6BB5C9A9B3: change Leader from null to s0 at term 2 for appendEntries, leader elected after 1274ms
2022-10-04 05:48:25,707 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s2@group-FB6BB5C9A9B3: change Leader from null to s0 at term 2 for appendEntries, leader elected after 1267ms
2022-10-04 05:48:25,728 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0
2022-10-04 05:48:25,815 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:25,817 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s1@group-FB6BB5C9A9B3: set configuration 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,817 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(427)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Starting segment from index:0
2022-10-04 05:48:25,825 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:25,825 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s2@group-FB6BB5C9A9B3: set configuration 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:25,826 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(427)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Starting segment from index:0
2022-10-04 05:48:25,829 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0
2022-10-04 05:48:25,832 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2022-10-04 05:48:25,838 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0
2022-10-04 05:48:25,838 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s2#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2022-10-04 05:48:26,095 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:26,098 [Time-limited test] DEBUG client.RaftClient (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-10-04 05:48:26,100 [Time-limited test] DEBUG client.GrpcClientRpc (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-10-04 05:48:26,106 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 1) numMessages=1, printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:26,107 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s2
2022-10-04 05:48:26,107 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-10-04 05:48:26,107 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-10-04 05:48:26,145 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=0, seq=1*, Watch(0), Message:<EMPTY>)
2022-10-04 05:48:26,146 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=0, seq=1*, Watch(0), Message:<EMPTY>
2022-10-04 05:48:26,163 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=1, seq=2, RW, Message:6d30)
2022-10-04 05:48:26,174 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=1, seq=2, RW, Message:6d30, entry=(t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423
2022-10-04 05:48:26,176 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, (t:2, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:22, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423]
2022-10-04 05:48:26,177 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#22:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2022-10-04 05:48:26,177 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, (t:2, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:23, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423]
2022-10-04 05:48:26,180 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 0 to 1
2022-10-04 05:48:26,182 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423
2022-10-04 05:48:26,182 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, (t:2, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:24, entries: [(t:2, i:2), METADATAENTRY(c:1)]
2022-10-04 05:48:26,182 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 2, (t:2, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:24, entries: [(t:2, i:2), METADATAENTRY(c:1)]
2022-10-04 05:48:26,185 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#24:OK-t2,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2022-10-04 05:48:26,185 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423
2022-10-04 05:48:26,187 [grpc-default-executor-9] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=1
2022-10-04 05:48:26,187 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=2, seq=0, Watch(1), null
2022-10-04 05:48:26,189 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), null
2022-10-04 05:48:26,190 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), null
2022-10-04 05:48:26,190 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-10-04 05:48:26,190 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=1, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c0]
2022-10-04 05:48:26,191 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=2, seq=0, Watch(1), Message:<EMPTY>)
2022-10-04 05:48:26,191 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=2, seq=0, Watch(1), Message:<EMPTY>
2022-10-04 05:48:26,192 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 0 to 1
2022-10-04 05:48:26,193 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 1 to 2
2022-10-04 05:48:26,197 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>)
2022-10-04 05:48:26,197 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>
2022-10-04 05:48:26,199 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), Message:<EMPTY>)
2022-10-04 05:48:26,199 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=4, seq=0, Watch-MAJORITY_COMMITTED(1), Message:<EMPTY>
2022-10-04 05:48:26,199 [Thread-65] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=2, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c0]
2022-10-04 05:48:26,200 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>)
2022-10-04 05:48:26,200 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>
2022-10-04 05:48:26,203 [Thread-66] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=4, SUCCESS, logIndex=1, commits[s0:c2, s1:c1, s2:c0]
2022-10-04 05:48:26,208 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(1) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=2, SUCCESS, logIndex=1, commits[s0:c1, s1:c0, s2:c0]
2022-10-04 05:48:26,209 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(1) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=4, SUCCESS, logIndex=1, commits[s0:c2, s1:c1, s2:c0]
2022-10-04 05:48:26,270 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 1 to 2
2022-10-04 05:48:27,213 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:blockRequestor(49)) - Block requestor s0
2022-10-04 05:48:27,214 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:27,214 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,215 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,217 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #1/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,237 [s2-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s2: Block request from s0
2022-10-04 05:48:27,280 [s1-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s1: Block request from s0
2022-10-04 05:48:27,320 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:27,320 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,321 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,321 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #2/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,422 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:27,422 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,422 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,423 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #3/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,523 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:27,524 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,524 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,524 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #4/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s0
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,607 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:404588154ns, electionTimeout:279ms
2022-10-04 05:48:27,607 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,607 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-10-04 05:48:27,607 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:27,607 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-LeaderElection5
2022-10-04 05:48:27,608 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s1@group-FB6BB5C9A9B3: change Leader from s0 to null at term 2 for PRE_VOTE
2022-10-04 05:48:27,608 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-FB6BB5C9A9B3-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,613 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 2, (t:2, i:2))
2022-10-04 05:48:27,614 [grpc-default-executor-7] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1062)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: Lost leadership on term: 2. Election timeout: 300ms. In charge for: 2053ms. Conf: 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,614 [grpc-default-executor-7] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1066)) - Follower s0@group-FB6BB5C9A9B3->s1(c2,m2,n3, attendVote=true, lastRpcSendTime=32, lastRpcResponseTime=411)
2022-10-04 05:48:27,614 [grpc-default-executor-7] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1066)) - Follower s0@group-FB6BB5C9A9B3->s2(c0,m0,n3, attendVote=true, lastRpcSendTime=34, lastRpcResponseTime=453)
2022-10-04 05:48:27,615 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from    LEADER to FOLLOWER at term 2 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-10-04 05:48:27,615 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:48:27,613 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s1, group-FB6BB5C9A9B3, 2, (t:2, i:2))
2022-10-04 05:48:27,615 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:27,615 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s2#0:OK-t2. Peer's state: s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,616 [s0@group-FB6BB5C9A9B3->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-FB6BB5C9A9B3->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:48:27,617 [grpc-default-executor-9] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#24-t2,previous=(t:2, i:1),leaderCommit=1,initializing? true,entries: size=1, first=(t:2, i:2), METADATAENTRY(c:1)
2022-10-04 05:48:27,619 [s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:48:27,621 [grpc-default-executor-7] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-FB6BB5C9A9B3-PendingRequests: sendNotLeaderResponses
2022-10-04 05:48:27,621 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-FB6BB5C9A9B3-LeaderElection5: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:27,621 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t2
2022-10-04 05:48:27,621 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-FB6BB5C9A9B3-LeaderElection5 PRE_VOTE round 0: result PASSED
2022-10-04 05:48:27,621 [grpc-default-executor-9] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#24-t2,previous=(t:2, i:1),leaderCommit=1,initializing? true,entries: size=1, first=(t:2, i:2), METADATAENTRY(c:1)
2022-10-04 05:48:27,621 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:27,623 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-FB6BB5C9A9B3-LeaderElection5 ELECTION round 0: submit vote requests at term 3 for 0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,623 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:27,625 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:27,625 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-FB6BB5C9A9B3:t3, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:27,625 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-FB6BB5C9A9B3:t3, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-FB6BB5C9A9B3:t3, leader=null, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:431)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,633 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s1: nextIndex: updateUnconditionally 3 -> 2
2022-10-04 05:48:27,634 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s0@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s1, group-FB6BB5C9A9B3, 3, (t:2, i:2))
2022-10-04 05:48:27,634 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 3 -> 1
2022-10-04 05:48:27,635 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s1, group-FB6BB5C9A9B3, 3, (t:2, i:2))
2022-10-04 05:48:27,636 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c2, s1:c2, s2:c0]
2022-10-04 05:48:27,638 [grpc-default-executor-8] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:27,639 [grpc-default-executor-8] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s2@group-FB6BB5C9A9B3: change Leader from s0 to null at term 3 for updateCurrentTerm
2022-10-04 05:48:27,639 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s1
2022-10-04 05:48:27,639 [grpc-default-executor-8] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,639 [grpc-default-executor-8] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,639 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:48:27,641 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c2, s1:c2, s2:c0]
2022-10-04 05:48:27,656 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to ELECTION vote request: s1<-s2#0:OK-t3. Peer's state: s2@group-FB6BB5C9A9B3:t3, leader=null, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,659 [Thread-74] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:27,667 [Thread-73] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:27,676 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,669 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-FB6BB5C9A9B3-LeaderElection5: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t3
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-FB6BB5C9A9B3-LeaderElection5 ELECTION round 0: result PASSED
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-FB6BB5C9A9B3-LeaderElection5
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s1@group-FB6BB5C9A9B3: change Leader from null to s1 at term 3 for becomeLeader, leader elected after 69ms
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:27,677 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:27,678 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-10-04 05:48:27,678 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-10-04 05:48:27,678 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-10-04 05:48:27,678 [Thread-73] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,684 [Thread-73] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,685 [Thread-73] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,686 [Thread-73] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:27,686 [Thread-73] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:27,680 [Thread-74] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,679 [grpc-default-executor-7] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-FOLLOWER: reject PRE_VOTE from s1: this server is a follower and still has a valid leader s0
2022-10-04 05:48:27,686 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s1<-s0#0:FAIL-t2. Peer's state: s0@group-FB6BB5C9A9B3:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,678 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:27,687 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-10-04 05:48:27,687 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-FB6BB5C9A9B3-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-10-04 05:48:27,687 [grpc-default-executor-6] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s0@group-FB6BB5C9A9B3: change Leader from s0 to null at term 3 for updateCurrentTerm
2022-10-04 05:48:27,687 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:27,687 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s1
2022-10-04 05:48:27,688 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,688 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:27,688 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:27,688 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:48:27,689 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:27,697 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:27,698 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:48:27,699 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-10-04 05:48:27,701 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:27,701 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:27,692 [Thread-74] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,705 [Thread-74] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:27,705 [Thread-74] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:27,713 [s1@group-FB6BB5C9A9B3-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s1@group-FB6BB5C9A9B3: set configuration 3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,713 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3
2022-10-04 05:48:27,714 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s0@group-FB6BB5C9A9B3 replies to ELECTION vote request: s1<-s0#0:OK-t3. Peer's state: s0@group-FB6BB5C9A9B3:t3, leader=null, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c2, conf=0: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,717 [Thread-74] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-10-04 05:48:27,717 [Thread-73] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), null
2022-10-04 05:48:27,743 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s0@group-FB6BB5C9A9B3: change Leader from null to s1 at term 3 for appendEntries, leader elected after 55ms
2022-10-04 05:48:27,745 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 0 to 2
2022-10-04 05:48:27,745 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 0 to 2
2022-10-04 05:48:27,749 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:2, i:2), 2, true, commits:[s1:c2, s0:c2, s2:c0], cId:1, entries: [(t:3, i:3), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:27,749 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s2@group-FB6BB5C9A9B3: change Leader from null to s1 at term 3 for appendEntries, leader elected after 110ms
2022-10-04 05:48:27,749 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:2, i:2), 2, true, commits:[s1:c2, s0:c2, s2:c0], cId:1, entries: [(t:3, i:3), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:27,749 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s2@group-FB6BB5C9A9B3: set configuration 3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,749 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s0@group-FB6BB5C9A9B3: set configuration 3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:27,749 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-10-04 05:48:27,750 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:27,751 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:27,749 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-0_2 to index:2
2022-10-04 05:48:27,762 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3
2022-10-04 05:48:27,764 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#1:OK-t3,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2022-10-04 05:48:27,766 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 2 to 3
2022-10-04 05:48:27,767 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:3), 3, true, commits:[s1:c3, s0:c2, s2:c0], cId:4, entries: [(t:3, i:4), METADATAENTRY(c:3)]
2022-10-04 05:48:27,767 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:3), 3, true, commits:[s1:c3, s0:c2, s2:c0], cId:2, entries: [(t:3, i:4), METADATAENTRY(c:3)]
2022-10-04 05:48:27,768 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#2:OK-t3,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2022-10-04 05:48:27,769 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 2 to 3
2022-10-04 05:48:27,770 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 3 to 4
2022-10-04 05:48:27,818 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), null
2022-10-04 05:48:27,818 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), null
2022-10-04 05:48:27,828 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>)
2022-10-04 05:48:27,829 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=3, seq=0, Watch-ALL(1), Message:<EMPTY>
2022-10-04 05:48:27,829 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>)
2022-10-04 05:48:27,830 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=5, seq=0, Watch-ALL_COMMITTED(1), Message:<EMPTY>
2022-10-04 05:48:27,848 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 3 to 4
2022-10-04 05:48:28,076 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c0, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:28,076 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:lambda$changeLeader$6(435)) - Changed leader from s0 to s1
2022-10-04 05:48:28,076 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:unblockRequestor(54)) - UnBlock requestor s0
2022-10-04 05:48:28,077 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(141)) - unblock FLUSH_STATE_MACHINE_DATA
2022-10-04 05:48:28,077 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(366)) - unblock follower s2
2022-10-04 05:48:28,077 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 0: logIndex=1
2022-10-04 05:48:28,077 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s2#23:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2022-10-04 05:48:28,079 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:28,079 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_0-2
2022-10-04 05:48:28,083 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s2#24:OK-t2,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2022-10-04 05:48:28,083 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 1, m0 -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-E5C30A31B423
2022-10-04 05:48:28,090 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3
2022-10-04 05:48:28,090 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#1:OK-t3,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2022-10-04 05:48:28,091 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#4:OK-t3,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2022-10-04 05:48:28,092 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 0 to 2
2022-10-04 05:48:28,092 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s1@group-FB6BB5C9A9B3-WatchRequests: complete Watch-ALL_COMMITTED(1)@3.456s?NOT_DONE
2022-10-04 05:48:28,093 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 2 to 3
2022-10-04 05:48:28,094 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update ALL index from 0 to 4
2022-10-04 05:48:28,094 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s1@group-FB6BB5C9A9B3-WatchRequests: complete Watch-ALL(1)@3.456s?NOT_DONE
2022-10-04 05:48:28,096 [Thread-86] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=5, SUCCESS, logIndex=2, commits[s1:c4, s0:c4, s2:c2]
2022-10-04 05:48:28,098 [Thread-87] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=3, SUCCESS, logIndex=4, commits[s1:c4, s0:c4, s2:c3]
2022-10-04 05:48:28,099 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(1) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=3, SUCCESS, logIndex=4, commits[s1:c4, s0:c4, s2:c3]
2022-10-04 05:48:28,099 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(1) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=5, SUCCESS, logIndex=2, commits[s1:c4, s0:c4, s2:c2]
2022-10-04 05:48:28,099 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 10) numMessages=10, printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:28,100 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s2
2022-10-04 05:48:28,100 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-10-04 05:48:28,100 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-10-04 05:48:28,100 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 1: message=m1
2022-10-04 05:48:28,101 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 2: message=m2
2022-10-04 05:48:28,101 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 3: message=m3
2022-10-04 05:48:28,101 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 4: message=m4
2022-10-04 05:48:28,101 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 5: message=m5
2022-10-04 05:48:28,102 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 6: message=m6
2022-10-04 05:48:28,102 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 7: message=m7
2022-10-04 05:48:28,102 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 8: message=m8
2022-10-04 05:48:28,103 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 9: message=m9
2022-10-04 05:48:28,139 [s2-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s2: unBlock request from s0
2022-10-04 05:48:28,139 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#147:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,140 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#151:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,141 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#155:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,142 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#159:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,143 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#163:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,143 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#167:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,144 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#171:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,145 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#175:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,146 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#179:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,147 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#183:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,148 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c3, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s2#187:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=3,matchIndex=-1
2022-10-04 05:48:28,148 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:48:28,149 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:28,149 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 1 -> 0
2022-10-04 05:48:28,171 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 3 to 4
2022-10-04 05:48:28,180 [s1-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s1: unBlock request from s0
2022-10-04 05:48:28,181 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#46:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,181 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#47:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,182 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#48:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,183 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#49:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,183 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#50:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,184 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#51:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,184 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#52:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,185 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#53:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,185 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s1@group-FB6BB5C9A9B3: Not recognize s0 (term=2) as leader, state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s0<-s1#54:FAIL-t3,NOT_LEADER,nextIndex=5,followerCommit=4,matchIndex=-1
2022-10-04 05:48:28,186 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:48:28,187 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:28,188 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s1: nextIndex: updateUnconditionally 2 -> 1
2022-10-04 05:48:31,100 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=6, seq=3, RW, m0 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #6 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,101 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,101 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=9, seq=6, RW, m3 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #9 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,102 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,102 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s2
2022-10-04 05:48:31,102 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:31,102 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=12, seq=9, RW, m6 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #12 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,103 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=13, seq=10, RW, m7 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #13 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,104 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=14, seq=11, RW, m8 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=14
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,104 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,104 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,101 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=10, seq=7, RW, m4 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #10 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,105 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,105 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,105 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, seq=12, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=15
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,105 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,106 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,104 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,106 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,103 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,106 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,102 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=11, seq=8, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #11 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,106 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,107 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,102 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=8, seq=5, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #8 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,107 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,107 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,101 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:31,101 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=7, seq=4, RW, m1 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #7 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,112 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:31,112 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:31,223 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=6, seq=3*, RW, Message:6d30)
2022-10-04 05:48:31,228 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=6, seq=3*, RW, m0 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:31,228 [grpc-default-executor-2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:31,229 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s1
2022-10-04 05:48:31,229 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s1 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:31,236 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=6, seq=3*, RW, Message:6d30)
2022-10-04 05:48:31,237 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=6, seq=3*, RW, Message:6d30, entry=(t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423
2022-10-04 05:48:31,239 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:4), 4, true, commits:[s1:c4, s0:c4, s2:c4], cId:94, entries: [(t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423]
2022-10-04 05:48:31,239 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:4), 4, true, commits:[s1:c4, s0:c4, s2:c4], cId:56, entries: [(t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423]
2022-10-04 05:48:31,240 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#56:OK-t3,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2022-10-04 05:48:31,241 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 4 to 5
2022-10-04 05:48:31,241 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423
2022-10-04 05:48:31,242 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:5), 5, true, commits:[s1:c5, s0:c4, s2:c4], cId:95, entries: [(t:3, i:6), METADATAENTRY(c:5)]
2022-10-04 05:48:31,243 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=5
2022-10-04 05:48:31,243 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=16, seq=0, Watch(5), null
2022-10-04 05:48:31,243 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:31,244 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), null
2022-10-04 05:48:31,244 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:31,244 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=6, SUCCESS, logIndex=5, commits[s1:c5, s0:c4, s2:c4]
2022-10-04 05:48:31,245 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:5), 5, true, commits:[s1:c5, s0:c4, s2:c4], cId:57, entries: [(t:3, i:6), METADATAENTRY(c:5)]
2022-10-04 05:48:31,245 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#57:OK-t3,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2022-10-04 05:48:31,246 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423
2022-10-04 05:48:31,247 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 4 to 5
2022-10-04 05:48:31,247 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=7, seq=4, RW, Message:6d31)
2022-10-04 05:48:31,248 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=7, seq=4, RW, Message:6d31, entry=(t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423
2022-10-04 05:48:31,249 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 5 to 6
2022-10-04 05:48:31,249 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:6), 5, true, commits:[s1:c5, s0:c5, s2:c4], cId:96, entries: [(t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423]
2022-10-04 05:48:31,249 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=16, seq=0, Watch(5), Message:<EMPTY>)
2022-10-04 05:48:31,249 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=16, seq=0, Watch(5), Message:<EMPTY>
2022-10-04 05:48:31,250 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:6), 5, true, commits:[s1:c5, s0:c5, s2:c4], cId:58, entries: [(t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423]
2022-10-04 05:48:31,250 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-10-04 05:48:31,250 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>
2022-10-04 05:48:31,251 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#58:OK-t3,SUCCESS,nextIndex=8,followerCommit=5,matchIndex=7
2022-10-04 05:48:31,251 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), Message:<EMPTY>)
2022-10-04 05:48:31,252 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=18, seq=0, Watch-MAJORITY_COMMITTED(5), Message:<EMPTY>
2022-10-04 05:48:31,252 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 6 to 7
2022-10-04 05:48:31,252 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423
2022-10-04 05:48:31,253 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-10-04 05:48:31,253 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>
2022-10-04 05:48:31,253 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:7), 7, true, commits:[s1:c7, s0:c5, s2:c4], cId:98, entries: [(t:3, i:8), METADATAENTRY(c:7)]
2022-10-04 05:48:31,254 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:7), 7, true, commits:[s1:c7, s0:c5, s2:c4], cId:61, entries: [(t:3, i:8), METADATAENTRY(c:7)]
2022-10-04 05:48:31,254 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#61:OK-t3,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2022-10-04 05:48:31,254 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423
2022-10-04 05:48:31,255 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 5 to 7
2022-10-04 05:48:31,255 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 7 to 8
2022-10-04 05:48:31,259 [Thread-91] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=16, SUCCESS, logIndex=6, commits[s1:c6, s0:c5, s2:c4]
2022-10-04 05:48:31,260 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(5) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=16, SUCCESS, logIndex=6, commits[s1:c6, s0:c5, s2:c4]
2022-10-04 05:48:31,263 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=8, seq=5, RW, Message:6d32)
2022-10-04 05:48:31,264 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=8, seq=5, RW, Message:6d32, entry=(t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423
2022-10-04 05:48:31,264 [Thread-92] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=18, SUCCESS, logIndex=5, commits[s1:c6, s0:c5, s2:c4]
2022-10-04 05:48:31,265 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(5) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=18, SUCCESS, logIndex=5, commits[s1:c6, s0:c5, s2:c4]
2022-10-04 05:48:31,265 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:8), 8, true, commits:[s1:c8, s0:c7, s2:c4], cId:101, entries: [(t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423]
2022-10-04 05:48:31,265 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:8), 8, true, commits:[s1:c8, s0:c7, s2:c4], cId:64, entries: [(t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423]
2022-10-04 05:48:31,266 [grpc-default-executor-6] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m1, logIndex=7
2022-10-04 05:48:31,266 [grpc-default-executor-6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=20, seq=0, Watch(7), null
2022-10-04 05:48:31,266 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#64:OK-t3,SUCCESS,nextIndex=10,followerCommit=8,matchIndex=9
2022-10-04 05:48:31,267 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 7 to 8
2022-10-04 05:48:31,270 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 8 to 9
2022-10-04 05:48:31,270 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423
2022-10-04 05:48:31,271 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:9), 9, true, commits:[s1:c9, s0:c8, s2:c4], cId:65, entries: [(t:3, i:10), METADATAENTRY(c:9)]
2022-10-04 05:48:31,272 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=20, seq=0, Watch(7), Message:<EMPTY>)
2022-10-04 05:48:31,272 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=20, seq=0, Watch(7), Message:<EMPTY>
2022-10-04 05:48:31,271 [grpc-default-executor-6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:31,272 [grpc-default-executor-6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), null
2022-10-04 05:48:31,273 [grpc-default-executor-6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-10-04 05:48:31,272 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423
2022-10-04 05:48:31,273 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 1: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=7, SUCCESS, logIndex=7, commits[s1:c7, s0:c5, s2:c4]
2022-10-04 05:48:31,272 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#65:OK-t3,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2022-10-04 05:48:31,273 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-10-04 05:48:31,274 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>
2022-10-04 05:48:31,274 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m2, logIndex=9
2022-10-04 05:48:31,274 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=24, seq=0, Watch(9), null
2022-10-04 05:48:31,274 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:31,275 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), null
2022-10-04 05:48:31,275 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-10-04 05:48:31,276 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 8 to 9
2022-10-04 05:48:31,275 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), Message:<EMPTY>)
2022-10-04 05:48:31,276 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=22, seq=0, Watch-MAJORITY_COMMITTED(7), Message:<EMPTY>
2022-10-04 05:48:31,276 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 9 to 10
2022-10-04 05:48:31,277 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>)
2022-10-04 05:48:31,277 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>
2022-10-04 05:48:31,277 [Thread-93] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=20, SUCCESS, logIndex=9, commits[s1:c9, s0:c8, s2:c4]
2022-10-04 05:48:31,277 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:9), 9, true, commits:[s1:c9, s0:c9, s2:c4], cId:104, entries: [(t:3, i:10), METADATAENTRY(c:9)]
2022-10-04 05:48:31,278 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=24, seq=0, Watch(9), Message:<EMPTY>)
2022-10-04 05:48:31,278 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(7) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=20, SUCCESS, logIndex=9, commits[s1:c9, s0:c8, s2:c4]
2022-10-04 05:48:31,278 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=24, seq=0, Watch(9), Message:<EMPTY>
2022-10-04 05:48:31,279 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-10-04 05:48:31,279 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>
2022-10-04 05:48:31,279 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), Message:<EMPTY>)
2022-10-04 05:48:31,279 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=26, seq=0, Watch-MAJORITY_COMMITTED(9), Message:<EMPTY>
2022-10-04 05:48:31,280 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>)
2022-10-04 05:48:31,280 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>
2022-10-04 05:48:31,286 [Thread-94] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=22, SUCCESS, logIndex=9, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,286 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(7) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=22, SUCCESS, logIndex=9, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,287 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 2: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=8, SUCCESS, logIndex=9, commits[s1:c9, s0:c8, s2:c4]
2022-10-04 05:48:31,287 [Thread-95] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=24, SUCCESS, logIndex=10, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,290 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(9) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=24, SUCCESS, logIndex=10, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,290 [Thread-96] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=26, SUCCESS, logIndex=9, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,291 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(9) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=26, SUCCESS, logIndex=9, commits[s1:c10, s0:c9, s2:c4]
2022-10-04 05:48:31,354 [grpc-default-executor-4] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 9 to 10
2022-10-04 05:48:34,106 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=89, target=localhost:42417}}. 
2022-10-04 05:48:34,109 [grpc-default-executor-4] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:48:34,215 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=9, seq=6, RW, Message:6d33)
2022-10-04 05:48:34,215 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=9, seq=6, RW, Message:6d33, entry=(t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423
2022-10-04 05:48:34,216 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=10, seq=7, RW, Message:6d34)
2022-10-04 05:48:34,216 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=10, seq=7, RW, Message:6d34, entry=(t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423
2022-10-04 05:48:34,216 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=11, seq=8, RW, Message:6d35)
2022-10-04 05:48:34,217 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=11, seq=8, RW, Message:6d35, entry=(t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423
2022-10-04 05:48:34,217 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=12, seq=9, RW, Message:6d36)
2022-10-04 05:48:34,217 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=12, seq=9, RW, Message:6d36, entry=(t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423
2022-10-04 05:48:34,218 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=13, seq=10, RW, Message:6d37)
2022-10-04 05:48:34,218 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=13, seq=10, RW, Message:6d37, entry=(t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423
2022-10-04 05:48:34,218 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:10), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:113, entries: [(t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423, (t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423]
2022-10-04 05:48:34,219 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:10), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:450, entries: [(t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423, (t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423, (t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423]
2022-10-04 05:48:34,219 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#113:OK-t3,SUCCESS,nextIndex=13,followerCommit=10,matchIndex=12
2022-10-04 05:48:34,220 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:12), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:114, entries: [(t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423]
2022-10-04 05:48:34,220 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:13), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:451, entries: [(t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423, (t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423]
2022-10-04 05:48:34,220 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=14, seq=11, RW, Message:6d38)
2022-10-04 05:48:34,221 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=14, seq=11, RW, Message:6d38, entry=(t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423
2022-10-04 05:48:34,221 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#114:OK-t3,SUCCESS,nextIndex=14,followerCommit=10,matchIndex=13
2022-10-04 05:48:34,222 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, seq=12, RW, Message:6d39)
2022-10-04 05:48:34,222 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, seq=12, RW, Message:6d39, entry=(t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423
2022-10-04 05:48:34,223 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 10 to 12
2022-10-04 05:48:34,223 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423
2022-10-04 05:48:34,223 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 12, m4 -> (t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423
2022-10-04 05:48:34,225 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 12 to 13
2022-10-04 05:48:34,225 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 13, m5 -> (t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423
2022-10-04 05:48:34,226 [grpc-default-executor-4] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m3, logIndex=11
2022-10-04 05:48:34,226 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:13), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:115, entries: [(t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423]
2022-10-04 05:48:34,226 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=28, seq=0, Watch(11), null
2022-10-04 05:48:34,226 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:34,227 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-10-04 05:48:34,227 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:34,227 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#115:OK-t3,SUCCESS,nextIndex=15,followerCommit=10,matchIndex=14
2022-10-04 05:48:34,227 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:15), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:452, entries: [(t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423]
2022-10-04 05:48:34,227 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 3: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=9, SUCCESS, logIndex=11, commits[s1:c12, s0:c10, s2:c4]
2022-10-04 05:48:34,228 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:16), 12, true, commits:[s1:c12, s0:c10, s2:c4], cId:453, entries: [(t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423]
2022-10-04 05:48:34,228 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:17), 12, true, commits:[s1:c12, s0:c10, s2:c4], cId:454, entries: [(t:3, i:18), METADATAENTRY(c:12)]
2022-10-04 05:48:34,228 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:14), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:116, entries: [(t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423, (t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423]
2022-10-04 05:48:34,229 [grpc-default-executor-9] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m4, logIndex=12
2022-10-04 05:48:34,229 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=32, seq=0, Watch(12), null
2022-10-04 05:48:34,229 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:34,229 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#116:OK-t3,SUCCESS,nextIndex=17,followerCommit=10,matchIndex=16
2022-10-04 05:48:34,229 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), null
2022-10-04 05:48:34,229 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:34,229 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=28, seq=0, Watch(11), Message:<EMPTY>)
2022-10-04 05:48:34,229 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:18), 13, true, commits:[s1:c13, s0:c10, s2:c4], cId:455, entries: [(t:3, i:19), METADATAENTRY(c:13)]
2022-10-04 05:48:34,229 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=28, seq=0, Watch(11), Message:<EMPTY>
2022-10-04 05:48:34,230 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m5, logIndex=13
2022-10-04 05:48:34,230 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), null
2022-10-04 05:48:34,230 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:34,230 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), null
2022-10-04 05:48:34,231 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:34,231 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 13 to 14
2022-10-04 05:48:34,231 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 14, m6 -> (t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423
2022-10-04 05:48:34,232 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-10-04 05:48:34,232 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>
2022-10-04 05:48:34,233 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:16), 10, true, commits:[s1:c10, s0:c10, s2:c4], cId:117, entries: [(t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423]
2022-10-04 05:48:34,233 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 14 to 16
2022-10-04 05:48:34,234 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 15, m7 -> (t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423
2022-10-04 05:48:34,234 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 16, m8 -> (t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423
2022-10-04 05:48:34,235 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#117:OK-t3,SUCCESS,nextIndex=18,followerCommit=10,matchIndex=17
2022-10-04 05:48:34,236 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,236 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>
2022-10-04 05:48:34,236 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m6, logIndex=14
2022-10-04 05:48:34,236 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), null
2022-10-04 05:48:34,236 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:34,236 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), null
2022-10-04 05:48:34,237 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
2022-10-04 05:48:34,237 [Thread-97] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=28, SUCCESS, logIndex=13, commits[s1:c13, s0:c10, s2:c4]
2022-10-04 05:48:34,237 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(11) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=28, SUCCESS, logIndex=13, commits[s1:c13, s0:c10, s2:c4]
2022-10-04 05:48:34,238 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=94,entriesCount=1,lastEntry=(t:3, i:5)
2022-10-04 05:48:34,239 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,239 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>
2022-10-04 05:48:34,239 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:19), 14, true, commits:[s1:c14, s0:c10, s2:c4], cId:456, entries: [(t:3, i:20), METADATAENTRY(c:14)]
2022-10-04 05:48:34,240 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:17), 12, true, commits:[s1:c12, s0:c10, s2:c4], cId:118, entries: [(t:3, i:18), METADATAENTRY(c:12)]
2022-10-04 05:48:34,240 [grpc-default-executor-4] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m7, logIndex=15
2022-10-04 05:48:34,240 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), null
2022-10-04 05:48:34,240 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:34,240 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:20), 16, true, commits:[s1:c16, s0:c10, s2:c4], cId:457, entries: [(t:3, i:21), METADATAENTRY(c:16)]
2022-10-04 05:48:34,240 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), null
2022-10-04 05:48:34,241 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
2022-10-04 05:48:34,241 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 16 to 17
2022-10-04 05:48:34,241 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 17, m9 -> (t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423
2022-10-04 05:48:34,242 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=95,entriesCount=1,lastEntry=(t:3, i:6)
2022-10-04 05:48:34,242 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=32, seq=0, Watch(12), Message:<EMPTY>)
2022-10-04 05:48:34,242 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=32, seq=0, Watch(12), Message:<EMPTY>
2022-10-04 05:48:34,242 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#118:OK-t3,SUCCESS,nextIndex=19,followerCommit=12,matchIndex=18
2022-10-04 05:48:34,242 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:21), 17, true, commits:[s1:c17, s0:c10, s2:c4], cId:458, entries: [(t:3, i:22), METADATAENTRY(c:17)]
2022-10-04 05:48:34,243 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423
2022-10-04 05:48:34,243 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 12, m4 -> (t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423
2022-10-04 05:48:34,243 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>)
2022-10-04 05:48:34,243 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>
2022-10-04 05:48:34,244 [grpc-default-executor-4] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m8, logIndex=16
2022-10-04 05:48:34,244 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), null
2022-10-04 05:48:34,244 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
2022-10-04 05:48:34,244 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), null
2022-10-04 05:48:34,244 [grpc-default-executor-4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
2022-10-04 05:48:34,244 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 10 to 12
2022-10-04 05:48:34,245 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(153)) - s1@group-FB6BB5C9A9B3-WatchRequests: complete Watch-MAJORITY_COMMITTED(11)@10.456s?NOT_DONE
2022-10-04 05:48:34,245 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 17 to 18
2022-10-04 05:48:34,245 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:34,245 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), Message:<EMPTY>
2022-10-04 05:48:34,246 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:18), 13, true, commits:[s1:c13, s0:c10, s2:c4], cId:119, entries: [(t:3, i:19), METADATAENTRY(c:13)]
2022-10-04 05:48:34,246 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, seq=12, RW, m9 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s1 request #15 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,246 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,246 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:34,246 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:34,246 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:19), 14, true, commits:[s1:c14, s0:c10, s2:c4], cId:120, entries: [(t:3, i:20), METADATAENTRY(c:14)]
2022-10-04 05:48:34,260 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:20), 16, true, commits:[s1:c16, s0:c10, s2:c4], cId:121, entries: [(t:3, i:21), METADATAENTRY(c:16)]
2022-10-04 05:48:34,260 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#120:OK-t3,SUCCESS,nextIndex=21,followerCommit=14,matchIndex=20
2022-10-04 05:48:34,258 [Thread-110] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,254 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 13, m5 -> (t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423
2022-10-04 05:48:34,261 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#121:OK-t3,SUCCESS,nextIndex=22,followerCommit=16,matchIndex=21
2022-10-04 05:48:34,254 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#119:OK-t3,SUCCESS,nextIndex=20,followerCommit=13,matchIndex=19
2022-10-04 05:48:34,253 [Thread-109] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,253 [Thread-108] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,261 [Thread-108] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=33
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,273 [Thread-108] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=33
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,273 [Thread-108] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,273 [Thread-108] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,273 [Thread-108] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:34,253 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=98,entriesCount=1,lastEntry=(t:3, i:8)
2022-10-04 05:48:34,251 [Thread-106] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,273 [Thread-106] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=30
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,274 [Thread-106] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=30
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,274 [Thread-106] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,274 [Thread-106] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,274 [Thread-106] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-10-04 05:48:34,251 [Thread-107] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,274 [Thread-107] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=31
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,275 [Thread-107] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=31
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,275 [Thread-107] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,275 [Thread-107] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,275 [Thread-107] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:34,250 [Thread-98] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=32, SUCCESS, logIndex=17, commits[s1:c17, s0:c10, s2:c4]
2022-10-04 05:48:34,250 [Thread-105] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,275 [Thread-105] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=29
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,276 [Thread-105] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=29
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,276 [Thread-105] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,276 [Thread-105] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,276 [Thread-105] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:34,250 [Thread-104] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,250 [Thread-103] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,277 [Thread-103] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=25
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,277 [Thread-103] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=25
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,277 [Thread-103] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,277 [Thread-103] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,278 [Thread-103] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:34,250 [Thread-102] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,278 [Thread-102] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=23
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,280 [Thread-102] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=23
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,280 [Thread-102] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,281 [Thread-102] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,281 [Thread-102] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-10-04 05:48:34,250 [Thread-101] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,282 [Thread-101] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=21
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,282 [Thread-101] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=21
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,282 [Thread-101] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,282 [Thread-101] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,282 [Thread-101] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:34,249 [Thread-100] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,282 [Thread-100] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=19
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,283 [Thread-100] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=19
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,283 [Thread-100] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,283 [Thread-100] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,283 [Thread-100] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:34,249 [Thread-99] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,249 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:34,283 [Thread-99] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=17
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,284 [Thread-99] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=17
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,284 [Thread-99] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,284 [Thread-99] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,284 [Thread-99] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:34,277 [Thread-104] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=27
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,288 [Thread-104] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=27
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,288 [Thread-104] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,288 [Thread-104] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,288 [Thread-104] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-10-04 05:48:34,276 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=104,entriesCount=1,lastEntry=(t:3, i:10)
2022-10-04 05:48:34,272 [Thread-113] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,288 [Thread-113] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=38
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,289 [Thread-113] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=38
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,289 [Thread-113] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,289 [Thread-113] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,289 [Thread-113] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), null
2022-10-04 05:48:34,272 [Thread-114] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,270 [Thread-111] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,290 [Thread-111] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=36
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,290 [Thread-111] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=36
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,290 [Thread-111] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,290 [Thread-111] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,290 [Thread-111] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), null
2022-10-04 05:48:34,270 [Thread-112] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,267 [Thread-126] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,292 [Thread-126] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=51
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,292 [Thread-126] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=51
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,292 [Thread-126] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,292 [Thread-126] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,292 [Thread-126] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
2022-10-04 05:48:34,267 [Thread-125] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,292 [Thread-125] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=50
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,295 [Thread-125] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=50
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,295 [Thread-125] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,295 [Thread-125] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,295 [Thread-125] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), null
2022-10-04 05:48:34,267 [Thread-124] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,295 [Thread-124] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=49
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,296 [Thread-124] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=49
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,296 [Thread-124] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,296 [Thread-124] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,296 [Thread-124] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
2022-10-04 05:48:34,266 [Thread-123] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,296 [Thread-123] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=48
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,297 [Thread-123] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=48
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,297 [Thread-123] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,297 [Thread-123] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,297 [Thread-123] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), null
2022-10-04 05:48:34,265 [Thread-122] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,297 [Thread-122] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=47
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,297 [Thread-122] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=47
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,297 [Thread-122] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,298 [Thread-122] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,298 [Thread-122] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
2022-10-04 05:48:34,265 [Thread-121] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,265 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=101,entriesCount=1,lastEntry=(t:3, i:9)
2022-10-04 05:48:34,264 [Thread-120] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,298 [Thread-120] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=45
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,299 [Thread-120] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=45
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,300 [Thread-120] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,300 [Thread-120] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,300 [Thread-120] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:34,264 [Thread-119] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,300 [Thread-119] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=44
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,300 [Thread-119] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=44
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,300 [Thread-119] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,300 [Thread-119] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,300 [Thread-119] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), null
2022-10-04 05:48:34,264 [Thread-118] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,301 [Thread-118] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=43
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,301 [Thread-118] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=43
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,301 [Thread-118] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,301 [Thread-118] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,301 [Thread-118] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
2022-10-04 05:48:34,264 [Thread-117] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,301 [Thread-117] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=42
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,301 [Thread-117] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=42
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,301 [Thread-117] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,302 [Thread-117] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,302 [Thread-117] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), null
2022-10-04 05:48:34,264 [Thread-116] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,302 [Thread-116] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=41
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,302 [Thread-116] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=41
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,302 [Thread-116] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,302 [Thread-116] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,302 [Thread-116] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:34,264 [Thread-115] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:34,303 [Thread-115] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=40
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,303 [Thread-115] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=40
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,303 [Thread-115] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,303 [Thread-115] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,303 [Thread-115] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), null
2022-10-04 05:48:34,264 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: receive appendEntries(s1, 3, (t:3, i:21), 18, true, commits:[s1:c18, s0:c13, s2:c4], cId:122, entries: [(t:3, i:22), METADATAENTRY(c:17)]
2022-10-04 05:48:34,261 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 12 to 13
2022-10-04 05:48:34,261 [Thread-109] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=34
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,304 [Thread-109] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=34
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,304 [Thread-109] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,304 [Thread-109] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,304 [Thread-109] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), null
2022-10-04 05:48:34,261 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 14, m6 -> (t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423
2022-10-04 05:48:34,260 [Thread-110] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=35
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,305 [Thread-110] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=35
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,305 [Thread-110] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,305 [Thread-110] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,305 [Thread-110] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:34,304 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 13 to 14
2022-10-04 05:48:34,298 [Thread-121] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=46
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,305 [Thread-121] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=46
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,306 [Thread-121] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,306 [Thread-121] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,307 [Thread-121] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), null
2022-10-04 05:48:34,292 [Thread-112] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=37
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,307 [Thread-112] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=37
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,307 [Thread-112] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,307 [Thread-112] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,307 [Thread-112] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:34,290 [Thread-114] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=39
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,283 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>
2022-10-04 05:48:34,307 [Thread-114] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1: Stream close: no reply for async request cid=39
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:34,308 [Thread-114] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,308 [Thread-114] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=null
2022-10-04 05:48:34,308 [Thread-114] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:34,308 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), Message:<EMPTY>)
2022-10-04 05:48:34,308 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), Message:<EMPTY>
2022-10-04 05:48:34,306 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 14 to 16
2022-10-04 05:48:34,305 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s0@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s0#122:OK-t3,SUCCESS,nextIndex=23,followerCommit=18,matchIndex=22
2022-10-04 05:48:34,305 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 18 to 19
2022-10-04 05:48:34,305 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 15, m7 -> (t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423
2022-10-04 05:48:34,309 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 19 to 20
2022-10-04 05:48:34,309 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 16, m8 -> (t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423
2022-10-04 05:48:34,309 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 17, m9 -> (t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423
2022-10-04 05:48:34,310 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 20 to 21
2022-10-04 05:48:34,310 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 16 to 18
2022-10-04 05:48:34,310 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-10-04 05:48:34,310 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>
2022-10-04 05:48:34,311 [s1@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 21 to 22
2022-10-04 05:48:34,311 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:34,311 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>
2022-10-04 05:48:34,311 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:34,312 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>
2022-10-04 05:48:34,312 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), Message:<EMPTY>)
2022-10-04 05:48:34,312 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), Message:<EMPTY>
2022-10-04 05:48:34,313 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-10-04 05:48:34,313 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>
2022-10-04 05:48:34,313 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>)
2022-10-04 05:48:34,313 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>
2022-10-04 05:48:34,313 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>)
2022-10-04 05:48:34,314 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>
2022-10-04 05:48:34,314 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), Message:<EMPTY>)
2022-10-04 05:48:34,314 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), Message:<EMPTY>
2022-10-04 05:48:34,314 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-10-04 05:48:34,315 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>
2022-10-04 05:48:34,315 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>)
2022-10-04 05:48:34,315 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>
2022-10-04 05:48:34,315 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>)
2022-10-04 05:48:34,315 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>
2022-10-04 05:48:34,316 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), Message:<EMPTY>)
2022-10-04 05:48:34,316 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), Message:<EMPTY>
2022-10-04 05:48:34,316 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>)
2022-10-04 05:48:34,316 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>
2022-10-04 05:48:34,317 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>)
2022-10-04 05:48:34,317 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>
2022-10-04 05:48:34,317 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>)
2022-10-04 05:48:34,317 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>
2022-10-04 05:48:34,373 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:34,375 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:34,376 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:34,376 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-10-04 05:48:34,378 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:34,381 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>)
2022-10-04 05:48:34,381 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c18, s1:c18, s2:c4]
2022-10-04 05:48:34,382 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,382 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c18, s1:c18, s2:c4]
2022-10-04 05:48:34,382 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,383 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:34,383 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c18, s1:c18, s2:c4]
2022-10-04 05:48:34,383 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:34,384 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-10-04 05:48:34,384 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c18, s1:c18, s2:c4]
2022-10-04 05:48:34,384 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:34,385 [Thread-127] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,385 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-10-04 05:48:34,386 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c18, s1:c18, s2:c4]
2022-10-04 05:48:34,386 [Thread-127] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,387 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-10-04 05:48:34,387 [Thread-131] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,386 [Thread-130] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,389 [Thread-130] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-130] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-130] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-130] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:34,389 [Thread-130] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:34,386 [Thread-129] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,389 [Thread-129] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-129] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-129] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,389 [Thread-129] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,389 [Thread-129] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:34,389 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-10-04 05:48:34,390 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s1@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 18 to 22
2022-10-04 05:48:34,390 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-10-04 05:48:34,390 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), null
2022-10-04 05:48:34,391 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), null
2022-10-04 05:48:34,386 [Thread-128] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,392 [Thread-128] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,392 [Thread-128] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,394 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-10-04 05:48:34,392 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:34,394 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
2022-10-04 05:48:34,394 [Thread-132] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,394 [Thread-132] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,395 [Thread-132] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,395 [Thread-132] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,395 [Thread-132] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,395 [Thread-132] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:34,395 [Thread-134] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,395 [Thread-134] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,396 [Thread-134] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,396 [Thread-134] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,397 [Thread-134] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,397 [Thread-134] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:34,397 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), null
2022-10-04 05:48:34,389 [Thread-133] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:34,389 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c22, s1:c22, s2:c4]
2022-10-04 05:48:34,398 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
2022-10-04 05:48:34,398 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c22, s1:c22, s2:c4]
2022-10-04 05:48:34,399 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c22, s1:c22, s2:c4]
2022-10-04 05:48:34,388 [Thread-127] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,399 [Thread-127] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,399 [Thread-127] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,399 [Thread-127] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:34,396 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
2022-10-04 05:48:34,399 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:34,400 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:34,394 [Thread-128] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,400 [Thread-128] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,400 [Thread-128] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:34,400 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), null
2022-10-04 05:48:34,392 [Thread-131] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,402 [Thread-131] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,402 [Thread-131] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,402 [Thread-131] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,402 [Thread-131] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:34,401 [Thread-133] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,401 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:34,405 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:34,401 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
2022-10-04 05:48:34,405 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:34,405 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), null
2022-10-04 05:48:34,405 [Thread-133] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s1. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,406 [Thread-133] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:34,406 [Thread-133] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=s1
2022-10-04 05:48:34,406 [Thread-133] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-10-04 05:48:34,406 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), null
2022-10-04 05:48:34,404 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), null
2022-10-04 05:48:34,403 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>)
2022-10-04 05:48:34,407 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>
2022-10-04 05:48:34,402 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:34,402 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:34,408 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:34,407 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), null
2022-10-04 05:48:34,409 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:34,409 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, seq=0, Watch-MAJORITY_COMMITTED(13), Message:<EMPTY>
2022-10-04 05:48:34,409 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:34,409 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), Message:<EMPTY>)
2022-10-04 05:48:34,409 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, seq=0, Watch(13), Message:<EMPTY>
2022-10-04 05:48:34,411 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-10-04 05:48:34,411 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>
2022-10-04 05:48:34,412 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>)
2022-10-04 05:48:34,412 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>
2022-10-04 05:48:34,412 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), Message:<EMPTY>)
2022-10-04 05:48:34,412 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, seq=0, Watch(16), Message:<EMPTY>
2022-10-04 05:48:34,412 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>)
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>)
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>
2022-10-04 05:48:34,413 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>)
2022-10-04 05:48:34,414 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>
2022-10-04 05:48:34,414 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), Message:<EMPTY>)
2022-10-04 05:48:34,414 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, seq=0, Watch(15), Message:<EMPTY>
2022-10-04 05:48:34,414 [Thread-135] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,415 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-10-04 05:48:34,415 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>
2022-10-04 05:48:34,415 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-10-04 05:48:34,415 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>
2022-10-04 05:48:34,416 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>)
2022-10-04 05:48:34,416 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>
2022-10-04 05:48:34,416 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:34,416 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>
2022-10-04 05:48:34,416 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:34,416 [Thread-136] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,416 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, seq=0, Watch-MAJORITY_COMMITTED(12), Message:<EMPTY>
2022-10-04 05:48:34,420 [Thread-137] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,420 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:34,420 [Thread-138] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,420 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, seq=0, Watch-MAJORITY_COMMITTED(11), Message:<EMPTY>
2022-10-04 05:48:34,422 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>)
2022-10-04 05:48:34,422 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, seq=0, Watch-MAJORITY_COMMITTED(14), Message:<EMPTY>
2022-10-04 05:48:34,422 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-10-04 05:48:34,422 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>
2022-10-04 05:48:34,423 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-10-04 05:48:34,423 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>
2022-10-04 05:48:34,423 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:34,423 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>
2022-10-04 05:48:34,423 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>)
2022-10-04 05:48:34,423 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, seq=0, Watch-MAJORITY_COMMITTED(15), Message:<EMPTY>
2022-10-04 05:48:34,424 [s1-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-10-04 05:48:34,424 [s1-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>
2022-10-04 05:48:34,427 [Thread-139] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,432 [Thread-140] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,432 [Thread-141] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,433 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(11) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=30, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 4: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=10, SUCCESS, logIndex=12, commits[s1:c12, s0:c10, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(12) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=32, SUCCESS, logIndex=17, commits[s1:c17, s0:c10, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(12) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=34, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 5: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=11, SUCCESS, logIndex=13, commits[s1:c13, s0:c10, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(13) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=36, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,438 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(13) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=38, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,439 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 6: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=12, SUCCESS, logIndex=14, commits[s1:c14, s0:c10, s2:c4]
2022-10-04 05:48:34,438 [Thread-142] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:34,729 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:37,217 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=450,entriesCount=3,lastEntry=(t:3, i:13)
2022-10-04 05:48:37,218 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=451,entriesCount=2,lastEntry=(t:3, i:15)
2022-10-04 05:48:37,221 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=452,entriesCount=1,lastEntry=(t:3, i:16)
2022-10-04 05:48:37,223 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=453,entriesCount=1,lastEntry=(t:3, i:17)
2022-10-04 05:48:37,223 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=454,entriesCount=1,lastEntry=(t:3, i:18)
2022-10-04 05:48:37,232 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=456,entriesCount=1,lastEntry=(t:3, i:20)
2022-10-04 05:48:37,242 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=458,entriesCount=1,lastEntry=(t:3, i:22)
2022-10-04 05:48:37,267 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=103, target=localhost:42417}}. 
2022-10-04 05:48:37,269 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=96,entriesCount=1,lastEntry=(t:3, i:7)
2022-10-04 05:48:37,269 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-10-04 05:48:37,270 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:37,270 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), null
2022-10-04 05:48:37,270 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), null
2022-10-04 05:48:37,270 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=455,entriesCount=1,lastEntry=(t:3, i:19)
2022-10-04 05:48:37,270 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=457,entriesCount=1,lastEntry=(t:3, i:21)
2022-10-04 05:48:37,271 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>)
2022-10-04 05:48:37,271 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>)
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, seq=0, Watch-MAJORITY_COMMITTED(16), Message:<EMPTY>
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), Message:<EMPTY>)
2022-10-04 05:48:37,272 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, seq=0, Watch(14), Message:<EMPTY>
2022-10-04 05:48:37,279 [Thread-143] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,282 [Thread-144] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(14) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=40, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(14) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=42, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 7: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=13, SUCCESS, logIndex=15, commits[s1:c16, s0:c10, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(15) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=44, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(15) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=46, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 8: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=14, SUCCESS, logIndex=16, commits[s1:c16, s0:c10, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(16) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=48, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,283 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(16) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=50, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,371 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, seq=12*, RW, Message:6d39)
2022-10-04 05:48:37,372 [grpc-default-executor-9] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m9, logIndex=17
2022-10-04 05:48:37,372 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=52, seq=0, Watch(17), null
2022-10-04 05:48:37,373 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), null
2022-10-04 05:48:37,373 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=54, seq=0, Watch-MAJORITY_COMMITTED(17), null
2022-10-04 05:48:37,373 [grpc-default-executor-9] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), null
2022-10-04 05:48:37,373 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 9: receive RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=15, SUCCESS, logIndex=17, commits[s1:c17, s0:c10, s2:c4]
2022-10-04 05:48:37,373 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=52, seq=0, Watch(17), Message:<EMPTY>)
2022-10-04 05:48:37,373 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=52, seq=0, Watch(17), Message:<EMPTY>
2022-10-04 05:48:37,374 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), Message:<EMPTY>)
2022-10-04 05:48:37,374 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), Message:<EMPTY>
2022-10-04 05:48:37,374 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=54, seq=0, Watch-MAJORITY_COMMITTED(17), Message:<EMPTY>)
2022-10-04 05:48:37,374 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=54, seq=0, Watch-MAJORITY_COMMITTED(17), Message:<EMPTY>
2022-10-04 05:48:37,374 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>)
2022-10-04 05:48:37,375 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>
2022-10-04 05:48:37,376 [Thread-145] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=52, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,376 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(17) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=52, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,379 [Thread-146] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=54, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,379 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(17) returns RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=54, SUCCESS, logIndex=22, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:37,392 [Thread-130] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=110, target=localhost:33335}}. 
2022-10-04 05:48:37,394 [Thread-130] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:37,394 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:37,394 [grpc-default-executor-4] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 3-UnorderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:48:37,394 [grpc-default-executor-7] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 4-UnorderedRequestStreamObserver4: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:48:37,396 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-10-04 05:48:37,396 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s1@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>
2022-10-04 05:48:38,380 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:blockRequestor(49)) - Block requestor s1
2022-10-04 05:48:38,380 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:38,380 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,381 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,381 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #1/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,435 [s2-server-thread4] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s2: Block request from s1
2022-10-04 05:48:38,453 [s0-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(77)) - s0: Block request from s1
2022-10-04 05:48:38,482 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:38,482 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,483 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,483 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #2/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,583 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:38,584 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,585 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,585 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "changeLeader-changeLeader", attempt #3/20: org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1, sleep 100ms and then retry.
org.junit.AssumptionViolatedException: Failed to change leader: newLeader == oldLeader == s1
	at org.apache.ratis.RaftTestUtil.lambda$changeLeader$6(RaftTestUtil.java:433)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:430)
	at org.apache.ratis.RaftTestUtil.changeLeader(RaftTestUtil.java:422)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:362)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,587 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-FB6BB5C9A9B3-FollowerState: change to CANDIDATE, lastRpcElapsedTime:211348478ns, electionTimeout:180ms
2022-10-04 05:48:38,587 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:38,587 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-10-04 05:48:38,587 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-10-04 05:48:38,587 [s0@group-FB6BB5C9A9B3-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-LeaderElection6
2022-10-04 05:48:38,588 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s0@group-FB6BB5C9A9B3: change Leader from s1 to null at term 3 for PRE_VOTE
2022-10-04 05:48:38,588 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 3 for 3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,591 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 3, (t:3, i:22))
2022-10-04 05:48:38,591 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-LEADER: reject PRE_VOTE from s0: this server is the leader and still has leadership
2022-10-04 05:48:38,591 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t3. Peer's state: s1@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,593 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(PRE_VOTE, s0, group-FB6BB5C9A9B3, 3, (t:3, i:22))
2022-10-04 05:48:38,593 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:38,594 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to PRE_VOTE vote request: s0<-s2#0:OK-t3. Peer's state: s2@group-FB6BB5C9A9B3:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,594 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection6: PRE_VOTE PASSED received 2 response(s) and 0 exception(s):
2022-10-04 05:48:38,594 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:FAIL-t3
2022-10-04 05:48:38,594 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:OK-t3
2022-10-04 05:48:38,595 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection6 PRE_VOTE round 0: result PASSED
2022-10-04 05:48:38,597 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-FB6BB5C9A9B3-LeaderElection6 ELECTION round 0: submit vote requests at term 4 for 3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s2@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 4, (t:3, i:22))
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-FB6BB5C9A9B3-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s2@group-FB6BB5C9A9B3: change Leader from s1 to null at term 4 for updateCurrentTerm
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s2@group-FB6BB5C9A9B3: changes role from  FOLLOWER to FOLLOWER at term 4 for candidate:s0
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:38,599 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:38,599 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:48:38,604 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1288)) - s1@group-FB6BB5C9A9B3: receive requestVote(ELECTION, s0, group-FB6BB5C9A9B3, 4, (t:3, i:22))
2022-10-04 05:48:38,604 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-FB6BB5C9A9B3-LEADER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-10-04 05:48:38,604 [grpc-default-executor-9] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s1@group-FB6BB5C9A9B3: change Leader from s1 to null at term 4 for updateCurrentTerm
2022-10-04 05:48:38,604 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s1@group-FB6BB5C9A9B3: changes role from    LEADER to FOLLOWER at term 4 for candidate:s0
2022-10-04 05:48:38,604 [grpc-default-executor-9] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s1: shutdown s1@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:48:38,605 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s2@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s2#0:OK-t4. Peer's state: s2@group-FB6BB5C9A9B3:t4, leader=null, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,605 [s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-FB6BB5C9A9B3->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:48:38,606 [s1@group-FB6BB5C9A9B3->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-FB6BB5C9A9B3->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:48:38,605 [grpc-default-executor-9] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s1@group-FB6BB5C9A9B3-PendingRequests: sendNotLeaderResponses
2022-10-04 05:48:38,607 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,612 [grpc-default-executor-9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:48:38,614 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1321)) - s1@group-FB6BB5C9A9B3 replies to ELECTION vote request: s0<-s1#0:OK-t4. Peer's state: s1@group-FB6BB5C9A9B3:t4, leader=null, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c22, conf=3: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-FB6BB5C9A9B3-LeaderElection6: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t4
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-FB6BB5C9A9B3-LeaderElection6 ELECTION round 0: result PASSED
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-FB6BB5C9A9B3-LeaderElection6
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(324)) - s0@group-FB6BB5C9A9B3: changes role from CANDIDATE to LEADER at term 4 for changeToLeader
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s0@group-FB6BB5C9A9B3: change Leader from null to s0 at term 4 for becomeLeader, leader elected after 27ms
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:38,615 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:38,616 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:48:38,617 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-10-04 05:48:38,618 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,618 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,624 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#458-t3,previous=(t:3, i:21),leaderCommit=17,initializing? true,entries: size=1, first=(t:3, i:22), METADATAENTRY(c:17)
2022-10-04 05:48:38,624 [grpc-default-executor-9] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#122-t3,previous=(t:3, i:21),leaderCommit=18,initializing? true,entries: size=1, first=(t:3, i:22), METADATAENTRY(c:17)
2022-10-04 05:48:38,625 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-FB6BB5C9A9B3->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:38,625 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-FB6BB5C9A9B3->s0: nextIndex: updateUnconditionally 23 -> 22
2022-10-04 05:48:38,625 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:38,625 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 23 -> 5
2022-10-04 05:48:38,625 [s0@group-FB6BB5C9A9B3-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s0@group-FB6BB5C9A9B3: set configuration 23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,628 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,629 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,630 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,631 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,631 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s0/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_23
2022-10-04 05:48:38,631 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,631 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,632 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s1@group-FB6BB5C9A9B3: change Leader from null to s0 at term 4 for appendEntries, leader elected after 27ms
2022-10-04 05:48:38,632 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,632 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,632 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,633 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 0 to 22
2022-10-04 05:48:38,633 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 0 to 22
2022-10-04 05:48:38,634 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:3, i:22), 22, true, commits:[s0:c22, s1:c22, s2:c4], cId:1, entries: [(t:4, i:23), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:38,634 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s1@group-FB6BB5C9A9B3: set configuration 23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,634 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-10-04 05:48:38,635 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,635 [Thread-157] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,636 [Thread-157] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,642 [Thread-157] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,642 [Thread-157] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,635 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,642 [Thread-157] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s2
2022-10-04 05:48:38,645 [Thread-157] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s2 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:38,642 [Thread-158] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,646 [Thread-158] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,646 [Thread-158] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,646 [Thread-158] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,646 [Thread-158] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,647 [Thread-158] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:38,647 [Thread-159] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,647 [Thread-159] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,647 [Thread-159] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,647 [Thread-159] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,647 [Thread-159] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,648 [Thread-159] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:38,636 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,648 [Thread-160] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,648 [Thread-160] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-160] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-160] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-160] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,648 [Thread-160] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:38,648 [Thread-161] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,648 [Thread-161] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-161] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-161] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,648 [Thread-161] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,649 [Thread-161] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:38,649 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=35, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,649 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,650 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=39, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,650 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,650 [s2-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(259)) - s2@group-FB6BB5C9A9B3: change Leader from null to s0 at term 4 for appendEntries, leader elected after 51ms
2022-10-04 05:48:38,652 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 0 to 4
2022-10-04 05:48:38,655 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:3, i:22), 22, true, commits:[s0:c22, s1:c22, s2:c4], cId:1, entries: [(t:4, i:23), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40977"
dataStreamAddress: "localhost:41841"
clientAddress: "localhost:33335"
adminAddress: "localhost:40429"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:46653"
dataStreamAddress: "localhost:33181"
clientAddress: "localhost:42417"
adminAddress: "localhost:35421"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:32897"
dataStreamAddress: "localhost:41205"
clientAddress: "localhost:36881"
adminAddress: "localhost:35395"
startupRole: FOLLOWER
, old:)]
2022-10-04 05:48:38,655 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(376)) - s2@group-FB6BB5C9A9B3: set configuration 23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-10-04 05:48:38,656 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(432)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolling segment log-3_22 to index:22
2022-10-04 05:48:38,657 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s1/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_23
2022-10-04 05:48:38,657 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,657 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,657 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#1:OK-t4,SUCCESS,nextIndex=24,followerCommit=22,matchIndex=23
2022-10-04 05:48:38,660 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,660 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,661 [Thread-162] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,661 [Thread-162] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,661 [Thread-162] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,661 [Thread-162] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,662 [Thread-162] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,662 [Thread-162] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
2022-10-04 05:48:38,662 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:23), 23, true, commits:[s0:c23, s1:c22, s2:c4], cId:2, entries: [(t:4, i:24), METADATAENTRY(c:23)]
2022-10-04 05:48:38,662 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:23), 23, true, commits:[s0:c23, s1:c22, s2:c4], cId:2, entries: [(t:4, i:24), METADATAENTRY(c:23)]
2022-10-04 05:48:38,663 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#2:OK-t4,SUCCESS,nextIndex=25,followerCommit=23,matchIndex=24
2022-10-04 05:48:38,663 [Thread-163] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,663 [Thread-163] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,663 [Thread-163] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,663 [Thread-163] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,663 [Thread-163] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,663 [Thread-163] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:38,664 [Thread-164] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,664 [Thread-164] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,664 [Thread-164] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,664 [Thread-164] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,664 [Thread-164] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,664 [Thread-164] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
2022-10-04 05:48:38,664 [Thread-165] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,664 [Thread-165] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,664 [Thread-165] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,665 [Thread-165] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,665 [Thread-165] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,665 [Thread-165] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
2022-10-04 05:48:38,664 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,665 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s1:c22, s0:c22, s2:c4]
2022-10-04 05:48:38,666 [Thread-166] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,666 [Thread-166] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,666 [Thread-166] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,666 [Thread-166] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,666 [Thread-166] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,667 [Thread-166] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:38,668 [Thread-167] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,668 [Thread-167] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,668 [Thread-167] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,668 [Thread-167] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,668 [Thread-167] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,668 [Thread-167] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:38,668 [Thread-168] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,668 [Thread-168] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,668 [Thread-168] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,668 [Thread-168] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,669 [Thread-168] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,669 [Thread-168] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
2022-10-04 05:48:38,669 [Thread-169] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:38,669 [Thread-169] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,669 [Thread-169] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,669 [Thread-169] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,669 [Thread-169] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,669 [Thread-169] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), null
2022-10-04 05:48:38,673 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 22 to 23
2022-10-04 05:48:38,674 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 22 to 23
2022-10-04 05:48:38,674 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 23 to 24
2022-10-04 05:48:38,675 [Thread-172] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:38,675 [Thread-172] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-172] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-172] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-172] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,676 [Thread-172] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), null
2022-10-04 05:48:38,676 [Thread-170] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,676 [Thread-170] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-170] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-170] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-170] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,676 [Thread-170] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:38,676 [Thread-173] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,676 [Thread-173] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-173] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,676 [Thread-173] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,677 [Thread-173] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,677 [Thread-173] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:38,677 [Thread-174] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,677 [Thread-174] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-174] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-174] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-174] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,678 [Thread-174] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-10-04 05:48:38,678 [Thread-175] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,678 [Thread-175] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-175] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-175] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,678 [Thread-175] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,678 [Thread-175] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:38,679 [Thread-171] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:38,679 [Thread-171] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,679 [Thread-171] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,679 [Thread-171] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,679 [Thread-171] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,679 [Thread-171] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-10-04 05:48:38,683 [Thread-157] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:38,683 [Thread-176] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,683 [Thread-176] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,684 [Thread-176] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,684 [Thread-176] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,684 [Thread-176] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s2, newLeader=null
2022-10-04 05:48:38,684 [Thread-176] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:38,687 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-10-04 05:48:38,687 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,687 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c4, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:38,687 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:lambda$changeLeader$6(435)) - Changed leader from s1 to s0
2022-10-04 05:48:38,687 [Time-limited test] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:unblockRequestor(54)) - UnBlock requestor s1
2022-10-04 05:48:38,687 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(141)) - unblock FLUSH_STATE_MACHINE_DATA
2022-10-04 05:48:38,687 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(366)) - unblock follower s2
2022-10-04 05:48:38,687 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 0: logIndex=5
2022-10-04 05:48:38,689 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#94:OK-t3,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2022-10-04 05:48:38,690 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,690 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(588)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_3-22
2022-10-04 05:48:38,690 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#95:OK-t3,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2022-10-04 05:48:38,690 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#96:OK-t3,SUCCESS,nextIndex=8,followerCommit=5,matchIndex=7
2022-10-04 05:48:38,690 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 5, m0 -> (t:3, i:5), STATEMACHINELOGENTRY, 6@client-E5C30A31B423
2022-10-04 05:48:38,691 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#101:OK-t3,SUCCESS,nextIndex=10,followerCommit=8,matchIndex=9
2022-10-04 05:48:38,691 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#450:OK-t3,SUCCESS,nextIndex=14,followerCommit=10,matchIndex=13
2022-10-04 05:48:38,691 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#104:OK-t3,SUCCESS,nextIndex=11,followerCommit=10,matchIndex=10
2022-10-04 05:48:38,691 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 7, m1 -> (t:3, i:7), STATEMACHINELOGENTRY, 7@client-E5C30A31B423
2022-10-04 05:48:38,691 [s2-server-thread6] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#451:OK-t3,SUCCESS,nextIndex=16,followerCommit=12,matchIndex=15
2022-10-04 05:48:38,691 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 9, m2 -> (t:3, i:9), STATEMACHINELOGENTRY, 8@client-E5C30A31B423
2022-10-04 05:48:38,691 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#453:OK-t3,SUCCESS,nextIndex=18,followerCommit=12,matchIndex=17
2022-10-04 05:48:38,692 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#454:OK-t3,SUCCESS,nextIndex=19,followerCommit=12,matchIndex=18
2022-10-04 05:48:38,692 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#452:OK-t3,SUCCESS,nextIndex=17,followerCommit=12,matchIndex=16
2022-10-04 05:48:38,693 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#456:OK-t3,SUCCESS,nextIndex=21,followerCommit=14,matchIndex=20
2022-10-04 05:48:38,693 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 11, m3 -> (t:3, i:11), STATEMACHINELOGENTRY, 9@client-E5C30A31B423
2022-10-04 05:48:38,694 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 12, m4 -> (t:3, i:12), STATEMACHINELOGENTRY, 10@client-E5C30A31B423
2022-10-04 05:48:38,694 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 13, m5 -> (t:3, i:13), STATEMACHINELOGENTRY, 11@client-E5C30A31B423
2022-10-04 05:48:38,694 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 14, m6 -> (t:3, i:14), STATEMACHINELOGENTRY, 12@client-E5C30A31B423
2022-10-04 05:48:38,694 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#457:OK-t3,SUCCESS,nextIndex=22,followerCommit=16,matchIndex=21
2022-10-04 05:48:38,694 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#458:OK-t3,SUCCESS,nextIndex=23,followerCommit=17,matchIndex=22
2022-10-04 05:48:38,694 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 15, m7 -> (t:3, i:15), STATEMACHINELOGENTRY, 13@client-E5C30A31B423
2022-10-04 05:48:38,695 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 16, m8 -> (t:3, i:16), STATEMACHINELOGENTRY, 14@client-E5C30A31B423
2022-10-04 05:48:38,695 [s2@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 17, m9 -> (t:3, i:17), STATEMACHINELOGENTRY, 15@client-E5C30A31B423
2022-10-04 05:48:38,695 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#98:OK-t3,SUCCESS,nextIndex=9,followerCommit=17,matchIndex=8
2022-10-04 05:48:38,695 [s2-server-thread7] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s1<-s2#455:OK-t3,SUCCESS,nextIndex=20,followerCommit=17,matchIndex=19
2022-10-04 05:48:38,704 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(631)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/528adb0e/MiniRaftClusterWithGrpc199e4fe3/s2/941eb923-a2e1-47a6-b099-fb6bb5c9a9b3/current/log_inprogress_23
2022-10-04 05:48:38,705 [s2-server-thread7] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s2#1:OK-t4,SUCCESS,nextIndex=24,followerCommit=22,matchIndex=23
2022-10-04 05:48:38,706 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 4 to 22
2022-10-04 05:48:38,706 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL index from 0 to 23
2022-10-04 05:48:38,706 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s2#2:OK-t4,SUCCESS,nextIndex=25,followerCommit=23,matchIndex=24
2022-10-04 05:48:38,709 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 22 to 23
2022-10-04 05:48:38,709 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL index from 23 to 24
2022-10-04 05:48:38,736 [s2-server-thread4] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s2: unBlock request from s1
2022-10-04 05:48:38,736 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s2#956:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=23,matchIndex=-1
2022-10-04 05:48:38,736 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s2#960:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=23,matchIndex=-1
2022-10-04 05:48:38,737 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s2#964:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=23,matchIndex=-1
2022-10-04 05:48:38,737 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s2#968:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=23,matchIndex=-1
2022-10-04 05:48:38,738 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s2@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c23, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s2#972:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=23,matchIndex=-1
2022-10-04 05:48:38,738 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:48:38,738 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:38,739 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 5 -> 4
2022-10-04 05:48:38,740 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 23 to 24
2022-10-04 05:48:38,747 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:38,748 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:38,749 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:38,749 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:38,753 [s0-server-thread3] INFO  util.CodeInjectionForTesting (BlockRequestHandlingInjection.java:execute(84)) - s0: unBlock request from s1
2022-10-04 05:48:38,753 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s0@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s0#194:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-10-04 05:48:38,755 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s0@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s0#195:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-10-04 05:48:38,755 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-10-04 05:48:38,755 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c23, s0:c23, s1:c22]
2022-10-04 05:48:38,755 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s0@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s0#196:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-10-04 05:48:38,756 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s0@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s0#197:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-10-04 05:48:38,757 [s0-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1478)) - s0@group-FB6BB5C9A9B3: Not recognize s1 (term=3) as leader, state: s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null reply: s1<-s0#198:FAIL-t4,NOT_LEADER,nextIndex=25,followerCommit=24,matchIndex=-1
2022-10-04 05:48:38,757 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:38,757 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:48:38,757 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c23, s0:c23, s1:c22]
2022-10-04 05:48:38,757 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-10-04 05:48:38,758 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c23, s0:c23, s1:c22]
2022-10-04 05:48:38,758 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:38,758 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c23, s0:c23, s1:c22]
2022-10-04 05:48:38,759 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-FB6BB5C9A9B3->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:48:38,759 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-FB6BB5C9A9B3->s0: nextIndex: updateUnconditionally 22 -> 21
2022-10-04 05:48:38,759 [Thread-180] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,759 [Thread-180] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-180] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-180] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-180] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:48:38,764 [Thread-180] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:38,763 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:38,759 [Thread-181] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,764 [Thread-181] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-181] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-181] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-181] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:38,764 [Thread-181] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:38,764 [Thread-183] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,764 [Thread-183] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-183] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,764 [Thread-183] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,765 [Thread-183] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:38,765 [Thread-183] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:38,765 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), null
2022-10-04 05:48:38,766 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), null
2022-10-04 05:48:38,766 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), null
2022-10-04 05:48:38,767 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), null
2022-10-04 05:48:38,768 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), null
2022-10-04 05:48:38,773 [Thread-182] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,779 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), null
2022-10-04 05:48:38,778 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), null
2022-10-04 05:48:38,779 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), null
2022-10-04 05:48:38,777 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), null
2022-10-04 05:48:38,777 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-10-04 05:48:38,777 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>)
2022-10-04 05:48:38,780 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=47, seq=0, Watch-ALL_COMMITTED(15), Message:<EMPTY>
2022-10-04 05:48:38,776 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), null
2022-10-04 05:48:38,773 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), null
2022-10-04 05:48:38,773 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), null
2022-10-04 05:48:38,780 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), null
2022-10-04 05:48:38,780 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), null
2022-10-04 05:48:38,780 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), null
2022-10-04 05:48:38,781 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c23, s0:c23, s1:c22]
2022-10-04 05:48:38,782 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>)
2022-10-04 05:48:38,782 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=49, seq=0, Watch-ALL(16), Message:<EMPTY>
2022-10-04 05:48:38,783 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>)
2022-10-04 05:48:38,783 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=37, seq=0, Watch-ALL(13), Message:<EMPTY>
2022-10-04 05:48:38,783 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>)
2022-10-04 05:48:38,783 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, seq=0, Watch-ALL(5), Message:<EMPTY>
2022-10-04 05:48:38,783 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), null
2022-10-04 05:48:38,784 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>)
2022-10-04 05:48:38,784 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, seq=0, Watch-ALL_COMMITTED(5), Message:<EMPTY>
2022-10-04 05:48:38,784 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>)
2022-10-04 05:48:38,784 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=27, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>
2022-10-04 05:48:38,784 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), null
2022-10-04 05:48:38,785 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>)
2022-10-04 05:48:38,785 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, seq=0, Watch-ALL(11), Message:<EMPTY>
2022-10-04 05:48:38,785 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>)
2022-10-04 05:48:38,785 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=23, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>
2022-10-04 05:48:38,786 [Thread-182] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,786 [Thread-182] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,786 [Thread-182] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,787 [Thread-182] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:38,787 [Thread-182] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:38,787 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), null
2022-10-04 05:48:38,788 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>)
2022-10-04 05:48:38,788 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, seq=0, Watch-ALL(9), Message:<EMPTY>
2022-10-04 05:48:38,788 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>)
2022-10-04 05:48:38,788 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, seq=0, Watch-ALL(7), Message:<EMPTY>
2022-10-04 05:48:38,790 [Thread-184] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:38,790 [Thread-184] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,795 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>)
2022-10-04 05:48:38,795 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=51, seq=0, Watch-ALL_COMMITTED(16), Message:<EMPTY>
2022-10-04 05:48:38,795 [Thread-184] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,795 [Thread-184] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:38,795 [Thread-184] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:38,795 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update ALL_COMMITTED index from 23 to 24
2022-10-04 05:48:38,795 [Thread-184] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:38,796 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), null
2022-10-04 05:48:38,796 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>)
2022-10-04 05:48:38,796 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=43, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>
2022-10-04 05:48:38,796 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>)
2022-10-04 05:48:38,796 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=41, seq=0, Watch-ALL(14), Message:<EMPTY>
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), Message:<EMPTY>)
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=53, seq=0, Watch-ALL(17), Message:<EMPTY>
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>)
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=55, seq=0, Watch-ALL_COMMITTED(17), Message:<EMPTY>
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>)
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, seq=0, Watch-ALL(12), Message:<EMPTY>
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>)
2022-10-04 05:48:38,797 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, seq=0, Watch-ALL_COMMITTED(11), Message:<EMPTY>
2022-10-04 05:48:38,798 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>)
2022-10-04 05:48:38,798 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=39, seq=0, Watch-ALL_COMMITTED(13), Message:<EMPTY>
2022-10-04 05:48:38,798 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>)
2022-10-04 05:48:38,798 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=45, seq=0, Watch-ALL(15), Message:<EMPTY>
2022-10-04 05:48:38,800 [Thread-186] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=49, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,800 [Thread-185] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=47, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,801 [Thread-188] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,801 [Thread-189] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,801 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(5) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=17, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,802 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(5) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=19, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,801 [Thread-190] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=27, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,802 [Thread-191] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,802 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 1: logIndex=7
2022-10-04 05:48:38,803 [Thread-192] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=23, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,803 [Thread-187] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=37, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Thread-193] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Thread-194] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(7) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=21, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(7) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=23, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 2: logIndex=9
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(9) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=25, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(9) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=27, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 3: logIndex=11
2022-10-04 05:48:38,804 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(11) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=29, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,805 [Thread-195] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=51, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:38,805 [Thread-196] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=43, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,806 [Thread-199] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=55, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,806 [Thread-197] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=41, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,806 [Thread-198] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=53, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,807 [Thread-201] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,807 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(11) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=31, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,807 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 4: logIndex=12
2022-10-04 05:48:38,808 [Thread-202] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=39, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,808 [Thread-203] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=45, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,810 [Thread-200] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:38,810 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(12) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=33, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,764 [Thread-180] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=124, target=localhost:36881}}. 
2022-10-04 05:48:41,765 [grpc-default-executor-9] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:48:41,766 [Thread-180] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:41,766 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), null
2022-10-04 05:48:41,767 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>)
2022-10-04 05:48:41,767 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=35, seq=0, Watch-ALL_COMMITTED(12), Message:<EMPTY>
2022-10-04 05:48:41,769 [Thread-204] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=35, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(12) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=35, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 5: logIndex=13
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(13) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=37, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(13) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=39, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 6: logIndex=14
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(14) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=41, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,769 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(14) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=43, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 7: logIndex=15
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(15) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=45, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(15) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=47, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 8: logIndex=16
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(16) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=49, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(16) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=51, SUCCESS, logIndex=23, commits[s0:c24, s1:c24, s2:c23]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkAll(301)) - checkAll 9: logIndex=17
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - all-Watch(17) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=53, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - allCommitted-Watch(17) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=55, SUCCESS, logIndex=24, commits[s0:c24, s1:c24, s2:c24]
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTest(148)) - 20) numMessages=20, printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:runTestWatchRequestAsyncChangeLeader(344)) - block follower s2
2022-10-04 05:48:41,770 [Time-limited test] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(134)) - block FLUSH_STATE_MACHINE_DATA
2022-10-04 05:48:41,770 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 0: message=m0
2022-10-04 05:48:41,771 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 1: message=m1
2022-10-04 05:48:41,771 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 2: message=m2
2022-10-04 05:48:41,771 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 3: message=m3
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 4: message=m4
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 5: message=m5
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 6: message=m6
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 7: message=m7
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 8: message=m8
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 9: message=m9
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 10: message=m10
2022-10-04 05:48:41,772 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 11: message=m11
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 12: message=m12
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 13: message=m13
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 14: message=m14
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 15: message=m15
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 16: message=m16
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 17: message=m17
2022-10-04 05:48:41,773 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 18: message=m18
2022-10-04 05:48:41,774 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:sendRequests(101)) - SEND_REQUEST 19: message=m19
2022-10-04 05:48:44,729 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:44,771 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, seq=14, RW, m1 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #57 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,771 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,771 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:44,771 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:44,771 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, seq=15, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #58 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,772 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=64
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,772 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,772 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=56, seq=13, RW, m0 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #56 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=65
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,772 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,773 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=66
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,774 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,773 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,774 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,774 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=67
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,775 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,775 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,775 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=68
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,777 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,777 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,778 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,778 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,778 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,778 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,778 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,779 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,779 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,779 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,780 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,781 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,781 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,781 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,781 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,781 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,782 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,782 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,782 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,782 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,782 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,783 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,783 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,783 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, seq=16, RW, m3 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=59
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,783 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,783 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,784 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, seq=17, RW, m4 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=60
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,784 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,784 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,784 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, seq=18, RW, m5 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=61
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,784 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,785 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,785 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=62
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,785 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,785 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,785 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=63
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,786 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:44,786 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:44,876 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=56, seq=13*, RW, Message:6d30)
2022-10-04 05:48:44,877 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=56, seq=13*, RW, m0 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:44,878 [grpc-default-executor-2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:44,878 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:48:44,878 [grpc-default-executor-2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:44,886 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=56, seq=13*, RW, Message:6d30)
2022-10-04 05:48:44,887 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=56, seq=13*, RW, Message:6d30, entry=(t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423
2022-10-04 05:48:44,888 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:24), 24, true, commits:[s0:c24, s1:c24, s2:c24], cId:92, entries: [(t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423]
2022-10-04 05:48:44,888 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:24), 24, true, commits:[s0:c24, s1:c24, s2:c24], cId:96, entries: [(t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423]
2022-10-04 05:48:44,889 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#92:OK-t4,SUCCESS,nextIndex=26,followerCommit=24,matchIndex=25
2022-10-04 05:48:44,890 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 24 to 25
2022-10-04 05:48:44,890 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 25, m0 -> (t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423
2022-10-04 05:48:44,891 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:25), 25, true, commits:[s0:c25, s1:c24, s2:c24], cId:93, entries: [(t:4, i:26), METADATAENTRY(c:25)]
2022-10-04 05:48:44,891 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#93:OK-t4,SUCCESS,nextIndex=27,followerCommit=25,matchIndex=26
2022-10-04 05:48:44,891 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 25, m0 -> (t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423
2022-10-04 05:48:44,892 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:25), 25, true, commits:[s0:c25, s1:c24, s2:c24], cId:97, entries: [(t:4, i:26), METADATAENTRY(c:25)]
2022-10-04 05:48:44,893 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 24 to 25
2022-10-04 05:48:44,893 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 25 to 26
2022-10-04 05:48:44,893 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m0, logIndex=25
2022-10-04 05:48:44,893 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=76, seq=0, Watch(25), null
2022-10-04 05:48:44,894 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
2022-10-04 05:48:44,894 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), null
2022-10-04 05:48:44,894 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:48:44,894 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 0: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=56, SUCCESS, logIndex=25, commits[s0:c25, s1:c24, s2:c24]
2022-10-04 05:48:44,896 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=76, seq=0, Watch(25), Message:<EMPTY>)
2022-10-04 05:48:44,896 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=76, seq=0, Watch(25), Message:<EMPTY>
2022-10-04 05:48:44,897 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-10-04 05:48:44,897 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-10-04 05:48:44,897 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), Message:<EMPTY>)
2022-10-04 05:48:44,898 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=78, seq=0, Watch-MAJORITY_COMMITTED(25), Message:<EMPTY>
2022-10-04 05:48:44,898 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-10-04 05:48:44,898 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-10-04 05:48:44,901 [Thread-205] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=76, SUCCESS, logIndex=26, commits[s0:c26, s1:c25, s2:c24]
2022-10-04 05:48:44,901 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(25) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=76, SUCCESS, logIndex=26, commits[s0:c26, s1:c25, s2:c24]
2022-10-04 05:48:44,901 [Thread-206] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=78, SUCCESS, logIndex=25, commits[s0:c26, s1:c25, s2:c24]
2022-10-04 05:48:44,901 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(25) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=78, SUCCESS, logIndex=25, commits[s0:c26, s1:c25, s2:c24]
2022-10-04 05:48:44,969 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 25 to 26
2022-10-04 05:48:47,786 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=137, target=localhost:33335}}. 
2022-10-04 05:48:47,888 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=96,entriesCount=1,lastEntry=(t:4, i:25)
2022-10-04 05:48:47,889 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, seq=14, RW, Message:6d31)
2022-10-04 05:48:47,889 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, seq=14, RW, Message:6d31, entry=(t:4, i:27), STATEMACHINELOGENTRY, 57@client-E5C30A31B423
2022-10-04 05:48:47,890 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, seq=15, RW, Message:6d32)
2022-10-04 05:48:47,890 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, seq=15, RW, Message:6d32, entry=(t:4, i:28), STATEMACHINELOGENTRY, 58@client-E5C30A31B423
2022-10-04 05:48:47,890 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=97,entriesCount=1,lastEntry=(t:4, i:26)
2022-10-04 05:48:47,890 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, seq=16, RW, Message:6d33)
2022-10-04 05:48:47,891 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, seq=16, RW, Message:6d33, entry=(t:4, i:29), STATEMACHINELOGENTRY, 59@client-E5C30A31B423
2022-10-04 05:48:47,891 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, seq=17, RW, Message:6d34)
2022-10-04 05:48:47,892 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, seq=17, RW, Message:6d34, entry=(t:4, i:30), STATEMACHINELOGENTRY, 60@client-E5C30A31B423
2022-10-04 05:48:47,892 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, seq=18, RW, Message:6d35)
2022-10-04 05:48:47,893 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, seq=18, RW, Message:6d35, entry=(t:4, i:31), STATEMACHINELOGENTRY, 61@client-E5C30A31B423
2022-10-04 05:48:47,893 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, Message:6d36)
2022-10-04 05:48:47,894 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, Message:6d36, entry=(t:4, i:32), STATEMACHINELOGENTRY, 62@client-E5C30A31B423
2022-10-04 05:48:47,894 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, Message:6d37)
2022-10-04 05:48:47,894 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, Message:6d37, entry=(t:4, i:33), STATEMACHINELOGENTRY, 63@client-E5C30A31B423
2022-10-04 05:48:47,894 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, Message:6d38)
2022-10-04 05:48:47,895 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, Message:6d38, entry=(t:4, i:34), STATEMACHINELOGENTRY, 64@client-E5C30A31B423
2022-10-04 05:48:47,895 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #63 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,895 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,895 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #65 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,895 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, seq=17, RW, m4 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #60 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,895 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, seq=18, RW, m5 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #61 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,896 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,896 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:47,896 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:47,895 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, seq=15, RW, m2 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #58 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,900 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,900 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,895 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #66 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,900 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,900 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,895 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:47,899 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:26), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:141, entries: [(t:4, i:27), STATEMACHINELOGENTRY, 57@client-E5C30A31B423, (t:4, i:28), STATEMACHINELOGENTRY, 58@client-E5C30A31B423, (t:4, i:29), STATEMACHINELOGENTRY, 59@client-E5C30A31B423]
2022-10-04 05:48:47,900 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, Message:6d39)
2022-10-04 05:48:47,897 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:26), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:453, entries: [(t:4, i:27), STATEMACHINELOGENTRY, 57@client-E5C30A31B423, (t:4, i:28), STATEMACHINELOGENTRY, 58@client-E5C30A31B423, (t:4, i:29), STATEMACHINELOGENTRY, 59@client-E5C30A31B423]
2022-10-04 05:48:47,896 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=64
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,901 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,901 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,901 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=67
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,902 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,902 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,902 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=68
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,903 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,903 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,903 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=69
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=70
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=71
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,904 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=72
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,904 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=73
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=74
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,905 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,906 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, seq=14, RW, m1 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=57
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,896 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,906 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,895 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,906 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,907 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,906 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:29), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:454, entries: [(t:4, i:30), STATEMACHINELOGENTRY, 60@client-E5C30A31B423, (t:4, i:31), STATEMACHINELOGENTRY, 61@client-E5C30A31B423]
2022-10-04 05:48:47,903 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#141:OK-t4,SUCCESS,nextIndex=30,followerCommit=26,matchIndex=29
2022-10-04 05:48:47,907 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:29), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:142, entries: [(t:4, i:30), STATEMACHINELOGENTRY, 60@client-E5C30A31B423, (t:4, i:31), STATEMACHINELOGENTRY, 61@client-E5C30A31B423]
2022-10-04 05:48:47,907 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, seq=16, RW, m3 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=59
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,906 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,908 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:31), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:143, entries: [(t:4, i:32), STATEMACHINELOGENTRY, 62@client-E5C30A31B423, (t:4, i:33), STATEMACHINELOGENTRY, 63@client-E5C30A31B423, (t:4, i:34), STATEMACHINELOGENTRY, 64@client-E5C30A31B423]
2022-10-04 05:48:47,908 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:31), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:455, entries: [(t:4, i:32), STATEMACHINELOGENTRY, 62@client-E5C30A31B423]
2022-10-04 05:48:47,908 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#142:OK-t4,SUCCESS,nextIndex=32,followerCommit=26,matchIndex=31
2022-10-04 05:48:47,908 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#143:OK-t4,SUCCESS,nextIndex=35,followerCommit=26,matchIndex=34
2022-10-04 05:48:47,909 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, Message:6d39, entry=(t:4, i:35), STATEMACHINELOGENTRY, 65@client-E5C30A31B423
2022-10-04 05:48:47,909 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,909 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,909 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 26 to 34
2022-10-04 05:48:47,909 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=62
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,909 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,909 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,909 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:32), 26, true, commits:[s0:c26, s1:c26, s2:c24], cId:456, entries: [(t:4, i:33), STATEMACHINELOGENTRY, 63@client-E5C30A31B423, (t:4, i:34), STATEMACHINELOGENTRY, 64@client-E5C30A31B423]
2022-10-04 05:48:47,909 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 27, m1 -> (t:4, i:27), STATEMACHINELOGENTRY, 57@client-E5C30A31B423
2022-10-04 05:48:47,910 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 28, m2 -> (t:4, i:28), STATEMACHINELOGENTRY, 58@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 29, m3 -> (t:4, i:29), STATEMACHINELOGENTRY, 59@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 30, m4 -> (t:4, i:30), STATEMACHINELOGENTRY, 60@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 31, m5 -> (t:4, i:31), STATEMACHINELOGENTRY, 61@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 32, m6 -> (t:4, i:32), STATEMACHINELOGENTRY, 62@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 33, m7 -> (t:4, i:33), STATEMACHINELOGENTRY, 63@client-E5C30A31B423
2022-10-04 05:48:47,911 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 34, m8 -> (t:4, i:34), STATEMACHINELOGENTRY, 64@client-E5C30A31B423
2022-10-04 05:48:47,912 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, Message:6d3130)
2022-10-04 05:48:47,912 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, Message:6d3130, entry=(t:4, i:37), STATEMACHINELOGENTRY, 66@client-E5C30A31B423
2022-10-04 05:48:47,912 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, Message:6d3131)
2022-10-04 05:48:47,913 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:34), 34, true, commits:[s0:c34, s1:c26, s2:c24], cId:144, entries: [(t:4, i:35), STATEMACHINELOGENTRY, 65@client-E5C30A31B423, (t:4, i:36), METADATAENTRY(c:34)]
2022-10-04 05:48:47,914 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:36), 34, true, commits:[s0:c34, s1:c26, s2:c24], cId:145, entries: [(t:4, i:37), STATEMACHINELOGENTRY, 66@client-E5C30A31B423]
2022-10-04 05:48:47,914 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#144:OK-t4,SUCCESS,nextIndex=37,followerCommit=34,matchIndex=36
2022-10-04 05:48:47,914 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 27, m1 -> (t:4, i:27), STATEMACHINELOGENTRY, 57@client-E5C30A31B423
2022-10-04 05:48:47,914 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 28, m2 -> (t:4, i:28), STATEMACHINELOGENTRY, 58@client-E5C30A31B423
2022-10-04 05:48:47,914 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 29, m3 -> (t:4, i:29), STATEMACHINELOGENTRY, 59@client-E5C30A31B423
2022-10-04 05:48:47,915 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 30, m4 -> (t:4, i:30), STATEMACHINELOGENTRY, 60@client-E5C30A31B423
2022-10-04 05:48:47,915 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 31, m5 -> (t:4, i:31), STATEMACHINELOGENTRY, 61@client-E5C30A31B423
2022-10-04 05:48:47,916 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 32, m6 -> (t:4, i:32), STATEMACHINELOGENTRY, 62@client-E5C30A31B423
2022-10-04 05:48:47,916 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 33, m7 -> (t:4, i:33), STATEMACHINELOGENTRY, 63@client-E5C30A31B423
2022-10-04 05:48:47,922 [Thread-207] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:47,922 [Thread-207] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,922 [Thread-207] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=77
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,922 [Thread-207] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:47,922 [Thread-207] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,922 [Thread-207] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
2022-10-04 05:48:47,923 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, Message:6d3131, entry=(t:4, i:38), STATEMACHINELOGENTRY, 67@client-E5C30A31B423
2022-10-04 05:48:47,923 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#145:OK-t4,SUCCESS,nextIndex=38,followerCommit=34,matchIndex=37
2022-10-04 05:48:47,923 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 26 to 34
2022-10-04 05:48:47,923 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 34, m8 -> (t:4, i:34), STATEMACHINELOGENTRY, 64@client-E5C30A31B423
2022-10-04 05:48:47,924 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:34), 34, true, commits:[s0:c34, s1:c26, s2:c24], cId:457, entries: [(t:4, i:35), STATEMACHINELOGENTRY, 65@client-E5C30A31B423, (t:4, i:36), METADATAENTRY(c:34)]
2022-10-04 05:48:47,924 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 34 to 36
2022-10-04 05:48:47,924 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:37), 34, true, commits:[s0:c34, s1:c34, s2:c24], cId:146, entries: [(t:4, i:38), STATEMACHINELOGENTRY, 67@client-E5C30A31B423]
2022-10-04 05:48:47,924 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 36 to 37
2022-10-04 05:48:47,924 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 35, m9 -> (t:4, i:35), STATEMACHINELOGENTRY, 65@client-E5C30A31B423
2022-10-04 05:48:47,924 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 37, m10 -> (t:4, i:37), STATEMACHINELOGENTRY, 66@client-E5C30A31B423
2022-10-04 05:48:47,924 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, Message:6d3132)
2022-10-04 05:48:47,925 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, Message:6d3132, entry=(t:4, i:40), STATEMACHINELOGENTRY, 68@client-E5C30A31B423
2022-10-04 05:48:47,925 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#146:OK-t4,SUCCESS,nextIndex=39,followerCommit=34,matchIndex=38
2022-10-04 05:48:47,925 [Thread-208] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:47,926 [Thread-208] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,926 [Thread-208] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=79
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:47,926 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, Message:6d3133)
2022-10-04 05:48:47,926 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:38), 37, true, commits:[s0:c37, s1:c34, s2:c24], cId:147, entries: [(t:4, i:39), METADATAENTRY(c:37), (t:4, i:40), STATEMACHINELOGENTRY, 68@client-E5C30A31B423]
2022-10-04 05:48:47,926 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 38, m11 -> (t:4, i:38), STATEMACHINELOGENTRY, 67@client-E5C30A31B423
2022-10-04 05:48:47,926 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:36), 34, true, commits:[s0:c34, s1:c34, s2:c24], cId:459, entries: [(t:4, i:37), STATEMACHINELOGENTRY, 66@client-E5C30A31B423, (t:4, i:38), STATEMACHINELOGENTRY, 67@client-E5C30A31B423]
2022-10-04 05:48:47,926 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 37 to 38
2022-10-04 05:48:47,927 [Thread-208] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:47,928 [Thread-208] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:47,928 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:38), 37, true, commits:[s0:c37, s1:c34, s2:c24], cId:460, entries: [(t:4, i:39), METADATAENTRY(c:37)]
2022-10-04 05:48:47,928 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:40), 38, true, commits:[s0:c38, s1:c34, s2:c24], cId:148, entries: [(t:4, i:41), METADATAENTRY(c:38)]
2022-10-04 05:48:47,928 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 35, m9 -> (t:4, i:35), STATEMACHINELOGENTRY, 65@client-E5C30A31B423
2022-10-04 05:48:47,929 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 37, m10 -> (t:4, i:37), STATEMACHINELOGENTRY, 66@client-E5C30A31B423
2022-10-04 05:48:47,928 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#147:OK-t4,SUCCESS,nextIndex=41,followerCommit=37,matchIndex=40
2022-10-04 05:48:47,929 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 34 to 37
2022-10-04 05:48:47,928 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, Message:6d3133, entry=(t:4, i:42), STATEMACHINELOGENTRY, 69@client-E5C30A31B423
2022-10-04 05:48:47,929 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:39), 37, true, commits:[s0:c37, s1:c34, s2:c24], cId:461, entries: [(t:4, i:40), STATEMACHINELOGENTRY, 68@client-E5C30A31B423]
2022-10-04 05:48:47,930 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 38 to 40
2022-10-04 05:48:47,930 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 40, m12 -> (t:4, i:40), STATEMACHINELOGENTRY, 68@client-E5C30A31B423
2022-10-04 05:48:47,930 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#148:OK-t4,SUCCESS,nextIndex=42,followerCommit=38,matchIndex=41
2022-10-04 05:48:47,930 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 38, m11 -> (t:4, i:38), STATEMACHINELOGENTRY, 67@client-E5C30A31B423
2022-10-04 05:48:47,930 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 37 to 38
2022-10-04 05:48:47,930 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 40 to 41
2022-10-04 05:48:47,931 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, Message:6d3134)
2022-10-04 05:48:47,928 [Thread-208] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:48:47,931 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, Message:6d3134, entry=(t:4, i:44), STATEMACHINELOGENTRY, 70@client-E5C30A31B423
2022-10-04 05:48:47,930 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:40), 38, true, commits:[s0:c38, s1:c34, s2:c24], cId:462, entries: [(t:4, i:41), METADATAENTRY(c:38)]
2022-10-04 05:48:47,931 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:41), 38, true, commits:[s0:c38, s1:c37, s2:c24], cId:150, entries: [(t:4, i:42), STATEMACHINELOGENTRY, 69@client-E5C30A31B423]
2022-10-04 05:48:47,932 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:42), 41, true, commits:[s0:c41, s1:c38, s2:c24], cId:151, entries: [(t:4, i:43), METADATAENTRY(c:40)]
2022-10-04 05:48:47,932 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:41), 38, true, commits:[s0:c38, s1:c37, s2:c24], cId:464, entries: [(t:4, i:42), STATEMACHINELOGENTRY, 69@client-E5C30A31B423]
2022-10-04 05:48:47,933 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#151:OK-t4,SUCCESS,nextIndex=44,followerCommit=41,matchIndex=43
2022-10-04 05:48:47,933 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#150:OK-t4,SUCCESS,nextIndex=43,followerCommit=41,matchIndex=42
2022-10-04 05:48:47,933 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 40, m12 -> (t:4, i:40), STATEMACHINELOGENTRY, 68@client-E5C30A31B423
2022-10-04 05:48:47,933 [grpc-default-executor-2] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 38 to 41
2022-10-04 05:48:47,934 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:42), 40, true, commits:[s0:c40, s1:c37, s2:c24], cId:466, entries: [(t:4, i:43), METADATAENTRY(c:40)]
2022-10-04 05:48:47,934 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 41 to 42
2022-10-04 05:48:47,934 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:43), 41, true, commits:[s0:c41, s1:c38, s2:c24], cId:152, entries: [(t:4, i:44), STATEMACHINELOGENTRY, 70@client-E5C30A31B423]
2022-10-04 05:48:47,934 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 42, m13 -> (t:4, i:42), STATEMACHINELOGENTRY, 69@client-E5C30A31B423
2022-10-04 05:48:47,934 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, Message:6d3135)
2022-10-04 05:48:47,935 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:43), 41, true, commits:[s0:c41, s1:c38, s2:c24], cId:469, entries: [(t:4, i:44), STATEMACHINELOGENTRY, 70@client-E5C30A31B423]
2022-10-04 05:48:47,935 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, Message:6d3135, entry=(t:4, i:46), STATEMACHINELOGENTRY, 71@client-E5C30A31B423
2022-10-04 05:48:47,935 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#152:OK-t4,SUCCESS,nextIndex=45,followerCommit=41,matchIndex=44
2022-10-04 05:48:47,936 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, Message:6d3136)
2022-10-04 05:48:47,936 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 42 to 43
2022-10-04 05:48:47,936 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 44, m14 -> (t:4, i:44), STATEMACHINELOGENTRY, 70@client-E5C30A31B423
2022-10-04 05:48:47,937 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 43 to 44
2022-10-04 05:48:47,937 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:44), 43, true, commits:[s0:c43, s1:c41, s2:c24], cId:470, entries: [(t:4, i:45), METADATAENTRY(c:42), (t:4, i:46), STATEMACHINELOGENTRY, 71@client-E5C30A31B423]
2022-10-04 05:48:47,938 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:44), 43, true, commits:[s0:c43, s1:c41, s2:c24], cId:153, entries: [(t:4, i:45), METADATAENTRY(c:42), (t:4, i:46), STATEMACHINELOGENTRY, 71@client-E5C30A31B423]
2022-10-04 05:48:47,938 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:46), 44, true, commits:[s0:c44, s1:c41, s2:c24], cId:471, entries: [(t:4, i:47), METADATAENTRY(c:44)]
2022-10-04 05:48:47,938 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:46), 44, true, commits:[s0:c44, s1:c41, s2:c24], cId:154, entries: [(t:4, i:47), METADATAENTRY(c:44)]
2022-10-04 05:48:47,939 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, Message:6d3136, entry=(t:4, i:48), STATEMACHINELOGENTRY, 72@client-E5C30A31B423
2022-10-04 05:48:47,939 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#153:OK-t4,SUCCESS,nextIndex=47,followerCommit=43,matchIndex=46
2022-10-04 05:48:47,939 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 42, m13 -> (t:4, i:42), STATEMACHINELOGENTRY, 69@client-E5C30A31B423
2022-10-04 05:48:47,940 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 41 to 43
2022-10-04 05:48:47,940 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#154:OK-t4,SUCCESS,nextIndex=48,followerCommit=44,matchIndex=47
2022-10-04 05:48:47,940 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 44, m14 -> (t:4, i:44), STATEMACHINELOGENTRY, 70@client-E5C30A31B423
2022-10-04 05:48:47,940 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:47), 44, true, commits:[s0:c44, s1:c41, s2:c24], cId:155, entries: [(t:4, i:48), STATEMACHINELOGENTRY, 72@client-E5C30A31B423]
2022-10-04 05:48:47,941 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 44 to 46
2022-10-04 05:48:47,941 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 46, m15 -> (t:4, i:46), STATEMACHINELOGENTRY, 71@client-E5C30A31B423
2022-10-04 05:48:47,941 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:48), 46, true, commits:[s0:c46, s1:c43, s2:c24], cId:157, entries: [(t:4, i:49), METADATAENTRY(c:46)]
2022-10-04 05:48:47,942 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 43 to 44
2022-10-04 05:48:47,942 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#155:OK-t4,SUCCESS,nextIndex=49,followerCommit=44,matchIndex=48
2022-10-04 05:48:47,942 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#157:OK-t4,SUCCESS,nextIndex=50,followerCommit=46,matchIndex=49
2022-10-04 05:48:47,942 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 46, m15 -> (t:4, i:46), STATEMACHINELOGENTRY, 71@client-E5C30A31B423
2022-10-04 05:48:47,942 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 46 to 48
2022-10-04 05:48:47,943 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 48, m16 -> (t:4, i:48), STATEMACHINELOGENTRY, 72@client-E5C30A31B423
2022-10-04 05:48:47,943 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 44 to 46
2022-10-04 05:48:47,943 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:49), 48, true, commits:[s0:c48, s1:c44, s2:c24], cId:160, entries: [(t:4, i:50), METADATAENTRY(c:48)]
2022-10-04 05:48:47,943 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 48 to 49
2022-10-04 05:48:47,944 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#160:OK-t4,SUCCESS,nextIndex=51,followerCommit=48,matchIndex=50
2022-10-04 05:48:47,944 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 48, m16 -> (t:4, i:48), STATEMACHINELOGENTRY, 72@client-E5C30A31B423
2022-10-04 05:48:47,944 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:47), 44, true, commits:[s0:c44, s1:c43, s2:c24], cId:472, entries: [(t:4, i:48), STATEMACHINELOGENTRY, 72@client-E5C30A31B423]
2022-10-04 05:48:47,944 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, Message:6d3137)
2022-10-04 05:48:47,944 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, Message:6d3137, entry=(t:4, i:51), STATEMACHINELOGENTRY, 73@client-E5C30A31B423
2022-10-04 05:48:47,945 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, Message:6d3138)
2022-10-04 05:48:47,945 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, Message:6d3138, entry=(t:4, i:52), STATEMACHINELOGENTRY, 74@client-E5C30A31B423
2022-10-04 05:48:47,946 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:48), 46, true, commits:[s0:c46, s1:c43, s2:c24], cId:473, entries: [(t:4, i:49), METADATAENTRY(c:46)]
2022-10-04 05:48:47,946 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:49), 49, true, commits:[s0:c49, s1:c46, s2:c24], cId:474, entries: [(t:4, i:50), METADATAENTRY(c:48)]
2022-10-04 05:48:47,947 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:50), 49, true, commits:[s0:c49, s1:c46, s2:c24], cId:475, entries: [(t:4, i:51), STATEMACHINELOGENTRY, 73@client-E5C30A31B423]
2022-10-04 05:48:47,947 [grpc-default-executor-6] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 46 to 48
2022-10-04 05:48:47,947 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, Message:6d3139)
2022-10-04 05:48:47,947 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(409)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, Message:6d3139, entry=(t:4, i:53), STATEMACHINELOGENTRY, 75@client-E5C30A31B423
2022-10-04 05:48:47,948 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 49 to 50
2022-10-04 05:48:47,949 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:50), 49, true, commits:[s0:c49, s1:c46, s2:c24], cId:163, entries: [(t:4, i:51), STATEMACHINELOGENTRY, 73@client-E5C30A31B423]
2022-10-04 05:48:47,949 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:51), 49, true, commits:[s0:c49, s1:c46, s2:c24], cId:164, entries: [(t:4, i:52), STATEMACHINELOGENTRY, 74@client-E5C30A31B423]
2022-10-04 05:48:47,949 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#163:OK-t4,SUCCESS,nextIndex=52,followerCommit=49,matchIndex=51
2022-10-04 05:48:47,950 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#164:OK-t4,SUCCESS,nextIndex=53,followerCommit=49,matchIndex=52
2022-10-04 05:48:47,950 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:51), 50, true, commits:[s0:c50, s1:c48, s2:c24], cId:476, entries: [(t:4, i:52), STATEMACHINELOGENTRY, 74@client-E5C30A31B423, (t:4, i:53), STATEMACHINELOGENTRY, 75@client-E5C30A31B423]
2022-10-04 05:48:47,951 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:52), 49, true, commits:[s0:c49, s1:c48, s2:c24], cId:165, entries: [(t:4, i:53), STATEMACHINELOGENTRY, 75@client-E5C30A31B423]
2022-10-04 05:48:47,951 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 48 to 49
2022-10-04 05:48:47,951 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 51, m17 -> (t:4, i:51), STATEMACHINELOGENTRY, 73@client-E5C30A31B423
2022-10-04 05:48:47,951 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 50 to 51
2022-10-04 05:48:47,952 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#165:OK-t4,SUCCESS,nextIndex=54,followerCommit=49,matchIndex=53
2022-10-04 05:48:47,953 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:53), 51, true, commits:[s0:c51, s1:c49, s2:c24], cId:478, entries: [(t:4, i:54), METADATAENTRY(c:51)]
2022-10-04 05:48:47,953 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 51 to 52
2022-10-04 05:48:47,954 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 52, m18 -> (t:4, i:52), STATEMACHINELOGENTRY, 74@client-E5C30A31B423
2022-10-04 05:48:47,954 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:53), 51, true, commits:[s0:c51, s1:c49, s2:c24], cId:168, entries: [(t:4, i:54), METADATAENTRY(c:51)]
2022-10-04 05:48:47,955 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 52 to 53
2022-10-04 05:48:47,955 [s0@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 53, m19 -> (t:4, i:53), STATEMACHINELOGENTRY, 75@client-E5C30A31B423
2022-10-04 05:48:47,955 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#168:OK-t4,SUCCESS,nextIndex=55,followerCommit=51,matchIndex=54
2022-10-04 05:48:47,955 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 51, m17 -> (t:4, i:51), STATEMACHINELOGENTRY, 73@client-E5C30A31B423
2022-10-04 05:48:47,956 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:54), 52, true, commits:[s0:c52, s1:c49, s2:c24], cId:480, entries: [(t:4, i:55), METADATAENTRY(c:52)]
2022-10-04 05:48:47,956 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:54), 52, true, commits:[s0:c52, s1:c49, s2:c24], cId:171, entries: [(t:4, i:55), METADATAENTRY(c:52)]
2022-10-04 05:48:47,957 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 49 to 51
2022-10-04 05:48:47,957 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 53 to 54
2022-10-04 05:48:47,957 [s2-server-thread5] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s2@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:55), 53, true, commits:[s0:c53, s1:c49, s2:c24], cId:481, entries: [(t:4, i:56), METADATAENTRY(c:53)]
2022-10-04 05:48:47,957 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#171:OK-t4,SUCCESS,nextIndex=56,followerCommit=52,matchIndex=55
2022-10-04 05:48:47,957 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 52, m18 -> (t:4, i:52), STATEMACHINELOGENTRY, 74@client-E5C30A31B423
2022-10-04 05:48:47,958 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: receive appendEntries(s0, 4, (t:4, i:55), 53, true, commits:[s0:c53, s1:c49, s2:c24], cId:173, entries: [(t:4, i:56), METADATAENTRY(c:53)]
2022-10-04 05:48:47,958 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 51 to 52
2022-10-04 05:48:47,958 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 54 to 55
2022-10-04 05:48:47,959 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1415)) - s1@group-FB6BB5C9A9B3: succeeded to handle AppendEntries. Reply: s0<-s1#173:OK-t4,SUCCESS,nextIndex=57,followerCommit=53,matchIndex=56
2022-10-04 05:48:47,959 [s1@group-FB6BB5C9A9B3-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 53, m19 -> (t:4, i:53), STATEMACHINELOGENTRY, 75@client-E5C30A31B423
2022-10-04 05:48:47,959 [grpc-default-executor-7] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 52 to 53
2022-10-04 05:48:47,959 [s0@group-FB6BB5C9A9B3-LeaderStateImpl] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY index from 55 to 56
2022-10-04 05:48:48,012 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=57, seq=14*, RW, Message:6d31)
2022-10-04 05:48:48,018 [grpc-default-executor-7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=57, seq=14*, RW, m1 with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:48,018 [grpc-default-executor-7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:266)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:324)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:48,018 [grpc-default-executor-7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:48,018 [grpc-default-executor-7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:48,022 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
2022-10-04 05:48:48,025 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, seq=14*, RW, Message:6d31)
2022-10-04 05:48:48,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>)
2022-10-04 05:48:48,026 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-10-04 05:48:48,027 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m1, logIndex=27
2022-10-04 05:48:48,027 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=80, seq=0, Watch(27), null
2022-10-04 05:48:48,027 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:48:48,028 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), null
2022-10-04 05:48:48,028 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=80, seq=0, Watch(27), Message:<EMPTY>)
2022-10-04 05:48:48,028 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:48:48,028 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=80, seq=0, Watch(27), Message:<EMPTY>
2022-10-04 05:48:48,028 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 1: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=57, SUCCESS, logIndex=27, commits[s0:c34, s1:c26, s2:c24]
2022-10-04 05:48:48,029 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-10-04 05:48:48,029 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-10-04 05:48:48,030 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, seq=15, RW, Message:6d32)
2022-10-04 05:48:48,030 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, seq=16, RW, Message:6d33)
2022-10-04 05:48:48,031 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:48:48,031 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:48:48,031 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=82, seq=0, Watch-MAJORITY_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:48:48,032 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:48:48,032 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:48:48,033 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m2, logIndex=28
2022-10-04 05:48:48,033 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=84, seq=0, Watch(28), null
2022-10-04 05:48:48,033 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:48:48,033 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), null
2022-10-04 05:48:48,033 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-10-04 05:48:48,034 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>)
2022-10-04 05:48:48,034 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-10-04 05:48:48,034 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=84, seq=0, Watch(28), Message:<EMPTY>)
2022-10-04 05:48:48,034 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=84, seq=0, Watch(28), Message:<EMPTY>
2022-10-04 05:48:48,035 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:48:48,035 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-10-04 05:48:48,035 [grpc-default-executor-9] DEBUG impl.WatchRequests (WatchRequests.java:updateIndex(143)) - s0@group-FB6BB5C9A9B3-WatchRequests: update MAJORITY_COMMITTED index from 53 to 56
2022-10-04 05:48:48,035 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), Message:<EMPTY>)
2022-10-04 05:48:48,035 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=86, seq=0, Watch-MAJORITY_COMMITTED(28), Message:<EMPTY>
2022-10-04 05:48:48,036 [grpc-default-executor-7] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m3, logIndex=29
2022-10-04 05:48:48,036 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=88, seq=0, Watch(29), null
2022-10-04 05:48:48,036 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:48:48,036 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), null
2022-10-04 05:48:48,036 [grpc-default-executor-7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:48:48,037 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>)
2022-10-04 05:48:48,037 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-10-04 05:48:48,037 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=88, seq=0, Watch(29), Message:<EMPTY>)
2022-10-04 05:48:48,037 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=88, seq=0, Watch(29), Message:<EMPTY>
2022-10-04 05:48:48,038 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-10-04 05:48:48,038 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-10-04 05:48:48,038 [Thread-210] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=82, SUCCESS, logIndex=53, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,038 [Thread-211] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=84, SUCCESS, logIndex=56, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,036 [Thread-209] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=80, SUCCESS, logIndex=56, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,038 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), Message:<EMPTY>)
2022-10-04 05:48:48,039 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=90, seq=0, Watch-MAJORITY_COMMITTED(29), Message:<EMPTY>
2022-10-04 05:48:48,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(27) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=80, SUCCESS, logIndex=56, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(27) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=82, SUCCESS, logIndex=53, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 2: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=58, SUCCESS, logIndex=28, commits[s0:c34, s1:c26, s2:c24]
2022-10-04 05:48:48,039 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(28) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=84, SUCCESS, logIndex=56, commits[s0:c56, s1:c53, s2:c24]
2022-10-04 05:48:48,039 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-10-04 05:48:48,040 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-10-04 05:48:48,045 [Thread-212] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=86, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:48,045 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(28) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=86, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:48,045 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 3: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=59, SUCCESS, logIndex=29, commits[s0:c34, s1:c26, s2:c24]
2022-10-04 05:48:48,046 [Thread-213] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=88, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:48,046 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(29) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=88, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:48,046 [Thread-214] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=90, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:48,047 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(29) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=90, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:50,892 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=453,entriesCount=3,lastEntry=(t:4, i:29)
2022-10-04 05:48:50,894 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=455,entriesCount=1,lastEntry=(t:4, i:32)
2022-10-04 05:48:50,900 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=456,entriesCount=2,lastEntry=(t:4, i:34)
2022-10-04 05:48:50,916 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=457,entriesCount=2,lastEntry=(t:4, i:36)
2022-10-04 05:48:50,923 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=145, target=localhost:33335}}. 
2022-10-04 05:48:50,923 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=459,entriesCount=2,lastEntry=(t:4, i:38)
2022-10-04 05:48:50,925 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=461,entriesCount=1,lastEntry=(t:4, i:40)
2022-10-04 05:48:50,925 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=454,entriesCount=2,lastEntry=(t:4, i:31)
2022-10-04 05:48:50,925 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=460,entriesCount=1,lastEntry=(t:4, i:39)
2022-10-04 05:48:50,926 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, seq=17, RW, Message:6d34)
2022-10-04 05:48:50,926 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=462,entriesCount=1,lastEntry=(t:4, i:41)
2022-10-04 05:48:50,927 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m4, logIndex=30
2022-10-04 05:48:50,928 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=92, seq=0, Watch(30), null
2022-10-04 05:48:50,928 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
2022-10-04 05:48:50,928 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), null
2022-10-04 05:48:50,928 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:48:50,928 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 4: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=60, SUCCESS, logIndex=30, commits[s0:c34, s1:c26, s2:c24]
2022-10-04 05:48:50,929 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=92, seq=0, Watch(30), Message:<EMPTY>)
2022-10-04 05:48:50,929 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=92, seq=0, Watch(30), Message:<EMPTY>
2022-10-04 05:48:50,930 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=466,entriesCount=1,lastEntry=(t:4, i:43)
2022-10-04 05:48:50,930 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=464,entriesCount=1,lastEntry=(t:4, i:42)
2022-10-04 05:48:50,930 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-10-04 05:48:50,930 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-10-04 05:48:50,930 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:48:50,930 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=94, seq=0, Watch-MAJORITY_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:48:50,931 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:48:50,931 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:48:50,931 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=469,entriesCount=1,lastEntry=(t:4, i:44)
2022-10-04 05:48:50,932 [Thread-215] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=92, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:50,932 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(30) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=92, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:50,932 [Thread-216] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=94, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:50,932 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majorityCommitted-Watch(30) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=94, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:50,936 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=470,entriesCount=2,lastEntry=(t:4, i:46)
2022-10-04 05:48:50,937 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=471,entriesCount=1,lastEntry=(t:4, i:47)
2022-10-04 05:48:50,940 [timer3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=472,entriesCount=1,lastEntry=(t:4, i:48)
2022-10-04 05:48:50,941 [timer5] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=473,entriesCount=1,lastEntry=(t:4, i:49)
2022-10-04 05:48:50,943 [timer7] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=474,entriesCount=1,lastEntry=(t:4, i:50)
2022-10-04 05:48:50,945 [timer1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=475,entriesCount=1,lastEntry=(t:4, i:51)
2022-10-04 05:48:50,948 [timer4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=476,entriesCount=2,lastEntry=(t:4, i:53)
2022-10-04 05:48:50,951 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=478,entriesCount=1,lastEntry=(t:4, i:54)
2022-10-04 05:48:50,954 [timer0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=480,entriesCount=1,lastEntry=(t:4, i:55)
2022-10-04 05:48:50,955 [timer2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(311)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=481,entriesCount=1,lastEntry=(t:4, i:56)
2022-10-04 05:48:51,025 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, seq=18, RW, Message:6d35)
2022-10-04 05:48:51,025 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, Message:6d36)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, Message:6d37)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, Message:6d38)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, Message:6d39)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, Message:6d3130)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, Message:6d3131)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, Message:6d3132)
2022-10-04 05:48:51,026 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, Message:6d3133)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, Message:6d3134)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, Message:6d3135)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, Message:6d3136)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, Message:6d3137)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, Message:6d3138)
2022-10-04 05:48:51,027 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, Message:6d3139)
2022-10-04 05:48:51,029 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=64, seq=21, RW, m8 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #64 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,029 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,029 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:51,029 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:51,029 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=70, seq=27, RW, m14 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #70 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,032 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=65, seq=22, RW, m9 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=65
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,033 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,032 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=73, seq=30, RW, m17 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #73 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,033 [timer5] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,032 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=72, seq=29, RW, m16 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #72 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,033 [timer4] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,032 [grpc-default-executor-2] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:lambda$sendRequests$0(109)) - SEND_WATCH: message=m5, logIndex=31
2022-10-04 05:48:51,034 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), null
2022-10-04 05:48:51,031 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=71, seq=28, RW, m15 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #71 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,036 [timer3] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,031 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=74, seq=31, RW, m18 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #74 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,036 [timer6] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,031 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=69, seq=26, RW, m13 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #69 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,036 [timer1] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,031 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=67, seq=24, RW, m11 with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #67 timeout 3000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,036 [timer0] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,032 [timer2] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,037 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,040 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), Message:<EMPTY>)
2022-10-04 05:48:51,041 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:48:51,042 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:51,042 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:48:51,044 [Thread-217] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:51,044 [Thread-217] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,044 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
2022-10-04 05:48:51,045 [Thread-217] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,045 [Thread-217] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,045 [Thread-217] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:51,045 [Thread-217] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:51,045 [grpc-default-executor-2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #1 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:51,049 [Thread-218] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:51,049 [Thread-218] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,049 [Thread-218] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,051 [Thread-218] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,051 [Thread-218] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:48:51,055 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:51,056 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:48:51,052 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:51,057 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:48:51,052 [timer5] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,052 [timer4] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,052 [timer3] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:51,052 [timer6] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:51,052 [timer1] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,052 [timer0] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,052 [timer2] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,052 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:checkMajority(271)) - checkMajority 5: receive RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=61, SUCCESS, logIndex=31, commits[s0:c34, s1:c26, s2:c24]
2022-10-04 05:48:51,051 [Thread-219] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:51,059 [Thread-219] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1 is closed.
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.onNext(GrpcClientProtocolClient.java:359)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:83)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.send(UnorderedAsync.java:61)
	at org.apache.ratis.client.impl.AsyncImpl.watch(AsyncImpl.java:61)
	at org.apache.ratis.WatchRequestTests$TestParameters.lambda$sendRequests$0(WatchRequestTests.java:113)
	at java.base/java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:714)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,059 [Thread-219] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s1 is closed.
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.onNext(GrpcClientProtocolClient.java:359)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:83)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.send(UnorderedAsync.java:61)
	at org.apache.ratis.client.impl.AsyncImpl.watch(AsyncImpl.java:61)
	at org.apache.ratis.WatchRequestTests$TestParameters.lambda$sendRequests$0(WatchRequestTests.java:113)
	at java.base/java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:714)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:98)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.setReply(OrderedAsync.java:59)
	at org.apache.ratis.util.SlidingWindow$RequestMap.setReply(SlidingWindow.java:144)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:348)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$9(OrderedAsync.java:248)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:332)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:332)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,059 [Thread-219] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,059 [Thread-219] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:51,059 [Thread-219] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:48:51,060 [Thread-219] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
2022-10-04 05:48:51,051 [Thread-217] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), null
2022-10-04 05:48:51,060 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), null
2022-10-04 05:48:51,059 [Thread-218] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,063 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,064 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), Message:<EMPTY>)
2022-10-04 05:48:51,064 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=96, seq=0, Watch(31), Message:<EMPTY>
2022-10-04 05:48:51,072 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:51,072 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-10-04 05:48:51,074 [Thread-220] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=96, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:51,074 [Time-limited test] INFO  grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(210)) - majority-Watch(31) returns RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=96, SUCCESS, logIndex=56, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:51,074 [Thread-221] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:51,074 [Thread-221] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,075 [Thread-221] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:51,075 [Thread-221] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,075 [Thread-221] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:51,075 [Thread-221] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:48:51,076 [Thread-222] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:51,076 [Thread-222] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,076 [Thread-222] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,076 [Thread-222] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,076 [Thread-222] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:51,076 [Thread-222] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,176 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,181 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:51,182 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:48:51,183 [Thread-223] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:51,184 [Thread-223] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,185 [Thread-223] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,185 [Thread-223] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:51,185 [Thread-223] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:48:51,185 [Thread-223] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:51,187 [Thread-223] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,187 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:51,192 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:51,192 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-10-04 05:48:54,074 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=173, target=localhost:33335}}. 
2022-10-04 05:48:54,076 [Thread-221] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=180, target=localhost:33335}}. 
2022-10-04 05:48:54,077 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=66, seq=23, RW, m10 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=66
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:54,077 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:54,077 [Thread-221] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:54,077 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:48:54,078 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:48:54,079 [Thread-224] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:48:54,079 [Thread-224] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:54,079 [Thread-224] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:54,079 [Thread-224] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,079 [Thread-224] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:48:54,079 [Thread-224] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:54,178 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:54,179 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:54,188 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:54,188 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:48:54,189 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:54,189 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:48:54,190 [Thread-225] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:48:54,190 [Thread-225] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,191 [Thread-226] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:54,191 [Thread-226] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,191 [Thread-226] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,191 [Thread-226] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,191 [Thread-226] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:48:54,191 [Thread-226] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:54,192 [Thread-225] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,193 [Thread-225] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:54,193 [Thread-225] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:48:54,193 [Thread-225] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:54,193 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:54,196 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:54,196 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-10-04 05:48:54,197 [Thread-226] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:54,197 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:54,198 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:54,198 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:48:54,728 [Timer-0] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:48:54,889 [s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(91)) - Timeout 0/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:364)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:60)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:546)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:303)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.util.concurrent.TimeoutException
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1886)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2021)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 6 more
2022-10-04 05:48:55,858 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(25)@21.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-10-04 05:48:55,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:55,859 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(25)@21.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>
2022-10-04 05:48:55,861 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 77 and log index 25 is not yet replicated to ALL, logIndex=25, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:57,079 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=194, target=localhost:33335}}. 
2022-10-04 05:48:57,080 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=68, seq=25, RW, m12 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=68
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,081 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,081 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:57,081 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:48:57,082 [Thread-227] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #6 receive~ null
2022-10-04 05:48:57,082 [Thread-227] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #6 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,083 [Thread-227] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=97
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,083 [Thread-227] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,083 [Thread-227] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:57,083 [Thread-227] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:57,083 [Thread-228] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:48:57,084 [Thread-228] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,084 [Thread-228] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:57,084 [Thread-228] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,084 [Thread-228] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:57,084 [Thread-228] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:57,184 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:57,185 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #7 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:48:57,191 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>)
2022-10-04 05:48:57,191 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:48:57,191 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:57,192 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:48:57,202 [Thread-229] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #7 receive~ null
2022-10-04 05:48:57,202 [Thread-229] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #7 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,202 [Thread-229] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,202 [Thread-229] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,202 [Thread-229] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:48:57,202 [Thread-229] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:57,203 [Thread-230] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:48:57,203 [Thread-230] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,204 [Thread-230] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,204 [Thread-230] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:57,204 [Thread-230] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:57,204 [Thread-230] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:57,204 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:57,208 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:57,208 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:48:58,029 [Thread-231] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,029 [Thread-231] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #81 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,029 [Thread-231] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #81 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,029 [Thread-231] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,029 [Thread-232] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,029 [Thread-231] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:48:58,030 [Thread-232] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #83 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,030 [Thread-231] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:48:58,030 [Thread-232] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #83 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,030 [Thread-232] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,030 [Thread-232] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,031 [Thread-232] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:48:58,031 [Thread-233] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:48:58,032 [Thread-233] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,032 [Thread-233] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,032 [Thread-233] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,032 [Thread-233] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,032 [Thread-234] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:58,032 [Thread-233] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:58,032 [Thread-234] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #79 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,037 [Thread-234] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #79 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,037 [Thread-234] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,037 [Thread-234] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,037 [Thread-234] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:48:58,037 [Thread-235] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,038 [Thread-235] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #85 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,037 [Thread-236] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,043 [Thread-236] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #91 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,043 [Thread-235] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #85 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,045 [Thread-235] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,045 [Thread-235] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,045 [Thread-235] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:48:58,045 [Thread-238] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,045 [Thread-238] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #89 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,046 [Thread-238] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #89 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,046 [Thread-238] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,046 [Thread-238] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,046 [Thread-238] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:48:58,045 [Thread-237] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:48:58,046 [Thread-237] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #87 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,046 [Thread-237] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #87 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,046 [Thread-237] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,046 [Thread-237] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,046 [Thread-237] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-10-04 05:48:58,046 [Thread-236] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #91 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:48:58,046 [Thread-236] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,047 [Thread-236] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:48:58,047 [Thread-236] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:48:58,131 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:48:58,133 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:58,136 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:48:58,136 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:48:58,137 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:58,138 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:48:58,138 [Thread-239] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:48:58,138 [Thread-239] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,139 [Thread-239] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,139 [Thread-239] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,139 [Thread-239] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:48:58,139 [Thread-239] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:48:58,139 [Thread-240] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #6 receive~ null
2022-10-04 05:48:58,139 [Thread-240] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #6 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,139 [Thread-240] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,140 [Thread-240] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:48:58,140 [Thread-240] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:48:58,140 [Thread-240] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:58,140 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #7 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:48:58,143 [Thread-239] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:48:58,143 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:48:58,147 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:48:58,148 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:48:58,148 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:48:58,149 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:48:58,149 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:48:58,150 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:48:58,150 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>)
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:48:58,152 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-10-04 05:48:58,856 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(27)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-10-04 05:48:58,856 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 81 and log index 27 is not yet replicated to ALL, logIndex=27, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:58,857 [timer5] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(28)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>
2022-10-04 05:48:58,857 [timer1] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(27)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:48:58,857 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=87, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 87 and log index 28 is not yet replicated to ALL_COMMITTED, logIndex=28, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:58,857 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 83 and log index 27 is not yet replicated to ALL_COMMITTED, logIndex=27, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:58,857 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(29)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-10-04 05:48:58,857 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(28)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-10-04 05:48:58,858 [timer6] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(25)@24.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>
2022-10-04 05:48:58,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 89 and log index 29 is not yet replicated to ALL, logIndex=29, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:58,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 85 and log index 28 is not yet replicated to ALL, logIndex=28, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:48:58,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=79, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 79 and log index 25 is not yet replicated to ALL_COMMITTED, logIndex=25, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:00,082 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=208, target=localhost:33335}}. 
2022-10-04 05:49:00,084 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=75, seq=32, RW, m19 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=75
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,084 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,085 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:49:00,085 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:49:00,085 [Thread-241] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #7 receive~ null
2022-10-04 05:49:00,086 [Thread-241] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #7 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,086 [Thread-241] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,086 [Thread-241] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,086 [Thread-241] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,086 [Thread-242] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:00,086 [Thread-243] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:00,087 [Thread-243] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,087 [Thread-243] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,087 [Thread-243] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,087 [Thread-243] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,087 [Thread-243] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:00,086 [Thread-241] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #7, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:00,087 [Thread-242] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,088 [Thread-242] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,088 [Thread-242] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,088 [Thread-242] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,088 [Thread-242] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:00,089 [Thread-244] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:00,089 [Thread-244] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,089 [Thread-244] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,089 [Thread-244] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,089 [Thread-244] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,089 [Thread-244] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:00,091 [Thread-245] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:00,091 [Thread-245] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,091 [Thread-245] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=91
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,092 [Thread-245] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,092 [Thread-245] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,092 [Thread-245] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:49:00,187 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:00,188 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #8 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:00,189 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:00,190 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:00,194 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:49:00,195 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:00,195 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-10-04 05:49:00,195 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:00,196 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:00,196 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:00,196 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:49:00,196 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:00,197 [Thread-246] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:49:00,197 [Thread-246] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,202 [Thread-246] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,202 [Thread-246] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,203 [Thread-246] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:49:00,203 [Thread-246] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:49:00,203 [Thread-229] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=215, target=localhost:36881}}. 
2022-10-04 05:49:00,197 [Thread-248] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:00,197 [Thread-247] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #8 receive~ null
2022-10-04 05:49:00,206 [Thread-246] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:00,206 [Thread-229] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #7, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:49:00,206 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:00,206 [Thread-248] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,206 [Thread-248] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,206 [Thread-248] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,206 [Thread-248] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:00,206 [Thread-248] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:00,206 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:00,204 [grpc-default-executor-9] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 6-UnorderedRequestStreamObserver6: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:49:00,211 [Thread-249] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:00,211 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:49:00,212 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-10-04 05:49:00,206 [Thread-247] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #8 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,212 [Thread-247] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,212 [Thread-247] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,212 [Thread-247] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:00,212 [Thread-247] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #8, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:00,213 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #9 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:00,213 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:00,213 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:49:00,213 [Thread-249] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,213 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:49:00,214 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:49:00,214 [Thread-249] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,214 [Thread-249] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,214 [Thread-249] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:00,214 [Thread-249] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:00,214 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:00,215 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-10-04 05:49:00,215 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>
2022-10-04 05:49:00,929 [Thread-250] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:49:00,929 [Thread-250] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #93 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,930 [Thread-250] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #93 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,930 [Thread-250] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,930 [Thread-250] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:49:00,930 [Thread-250] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.TimeoutIOException
2022-10-04 05:49:00,929 [Thread-251] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #1 receive~ null
2022-10-04 05:49:00,930 [Thread-251] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #1 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #95 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,935 [Thread-251] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E5C30A31B423->s0 request #95 timeout 10000ms
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:384)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$1(GrpcClientProtocolClient.java:372)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:00,935 [Thread-251] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,935 [Thread-251] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,935 [Thread-251] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:00,931 [Thread-253] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #9 receive~ null
2022-10-04 05:49:00,930 [Thread-252] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:49:00,935 [Thread-252] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,935 [Thread-254] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:49:00,936 [Thread-254] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-254] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-254] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-254] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,936 [Thread-252] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-252] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-252] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,936 [Thread-252] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:00,936 [Thread-255] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:49:00,936 [Thread-254] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:00,936 [Thread-253] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #9 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,936 [Thread-255] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,937 [Thread-255] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=89
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,937 [Thread-255] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,937 [Thread-255] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,937 [Thread-255] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:00,939 [Thread-253] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,939 [Thread-253] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:00,939 [Thread-253] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:00,939 [Thread-253] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #9, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:01,032 [Thread-231] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=222, target=localhost:33335}}. 
2022-10-04 05:49:01,033 [Thread-231] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:01,035 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:01,036 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:01,037 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:01,037 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:01,041 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #10 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:01,043 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:49:01,043 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,044 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>)
2022-10-04 05:49:01,046 [Thread-256] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #6 receive~ null
2022-10-04 05:49:01,046 [Thread-256] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #6 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-256] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-256] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-256] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:49:01,052 [Thread-256] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:49:01,048 [Thread-259] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:49:01,052 [Thread-259] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-259] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-259] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,052 [Thread-259] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:01,052 [Thread-259] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:01,048 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,053 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:49:01,046 [Thread-258] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:49:01,046 [Thread-257] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #10 receive~ null
2022-10-04 05:49:01,054 [Thread-257] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #10 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-257] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-257] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-257] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:01,054 [Thread-257] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #10, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:01,054 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #11 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:01,054 [Thread-258] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-258] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-258] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,054 [Thread-258] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:01,054 [Thread-258] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:01,054 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:01,055 [Thread-260] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:01,055 [Thread-260] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,055 [Thread-260] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,055 [Thread-260] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,055 [Thread-260] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s0, newLeader=s0
2022-10-04 05:49:01,056 [Thread-260] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:01,056 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:01,054 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,059 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,056 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:49:01,056 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:01,061 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>)
2022-10-04 05:49:01,063 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:49:01,064 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,064 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:49:01,064 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:49:01,064 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>)
2022-10-04 05:49:01,064 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>
2022-10-04 05:49:01,065 [Thread-256] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:01,065 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #7 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:01,066 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:01,066 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:49:01,074 [Time-limited test] ERROR grpc.TestWatchRequestWithGrpc (WatchRequestTests.java:get(207)) - Failed to get majorityCommitted(31)
2022-10-04 05:49:01,077 [Thread-261] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #11 receive~ null
2022-10-04 05:49:01,077 [Thread-261] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #11 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-261] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=99
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-261] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-263] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #6 receive~ null
2022-10-04 05:49:01,078 [Thread-263] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #6 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-263] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=85
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-263] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,078 [Thread-262] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #7 receive~ null
2022-10-04 05:49:01,079 [Thread-262] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #7 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,079 [Thread-262] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,079 [Thread-262] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,079 [Thread-262] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:49:01,079 [Thread-262] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:49:01,079 [Thread-262] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #7, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:01,079 [Thread-263] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s1
2022-10-04 05:49:01,080 [Thread-263] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:01,078 [Thread-261] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:49:01,083 [Thread-261] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #11, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:01,087 [Thread-264] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:01,087 [Thread-264] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,087 [Thread-264] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$3(PeerProxyMap.java:169)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.lambda$close$4(PeerProxyMap.java:169)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.concurrent.ConcurrentHashMap$ValueSpliterator.forEachRemaining(ConcurrentHashMap.java:3605)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base/java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:290)
	at java.base/java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:746)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.helpCC(ForkJoinPool.java:1115)
	at java.base/java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:1957)
	at java.base/java.util.concurrent.ForkJoinTask.tryExternalHelp(ForkJoinTask.java:378)
	at java.base/java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:323)
	at java.base/java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:412)
	at java.base/java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:736)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:159)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)
	at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:661)
	at org.apache.ratis.util.PeerProxyMap.close(PeerProxyMap.java:168)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.close(RaftClientRpcWithProxy.java:53)
	at org.apache.ratis.client.impl.RaftClientImpl.close(RaftClientImpl.java:406)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:144)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,087 [Thread-264] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,087 [Thread-264] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s1, newLeader=null
2022-10-04 05:49:01,087 [Thread-264] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:01,133 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:01,138 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s1@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-10-04 05:49:01,139 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c56, s0:c56, s2:c24]
2022-10-04 05:49:01,141 [Thread-265] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:01,141 [Thread-265] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,141 [Thread-265] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,141 [Thread-265] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:01,141 [Thread-265] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:49:01,141 [Thread-265] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:49:01,144 [Thread-265] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:01,144 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:01,150 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-10-04 05:49:01,150 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-10-04 05:49:01,180 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #8 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:01,180 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:01,180 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:49:01,187 [timer0] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:01,187 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:49:01,188 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:49:01,857 [timer0] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(31)@27.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 99 and log index 31 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>
2022-10-04 05:49:01,857 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 99 and log index 31 is not yet replicated to ALL_COMMITTED, logIndex=31, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:01,857 [timer3] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(30)@27.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-10-04 05:49:01,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, logIndex=30, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:01,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 93 and log index 30 is not yet replicated to ALL, logIndex=30, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:01,857 [timer4] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL_COMMITTED(30)@27.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 95 and log index 30 is not yet replicated to ALL_COMMITTED, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:49:01,858 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, logIndex=31, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:01,859 [timer2] DEBUG impl.WatchRequests (WatchRequests.java:handleTimeout(125)) - s0@group-FB6BB5C9A9B3-WatchRequests: timeout Watch-ALL(31)@27.456s?java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>
2022-10-04 05:49:01,859 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotReplicatedException: Request with call Id 97 and log index 31 is not yet replicated to ALL, logIndex=31, commits[s0:c56, s1:c56, s2:c24]
2022-10-04 05:49:03,091 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=236, target=localhost:33335}}. 
2022-10-04 05:49:03,093 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=62, seq=19, RW, m6 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=62
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,094 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,094 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:49:03,094 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:49:03,096 [Thread-266] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:03,096 [Thread-266] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,096 [Thread-266] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=81
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,097 [Thread-266] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,097 [Thread-266] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:03,097 [Thread-266] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:03,097 [Thread-267] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #8 receive~ null
2022-10-04 05:49:03,097 [Thread-267] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #8 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,097 [Thread-267] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=83
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,098 [Thread-267] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,098 [Thread-267] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:03,098 [Thread-267] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #8, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:03,102 [Thread-268] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:49:03,103 [Thread-268] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,103 [Thread-268] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=95
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:03,104 [Thread-268] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,104 [Thread-268] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:03,104 [Thread-268] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:03,197 [timer4] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #4 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:03,200 [timer5] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #9 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:03,203 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-10-04 05:49:03,204 [timer6] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:03,204 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:49:03,204 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:03,205 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:49:03,205 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s2@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:49:03,206 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s2:c24, s0:c56, s1:c56]
2022-10-04 05:49:03,208 [Thread-269] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #4 receive~ null
2022-10-04 05:49:03,208 [Thread-269] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #4 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,208 [Thread-270] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #9 receive~ null
2022-10-04 05:49:03,212 [Thread-270] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #9 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,212 [Thread-270] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,212 [Thread-270] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,212 [Thread-270] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s0
2022-10-04 05:49:03,212 [Thread-270] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s0 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:49:03,212 [Thread-269] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,213 [Thread-269] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,213 [Thread-269] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:49:03,213 [Thread-269] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #4, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:03,213 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #5 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:03,212 [Thread-271] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:49:03,219 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>)
2022-10-04 05:49:03,219 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>
2022-10-04 05:49:03,220 [Thread-271] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,220 [Thread-271] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: s0. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-FB6BB5C9A9B3 is not the leader s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,220 [Thread-271] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:03,220 [Thread-271] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=s0
2022-10-04 05:49:03,220 [Thread-271] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:03,220 [timer2] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:03,220 [Thread-270] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #9, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:03,221 [timer3] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #10 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:03,220 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>)
2022-10-04 05:49:03,221 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>
2022-10-04 05:49:03,221 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>)
2022-10-04 05:49:03,221 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>
2022-10-04 05:49:03,936 [Thread-250] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=250, target=localhost:33335}}. 
2022-10-04 05:49:03,937 [grpc-default-executor-6] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 18-UnorderedRequestStreamObserver18: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:49:03,937 [Thread-250] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #1, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
2022-10-04 05:49:04,037 [timer1] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
2022-10-04 05:49:04,038 [s0-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(826)) - s0@group-FB6BB5C9A9B3: receive client request(RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>)
2022-10-04 05:49:04,038 [s0-client-thread2] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(427)) - s0@group-FB6BB5C9A9B3-LeaderStateImpl: addWatchRequest RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>
2022-10-04 05:49:04,084 [Time-limited test] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=264, target=localhost:33335}}. 
2022-10-04 05:49:04,085 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(143)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:49:04,085 [Time-limited test] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(144)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
java.util.concurrent.TimeoutException
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1886)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2021)
	at org.apache.ratis.WatchRequestTests$WatchReplies.get(WatchRequestTests.java:205)
	at org.apache.ratis.WatchRequestTests$WatchReplies.getMajorityCommitted(WatchRequestTests.java:191)
	at org.apache.ratis.WatchRequestTests.checkMajority(WatchRequestTests.java:279)
	at org.apache.ratis.WatchRequestTests.runTestWatchRequestAsyncChangeLeader(WatchRequestTests.java:356)
	at org.apache.ratis.WatchRequestTests.runTest(WatchRequestTests.java:149)
	at org.apache.ratis.WatchRequestTests.lambda$testWatchRequestAsyncChangeLeader$6(WatchRequestTests.java:333)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.WatchRequestTests.testWatchRequestAsyncChangeLeader(WatchRequestTests.java:332)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - *** 
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(833)) - ***     Stopping MiniRaftClusterWithGrpc
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(834)) - *** 
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(835)) - ************************************************************** 
2022-10-04 05:49:04,086 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c56, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-FB6BB5C9A9B3:t4, leader=s0, voted=s0, raftlog=Memoized:s2@group-FB6BB5C9A9B3-SegmentedRaftLog:OPENED:c24, conf=23: peers:[s0|rpc:localhost:40977|admin:localhost:40429|client:localhost:33335|dataStream:localhost:41841|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:46653|admin:localhost:35421|client:localhost:42417|dataStream:localhost:33181|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:32897|admin:localhost:35395|client:localhost:36881|dataStream:localhost:41205|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-10-04 05:49:04,088 [MiniRaftCluster-1] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(412)) - s0: close
2022-10-04 05:49:04,089 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-10-04 05:49:04,089 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(461)) - s0@group-FB6BB5C9A9B3: shutdown
2022-10-04 05:49:04,089 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s0
2022-10-04 05:49:04,089 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-FB6BB5C9A9B3-LeaderStateImpl
2022-10-04 05:49:04,089 [s0-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-FB6BB5C9A9B3-PendingRequests: sendNotLeaderResponses
2022-10-04 05:49:04,089 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,090 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,090 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,093 [s0@group-FB6BB5C9A9B3->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-FB6BB5C9A9B3->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:49:04,093 [s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-FB6BB5C9A9B3->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-10-04 05:49:04,093 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:49:04,094 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#173-t4,previous=(t:4, i:55),leaderCommit=53,initializing? true,entries: size=1, first=(t:4, i:56), METADATAENTRY(c:53)
2022-10-04 05:49:04,094 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:49:04,094 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s1: nextIndex: updateUnconditionally 57 -> 56
2022-10-04 05:49:04,094 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#481-t4,previous=(t:4, i:55),leaderCommit=53,initializing? true,entries: size=1, first=(t:4, i:56), METADATAENTRY(c:53)
2022-10-04 05:49:04,094 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-10-04 05:49:04,094 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:49:04,095 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s1: nextIndex: updateUnconditionally 56 -> 55
2022-10-04 05:49:04,095 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:49:04,095 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 57 -> 25
2022-10-04 05:49:04,095 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-FB6BB5C9A9B3->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-10-04 05:49:04,095 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-FB6BB5C9A9B3->s2: nextIndex: updateUnconditionally 25 -> 24
2022-10-04 05:49:04,097 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,097 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(154)) - s0@group-FB6BB5C9A9B3-StateMachineUpdater: set stopIndex = 56
2022-10-04 05:49:04,097 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,097 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(412)) - s0@group-FB6BB5C9A9B3: applyIndex: 56
2022-10-04 05:49:04,098 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,092 [MiniRaftCluster-2] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(412)) - s1: close
2022-10-04 05:49:04,098 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(461)) - s1@group-FB6BB5C9A9B3: shutdown
2022-10-04 05:49:04,098 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s1
2022-10-04 05:49:04,098 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:49:04,098 [MiniRaftCluster-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s1 Close channels
2022-10-04 05:49:04,098 [s1@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:49:04,093 [MiniRaftCluster-3] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(412)) - s2: close
2022-10-04 05:49:04,099 [Thread-275] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:04,099 [Thread-275] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,109 [Thread-275] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,109 [Thread-275] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,109 [Thread-275] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s0, newLeader=s2
2022-10-04 05:49:04,109 [Thread-275] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s0 to s2 ex=org.apache.ratis.protocol.exceptions.NotLeaderException
2022-10-04 05:49:04,109 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=63, seq=20, RW, m7 with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s0: Stream close: no reply for async request cid=63
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,108 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(461)) - s2@group-FB6BB5C9A9B3: shutdown
2022-10-04 05:49:04,108 [Thread-278] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:04,111 [Thread-278] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-278] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-278] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-278] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:04,115 [Thread-278] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), null
2022-10-04 05:49:04,108 [Thread-277] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #10 receive~ null
2022-10-04 05:49:04,115 [Thread-277] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #10 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-277] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-277] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,115 [Thread-277] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:04,115 [Thread-277] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #10, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), null
2022-10-04 05:49:04,108 [s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(329)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-10-04 05:49:04,104 [Thread-276] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #5 receive~ null
2022-10-04 05:49:04,116 [Thread-276] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #5 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,116 [Thread-276] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,116 [Thread-276] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,116 [Thread-276] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:04,116 [Thread-276] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #5, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=81, seq=0, Watch-ALL(27), null
2022-10-04 05:49:04,103 [MiniRaftCluster-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s2 Close channels
2022-10-04 05:49:04,099 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-10-04 05:49:04,098 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(154)) - s1@group-FB6BB5C9A9B3-StateMachineUpdater: set stopIndex = 56
2022-10-04 05:49:04,116 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(412)) - s1@group-FB6BB5C9A9B3: applyIndex: 56
2022-10-04 05:49:04,117 [s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(329)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-10-04 05:49:04,117 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-10-04 05:49:04,117 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s0: shutdown server GrpcServerProtocolService now
2022-10-04 05:49:04,098 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-10-04 05:49:04,103 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,102 [grpc-default-executor-6] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 21-UnorderedRequestStreamObserver21: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:49:04,102 [grpc-default-executor-7] WARN  server.GrpcClientProtocolService (LogUtils.java:warn(122)) - 10-UnorderedRequestStreamObserver10: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-10-04 05:49:04,118 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,118 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, seq=0, Watch-ALL(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=93, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,118 [Thread-279] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #6 receive~ null
2022-10-04 05:49:04,118 [Thread-279] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #6 failed~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,118 [Thread-279] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null with {}
org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:384)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:320)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:315)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:452)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,118 [Thread-279] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleNotLeaderException(RaftClientImpl.java:348)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:109)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,111 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB6BB5C9A9B3,id=s2
2022-10-04 05:49:04,111 [timer7] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:404)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$3(GrpcClientProtocolClient.java:170)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:170)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:268)
	at java.base/java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:986)
	at java.base/java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:970)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:383)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:388)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:383)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,118 [timer7] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:04,119 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
2022-10-04 05:49:04,110 [Thread-275] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=77, seq=0, Watch-ALL(25), null
2022-10-04 05:49:04,122 [MiniRaftCluster-3] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s0 Close channels
2022-10-04 05:49:04,120 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s0: shutdown server GrpcServerProtocolService successfully
2022-10-04 05:49:04,120 [MiniRaftCluster-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s0 Close channels
2022-10-04 05:49:04,120 [timer7] ERROR client.GrpcClientRpc (GrpcClientRpc.java:sendRequestAsyncUnordered(85)) - client-E5C30A31B423: Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,120 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(242)) - s1@group-FB6BB5C9A9B3-SegmentedRaftLogWorker close()
2022-10-04 05:49:04,120 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(242)) - s0@group-FB6BB5C9A9B3-SegmentedRaftLogWorker close()
2022-10-04 05:49:04,118 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-FB6BB5C9A9B3-FollowerState
2022-10-04 05:49:04,124 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(154)) - s2@group-FB6BB5C9A9B3-StateMachineUpdater: set stopIndex = 24
2022-10-04 05:49:04,124 [s2@group-FB6BB5C9A9B3-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-FB6BB5C9A9B3-FollowerState was interrupted
2022-10-04 05:49:04,118 [Thread-279] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s0,  curLeader=s2, newLeader=null
2022-10-04 05:49:04,118 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=97, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,124 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:49:04,124 [timer7] ERROR client.GrpcClientRpc (GrpcClientRpc.java:sendRequestAsyncUnordered(85)) - client-E5C30A31B423: Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,123 [MiniRaftCluster-3] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s1 Close channels
2022-10-04 05:49:04,123 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-10-04 05:49:04,124 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,125 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,125 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,126 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,126 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, seq=0, Watch-ALL_COMMITTED(27), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=83, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,126 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,126 [Thread-280] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:04,126 [Thread-280] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,126 [Thread-280] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,126 [Thread-280] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,129 [Thread-280] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s2, newLeader=s1
2022-10-04 05:49:04,131 [Thread-280] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s2 to s1 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:49:04,131 [Thread-280] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=98, seq=0, Watch-MAJORITY_COMMITTED(31), null
2022-10-04 05:49:04,129 [Thread-281] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:04,129 [MiniRaftCluster-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(111)) - s2 Close channels
2022-10-04 05:49:04,129 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #2 send~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-10-04 05:49:04,127 [Thread-279] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #6, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), null
2022-10-04 05:49:04,127 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-10-04 05:49:04,132 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s2: shutdown server GrpcServerProtocolService now
2022-10-04 05:49:04,127 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-10-04 05:49:04,126 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=91, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,132 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,133 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,133 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, seq=0, Watch-ALL_COMMITTED(30), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=95, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,133 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,129 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(412)) - s2@group-FB6BB5C9A9B3: applyIndex: 24
2022-10-04 05:49:04,135 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,134 [Thread-281] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,134 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-10-04 05:49:04,136 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s1: shutdown server GrpcServerProtocolService now
2022-10-04 05:49:04,136 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s1: shutdown server GrpcServerProtocolService successfully
2022-10-04 05:49:04,136 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-10-04 05:49:04,133 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #3 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:49:04,136 [Thread-281] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,136 [Thread-281] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,136 [Thread-281] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s1, newLeader=null
2022-10-04 05:49:04,139 [timer7] ERROR client.GrpcClientRpc (GrpcClientRpc.java:sendRequestAsyncUnordered(85)) - client-E5C30A31B423: Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,140 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-10-04 05:49:04,143 [s2-server-thread4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#96-t4,previous=(t:4, i:24),leaderCommit=24,initializing? true,entries: size=1, first=(t:4, i:25), STATEMACHINELOGENTRY, 56@client-E5C30A31B423
java.util.concurrent.CompletionException: java.io.InterruptedIOException: s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker-flushStateMachineData interrupted.
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:515)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:312)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.InterruptedIOException: s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker-flushStateMachineData interrupted.
	at org.apache.ratis.util.IOUtils.toInterruptedIOException(IOUtils.java:49)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:83)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:364)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:60)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:546)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:303)
	... 1 more
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:385)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2022)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 6 more
2022-10-04 05:49:04,161 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(242)) - s2@group-FB6BB5C9A9B3-SegmentedRaftLogWorker close()
2022-10-04 05:49:04,160 [Thread-283] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #2 receive~ null
2022-10-04 05:49:04,154 [Thread-282] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #3 receive~ null
2022-10-04 05:49:04,163 [Thread-282] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #3 failed~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,163 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:115)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsyncUnordered(GrpcClientRpc.java:81)
	at org.apache.ratis.client.impl.UnorderedAsync.sendRequestWithRetry(UnorderedAsync.java:77)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$2(UnorderedAsync.java:126)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
2022-10-04 05:49:04,163 [Thread-282] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,164 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s1,  curLeader=s1, newLeader=s0
2022-10-04 05:49:04,164 [Thread-282] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(391)) - group-FB6BB5C9A9B3 client-E5C30A31B423: client change Leader from s1 to s0 ex=org.apache.ratis.protocol.exceptions.AlreadyClosedException
2022-10-04 05:49:04,164 [Thread-282] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=91, seq=0, Watch-ALL_COMMITTED(29), null
2022-10-04 05:49:04,147 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s2: shutdown server GrpcServerProtocolService successfully
2022-10-04 05:49:04,147 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #8 send~ RaftClientRequest:client-E5C30A31B423->s1@group-FB6BB5C9A9B3, cid=97, seq=0, Watch-ALL(31), null
2022-10-04 05:49:04,146 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,164 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,164 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), Message:<EMPTY>, reply=RaftClientReply:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-FB6BB5C9A9B3 is not the leader, logIndex=0, commits[s0:c56]
2022-10-04 05:49:04,143 [JvmPauseMonitor1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(111)) - JvmPauseMonitor-s1: Stopped
2022-10-04 05:49:04,165 [JvmPauseMonitor0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(111)) - JvmPauseMonitor-s0: Stopped
2022-10-04 05:49:04,164 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(319)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-10-04 05:49:04,167 [Thread-283] TRACE impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(101)) - client-E5C30A31B423: attempt #2 failed~ RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s2: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,168 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(328)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-10-04 05:49:04,168 [Thread-281] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #3, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=79, seq=0, Watch-ALL_COMMITTED(25), null
2022-10-04 05:49:04,168 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #6 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=89, seq=0, Watch-ALL(29), null
2022-10-04 05:49:04,170 [Thread-283] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(366)) - client-E5C30A31B423: suggested new leader: null. Failed RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null with {}
org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-E5C30A31B423->s2: Stream close: no reply for async request cid=87
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:406)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.close(GrpcClientProtocolClient.java:393)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$500(GrpcClientProtocolClient.java:310)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$close$4(GrpcClientProtocolClient.java:171)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.close(GrpcClientProtocolClient.java:171)
	at org.apache.ratis.util.PeerProxyMap.closeProxy(PeerProxyMap.java:175)
	at org.apache.ratis.util.PeerProxyMap.lambda$resetProxy$2(PeerProxyMap.java:150)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.util.PeerProxyMap.resetProxy(PeerProxyMap.java:150)
	at org.apache.ratis.util.PeerProxyMap.handleException(PeerProxyMap.java:156)
	at org.apache.ratis.client.impl.RaftClientRpcWithProxy.handleException(RaftClientRpcWithProxy.java:48)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:395)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,170 [Thread-283] TRACE client.RaftClient (RaftClientImpl.java:handleIOException(369)) - Stack trace
java.lang.Throwable: TRACE
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:369)
	at org.apache.ratis.client.impl.RaftClientImpl.handleIOException(RaftClientImpl.java:361)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:114)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:478)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-10-04 05:49:04,170 [Thread-283] DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(385)) - client-E5C30A31B423: oldLeader=s2,  curLeader=s0, newLeader=null
2022-10-04 05:49:04,170 [Thread-283] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(124)) - schedule retry for attempt #2, policy=RetryForeverWithSleep(sleepTime = 100ms), request=RaftClientRequest:client-E5C30A31B423->s2@group-FB6BB5C9A9B3, cid=87, seq=0, Watch-ALL_COMMITTED(28), null
2022-10-04 05:49:04,171 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #7 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=85, seq=0, Watch-ALL(28), null
2022-10-04 05:49:04,171 [timer7] DEBUG impl.UnorderedAsync (UnorderedAsync.java:sendRequestWithRetry(76)) - client-E5C30A31B423: attempt #12 send~ RaftClientRequest:client-E5C30A31B423->s0@group-FB6BB5C9A9B3, cid=99, seq=0, Watch-ALL_COMMITTED(31), null
2022-10-04 05:49:04,172 [JvmPauseMonitor2] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(111)) - JvmPauseMonitor-s2: Stopped
2022-10-04 05:49:04,173 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(855)) - MiniRaftClusterWithGrpc shutdown completed
2022-10-04 05:49:04,183 [Thread-285] DEBUG impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(79)) - client-E5C30A31B423: attempt #12 receive~ null
]]></system-out>
    <system-err><![CDATA[SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/runner/.m2/repository/org/slf4j/slf4j-simple/1.7.29/slf4j-simple-1.7.29.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
]]></system-err>
  </testcase>
  <testcase name="testWatchRequestAsync" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="7.058"/>
  <testcase name="testWatchRequestTimeout" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="4.304"/>
  <testcase name="testWatchRequestClientTimeout" classname="org.apache.ratis.grpc.TestWatchRequestWithGrpc" time="3.583"/>
</testsuite>