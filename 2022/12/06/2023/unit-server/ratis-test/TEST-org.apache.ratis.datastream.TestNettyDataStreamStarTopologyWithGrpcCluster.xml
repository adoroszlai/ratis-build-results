<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="383.535" tests="4" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="java.specification.version" value="11"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.3/ratis-thirdparty-misc-1.0.3.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.70/bcprov-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.70/bcpkix-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.70/bcutil-jdk15on-1.70.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:"/>
    <property name="java.vm.vendor" value="Eclipse Adoptium"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="11"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-11-jdk-amd64/lib"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter10877484976428363857.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2022-12-06T13-01-12_216-jvmRun1 surefire15082368732638227792tmp surefire_416717656680019239656tmp"/>
    <property name="jdk.debug" value="release"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.3/ratis-thirdparty-misc-1.0.3.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.70/bcprov-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.70/bcpkix-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.70/bcutil-jdk15on-1.70.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.version.date" value="2022-10-18"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-11-jdk-amd64"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="java.vm.compressedOopsMode" value="32-bit"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter10877484976428363857.jar"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="11.0.17+8"/>
    <property name="user.name" value="runner"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.15.0-1023-azure"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.version" value="Temurin-11.0.17+8"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="11.0.17"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Eclipse Adoptium"/>
    <property name="java.vm.version" value="11.0.17+8"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="55.0"/>
  </properties>
  <testcase name="testMultipleStreamsSingleServer" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="15.009"/>
  <testcase name="testMultipleStreamsMultipleServers" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="63.245"/>
  <testcase name="testMultipleStreamsMultipleServersStepDownLeader" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="300.024">
    <error message="test timed out after 300 seconds" type="org.junit.runners.model.TestTimedOutException">org.junit.runners.model.TestTimedOutException: test timed out after 300 seconds
	at java.base@11.0.17/jdk.internal.misc.Unsafe.park(Native Method)
	at java.base@11.0.17/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture$Signaller.block(CompletableFuture.java:1796)
	at java.base@11.0.17/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3128)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture.waitingGet(CompletableFuture.java:1823)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture.join(CompletableFuture.java:2043)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests$$Lambda$516/0x0000000100342440.apply(Unknown Source)
	at java.base@11.0.17/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)
	at java.base@11.0.17/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1655)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)
	at java.base@11.0.17/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base@11.0.17/java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:558)
	at java.base@11.0.17/java.util.stream.ReferencePipeline.max(ReferencePipeline.java:594)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:97)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStreamStepDownLeader(DataStreamAsyncClusterTests.java:82)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests$$Lambda$951/0x00000001004a4840.accept(Unknown Source)
	at app//org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at app//org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsMultipleServersStepDownLeader(DataStreamAsyncClusterTests.java:78)
	at java.base@11.0.17/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base@11.0.17/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base@11.0.17/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base@11.0.17/java.lang.reflect.Method.invoke(Method.java:566)
	at app//org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at app//org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at app//org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at app//org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at app//org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at app//org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at app//org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at app//org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base@11.0.17/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base@11.0.17/java.lang.Thread.run(Thread.java:829)
</error>
    <system-out><![CDATA[2022-12-06 13:03:15,929 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2022-12-06 13:03:15,929 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2022-12-06 13:03:15,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty with group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2022-12-06 13:03:15,970 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER], format? true
2022-12-06 13:03:15,970 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(186)) - deleteFully target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0
2022-12-06 13:03:15,971 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(202)) - deleteFully: target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0 does not exist.
2022-12-06 13:03:15,971 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0
2022-12-06 13:03:15,971 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 42117 (custom)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 39843 (custom)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-12-06 13:03:15,971 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 40727 (custom)
2022-12-06 13:03:15,971 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-12-06 13:03:15,972 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:15,973 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:15,973 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-12-06 13:03:15,973 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:15,975 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-12-06 13:03:15,975 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-12-06 13:03:15,975 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-12-06 13:03:15,975 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-12-06 13:03:15,976 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-12-06 13:03:15,979 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-12-06 13:03:15,980 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2022-12-06 13:03:15,980 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 39837 (custom)
2022-12-06 13:03:15,985 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-12-06 13:03:15,986 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-12-06 13:03:15,986 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:15,986 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:15,986 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0] (custom)
2022-12-06 13:03:15,986 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55] REGISTERED
2022-12-06 13:03:15,990 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55] BIND: 0.0.0.0/0.0.0.0:39837
2022-12-06 13:03:15,990 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] ACTIVE
2022-12-06 13:03:15,988 [pool-10-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s0: new RaftServerImpl for group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2022-12-06 13:03:15,988 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s0: addNew group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] returns group-BD1198AD89EB:java.util.concurrent.CompletableFuture@1012d72d[Not completed]
2022-12-06 13:03:15,992 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-12-06 13:03:15,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER], format? true
2022-12-06 13:03:15,997 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(186)) - deleteFully target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1
2022-12-06 13:03:15,997 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(202)) - deleteFully: target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1 does not exist.
2022-12-06 13:03:15,997 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1
2022-12-06 13:03:15,997 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 46153 (custom)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 44441 (custom)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-12-06 13:03:15,997 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 35713 (custom)
2022-12-06 13:03:15,997 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-12-06 13:03:15,998 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:15,999 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-12-06 13:03:15,999 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-12-06 13:03:16,000 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-12-06 13:03:16,000 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2022-12-06 13:03:16,002 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 35971 (custom)
2022-12-06 13:03:16,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-12-06 13:03:16,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-12-06 13:03:16,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:16,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:16,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1] (custom)
2022-12-06 13:03:16,003 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b] REGISTERED
2022-12-06 13:03:16,005 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b] BIND: 0.0.0.0/0.0.0.0:35971
2022-12-06 13:03:16,005 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] ACTIVE
2022-12-06 13:03:16,004 [pool-11-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s1: new RaftServerImpl for group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2022-12-06 13:03:16,003 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s1: addNew group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] returns group-BD1198AD89EB:java.util.concurrent.CompletableFuture@18beec34[Not completed]
2022-12-06 13:03:16,003 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-BD1198AD89EB: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-12-06 13:03:16,006 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-12-06 13:03:16,007 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-12-06 13:03:16,008 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:16,008 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-12-06 13:03:16,008 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-12-06 13:03:16,008 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-12-06 13:03:16,008 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-12-06 13:03:16,010 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER], format? true
2022-12-06 13:03:16,014 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(186)) - deleteFully target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2
2022-12-06 13:03:16,014 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(202)) - deleteFully: target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2 does not exist.
2022-12-06 13:03:16,014 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2
2022-12-06 13:03:16,015 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 37429 (custom)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 41515 (custom)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 34381 (custom)
2022-12-06 13:03:16,015 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-12-06 13:03:16,015 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:16,016 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-12-06 13:03:16,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-12-06 13:03:16,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-12-06 13:03:16,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-12-06 13:03:16,017 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-12-06 13:03:16,017 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-12-06 13:03:16,010 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-BD1198AD89EB: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-12-06 13:03:16,025 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-12-06 13:03:16,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:16,029 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-12-06 13:03:16,029 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-12-06 13:03:16,029 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-12-06 13:03:16,029 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-12-06 13:03:16,020 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-12-06 13:03:16,030 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-12-06 13:03:16,030 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2022-12-06 13:03:16,030 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 42945 (custom)
2022-12-06 13:03:16,036 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-12-06 13:03:16,036 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-12-06 13:03:16,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:16,037 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7] REGISTERED
2022-12-06 13:03:16,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:16,037 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7] BIND: 0.0.0.0/0.0.0.0:42945
2022-12-06 13:03:16,037 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] ACTIVE
2022-12-06 13:03:16,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2] (custom)
2022-12-06 13:03:16,050 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s2: addNew group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] returns group-BD1198AD89EB:java.util.concurrent.CompletableFuture@52ce54ac[Not completed]
2022-12-06 13:03:16,051 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-12-06 13:03:16,051 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-12-06 13:03:16,051 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0] (custom)
2022-12-06 13:03:16,052 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb does not exist. Creating ...
2022-12-06 13:03:16,052 [pool-12-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s2: new RaftServerImpl for group-BD1198AD89EB:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2022-12-06 13:03:16,052 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-12-06 13:03:16,054 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/in_use.lock acquired by nodename 2287@fv-az186-476
2022-12-06 13:03:16,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-12-06 13:03:16,054 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current
2022-12-06 13:03:16,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-12-06 13:03:16,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-12-06 13:03:16,055 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/sm
2022-12-06 13:03:16,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-12-06 13:03:16,055 [pool-12-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-BD1198AD89EB: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-12-06 13:03:16,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-12-06 13:03:16,056 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb has been successfully formatted.
2022-12-06 13:03:16,056 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2022-12-06 13:03:16,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-12-06 13:03:16,057 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-12-06 13:03:16,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-12-06 13:03:16,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,057 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-12-06 13:03:16,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-12-06 13:03:16,057 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-12-06 13:03:16,057 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-BD1198AD89EB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-12-06 13:03:16,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-12-06 13:03:16,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-12-06 13:03:16,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,059 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:16,059 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-12-06 13:03:16,059 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-12-06 13:03:16,059 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-12-06 13:03:16,059 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-12-06 13:03:16,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-12-06 13:03:16,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-12-06 13:03:16,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-12-06 13:03:16,060 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,060 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,067 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s0@group-BD1198AD89EB: start as a follower, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,067 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-12-06 13:03:16,067 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,070 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BD1198AD89EB,id=s0
2022-12-06 13:03:16,070 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-12-06 13:03:16,070 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-12-06 13:03:16,070 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-12-06 13:03:16,071 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,074 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s0: start RPC server
2022-12-06 13:03:16,074 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,076 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 39843
2022-12-06 13:03:16,087 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 40727
2022-12-06 13:03:16,088 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 42117
2022-12-06 13:03:16,097 [JvmPauseMonitor4] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s0: Started
2022-12-06 13:03:16,098 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-12-06 13:03:16,098 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-12-06 13:03:16,098 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1] (custom)
2022-12-06 13:03:16,098 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb does not exist. Creating ...
2022-12-06 13:03:16,098 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,100 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/in_use.lock acquired by nodename 2287@fv-az186-476
2022-12-06 13:03:16,100 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current
2022-12-06 13:03:16,100 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/sm
2022-12-06 13:03:16,101 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb has been successfully formatted.
2022-12-06 13:03:16,101 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-12-06 13:03:16,101 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-12-06 13:03:16,101 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,102 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-BD1198AD89EB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,103 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-12-06 13:03:16,104 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,105 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-12-06 13:03:16,105 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-12-06 13:03:16,105 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-12-06 13:03:16,105 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,105 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,109 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s1@group-BD1198AD89EB: start as a follower, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,110 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-12-06 13:03:16,110 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,112 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BD1198AD89EB,id=s1
2022-12-06 13:03:16,112 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-12-06 13:03:16,112 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-12-06 13:03:16,113 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-12-06 13:03:16,117 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,121 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,119 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s1: start RPC server
2022-12-06 13:03:16,123 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 44441
2022-12-06 13:03:16,124 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 35713
2022-12-06 13:03:16,127 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 46153
2022-12-06 13:03:16,134 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-12-06 13:03:16,134 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-12-06 13:03:16,134 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2] (custom)
2022-12-06 13:03:16,135 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb does not exist. Creating ...
2022-12-06 13:03:16,135 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,135 [JvmPauseMonitor5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s1: Started
2022-12-06 13:03:16,136 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/in_use.lock acquired by nodename 2287@fv-az186-476
2022-12-06 13:03:16,136 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current
2022-12-06 13:03:16,136 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/sm
2022-12-06 13:03:16,137 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb has been successfully formatted.
2022-12-06 13:03:16,137 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-12-06 13:03:16,137 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-12-06 13:03:16,137 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,137 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-BD1198AD89EB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-12-06 13:03:16,138 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-12-06 13:03:16,139 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2022-12-06 13:03:16,140 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-12-06 13:03:16,140 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,140 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-12-06 13:03:16,145 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s2@group-BD1198AD89EB: start as a follower, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,145 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-12-06 13:03:16,145 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,146 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BD1198AD89EB,id=s2
2022-12-06 13:03:16,146 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-12-06 13:03:16,146 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-12-06 13:03:16,146 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-12-06 13:03:16,146 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,146 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s2: start RPC server
2022-12-06 13:03:16,157 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,160 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 41515
2022-12-06 13:03:16,168 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 34381
2022-12-06 13:03:16,171 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 37429
2022-12-06 13:03:16,174 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s2: Started
2022-12-06 13:03:16,174 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,174 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,174 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:90)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStreamStepDownLeader(DataStreamAsyncClusterTests.java:82)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsMultipleServersStepDownLeader(DataStreamAsyncClusterTests.java:78)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-12-06 13:03:16,300 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:190327789ns, electionTimeout:179ms
2022-12-06 13:03:16,301 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,301 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-12-06 13:03:16,302 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:16,302 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-LeaderElection3
2022-12-06 13:03:16,303 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-BD1198AD89EB-LeaderElection3 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,305 [s1@group-BD1198AD89EB-LeaderElection3-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-12-06 13:03:16,308 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,310 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,308 [s1@group-BD1198AD89EB-LeaderElection3-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-12-06 13:03:16,313 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s1, group-BD1198AD89EB, 0, (t:0, i:0))
2022-12-06 13:03:16,314 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:16,314 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,316 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-BD1198AD89EB-LeaderElection3: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:16,316 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t0
2022-12-06 13:03:16,316 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-BD1198AD89EB-LeaderElection3 PRE_VOTE round 0: result PASSED
2022-12-06 13:03:16,317 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-BD1198AD89EB-LeaderElection3 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,327 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,327 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,329 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(ELECTION, s1, group-BD1198AD89EB, 1, (t:0, i:0))
2022-12-06 13:03:16,338 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:16,338 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s1
2022-12-06 13:03:16,338 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,338 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s1, group-BD1198AD89EB, 0, (t:0, i:0))
2022-12-06 13:03:16,339 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,339 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:16,339 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-BD1198AD89EB:t0, leader=null, voted=, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,346 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(ELECTION, s1, group-BD1198AD89EB, 1, (t:0, i:0))
2022-12-06 13:03:16,346 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:16,346 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s1
2022-12-06 13:03:16,347 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,347 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-BD1198AD89EB-FollowerState was interrupted
2022-12-06 13:03:16,347 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:16,348 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to ELECTION vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-BD1198AD89EB:t1, leader=null, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,349 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,350 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-BD1198AD89EB-LeaderElection3: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:16,349 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:shouldRun(117)) - s0@group-BD1198AD89EB-FollowerState: Stopping now (isRunning? false, role = FOLLOWER)
2022-12-06 13:03:16,358 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t1
2022-12-06 13:03:16,358 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-BD1198AD89EB-LeaderElection3 ELECTION round 0: result PASSED
2022-12-06 13:03:16,358 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-BD1198AD89EB-LeaderElection3
2022-12-06 13:03:16,350 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,358 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to ELECTION vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-BD1198AD89EB:t1, leader=null, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,358 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2022-12-06 13:03:16,358 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from null to s1 at term 1 for becomeLeader, leader elected after 333ms
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-12-06 13:03:16,358 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2022-12-06 13:03:16,359 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:16,360 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2022-12-06 13:03:16,360 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:16,361 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:16,362 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:16,362 [s1@group-BD1198AD89EB-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:16,362 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:16,362 [s1@group-BD1198AD89EB-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:16,362 [s1@group-BD1198AD89EB-LeaderElection3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Starting segment from index:0
2022-12-06 13:03:16,370 [s1@group-BD1198AD89EB-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s1@group-BD1198AD89EB: set configuration 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,373 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0
2022-12-06 13:03:16,382 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from null to s1 at term 1 for appendEntries, leader elected after 376ms
2022-12-06 13:03:16,392 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s0@group-BD1198AD89EB: set configuration 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,392 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Starting segment from index:0
2022-12-06 13:03:16,406 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0
2022-12-06 13:03:16,412 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s1 at term 1 for appendEntries, leader elected after 357ms
2022-12-06 13:03:16,417 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s2@group-BD1198AD89EB: set configuration 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:16,417 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Starting segment from index:0
2022-12-06 13:03:16,434 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0
2022-12-06 13:03:16,625 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,626 [pool-9-thread-3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,626 [pool-9-thread-4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,628 [pool-9-thread-6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,627 [pool-9-thread-7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,626 [pool-9-thread-5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,629 [pool-9-thread-8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,633 [pool-9-thread-4] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,633 [pool-9-thread-9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-12-06 13:03:16,633 [pool-9-thread-4] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,635 [pool-9-thread-4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,635 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,635 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,635 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,635 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,637 [pool-9-thread-6] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,642 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream376
2022-12-06 13:03:16,639 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x7964b591, L:/127.0.0.1:39837 - R:/127.0.0.1:49340]
2022-12-06 13:03:16,637 [pool-9-thread-9] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,659 [pool-9-thread-9] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,659 [pool-9-thread-9] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,659 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,659 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,660 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,660 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,661 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream380
2022-12-06 13:03:16,637 [pool-9-thread-3] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,662 [pool-9-thread-3] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,663 [pool-9-thread-3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,663 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,663 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,663 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,663 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,637 [pool-9-thread-5] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,681 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream382
2022-12-06 13:03:16,682 [pool-9-thread-5] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,682 [pool-9-thread-5] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,683 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,683 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,683 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,683 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,684 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x1150a5fe, L:/127.0.0.1:42945 - R:/127.0.0.1:59146]
2022-12-06 13:03:16,681 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream379
2022-12-06 13:03:16,680 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,661 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream381
2022-12-06 13:03:16,652 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream378
2022-12-06 13:03:16,647 [pool-9-thread-6] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,706 [pool-9-thread-6] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,706 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,706 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,706 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,706 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,644 [pool-9-thread-7] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,751 [pool-9-thread-7] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,751 [pool-9-thread-7] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,752 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,752 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,752 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,752 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,644 [pool-9-thread-8] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,753 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,644 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream377
2022-12-06 13:03:16,752 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,754 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,754 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,754 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,754 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,736 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:16,726 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x7170cc25, L:/127.0.0.1:39837 - R:/127.0.0.1:49356]
2022-12-06 13:03:16,707 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x4de41418, L:/127.0.0.1:35971 - R:/127.0.0.1:47972]
2022-12-06 13:03:16,756 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x89051034, L:/127.0.0.1:42945 - R:/127.0.0.1:59152]
2022-12-06 13:03:16,759 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,759 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,759 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,759 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,759 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,774 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:16,775 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,775 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,775 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,776 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,776 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,776 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:16,777 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,778 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,778 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,779 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,779 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,785 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,786 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x895046d9, L:/127.0.0.1:39837 - R:/127.0.0.1:49362]
2022-12-06 13:03:16,786 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,799 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x878fc1d2, L:/127.0.0.1:39837 - R:/127.0.0.1:49366]
2022-12-06 13:03:16,800 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x8e24ae61, L:/127.0.0.1:35971 - R:/127.0.0.1:47974]
2022-12-06 13:03:16,802 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,802 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,802 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,802 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,802 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,806 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,806 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,806 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,807 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,807 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,814 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:16,814 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0xfe1f069a, L:/127.0.0.1:35971 - R:/127.0.0.1:47986]
2022-12-06 13:03:16,815 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,815 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,815 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,815 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,815 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,818 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x312a7ae4, L:/127.0.0.1:35971 - R:/127.0.0.1:47992]
2022-12-06 13:03:16,820 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:16,820 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,827 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x030ecfb2, L:/127.0.0.1:39837 - R:/127.0.0.1:49368]
2022-12-06 13:03:16,827 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,827 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,827 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,827 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,827 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,827 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,829 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xa7d33e1f, L:/127.0.0.1:39837 - R:/127.0.0.1:49372]
2022-12-06 13:03:16,829 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,830 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,830 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,830 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,830 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,830 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,838 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x232722c1, L:/127.0.0.1:39837 - R:/127.0.0.1:49384]
2022-12-06 13:03:16,838 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,839 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,839 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,839 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,839 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,839 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,840 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,840 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,840 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,840 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,840 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,841 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x19f2685c, L:/127.0.0.1:39837 - R:/127.0.0.1:49390]
2022-12-06 13:03:16,841 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:16,841 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:16,842 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:16,842 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:16,842 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:16,842 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:16,843 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x370c92bf, L:/127.0.0.1:42945 - R:/127.0.0.1:59158]
2022-12-06 13:03:16,844 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x2537dbaf, L:/127.0.0.1:35971 - R:/127.0.0.1:48008]
2022-12-06 13:03:16,845 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:16,850 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0xb62568c6, L:/127.0.0.1:35971 - R:/127.0.0.1:48014]
2022-12-06 13:03:16,850 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:16,852 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,012 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:203622814ns, electionTimeout:158ms
2022-12-06 13:03:17,016 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:17,016 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-12-06 13:03:17,016 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:17,016 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderElection4
2022-12-06 13:03:17,012 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,016 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,016 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,017 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,017 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,011 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,017 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,017 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,017 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,018 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,010 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,018 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,018 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,018 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,018 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,019 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x7b9beebf, L:/127.0.0.1:42945 - R:/127.0.0.1:59162]
2022-12-06 13:03:17,031 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,032 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,032 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,032 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,032 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,038 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,038 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,038 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,038 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,038 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,042 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x19833254, L:/127.0.0.1:39837 - R:/127.0.0.1:49404]
2022-12-06 13:03:17,042 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,045 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,045 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,045 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,045 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,045 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,063 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x912cfbe3, L:/127.0.0.1:39837 - R:/127.0.0.1:49420]
2022-12-06 13:03:17,063 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,063 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,063 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,063 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,064 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,064 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,066 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x2c3fb9bb, L:/127.0.0.1:42945 - R:/127.0.0.1:59168]
2022-12-06 13:03:17,066 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,066 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x27f45db2, L:/127.0.0.1:42945 - R:/127.0.0.1:59174]
2022-12-06 13:03:17,066 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,073 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,073 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,073 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,073 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,074 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,073 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0xc15aa1f4, L:/127.0.0.1:35971 - R:/127.0.0.1:48022]
2022-12-06 13:03:17,074 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,076 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,076 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,076 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,077 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,077 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,077 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,077 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,077 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,078 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,078 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,080 [s0-server-thread3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2022-12-06 13:03:17,080 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-BD1198AD89EB-LeaderElection4
2022-12-06 13:03:17,081 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:17,081 [s0@group-BD1198AD89EB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:run(232)) - s0@group-BD1198AD89EB-LeaderElection4: skip running since this is already CLOSING
2022-12-06 13:03:17,089 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,089 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,089 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,089 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,089 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,095 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,095 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,095 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,096 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,096 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,097 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,097 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,097 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,098 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,098 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,101 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,101 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,101 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,101 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,101 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,102 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x08dc540c, L:/127.0.0.1:35971 - R:/127.0.0.1:48038]
2022-12-06 13:03:17,102 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,102 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xaf73cb03, L:/127.0.0.1:42945 - R:/127.0.0.1:59182]
2022-12-06 13:03:17,102 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x13af1c5e, L:/127.0.0.1:42945 - R:/127.0.0.1:59196]
2022-12-06 13:03:17,102 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,102 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x0cb731cb, L:/127.0.0.1:35971 - R:/127.0.0.1:48042]
2022-12-06 13:03:17,102 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,102 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x8401e1b3, L:/127.0.0.1:39837 - R:/127.0.0.1:49436]
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x65930563, L:/127.0.0.1:39837 - R:/127.0.0.1:49444]
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xb1d505b6, L:/127.0.0.1:39837 - R:/127.0.0.1:49458]
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,103 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,105 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x26616b74, L:/127.0.0.1:35971 - R:/127.0.0.1:48048]
2022-12-06 13:03:17,105 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,106 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,106 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,106 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,107 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,107 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,110 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x48768d9e, L:/127.0.0.1:39837 - R:/127.0.0.1:49470]
2022-12-06 13:03:17,110 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,111 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,111 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,111 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,111 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,111 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,114 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x94b2ee38, L:/127.0.0.1:35971 - R:/127.0.0.1:48060]
2022-12-06 13:03:17,115 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,117 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,117 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,117 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,117 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,117 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,118 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xd6f2564e, L:/127.0.0.1:39837 - R:/127.0.0.1:49486]
2022-12-06 13:03:17,118 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,119 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,119 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,119 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,119 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,119 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,121 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x34dcdc24, L:/127.0.0.1:42945 - R:/127.0.0.1:59204]
2022-12-06 13:03:17,121 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,124 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x603ba3d8, L:/127.0.0.1:42945 - R:/127.0.0.1:59210]
2022-12-06 13:03:17,124 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,125 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xd2bd6971, L:/127.0.0.1:39837 - R:/127.0.0.1:49488]
2022-12-06 13:03:17,125 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,125 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,125 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,125 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,125 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,125 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,130 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,130 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,130 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,130 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,130 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,134 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x9d406dc5, L:/127.0.0.1:35971 - R:/127.0.0.1:48070]
2022-12-06 13:03:17,134 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,135 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,135 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,135 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,135 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,135 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,148 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x222c7885, L:/127.0.0.1:35971 - R:/127.0.0.1:48086]
2022-12-06 13:03:17,148 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,150 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,150 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,150 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,150 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,150 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,151 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xd6a9e437, L:/127.0.0.1:39837 - R:/127.0.0.1:49502]
2022-12-06 13:03:17,151 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,152 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,152 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,152 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,152 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,152 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,153 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,153 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,153 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,153 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,154 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,158 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xf9fd854e, L:/127.0.0.1:42945 - R:/127.0.0.1:59222]
2022-12-06 13:03:17,158 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,160 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,160 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,160 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,160 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,160 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,162 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,162 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,162 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,162 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,162 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,163 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x21ad3b0b, L:/127.0.0.1:42945 - R:/127.0.0.1:59238]
2022-12-06 13:03:17,163 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,167 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x6002a8bc, L:/127.0.0.1:39837 - R:/127.0.0.1:49514]
2022-12-06 13:03:17,167 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,167 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,167 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,167 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,167 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,167 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,169 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xbbd4f091, L:/127.0.0.1:39837 - R:/127.0.0.1:49520]
2022-12-06 13:03:17,169 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,169 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,169 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,169 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,169 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,169 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,171 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x01fb12bb, L:/127.0.0.1:35971 - R:/127.0.0.1:48090]
2022-12-06 13:03:17,171 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,177 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x1a900b2b, L:/127.0.0.1:35971 - R:/127.0.0.1:48100]
2022-12-06 13:03:17,177 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,177 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x6ecf3f5b, L:/127.0.0.1:42945 - R:/127.0.0.1:59250]
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,178 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,180 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,180 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,181 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,181 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,181 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,181 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x4b644304, L:/127.0.0.1:35971 - R:/127.0.0.1:48104]
2022-12-06 13:03:17,182 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,182 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,182 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,182 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,183 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,183 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,184 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x5ec6fdd0, L:/127.0.0.1:39837 - R:/127.0.0.1:49532]
2022-12-06 13:03:17,184 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,184 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,184 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,184 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,184 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,184 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,185 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xb7981e6b, L:/127.0.0.1:42945 - R:/127.0.0.1:59260]
2022-12-06 13:03:17,185 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,186 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xdd7cd082, L:/127.0.0.1:42945 - R:/127.0.0.1:59262]
2022-12-06 13:03:17,186 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,186 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,186 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,186 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,186 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,186 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,187 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,187 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,187 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,187 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,187 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,201 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xe39d171e, L:/127.0.0.1:39837 - R:/127.0.0.1:49548]
2022-12-06 13:03:17,201 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,201 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,201 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,201 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,201 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,201 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,203 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x3b0d0237, L:/127.0.0.1:35971 - R:/127.0.0.1:48118]
2022-12-06 13:03:17,203 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,211 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x2c739808, L:/127.0.0.1:35971 - R:/127.0.0.1:48124]
2022-12-06 13:03:17,211 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,211 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,212 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,212 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,212 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,212 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,219 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x83a9d90f, L:/127.0.0.1:42945 - R:/127.0.0.1:59270]
2022-12-06 13:03:17,219 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:17,219 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,219 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,219 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,220 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,220 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,229 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0xc9edcfa6, L:/127.0.0.1:35971 - R:/127.0.0.1:49030]
2022-12-06 13:03:17,229 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:17,230 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0x615ae611, L:/127.0.0.1:39837 - R:/127.0.0.1:60546]
2022-12-06 13:03:17,230 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:17,234 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,234 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,234 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,234 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,234 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:17,235 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:17,235 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:17,235 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:17,235 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:17,236 [s0-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,260 [JvmPauseMonitor6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 1559100969ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=126ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1894ms
2022-12-06 13:03:19,261 [JvmPauseMonitor5] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 1623833377ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=126ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1894ms
2022-12-06 13:03:19,261 [JvmPauseMonitor4] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 1658273301ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=126ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1894ms
2022-12-06 13:03:19,261 [s2@group-BD1198AD89EB-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 253ms but took extra 1834620336ns (> threshold = 300ms)
2022-12-06 13:03:19,261 [s0@group-BD1198AD89EB-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 219ms but took extra 1942001727ns (> threshold = 300ms)
2022-12-06 13:03:19,266 [s1@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1095)) - s1@group-BD1198AD89EB-LeaderStateImpl: Lost leadership on term: 1. Election timeout: 300ms. In charge for: 2907ms. Conf: 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,267 [s1@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s1@group-BD1198AD89EB->s0(c0,m0,n1, attendVote=true, lastRpcSendTime=2064, lastRpcResponseTime=2058)
2022-12-06 13:03:19,267 [s1@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s1@group-BD1198AD89EB->s2(c0,m0,n1, attendVote=true, lastRpcSendTime=2077, lastRpcResponseTime=2058)
2022-12-06 13:03:19,267 [s1@group-BD1198AD89EB-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from    LEADER to FOLLOWER at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-12-06 13:03:19,267 [s1@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s1: shutdown s1@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:19,273 [s1@group-BD1198AD89EB->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-BD1198AD89EB->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:19,274 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:19,277 [s1@group-BD1198AD89EB->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-BD1198AD89EB->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:19,282 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:19,283 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:19,283 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 1 -> 0
2022-12-06 13:03:19,321 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x020a866f, L:/127.0.0.1:42945 - R:/127.0.0.1:42870]
2022-12-06 13:03:19,321 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,322 [s1@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s1@group-BD1198AD89EB-PendingRequests: sendNotLeaderResponses
2022-12-06 13:03:19,322 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,322 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,323 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,323 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,323 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,323 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:19,323 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s0: nextIndex: updateUnconditionally 1 -> 0
2022-12-06 13:03:19,325 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,325 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,325 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,325 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,325 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,327 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xff7c6c56, L:/127.0.0.1:42945 - R:/127.0.0.1:42884]
2022-12-06 13:03:19,327 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,323 [s1@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,333 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x58b38d82, L:/127.0.0.1:35971 - R:/127.0.0.1:49044]
2022-12-06 13:03:19,333 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:19,334 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,334 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,334 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,334 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,334 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,339 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ: [id: 0xb138a576, L:/127.0.0.1:39837 - R:/127.0.0.1:60550]
2022-12-06 13:03:19,339 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x9e711b55, L:/0.0.0.0:39837] READ COMPLETE
2022-12-06 13:03:19,341 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,341 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,341 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,341 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,341 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,353 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xa8107065, L:/127.0.0.1:42945 - R:/127.0.0.1:42886]
2022-12-06 13:03:19,354 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,356 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xba3eab1f, L:/127.0.0.1:42945 - R:/127.0.0.1:42890]
2022-12-06 13:03:19,357 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,357 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,357 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,357 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,357 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,357 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,379 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0xe62ff6ac, L:/127.0.0.1:35971 - R:/127.0.0.1:49054]
2022-12-06 13:03:19,379 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:19,380 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,380 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,380 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,380 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,380 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,386 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0xfb74c2b0, L:/127.0.0.1:42945 - R:/127.0.0.1:42896]
2022-12-06 13:03:19,386 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,386 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,386 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,387 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,387 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,387 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,393 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ: [id: 0x7f56e6d1, L:/127.0.0.1:35971 - R:/127.0.0.1:49064]
2022-12-06 13:03:19,393 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xf77ac73b, L:/0.0.0.0:35971] READ COMPLETE
2022-12-06 13:03:19,394 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-12-06 13:03:19,394 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-12-06 13:03:19,394 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-12-06 13:03:19,394 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-12-06 13:03:19,394 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-12-06 13:03:19,398 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ: [id: 0x825e8bf9, L:/127.0.0.1:42945 - R:/127.0.0.1:42906]
2022-12-06 13:03:19,398 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x901d39e7, L:/0.0.0.0:42945] READ COMPLETE
2022-12-06 13:03:19,444 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2235757518ns, electionTimeout:183ms
2022-12-06 13:03:19,444 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,444 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-12-06 13:03:19,444 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:19,444 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderElection5
2022-12-06 13:03:19,456 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from s1 to null at term 1 for PRE_VOTE
2022-12-06 13:03:19,457 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-BD1198AD89EB-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,493 [s0@group-BD1198AD89EB-LeaderElection5-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-12-06 13:03:19,501 [s0@group-BD1198AD89EB-LeaderElection5-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-12-06 13:03:19,537 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 1, (t:1, i:0))
2022-12-06 13:03:19,537 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:19,538 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-BD1198AD89EB:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,542 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-BD1198AD89EB-LeaderElection5: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:19,542 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t1
2022-12-06 13:03:19,542 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-BD1198AD89EB-LeaderElection5 PRE_VOTE round 0: result PASSED
2022-12-06 13:03:19,546 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-BD1198AD89EB-LeaderElection5 ELECTION round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,548 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#1-t1,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40727"
dataStreamAddress: "localhost:39837"
clientAddress: "localhost:39843"
adminAddress: "localhost:42117"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:35713"
dataStreamAddress: "localhost:35971"
clientAddress: "localhost:44441"
adminAddress: "localhost:46153"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34381"
dataStreamAddress: "localhost:42945"
clientAddress: "localhost:41515"
adminAddress: "localhost:37429"
startupRole: FOLLOWER
, old:)
2022-12-06 13:03:19,548 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2339719090ns, electionTimeout:287ms
2022-12-06 13:03:19,548 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,548 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-12-06 13:03:19,548 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:19,548 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection6
2022-12-06 13:03:19,551 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:19,573 [s2@group-BD1198AD89EB-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from s1 to null at term 1 for PRE_VOTE
2022-12-06 13:03:19,573 [s2@group-BD1198AD89EB-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,585 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 1, (t:1, i:0))
2022-12-06 13:03:19,552 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 0 -> 0
2022-12-06 13:03:19,585 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(ELECTION, s0, group-BD1198AD89EB, 2, (t:1, i:0))
2022-12-06 13:03:19,586 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:19,586 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from s1 to null at term 2 for updateCurrentTerm
2022-12-06 13:03:19,586 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s0
2022-12-06 13:03:19,586 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,586 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,586 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-BD1198AD89EB-FollowerState was interrupted
2022-12-06 13:03:19,585 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#1-t1,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:40727"
dataStreamAddress: "localhost:39837"
clientAddress: "localhost:39843"
adminAddress: "localhost:42117"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:35713"
dataStreamAddress: "localhost:35971"
clientAddress: "localhost:44441"
adminAddress: "localhost:46153"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:34381"
dataStreamAddress: "localhost:42945"
clientAddress: "localhost:41515"
adminAddress: "localhost:37429"
startupRole: FOLLOWER
, old:)
2022-12-06 13:03:19,587 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:19,587 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s0: nextIndex: updateUnconditionally 0 -> 0
2022-12-06 13:03:19,585 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(ELECTION, s0, group-BD1198AD89EB, 2, (t:1, i:0))
2022-12-06 13:03:19,585 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:19,587 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-BD1198AD89EB:t1, leader=null, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,588 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-CANDIDATE: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:19,588 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 2 for candidate:s0
2022-12-06 13:03:19,588 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection6
2022-12-06 13:03:19,588 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:19,590 [s2@group-BD1198AD89EB-LeaderElection6-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-12-06 13:03:19,590 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to ELECTION vote request: s0<-s1#0:OK-t2. Peer's state: s1@group-BD1198AD89EB:t2, leader=null, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,593 [s2@group-BD1198AD89EB-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection6: PRE_VOTE REJECTED received 0 response(s) and 0 exception(s):
2022-12-06 13:03:19,593 [s2@group-BD1198AD89EB-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection6 PRE_VOTE round 0: result REJECTED
2022-12-06 13:03:19,593 [s2@group-BD1198AD89EB-LeaderElection6-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-12-06 13:03:19,634 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to ELECTION vote request: s0<-s2#0:OK-t2. Peer's state: s2@group-BD1198AD89EB:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-BD1198AD89EB-LeaderElection5: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t2
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-BD1198AD89EB-LeaderElection5 ELECTION round 0: result PASSED
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-BD1198AD89EB-LeaderElection5
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from null to s0 at term 2 for becomeLeader, leader elected after 184ms
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:19,640 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:19,641 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:19,642 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:19,643 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:19,644 [s0@group-BD1198AD89EB-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:19,644 [s0@group-BD1198AD89EB-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2022-12-06 13:03:19,647 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,647 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,663 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1
2022-12-06 13:03:19,666 [s0@group-BD1198AD89EB-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s0@group-BD1198AD89EB: set configuration 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,712 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s0 at term 2 for appendEntries, leader elected after 138ms
2022-12-06 13:03:19,712 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s2@group-BD1198AD89EB: set configuration 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,712 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2022-12-06 13:03:19,713 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,713 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,714 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from null to s0 at term 2 for appendEntries, leader elected after 128ms
2022-12-06 13:03:19,714 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s1@group-BD1198AD89EB: set configuration 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,714 [s1-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2022-12-06 13:03:19,716 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,716 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_0-0
2022-12-06 13:03:19,731 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1
2022-12-06 13:03:19,732 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1
2022-12-06 13:03:19,736 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 1, (t:1, i:0))
2022-12-06 13:03:19,736 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-LEADER: reject PRE_VOTE from s2: this server is the leader and still has leadership
2022-12-06 13:03:19,736 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s0#0:FAIL-t2. Peer's state: s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:19,737 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 1, (t:1, i:0))
2022-12-06 13:03:19,737 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s0
2022-12-06 13:03:19,737 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s1#0:FAIL-t2. Peer's state: s1@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c0, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:22,879 [JvmPauseMonitor4] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 117570569ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=97ms
2022-12-06 13:03:22,880 [JvmPauseMonitor5] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 117908673ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=97ms
2022-12-06 13:03:22,880 [JvmPauseMonitor6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 118140375ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=97ms
2022-12-06 13:03:24,688 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:194802320ns, electionTimeout:181ms
2022-12-06 13:03:24,688 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:24,688 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-12-06 13:03:24,688 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:24,688 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection7
2022-12-06 13:03:24,713 [s2-server-thread2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 2 for appendEntries
2022-12-06 13:03:24,713 [s2-server-thread2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection7
2022-12-06 13:03:24,713 [s2-server-thread2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:24,738 [s2@group-BD1198AD89EB-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:run(232)) - s2@group-BD1198AD89EB-LeaderElection7: skip running since this is already CLOSING
2022-12-06 13:03:26,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c2, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c2, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c2, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:26,936 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream378: bytesWritten=3747117
2022-12-06 13:03:27,589 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream376: bytesWritten=3756529
2022-12-06 13:03:27,890 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream377: bytesWritten=3730299
2022-12-06 13:03:27,904 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:27,906 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:27,907 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:27,917 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream383
2022-12-06 13:03:28,007 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream380: bytesWritten=3748993
2022-12-06 13:03:28,012 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream379: bytesWritten=3747533
2022-12-06 13:03:28,158 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,159 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,159 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,161 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream384
2022-12-06 13:03:28,187 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,188 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,188 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,190 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream385
2022-12-06 13:03:28,213 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream381: bytesWritten=3730916
2022-12-06 13:03:28,223 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream382: bytesWritten=3733540
2022-12-06 13:03:28,658 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,660 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,661 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,661 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,661 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,662 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:28,664 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream386
2022-12-06 13:03:28,667 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream387
2022-12-06 13:03:29,183 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:208120852ns, electionTimeout:153ms
2022-12-06 13:03:29,183 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:29,183 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-12-06 13:03:29,183 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:29,183 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection8
2022-12-06 13:03:29,196 [s2@group-BD1198AD89EB-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from s0 to null at term 2 for PRE_VOTE
2022-12-06 13:03:29,196 [s2@group-BD1198AD89EB-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection8 PRE_VOTE round 0: submit vote requests at term 2 for 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:29,205 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 2 for appendEntries
2022-12-06 13:03:29,205 [s2-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection8
2022-12-06 13:03:29,206 [s2-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:29,277 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 2, (t:2, i:11))
2022-12-06 13:03:29,278 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-LEADER: reject PRE_VOTE from s2: this server is the leader and still has leadership
2022-12-06 13:03:29,278 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s0#0:FAIL-t2. Peer's state: s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c11, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:29,278 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 2, (t:2, i:11))
2022-12-06 13:03:29,278 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s0
2022-12-06 13:03:29,278 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s1#0:FAIL-t2. Peer's state: s1@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c11, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:29,279 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s0 at term 2 for appendEntries, leader elected after 80ms
2022-12-06 13:03:29,280 [s2@group-BD1198AD89EB-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection8: PRE_VOTE REJECTED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:29,280 [s2@group-BD1198AD89EB-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t2
2022-12-06 13:03:29,280 [s2@group-BD1198AD89EB-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection8 PRE_VOTE round 0: result REJECTED
2022-12-06 13:03:30,311 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,313 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,314 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,316 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream388
2022-12-06 13:03:30,809 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,814 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,814 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:30,816 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream389
2022-12-06 13:03:31,803 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream383: bytesWritten=3732057
2022-12-06 13:03:32,638 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream384: bytesWritten=3724130
2022-12-06 13:03:32,740 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream385: bytesWritten=3744841
2022-12-06 13:03:36,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c15, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c15, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c15, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:36,202 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,205 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,206 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,209 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream390
2022-12-06 13:03:36,251 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,252 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,252 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,253 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,255 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,256 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:36,257 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream391
2022-12-06 13:03:36,267 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream392
2022-12-06 13:03:36,426 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream387: bytesWritten=3757741
2022-12-06 13:03:36,451 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream386: bytesWritten=3750192
2022-12-06 13:03:37,782 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream388: bytesWritten=3744681
2022-12-06 13:03:38,486 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream389: bytesWritten=3727557
2022-12-06 13:03:40,327 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,329 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,330 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,332 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream393
2022-12-06 13:03:40,368 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,369 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,370 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,379 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream394
2022-12-06 13:03:40,392 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,393 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=389, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,393 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,393 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,394 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=389, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,394 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=389, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,397 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream395
2022-12-06 13:03:40,401 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream396
2022-12-06 13:03:40,429 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream396: bytesWritten=731183
2022-12-06 13:03:40,517 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=396, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,518 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=396, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,519 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=396, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,521 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream397
2022-12-06 13:03:40,577 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream397: bytesWritten=731216
2022-12-06 13:03:40,580 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=397, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,581 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=397, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,582 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=397, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,584 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream398
2022-12-06 13:03:40,601 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream398: bytesWritten=737586
2022-12-06 13:03:40,603 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=398, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,604 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=398, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,604 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=398, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,606 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream399
2022-12-06 13:03:40,658 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream399: bytesWritten=695961
2022-12-06 13:03:40,661 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=399, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,662 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=399, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,662 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=399, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,664 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream400
2022-12-06 13:03:40,798 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream400: bytesWritten=765935
2022-12-06 13:03:40,803 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=400, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,804 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=400, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,804 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=400, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:40,807 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream401
2022-12-06 13:03:40,981 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream390: bytesWritten=3752286
2022-12-06 13:03:41,426 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream392: bytesWritten=3742850
2022-12-06 13:03:41,477 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream401: bytesWritten=738359
2022-12-06 13:03:41,598 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream391: bytesWritten=3752204
2022-12-06 13:03:41,773 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=401, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,775 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=401, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,776 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=401, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,778 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream402
2022-12-06 13:03:41,803 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream402: bytesWritten=779507
2022-12-06 13:03:41,806 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=402, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,807 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=402, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,808 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=402, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,811 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream403
2022-12-06 13:03:41,828 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream403: bytesWritten=782912
2022-12-06 13:03:41,832 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=403, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,833 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=403, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,834 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=403, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,837 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream404
2022-12-06 13:03:41,875 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream404: bytesWritten=757498
2022-12-06 13:03:41,881 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=404, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,882 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=404, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,882 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=404, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:41,889 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream405
2022-12-06 13:03:45,318 [s2@group-BD1198AD89EB-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 214ms but took extra 1737216950ns (> threshold = 300ms)
2022-12-06 13:03:45,318 [JvmPauseMonitor6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 1809034197ns.
GC pool 'G1 Young Generation' had collection(s): count=2 time=114ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1907ms
2022-12-06 13:03:45,319 [JvmPauseMonitor5] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 1809393801ns.
GC pool 'G1 Young Generation' had collection(s): count=2 time=114ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1907ms
2022-12-06 13:03:45,319 [JvmPauseMonitor4] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 1809497701ns.
GC pool 'G1 Young Generation' had collection(s): count=2 time=114ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1907ms
2022-12-06 13:03:45,319 [s1@group-BD1198AD89EB-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 151ms but took extra 1821557750ns (> threshold = 300ms)
2022-12-06 13:03:45,319 [s0@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1095)) - s0@group-BD1198AD89EB-LeaderStateImpl: Lost leadership on term: 2. Election timeout: 300ms. In charge for: 25678ms. Conf: 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,319 [s0@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s0@group-BD1198AD89EB->s1(c47,m47,n48, attendVote=true, lastRpcSendTime=1969, lastRpcResponseTime=1963)
2022-12-06 13:03:45,319 [s0@group-BD1198AD89EB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s0@group-BD1198AD89EB->s2(c47,m47,n48, attendVote=true, lastRpcSendTime=1969, lastRpcResponseTime=1959)
2022-12-06 13:03:45,319 [s0@group-BD1198AD89EB-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from    LEADER to FOLLOWER at term 2 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-12-06 13:03:45,320 [s0@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:45,320 [s0@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-BD1198AD89EB-PendingRequests: sendNotLeaderResponses
2022-12-06 13:03:45,321 [s0@group-BD1198AD89EB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,334 [s0@group-BD1198AD89EB->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-BD1198AD89EB->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:45,334 [grpc-default-executor-8] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#475-t2,previous=(t:2, i:46),leaderCommit=46,initializing? true,entries: size=1, first=(t:2, i:47), METADATAENTRY(c:46)
2022-12-06 13:03:45,335 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:45,335 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 48 -> 47
2022-12-06 13:03:45,340 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:45,340 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:45,340 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 47 -> 46
2022-12-06 13:03:45,351 [s0@group-BD1198AD89EB->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s0@group-BD1198AD89EB->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:45,356 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#478-t2,previous=(t:2, i:46),leaderCommit=46,initializing? true,entries: size=1, first=(t:2, i:47), METADATAENTRY(c:46)
2022-12-06 13:03:45,356 [grpc-default-executor-8] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:45,362 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:45,362 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 48 -> 47
2022-12-06 13:03:45,363 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:45,363 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 47 -> 46
2022-12-06 13:03:45,486 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2131701139ns, electionTimeout:167ms
2022-12-06 13:03:45,486 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,486 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-12-06 13:03:45,486 [s1@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:45,486 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-LeaderElection9
2022-12-06 13:03:45,506 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from s0 to null at term 2 for PRE_VOTE
2022-12-06 13:03:45,507 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-BD1198AD89EB-LeaderElection9 PRE_VOTE round 0: submit vote requests at term 2 for 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,557 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2203157807ns, electionTimeout:239ms
2022-12-06 13:03:45,557 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,558 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-12-06 13:03:45,558 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:45,558 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection10
2022-12-06 13:03:45,595 [s2@group-BD1198AD89EB-LeaderElection10] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from s0 to null at term 2 for PRE_VOTE
2022-12-06 13:03:45,595 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection10 PRE_VOTE round 0: submit vote requests at term 2 for 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,603 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(108)) - s0@group-BD1198AD89EB-FollowerState: Skipping leader election since it stepped down recently (elapsed = 282ms < waitTime = 10s)
2022-12-06 13:03:45,607 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s1, group-BD1198AD89EB, 2, (t:2, i:47))
2022-12-06 13:03:45,607 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:45,607 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s1<-s0#0:OK-t2. Peer's state: s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,607 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s1, group-BD1198AD89EB, 2, (t:2, i:47))
2022-12-06 13:03:45,607 [grpc-default-executor-8] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:45,607 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to PRE_VOTE vote request: s1<-s2#0:OK-t2. Peer's state: s2@group-BD1198AD89EB:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,608 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-BD1198AD89EB-LeaderElection9: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:45,608 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t2
2022-12-06 13:03:45,608 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-BD1198AD89EB-LeaderElection9 PRE_VOTE round 0: result PASSED
2022-12-06 13:03:45,609 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 2, (t:2, i:47))
2022-12-06 13:03:45,608 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 2, (t:2, i:47))
2022-12-06 13:03:45,609 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s0
2022-12-06 13:03:45,610 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s0#0:FAIL-t2. Peer's state: s0@group-BD1198AD89EB:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,626 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-BD1198AD89EB-LeaderElection9 ELECTION round 0: submit vote requests at term 3 for 1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,627 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-12-06 13:03:45,627 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s1#0:OK-t3. Peer's state: s1@group-BD1198AD89EB:t3, leader=null, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,629 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection10: PRE_VOTE DISCOVERED_A_NEW_TERM (term=3) received 2 response(s) and 0 exception(s):
2022-12-06 13:03:45,629 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t2
2022-12-06 13:03:45,629 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s2<-s1#0:OK-t3
2022-12-06 13:03:45,629 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection10 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=3)
2022-12-06 13:03:45,630 [s2@group-BD1198AD89EB-LeaderElection10] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM (term=3)
2022-12-06 13:03:45,630 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection10
2022-12-06 13:03:45,630 [s2@group-BD1198AD89EB-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,705 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(ELECTION, s1, group-BD1198AD89EB, 3, (t:2, i:47))
2022-12-06 13:03:45,705 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:45,705 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from s0 to null at term 3 for updateCurrentTerm
2022-12-06 13:03:45,705 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s1
2022-12-06 13:03:45,705 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,706 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,706 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-BD1198AD89EB-FollowerState was interrupted
2022-12-06 13:03:45,709 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to ELECTION vote request: s1<-s0#0:OK-t3. Peer's state: s0@group-BD1198AD89EB:t3, leader=null, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,710 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-BD1198AD89EB-LeaderElection9: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:45,710 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t3
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-BD1198AD89EB-LeaderElection9 ELECTION round 0: result PASSED
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-BD1198AD89EB-LeaderElection9
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from null to s1 at term 3 for becomeLeader, leader elected after 204ms
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:45,711 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:45,712 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:45,713 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:45,713 [s1@group-BD1198AD89EB-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:45,713 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:45,713 [s1@group-BD1198AD89EB-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:45,713 [s1@group-BD1198AD89EB-LeaderElection9] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-1_47 to index:47
2022-12-06 13:03:45,715 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,715 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,717 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(ELECTION, s1, group-BD1198AD89EB, 3, (t:2, i:47))
2022-12-06 13:03:45,717 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-12-06 13:03:45,717 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s1
2022-12-06 13:03:45,717 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,717 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:45,719 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to ELECTION vote request: s1<-s2#0:OK-t3. Peer's state: s2@group-BD1198AD89EB:t3, leader=null, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c47, conf=1: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,729 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48
2022-12-06 13:03:45,734 [s0-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from null to s1 at term 3 for appendEntries, leader elected after 28ms
2022-12-06 13:03:45,736 [s1@group-BD1198AD89EB-LeaderElection9] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s1@group-BD1198AD89EB: set configuration 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,749 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s0@group-BD1198AD89EB: set configuration 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,749 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-1_47 to index:47
2022-12-06 13:03:45,749 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-BD1198AD89EB-FollowerState was interrupted
2022-12-06 13:03:45,750 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,750 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,760 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s1 at term 3 for appendEntries, leader elected after 165ms
2022-12-06 13:03:45,765 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48
2022-12-06 13:03:45,778 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s2@group-BD1198AD89EB: set configuration 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:45,779 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-1_47 to index:47
2022-12-06 13:03:45,779 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,779 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_1-47
2022-12-06 13:03:45,799 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48
2022-12-06 13:03:45,894 [s1-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=392, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:45,899 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=392, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:45,900 [s0-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=392, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:45,922 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream407
2022-12-06 13:03:45,939 [s1-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=391, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:45,940 [s0-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=391, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:45,942 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=391, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,003 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=390, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,013 [s0-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=390, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,016 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=390, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,041 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream408
2022-12-06 13:03:46,054 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream409
2022-12-06 13:03:46,077 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream408: bytesWritten=731021
2022-12-06 13:03:46,169 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=408, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,170 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=408, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,171 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=408, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c55, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c56, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c55, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:03:46,177 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream410
2022-12-06 13:03:46,191 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream405: bytesWritten=824552
2022-12-06 13:03:46,208 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream407: bytesWritten=780236
2022-12-06 13:03:46,242 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream409: bytesWritten=665769
2022-12-06 13:03:46,242 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream410: bytesWritten=740165
2022-12-06 13:03:46,247 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=410, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,248 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=410, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,250 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=410, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,250 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream411
2022-12-06 13:03:46,270 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream411: bytesWritten=741821
2022-12-06 13:03:46,274 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=411, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,276 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=411, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,278 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=411, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,279 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream412
2022-12-06 13:03:46,316 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=407, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,317 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=407, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,317 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=409, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,317 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=407, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,318 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=405, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,319 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=409, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,318 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=409, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,320 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=405, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,321 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-178A76C63048->s2@group-BD1198AD89EB, cid=405, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,322 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream413
2022-12-06 13:03:46,324 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream414
2022-12-06 13:03:46,329 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream412: bytesWritten=768110
2022-12-06 13:03:46,343 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream415
2022-12-06 13:03:46,348 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=412, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,349 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=412, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,349 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=412, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,356 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream416
2022-12-06 13:03:46,390 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream413: bytesWritten=775969
2022-12-06 13:03:46,392 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream416: bytesWritten=844126
2022-12-06 13:03:46,399 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=413, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,403 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=413, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,404 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=413, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,407 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream414: bytesWritten=813327
2022-12-06 13:03:46,407 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream415: bytesWritten=774156
2022-12-06 13:03:46,410 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=416, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,413 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=416, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,417 [pool-9-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream417
2022-12-06 13:03:46,427 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=416, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,431 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream418
2022-12-06 13:03:46,436 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=414, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,443 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream419
2022-12-06 13:03:46,447 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=414, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,449 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=415, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,452 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=415, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,454 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=414, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,459 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-B1C0C37A2E08->s1@group-BD1198AD89EB, cid=415, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,466 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream420
2022-12-06 13:03:46,468 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream421
2022-12-06 13:03:46,499 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream422
2022-12-06 13:03:46,989 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream393: bytesWritten=3739744
2022-12-06 13:03:46,995 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=393, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,996 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=393, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:46,997 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=393, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:47,000 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream423
2022-12-06 13:03:47,278 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:200180072ns, electionTimeout:169ms
2022-12-06 13:03:47,278 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,278 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-12-06 13:03:47,278 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:47,278 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderElection11
2022-12-06 13:03:47,279 [s0@group-BD1198AD89EB-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from s1 to null at term 3 for PRE_VOTE
2022-12-06 13:03:47,279 [s0@group-BD1198AD89EB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-BD1198AD89EB-LeaderElection11 PRE_VOTE round 0: submit vote requests at term 3 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,282 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:203123399ns, electionTimeout:191ms
2022-12-06 13:03:47,282 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,282 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-12-06 13:03:47,282 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:47,282 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection12
2022-12-06 13:03:47,361 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream395: bytesWritten=3746251
2022-12-06 13:03:47,377 [s2@group-BD1198AD89EB-LeaderElection12] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from s1 to null at term 3 for PRE_VOTE
2022-12-06 13:03:47,378 [s2@group-BD1198AD89EB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection12 PRE_VOTE round 0: submit vote requests at term 3 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,379 [s1-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=395, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:47,379 [s0-server-thread3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 3 for appendEntries
2022-12-06 13:03:47,383 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-BD1198AD89EB-LeaderElection11
2022-12-06 13:03:47,383 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,383 [s0-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from null to s1 at term 3 for appendEntries, leader elected after 103ms
2022-12-06 13:03:47,392 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 3, (t:3, i:79))
2022-12-06 13:03:47,392 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=395, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:47,394 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 3 for appendEntries
2022-12-06 13:03:47,394 [s2-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection12
2022-12-06 13:03:47,394 [s2-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,392 [grpc-default-executor-3] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1095)) - s1@group-BD1198AD89EB-LeaderStateImpl: Lost leadership on term: 3. Election timeout: 300ms. In charge for: 1681ms. Conf: 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,399 [grpc-default-executor-3] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s1@group-BD1198AD89EB->s0(c79,m79,n81, attendVote=true, lastRpcSendTime=19, lastRpcResponseTime=6)
2022-12-06 13:03:47,399 [grpc-default-executor-3] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$16(1099)) - Follower s1@group-BD1198AD89EB->s2(c79,m79,n81, attendVote=true, lastRpcSendTime=3, lastRpcResponseTime=320)
2022-12-06 13:03:47,399 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from    LEADER to FOLLOWER at term 3 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-12-06 13:03:47,399 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s1: shutdown s1@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:47,400 [s1@group-BD1198AD89EB->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-BD1198AD89EB->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:47,400 [s1@group-BD1198AD89EB->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(199)) - s1@group-BD1198AD89EB->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-12-06 13:03:47,402 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#142-t3,previous=(t:3, i:79),leaderCommit=79,initializing? true,entries: size=1, first=(t:3, i:80), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
2022-12-06 13:03:47,407 [grpc-default-executor-8] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:47,408 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:47,408 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s0: nextIndex: updateUnconditionally 81 -> 80
2022-12-06 13:03:47,409 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:47,409 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s0: nextIndex: updateUnconditionally 80 -> 79
2022-12-06 13:03:47,400 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s1@group-BD1198AD89EB-PendingRequests: sendNotLeaderResponses
2022-12-06 13:03:47,449 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s1 at term 3 for appendEntries, leader elected after 72ms
2022-12-06 13:03:47,450 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-448F7CBC4654->s0@group-BD1198AD89EB, cid=395, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:47,450 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#129-t3,previous=(t:3, i:79),leaderCommit=79,initializing? true,entries: size=1, first=(t:3, i:80), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
2022-12-06 13:03:47,479 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 3, (t:3, i:79))
2022-12-06 13:03:47,479 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s0: this server is a follower and still has a valid leader s1
2022-12-06 13:03:47,479 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s2#0:FAIL-t3. Peer's state: s2@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,479 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,485 [s2@group-BD1198AD89EB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection12: PRE_VOTE REJECTED received 0 response(s) and 0 exception(s):
2022-12-06 13:03:47,486 [s2@group-BD1198AD89EB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection12 PRE_VOTE round 0: result REJECTED
2022-12-06 13:03:47,494 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2022-12-06 13:03:47,570 [s0@group-BD1198AD89EB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-BD1198AD89EB-LeaderElection11: PRE_VOTE REJECTED received 0 response(s) and 0 exception(s):
2022-12-06 13:03:47,570 [s0@group-BD1198AD89EB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-BD1198AD89EB-LeaderElection11 PRE_VOTE round 0: result REJECTED
2022-12-06 13:03:47,591 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:47,591 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 81 -> 80
2022-12-06 13:03:47,595 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(413)) - s1@group-BD1198AD89EB->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-12-06 13:03:47,607 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 80 -> 79
2022-12-06 13:03:47,624 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s0: this server is a follower and still has a valid leader s1
2022-12-06 13:03:47,624 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t3. Peer's state: s1@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,626 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 3, (t:3, i:79))
2022-12-06 13:03:47,628 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s1
2022-12-06 13:03:47,628 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s1#0:FAIL-t3. Peer's state: s1@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,633 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 3, (t:3, i:79))
2022-12-06 13:03:47,633 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: our last entry (t:3, i:80) > candidate's last entry (t:3, i:79)
2022-12-06 13:03:47,633 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s0#0:FAIL-t3. Peer's state: s0@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,857 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(108)) - s1@group-BD1198AD89EB-FollowerState: Skipping leader election since it stepped down recently (elapsed = 377ms < waitTime = 10s)
2022-12-06 13:03:47,875 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:473943333ns, electionTimeout:253ms
2022-12-06 13:03:47,876 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,876 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-12-06 13:03:47,875 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-BD1198AD89EB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:381573969ns, electionTimeout:226ms
2022-12-06 13:03:47,876 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:47,876 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-12-06 13:03:47,876 [s2@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:47,876 [s2@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-LeaderElection14
2022-12-06 13:03:47,876 [s0@group-BD1198AD89EB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-12-06 13:03:47,876 [s0@group-BD1198AD89EB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderElection13
2022-12-06 13:03:47,883 [s2@group-BD1198AD89EB-LeaderElection14] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from s1 to null at term 3 for PRE_VOTE
2022-12-06 13:03:47,885 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection14 PRE_VOTE round 0: submit vote requests at term 3 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,896 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from s1 to null at term 3 for PRE_VOTE
2022-12-06 13:03:47,896 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-BD1198AD89EB-LeaderElection13 PRE_VOTE round 0: submit vote requests at term 3 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,951 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 3, (t:3, i:80))
2022-12-06 13:03:47,985 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:47,986 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s1#0:OK-t3. Peer's state: s1@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,975 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 3, (t:3, i:80))
2022-12-06 13:03:47,986 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-12-06 13:03:47,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s0#0:OK-t3. Peer's state: s0@group-BD1198AD89EB:t3, leader=null, voted=s1, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,988 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection14: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:47,988 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t3
2022-12-06 13:03:47,988 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection14 PRE_VOTE round 0: result PASSED
2022-12-06 13:03:47,975 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s2, group-BD1198AD89EB, 3, (t:3, i:80))
2022-12-06 13:03:47,988 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s1
2022-12-06 13:03:47,988 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to PRE_VOTE vote request: s2<-s1#0:FAIL-t3. Peer's state: s1@group-BD1198AD89EB:t3, leader=s1, voted=s1, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,989 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-BD1198AD89EB-LeaderElection14 ELECTION round 0: submit vote requests at term 4 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:47,993 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-BD1198AD89EB-LeaderElection13: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-12-06 13:03:47,993 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t3
2022-12-06 13:03:47,993 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-BD1198AD89EB-LeaderElection13 PRE_VOTE round 0: result PASSED
2022-12-06 13:03:48,004 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream394: bytesWritten=3745474
2022-12-06 13:03:48,005 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-BD1198AD89EB-LeaderElection13 ELECTION round 0: submit vote requests at term 4 for 48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,121 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s0@group-BD1198AD89EB: receive requestVote(ELECTION, s2, group-BD1198AD89EB, 4, (t:3, i:80))
2022-12-06 13:03:48,121 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-BD1198AD89EB-CANDIDATE: reject ELECTION from s2: already has voted for s0 at current term 4
2022-12-06 13:03:48,121 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s0@group-BD1198AD89EB replies to ELECTION vote request: s2<-s0#0:FAIL-t4. Peer's state: s0@group-BD1198AD89EB:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,122 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(PRE_VOTE, s0, group-BD1198AD89EB, 3, (t:3, i:80))
2022-12-06 13:03:48,122 [grpc-default-executor-9] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:48,122 [grpc-default-executor-9] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to PRE_VOTE vote request: s0<-s2#0:OK-t4. Peer's state: s2@group-BD1198AD89EB:t4, leader=null, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,122 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(ELECTION, s0, group-BD1198AD89EB, 4, (t:3, i:80))
2022-12-06 13:03:48,122 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-12-06 13:03:48,122 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from s1 to null at term 4 for updateCurrentTerm
2022-12-06 13:03:48,122 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-BD1198AD89EB: changes role from  FOLLOWER to FOLLOWER at term 4 for candidate:s0
2022-12-06 13:03:48,122 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:48,123 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:48,123 [s1@group-BD1198AD89EB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-BD1198AD89EB-FollowerState was interrupted
2022-12-06 13:03:48,127 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s2@group-BD1198AD89EB: receive requestVote(ELECTION, s0, group-BD1198AD89EB, 4, (t:3, i:80))
2022-12-06 13:03:48,127 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-BD1198AD89EB-CANDIDATE: reject ELECTION from s0: already has voted for s2 at current term 4
2022-12-06 13:03:48,127 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s2@group-BD1198AD89EB replies to ELECTION vote request: s0<-s2#0:FAIL-t4. Peer's state: s2@group-BD1198AD89EB:t4, leader=null, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,127 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1294)) - s1@group-BD1198AD89EB: receive requestVote(ELECTION, s2, group-BD1198AD89EB, 4, (t:3, i:80))
2022-12-06 13:03:48,148 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to ELECTION vote request: s0<-s1#0:OK-t4. Peer's state: s1@group-BD1198AD89EB:t4, leader=null, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,148 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-BD1198AD89EB-FOLLOWER: reject ELECTION from s2: already has voted for s0 at current term 4
2022-12-06 13:03:48,148 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1327)) - s1@group-BD1198AD89EB replies to ELECTION vote request: s2<-s1#0:FAIL-t4. Peer's state: s1@group-BD1198AD89EB:t4, leader=null, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c79, conf=48: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,149 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-BD1198AD89EB-LeaderElection13: ELECTION PASSED received 2 response(s) and 0 exception(s):
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t4
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:FAIL-t4
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-BD1198AD89EB-LeaderElection13 ELECTION round 0: result PASSED
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-BD1198AD89EB-LeaderElection13
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-BD1198AD89EB: changes role from CANDIDATE to LEADER at term 4 for changeToLeader
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-BD1198AD89EB: change Leader from null to s0 at term 4 for becomeLeader, leader elected after 254ms
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-12-06 13:03:48,150 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2022-12-06 13:03:48,151 [s0@group-BD1198AD89EB-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-BD1198AD89EB-LeaderStateImpl
2022-12-06 13:03:48,152 [s0@group-BD1198AD89EB-LeaderElection13] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-48_80 to index:80
2022-12-06 13:03:48,152 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-BD1198AD89EB-LeaderElection14: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t4
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s2<-s1#0:FAIL-t4
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-BD1198AD89EB-LeaderElection14 ELECTION round 0: result REJECTED
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-BD1198AD89EB: changes role from CANDIDATE to FOLLOWER at term 4 for REJECTED
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-BD1198AD89EB-LeaderElection14
2022-12-06 13:03:48,153 [s2@group-BD1198AD89EB-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-BD1198AD89EB-FollowerState
2022-12-06 13:03:48,155 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,155 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,173 [s0@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s0/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_81
2022-12-06 13:03:48,205 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-BD1198AD89EB: change Leader from null to s0 at term 4 for appendEntries, leader elected after 83ms
2022-12-06 13:03:48,206 [s0@group-BD1198AD89EB-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s0@group-BD1198AD89EB: set configuration 81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,208 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s1@group-BD1198AD89EB: set configuration 81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,208 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-48_80 to index:80
2022-12-06 13:03:48,209 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,209 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,215 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-BD1198AD89EB: change Leader from null to s0 at term 4 for appendEntries, leader elected after 332ms
2022-12-06 13:03:48,217 [s2-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(377)) - s2@group-BD1198AD89EB: set configuration 81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-12-06 13:03:48,217 [s2-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolling segment log-48_80 to index:80
2022-12-06 13:03:48,222 [s1@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s1/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_81
2022-12-06 13:03:48,228 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,228 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_48 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_48-80
2022-12-06 13:03:48,252 [s2@group-BD1198AD89EB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-BD1198AD89EB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/92995839/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty6f81f88e/s2/8b539dba-b40c-45c5-8ebc-bd1198ad89eb/current/log_inprogress_81
2022-12-06 13:03:48,390 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:03:48,398 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:03:48,400 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#11-t4,previous=(t:4, i:82),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:83), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:48,400 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:03:48,404 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#17-t4,previous=(t:4, i:82),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:83), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:48,477 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:48,511 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 84 -> 83
2022-12-06 13:03:48,523 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:48,524 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 84 -> 83
2022-12-06 13:03:53,675 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream421: bytesWritten=3720326
2022-12-06 13:03:53,749 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream419: bytesWritten=3755143
2022-12-06 13:03:54,213 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream420: bytesWritten=3762726
2022-12-06 13:03:54,214 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream418: bytesWritten=3758710
2022-12-06 13:03:54,283 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream422: bytesWritten=3745196
2022-12-06 13:03:54,286 [pool-9-thread-9] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream417: bytesWritten=3756828
2022-12-06 13:03:54,380 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=376, target=localhost:39843}}. 
2022-12-06 13:03:54,478 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=422, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,479 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=418, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,479 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=420, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,481 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=422, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,482 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#93-t4,previous=(t:4, i:83),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:84), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,484 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=417, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,483 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=422, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,488 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=418, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,488 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=420, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,483 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=418, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,489 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#88-t4,previous=(t:4, i:83),leaderCommit=82,initializing? true,entries: size=3, first=(t:4, i:84), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1442)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,489 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=419, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,489 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#94-t4,previous=(t:4, i:84),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:85), STATEMACHINELOGENTRY, 418@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,510 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,513 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 89 -> 84
2022-12-06 13:03:54,505 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=421, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,500 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,514 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 89 -> 84
2022-12-06 13:03:54,518 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=417, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,518 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=419, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,518 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=421, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,519 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#91-t4,previous=(t:4, i:83),leaderCommit=82,initializing? true,entries: size=6, first=(t:4, i:84), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,525 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=420, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,526 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=417, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,526 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=419, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,526 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=421, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:54,526 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#98-t4,previous=(t:4, i:83),leaderCommit=82,initializing? true,entries: size=6, first=(t:4, i:84), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1442)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,533 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,544 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 90 -> 84
2022-12-06 13:03:54,556 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:54,558 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 90 -> 84
2022-12-06 13:03:55,639 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream423: bytesWritten=3755175
2022-12-06 13:03:55,641 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=423, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:55,643 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=423, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:55,643 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-95D5D665D9AA->s0@group-BD1198AD89EB, cid=423, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-12-06 13:03:55,644 [s2-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#107-t4,previous=(t:4, i:89),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:90), STATEMACHINELOGENTRY, 423@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:55,644 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#114-t4,previous=(t:4, i:89),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:90), STATEMACHINELOGENTRY, 423@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:55,674 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:55,675 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 91 -> 90
2022-12-06 13:03:55,676 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:03:55,676 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 91 -> 90
2022-12-06 13:03:56,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:00,482 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=383, target=localhost:39843}}. 
2022-12-06 13:04:03,488 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=397, target=localhost:39843}}. 
2022-12-06 13:04:06,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:09,532 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=411, target=localhost:39843}}. 
2022-12-06 13:04:09,628 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=425, target=localhost:39843}}. 
2022-12-06 13:04:15,667 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=439, target=localhost:39843}}. 
2022-12-06 13:04:15,748 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=453, target=localhost:39843}}. 
2022-12-06 13:04:16,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:21,798 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=467, target=localhost:39843}}. 
2022-12-06 13:04:21,873 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=481, target=localhost:39843}}. 
2022-12-06 13:04:26,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:27,920 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=495, target=localhost:39843}}. 
2022-12-06 13:04:30,928 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=509, target=localhost:39843}}. 
2022-12-06 13:04:34,050 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=523, target=localhost:39843}}. 
2022-12-06 13:04:36,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:40,067 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=537, target=localhost:39843}}. 
2022-12-06 13:04:40,179 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=551, target=localhost:39843}}. 
2022-12-06 13:04:46,174 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:04:46,197 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=565, target=localhost:39843}}. 
2022-12-06 13:04:49,205 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=579, target=localhost:39843}}. 
2022-12-06 13:04:49,251 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:49,255 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:49,255 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#814-t4,previous=(t:4, i:90),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:91), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:49,258 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:49,259 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#807-t4,previous=(t:4, i:90),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:91), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:49,260 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:49,263 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 92 -> 91
2022-12-06 13:04:49,268 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:49,269 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 92 -> 91
2022-12-06 13:04:55,250 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=593, target=localhost:39843}}. 
2022-12-06 13:04:55,339 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=607, target=localhost:39843}}. 
2022-12-06 13:04:55,462 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:55,463 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:55,465 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#896-t4,previous=(t:4, i:91),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:92), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:55,463 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:04:55,471 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:55,471 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 93 -> 92
2022-12-06 13:04:55,471 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#889-t4,previous=(t:4, i:91),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:92), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:55,481 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:04:55,481 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 93 -> 92
2022-12-06 13:04:56,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:01,370 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=621, target=localhost:39843}}. 
2022-12-06 13:05:01,464 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=635, target=localhost:39843}}. 
2022-12-06 13:05:06,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:07,492 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=649, target=localhost:39843}}. 
2022-12-06 13:05:07,601 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=663, target=localhost:39843}}. 
2022-12-06 13:05:13,621 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=677, target=localhost:39843}}. 
2022-12-06 13:05:13,724 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=691, target=localhost:39843}}. 
2022-12-06 13:05:16,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:19,743 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=705, target=localhost:39843}}. 
2022-12-06 13:05:19,860 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=719, target=localhost:39843}}. 
2022-12-06 13:05:25,882 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=733, target=localhost:39843}}. 
2022-12-06 13:05:25,984 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=747, target=localhost:39843}}. 
2022-12-06 13:05:26,176 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:32,002 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=761, target=localhost:39843}}. 
2022-12-06 13:05:32,105 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=775, target=localhost:39843}}. 
2022-12-06 13:05:36,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:38,131 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=789, target=localhost:39843}}. 
2022-12-06 13:05:38,227 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=803, target=localhost:39843}}. 
2022-12-06 13:05:44,249 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=817, target=localhost:39843}}. 
2022-12-06 13:05:44,348 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=831, target=localhost:39843}}. 
2022-12-06 13:05:46,176 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:50,367 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=845, target=localhost:39843}}. 
2022-12-06 13:05:50,471 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=859, target=localhost:39843}}. 
2022-12-06 13:05:50,494 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:50,495 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:50,496 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#1616-t4,previous=(t:4, i:92),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:93), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:50,497 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:50,499 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#1609-t4,previous=(t:4, i:92),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:93), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:50,502 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:50,503 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 94 -> 93
2022-12-06 13:05:50,509 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:50,509 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 94 -> 93
2022-12-06 13:05:56,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:05:56,488 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=873, target=localhost:39843}}. 
2022-12-06 13:05:56,589 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=887, target=localhost:39843}}. 
2022-12-06 13:05:56,716 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:56,717 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:56,717 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:05:56,717 [s2-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#1693-t4,previous=(t:4, i:93),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:94), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:56,718 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#1700-t4,previous=(t:4, i:93),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:94), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1532)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:56,732 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:56,732 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 95 -> 94
2022-12-06 13:05:56,734 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:05:56,735 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 95 -> 94
2022-12-06 13:06:02,611 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=901, target=localhost:39843}}. 
2022-12-06 13:06:02,722 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=915, target=localhost:39843}}. 
2022-12-06 13:06:06,176 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:06:08,740 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=929, target=localhost:39843}}. 
2022-12-06 13:06:08,845 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=943, target=localhost:39843}}. 
2022-12-06 13:06:14,863 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=957, target=localhost:39843}}. 
2022-12-06 13:06:14,979 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=971, target=localhost:39843}}. 
2022-12-06 13:06:16,175 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:06:20,983 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=985, target=localhost:39843}}. 
2022-12-06 13:06:21,105 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=999, target=localhost:39843}}. 
2022-12-06 13:06:26,176 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:06:27,105 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1013, target=localhost:39843}}. 
2022-12-06 13:06:27,224 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1027, target=localhost:39843}}. 
2022-12-06 13:06:33,225 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1041, target=localhost:39843}}. 
2022-12-06 13:06:36,176 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:06:36,234 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1055, target=localhost:39843}}. 
2022-12-06 13:06:39,349 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1069, target=localhost:39843}}. 
2022-12-06 13:06:42,358 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1083, target=localhost:39843}}. 
2022-12-06 13:06:46,177 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:06:48,366 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1097, target=localhost:39843}}. 
2022-12-06 13:06:48,483 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1111, target=localhost:39843}}. 
2022-12-06 13:06:54,491 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1125, target=localhost:39843}}. 
2022-12-06 13:06:54,603 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1139, target=localhost:39843}}. 
2022-12-06 13:06:54,615 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:06:54,618 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:06:54,618 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#2458-t4,previous=(t:4, i:94),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:95), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:06:54,621 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:06:54,621 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#2451-t4,previous=(t:4, i:94),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:95), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:06:54,628 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:06:54,628 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 96 -> 95
2022-12-06 13:06:54,629 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:06:54,630 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 96 -> 95
2022-12-06 13:06:56,177 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:00,612 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1153, target=localhost:39843}}. 
2022-12-06 13:07:00,730 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1167, target=localhost:39843}}. 
2022-12-06 13:07:00,848 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:00,849 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:00,849 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:00,850 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#2541-t4,previous=(t:4, i:95),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:96), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:00,856 [s2-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#2535-t4,previous=(t:4, i:95),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:96), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:00,870 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:00,870 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 97 -> 96
2022-12-06 13:07:00,872 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:00,872 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 97 -> 96
2022-12-06 13:07:06,178 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:06,734 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1181, target=localhost:39843}}. 
2022-12-06 13:07:06,848 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1195, target=localhost:39843}}. 
2022-12-06 13:07:12,879 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1209, target=localhost:39843}}. 
2022-12-06 13:07:12,973 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1223, target=localhost:39843}}. 
2022-12-06 13:07:16,177 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:18,997 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1237, target=localhost:39843}}. 
2022-12-06 13:07:19,094 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1251, target=localhost:39843}}. 
2022-12-06 13:07:25,119 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1265, target=localhost:39843}}. 
2022-12-06 13:07:25,213 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1279, target=localhost:39843}}. 
2022-12-06 13:07:26,177 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:31,238 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1293, target=localhost:39843}}. 
2022-12-06 13:07:31,337 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1307, target=localhost:39843}}. 
2022-12-06 13:07:36,178 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:37,360 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1321, target=localhost:39843}}. 
2022-12-06 13:07:37,464 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1335, target=localhost:39843}}. 
2022-12-06 13:07:43,483 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1349, target=localhost:39843}}. 
2022-12-06 13:07:43,587 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1363, target=localhost:39843}}. 
2022-12-06 13:07:46,178 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:07:49,605 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1377, target=localhost:39843}}. 
2022-12-06 13:07:49,708 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1391, target=localhost:39843}}. 
2022-12-06 13:07:55,725 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1405, target=localhost:39843}}. 
2022-12-06 13:07:55,830 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1419, target=localhost:39843}}. 
2022-12-06 13:07:55,851 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:55,852 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:55,852 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:07:55,853 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#3256-t4,previous=(t:4, i:96),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:97), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:55,855 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#3262-t4,previous=(t:4, i:96),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:97), STATEMACHINELOGENTRY, 395@client-448F7CBC4654
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:55,863 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:55,863 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 98 -> 97
2022-12-06 13:07:55,865 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:07:55,865 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 98 -> 97
2022-12-06 13:07:56,178 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:08:01,851 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1433, target=localhost:39843}}. 
2022-12-06 13:08:01,952 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1447, target=localhost:39843}}. 
2022-12-06 13:08:02,089 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:08:02,090 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:08:02,090 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-12-06 13:08:02,090 [s1-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#3346-t4,previous=(t:4, i:97),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:98), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:08:02,091 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#3340-t4,previous=(t:4, i:97),leaderCommit=82,initializing? true,entries: size=1, first=(t:4, i:98), STATEMACHINELOGENTRY, 422@client-95D5D665D9AA
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:08:02,094 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:08:02,102 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s1: nextIndex: updateUnconditionally 99 -> 98
2022-12-06 13:08:02,106 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-BD1198AD89EB->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 83 for task WriteLog:83: (t:4, i:83), STATEMACHINELOGENTRY, StateMachineLogEntryProto:395@client-448F7CBC4654
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 4
index: 83
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\267G\024\371k\242B\300\255\221D\217|\274FT"
  callId: 395
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1520)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1388)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:813)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2022-12-06 13:08:02,106 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-BD1198AD89EB->s2: nextIndex: updateUnconditionally 99 -> 98
2022-12-06 13:08:06,179 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s0@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-BD1198AD89EB:t4, leader=s0, voted=s0, raftlog=Memoized:s1@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-BD1198AD89EB:t4, leader=s0, voted=s2, raftlog=Memoized:s2@group-BD1198AD89EB-SegmentedRaftLog:OPENED:c82, conf=81: peers:[s0|rpc:localhost:40727|admin:localhost:42117|client:localhost:39843|dataStream:localhost:39837|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35713|admin:localhost:46153|client:localhost:44441|dataStream:localhost:35971|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:34381|admin:localhost:37429|client:localhost:41515|dataStream:localhost:42945|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-12-06 13:08:07,970 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1461, target=localhost:39843}}. 
2022-12-06 13:08:08,089 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1475, target=localhost:39843}}. 
2022-12-06 13:08:14,089 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1489, target=localhost:39843}}. 
2022-12-06 13:08:14,206 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1503, target=localhost:39843}}. 
]]></system-out>
    <system-err><![CDATA[Dec 06, 2022 1:03:47 PM org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor run
SEVERE: Exception while executing runnable org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@2ba1df12
java.lang.IllegalStateException: Entry not found for key 0 in map OrderedStreamObservers
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:73)
	at org.apache.ratis.util.CollectionUtils.removeExisting(CollectionUtils.java:130)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedStreamObservers.removeExisting(GrpcClientProtocolService.java:115)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.cleanup(GrpcClientProtocolService.java:395)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.close(GrpcClientProtocolService.java:389)
	at org.apache.ratis.grpc.server.GrpcClientProtocolService$OrderedRequestStreamObserver.onCompleted(GrpcClientProtocolService.java:379)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onHalfClose(ServerCalls.java:273)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:354)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:866)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

]]></system-err>
  </testcase>
  <testcase name="testStreamWrites" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="4.131"/>
</testsuite>