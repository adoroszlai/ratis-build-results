<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="151.684" tests="4" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.0/ratis-thirdparty-misc-1.0.0.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-2.3.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.2.5/metrics-jvm-3.2.5.jar:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.5/metrics-core-3.2.5.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter4819622071128042332.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2022-05-18T08-03-03_280-jvmRun1 surefire279902627812327913tmp surefire_33200010474106965427tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.0/ratis-thirdparty-misc-1.0.0.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-2.3.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.2.5/metrics-jvm-3.2.5.jar:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.5/metrics-core-3.2.5.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter4819622071128042332.jar"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_332-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.4.0-1078-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="1.8.0_332"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.332-b09"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testMultipleStreamsSingleServer" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="22.352"/>
  <testcase name="testMultipleStreamsMultipleServers" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="66.031"/>
  <testcase name="testMultipleStreamsMultipleServersStepDownLeader" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="44.057">
    <error message="org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0" type="java.util.concurrent.CompletionException">java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:783)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
	... 12 more
</error>
    <system-out><![CDATA[2022-05-18 08:08:58,989 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-05-18 08:08:58,989 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-05-18 08:08:58,990 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(119)) - Running runWithNewCluster
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(272)) - new MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty with group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0]
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(315)) - .............................................................. 
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(316)) - ... 
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(317)) - ...     Starting MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(318)) - ... 
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(319)) - .............................................................. 
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(284)) - servers = {}
2022-05-18 08:08:58,991 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(358)) - newRaftServer: s0, group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], format? true
2022-05-18 08:08:58,991 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0
2022-05-18 08:08:58,992 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0 does not exist.
2022-05-18 08:08:58,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(363)) - Formatted directory target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0
2022-05-18 08:08:58,992 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-05-18 08:08:58,992 [Time-limited test] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-05-18 08:08:58,992 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 44289 (custom)
2022-05-18 08:08:58,993 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 35433 (custom)
2022-05-18 08:08:58,993 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 40531 (custom)
2022-05-18 08:08:58,993 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-05-18 08:08:58,993 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:58,993 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-05-18 08:08:58,993 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:08:58,993 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-05-18 08:08:58,993 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:58,994 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:58,994 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-05-18 08:08:58,995 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-05-18 08:08:58,996 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 42101 (custom)
2022-05-18 08:08:58,996 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-05-18 08:08:58,996 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-05-18 08:08:58,996 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18] REGISTERED
2022-05-18 08:08:58,996 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:58,996 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18] BIND: 0.0.0.0/0.0.0.0:42101
2022-05-18 08:08:58,997 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:58,997 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0] (custom)
2022-05-18 08:08:58,997 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] ACTIVE
2022-05-18 08:08:58,998 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s0: addNew group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] returns group-B23F4A4B975A:java.util.concurrent.CompletableFuture@21a95210[Not completed]
2022-05-18 08:08:58,998 [pool-10-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(190)) - s0: new RaftServerImpl for group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] with MultiDataStreamStateMachine:uninitialized
2022-05-18 08:08:58,998 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(358)) - newRaftServer: s1, group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], format? true
2022-05-18 08:08:59,000 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1
2022-05-18 08:08:59,000 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1 does not exist.
2022-05-18 08:08:59,000 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(363)) - Formatted directory target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1
2022-05-18 08:08:59,000 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-05-18 08:08:59,001 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-05-18 08:08:59,001 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-05-18 08:08:59,001 [Time-limited test] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-05-18 08:08:59,001 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-05-18 08:08:59,001 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 37277 (custom)
2022-05-18 08:08:59,001 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 39633 (custom)
2022-05-18 08:08:59,002 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 35349 (custom)
2022-05-18 08:08:59,002 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:08:59,002 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-05-18 08:08:59,002 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:59,002 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-05-18 08:08:59,002 [pool-10-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(107)) - s0@group-B23F4A4B975A: ConfigurationManager, init=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null, confs=<EMPTY_MAP>
2022-05-18 08:08:59,003 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0] (custom)
2022-05-18 08:08:59,003 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-05-18 08:08:59,003 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-05-18 08:08:59,003 [pool-10-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a does not exist. Creating ...
2022-05-18 08:08:59,004 [pool-10-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,005 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,005 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-05-18 08:08:59,005 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-05-18 08:08:59,005 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:59,005 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-05-18 08:08:59,006 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-05-18 08:08:59,006 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-05-18 08:08:59,006 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-05-18 08:08:59,007 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-05-18 08:08:59,007 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 42717 (custom)
2022-05-18 08:08:59,012 [pool-10-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/in_use.lock acquired by nodename 19159@fv-az58-550.32bp4kehjaiexiom31oljkjdjg.cx.internal.cloudapp.net
2022-05-18 08:08:59,012 [pool-10-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current
2022-05-18 08:08:59,012 [pool-10-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/sm
2022-05-18 08:08:59,014 [pool-10-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a has been successfully formatted.
2022-05-18 08:08:59,015 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-05-18 08:08:59,016 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9] REGISTERED
2022-05-18 08:08:59,016 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-05-18 08:08:59,015 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-05-18 08:08:59,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-05-18 08:08:59,016 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9] BIND: 0.0.0.0/0.0.0.0:42717
2022-05-18 08:08:59,017 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-05-18 08:08:59,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:59,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:59,017 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1] (custom)
2022-05-18 08:08:59,017 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,017 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] ACTIVE
2022-05-18 08:08:59,017 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s0@group-B23F4A4B975A-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-05-18 08:08:59,018 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,019 [pool-10-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,020 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-05-18 08:08:59,020 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-05-18 08:08:59,020 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s1: addNew group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] returns group-B23F4A4B975A:java.util.concurrent.CompletableFuture@6b38d061[Not completed]
2022-05-18 08:08:59,020 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-05-18 08:08:59,020 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-05-18 08:08:59,020 [pool-11-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(190)) - s1: new RaftServerImpl for group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] with MultiDataStreamStateMachine:uninitialized
2022-05-18 08:08:59,020 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100Î¼s (default)
2022-05-18 08:08:59,022 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(358)) - newRaftServer: s2, group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], format? true
2022-05-18 08:08:59,023 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2
2022-05-18 08:08:59,023 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2 does not exist.
2022-05-18 08:08:59,023 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(363)) - Formatted directory target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2
2022-05-18 08:08:59,024 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 34149 (custom)
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 40571 (custom)
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 36619 (custom)
2022-05-18 08:08:59,024 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-05-18 08:08:59,024 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:08:59,024 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-05-18 08:08:59,024 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-05-18 08:08:59,024 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-05-18 08:08:59,025 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-05-18 08:08:59,024 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:59,026 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,026 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2022-05-18 08:08:59,026 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(107)) - s1@group-B23F4A4B975A: ConfigurationManager, init=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null, confs=<EMPTY_MAP>
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1] (custom)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-05-18 08:08:59,027 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-05-18 08:08:59,028 [pool-11-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a does not exist. Creating ...
2022-05-18 08:08:59,028 [pool-11-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,027 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2022-05-18 08:08:59,029 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2022-05-18 08:08:59,029 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2022-05-18 08:08:59,029 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2022-05-18 08:08:59,029 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2022-05-18 08:08:59,029 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2022-05-18 08:08:59,029 [pool-11-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/in_use.lock acquired by nodename 19159@fv-az58-550.32bp4kehjaiexiom31oljkjdjg.cx.internal.cloudapp.net
2022-05-18 08:08:59,029 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2022-05-18 08:08:59,029 [pool-11-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current
2022-05-18 08:08:59,030 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 41933 (custom)
2022-05-18 08:08:59,030 [pool-11-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/sm
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a has been successfully formatted.
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,031 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s1@group-B23F4A4B975A-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:08:59,032 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-05-18 08:08:59,033 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-05-18 08:08:59,033 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-05-18 08:08:59,034 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-05-18 08:08:59,034 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:59,034 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:59,034 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2] (custom)
2022-05-18 08:08:59,034 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-05-18 08:08:59,034 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-05-18 08:08:59,034 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-05-18 08:08:59,035 [pool-11-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,035 [pool-11-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,035 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70] REGISTERED
2022-05-18 08:08:59,035 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70] BIND: 0.0.0.0/0.0.0.0:41933
2022-05-18 08:08:59,035 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] ACTIVE
2022-05-18 08:08:59,036 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-05-18 08:08:59,036 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-05-18 08:08:59,036 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-05-18 08:08:59,036 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s2: addNew group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] returns group-B23F4A4B975A:java.util.concurrent.CompletableFuture@caff1c[Not completed]
2022-05-18 08:08:59,036 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-05-18 08:08:59,036 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100Î¼s (default)
2022-05-18 08:08:59,037 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(310)) - s0@group-B23F4A4B975A: start as a follower, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,037 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:08:59,038 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-05-18 08:08:59,038 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-05-18 08:08:59,038 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-05-18 08:08:59,038 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-05-18 08:08:59,037 [pool-12-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(190)) - s2: new RaftServerImpl for group-B23F4A4B975A:[s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0] with MultiDataStreamStateMachine:uninitialized
2022-05-18 08:08:59,038 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-05-18 08:08:59,039 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-05-18 08:08:59,040 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(107)) - s2@group-B23F4A4B975A: ConfigurationManager, init=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null, confs=<EMPTY_MAP>
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2] (custom)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-05-18 08:08:59,040 [pool-12-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a does not exist. Creating ...
2022-05-18 08:08:59,041 [pool-12-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,041 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s0
2022-05-18 08:08:59,042 [pool-12-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/in_use.lock acquired by nodename 19159@fv-az58-550.32bp4kehjaiexiom31oljkjdjg.cx.internal.cloudapp.net
2022-05-18 08:08:59,042 [pool-12-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current
2022-05-18 08:08:59,042 [pool-12-thread-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/sm
2022-05-18 08:08:59,043 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$6(382)) - s0: start RPC server
2022-05-18 08:08:59,043 [pool-12-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a has been successfully formatted.
2022-05-18 08:08:59,044 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-05-18 08:08:59,044 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-05-18 08:08:59,051 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 40531
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-05-18 08:08:59,052 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s2@group-B23F4A4B975A-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-05-18 08:08:59,053 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-05-18 08:08:59,054 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100Î¼s (default)
2022-05-18 08:08:59,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:08:59,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-05-18 08:08:59,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-05-18 08:08:59,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-05-18 08:08:59,055 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-05-18 08:08:59,058 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 44289
2022-05-18 08:08:59,063 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s0: GrpcService started, listening on 35433
2022-05-18 08:08:59,063 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(310)) - s1@group-B23F4A4B975A: start as a follower, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,063 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-05-18 08:08:59,063 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@b140e97] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s0: Started
2022-05-18 08:08:59,063 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,064 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s1
2022-05-18 08:08:59,065 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$6(382)) - s1: start RPC server
2022-05-18 08:08:59,070 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s1: GrpcService started, listening on 35349
2022-05-18 08:08:59,072 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s1: GrpcService started, listening on 37277
2022-05-18 08:08:59,074 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s1: GrpcService started, listening on 39633
2022-05-18 08:08:59,075 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(310)) - s2@group-B23F4A4B975A: start as a follower, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,075 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-05-18 08:08:59,076 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,078 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s2
2022-05-18 08:08:59,079 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$6(382)) - s2: start RPC server
2022-05-18 08:08:59,085 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s2: GrpcService started, listening on 36619
2022-05-18 08:08:59,087 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@7d6e28c6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s1: Started
2022-05-18 08:08:59,087 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s2: GrpcService started, listening on 34149
2022-05-18 08:08:59,089 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(260)) - s2: GrpcService started, listening on 40571
2022-05-18 08:08:59,090 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@46ba1d75] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s2: Started
2022-05-18 08:08:59,090 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-05-18 08:08:59,090 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:08:59,090 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(172)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:533)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:567)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:560)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:166)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:152)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:90)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStreamStepDownLeader(DataStreamAsyncClusterTests.java:82)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:125)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:113)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsMultipleServersStepDownLeader(DataStreamAsyncClusterTests.java:78)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:08:59,229 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-B23F4A4B975A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:190759834ns, electionTimeout:188ms
2022-05-18 08:08:59,231 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,231 [s0@group-B23F4A4B975A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-05-18 08:08:59,231 [s0@group-B23F4A4B975A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-05-18 08:08:59,231 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-LeaderElection4
2022-05-18 08:08:59,234 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-B23F4A4B975A-LeaderElection4 PRE_VOTE round 0: submit vote requests at term 0 for -1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,246 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s0, group-B23F4A4B975A, 0, (t:0, i:0))
2022-05-18 08:08:59,246 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-05-18 08:08:59,247 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,249 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s2@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s0, group-B23F4A4B975A, 0, (t:0, i:0))
2022-05-18 08:08:59,249 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-B23F4A4B975A-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2022-05-18 08:08:59,249 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s2@group-B23F4A4B975A replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-B23F4A4B975A:t0, leader=null, voted=, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,250 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-B23F4A4B975A-LeaderElection4: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:08:59,253 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s2#0:OK-t0
2022-05-18 08:08:59,253 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-B23F4A4B975A-LeaderElection4 PRE_VOTE round 0: result PASSED
2022-05-18 08:08:59,262 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-B23F4A4B975A-LeaderElection4 ELECTION round 0: submit vote requests at term 1 for -1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,265 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s2@group-B23F4A4B975A: receive requestVote(ELECTION, s0, group-B23F4A4B975A, 1, (t:0, i:0))
2022-05-18 08:08:59,266 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-B23F4A4B975A-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-05-18 08:08:59,266 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s0
2022-05-18 08:08:59,266 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,266 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,268 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:08:59,272 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(ELECTION, s0, group-B23F4A4B975A, 1, (t:0, i:0))
2022-05-18 08:08:59,273 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2022-05-18 08:08:59,273 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s0
2022-05-18 08:08:59,273 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,273 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:08:59,274 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:08:59,275 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to ELECTION vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-B23F4A4B975A:t1, leader=null, voted=s0, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,276 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-B23F4A4B975A-LeaderElection4: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:08:59,276 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s0<-s1#0:OK-t1
2022-05-18 08:08:59,276 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-B23F4A4B975A-LeaderElection4 ELECTION round 0: result PASSED
2022-05-18 08:08:59,276 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-B23F4A4B975A-LeaderElection4
2022-05-18 08:08:59,276 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2022-05-18 08:08:59,277 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s0@group-B23F4A4B975A: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 262ms
2022-05-18 08:08:59,277 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-05-18 08:08:59,277 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:08:59,277 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:08:59,278 [s0@group-B23F4A4B975A-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:08:59,279 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:08:59,279 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:08:59,279 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:08:59,280 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s2@group-B23F4A4B975A replies to ELECTION vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-B23F4A4B975A:t1, leader=null, voted=s0, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c-1, conf=-1: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,281 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:08:59,283 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:08:59,283 [s0@group-B23F4A4B975A-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:08:59,283 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:08:59,283 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:08:59,283 [s0@group-B23F4A4B975A-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:08:59,284 [s0@group-B23F4A4B975A-LeaderElection4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: Starting segment from index:0
2022-05-18 08:08:59,295 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0
2022-05-18 08:08:59,324 [s0@group-B23F4A4B975A-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s0@group-B23F4A4B975A: set configuration 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,326 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s1@group-B23F4A4B975A: change Leader from null to s0 at term 1 for appendEntries, leader elected after 295ms
2022-05-18 08:08:59,329 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s2@group-B23F4A4B975A: change Leader from null to s0 at term 1 for appendEntries, leader elected after 285ms
2022-05-18 08:08:59,340 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s1@group-B23F4A4B975A: set configuration 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,340 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: Starting segment from index:0
2022-05-18 08:08:59,353 [s1@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0
2022-05-18 08:08:59,355 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s2@group-B23F4A4B975A: set configuration 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:08:59,356 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: Starting segment from index:0
2022-05-18 08:08:59,367 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0
2022-05-18 08:08:59,541 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-B23F4A4B975A:t1, leader=s0, voted=s0, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c0, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t1, leader=s0, voted=s0, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c0, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-B23F4A4B975A:t1, leader=s0, voted=s0, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c0, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:08:59,548 [pool-9-thread-7] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,548 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,548 [pool-9-thread-6] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,553 [pool-9-thread-4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,553 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,553 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,553 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,553 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,554 [pool-9-thread-8] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,554 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,554 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,554 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,555 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,556 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,556 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,556 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,556 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,553 [pool-9-thread-5] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,553 [pool-9-thread-3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,557 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,557 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,548 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,557 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,557 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,557 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,558 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,558 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,558 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,557 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,558 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,569 [pool-9-thread-9] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,569 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x5313081a, L:/127.0.0.1:41933 - R:/127.0.0.1:37804]
2022-05-18 08:08:59,570 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,570 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,570 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,570 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,572 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream366
2022-05-18 08:08:59,575 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream367
2022-05-18 08:08:59,588 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xa5e4f834, L:/127.0.0.1:42101 - R:/127.0.0.1:46632]
2022-05-18 08:08:59,604 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream371
2022-05-18 08:08:59,609 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream370
2022-05-18 08:08:59,612 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream369
2022-05-18 08:08:59,619 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,620 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xe92d1772, L:/127.0.0.1:41933 - R:/127.0.0.1:37806]
2022-05-18 08:08:59,621 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,621 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,622 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,622 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,622 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,625 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xbe6b2c6a, L:/127.0.0.1:41933 - R:/127.0.0.1:37808]
2022-05-18 08:08:59,628 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,628 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,628 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,629 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,629 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,632 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xe36c1984, L:/127.0.0.1:41933 - R:/127.0.0.1:37810]
2022-05-18 08:08:59,632 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xea08fa70, L:/127.0.0.1:41933 - R:/127.0.0.1:37816]
2022-05-18 08:08:59,632 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,633 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,633 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,633 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,634 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream373
2022-05-18 08:08:59,634 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,636 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,640 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream372
2022-05-18 08:08:59,646 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,647 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xfb4613f2, L:/127.0.0.1:42101 - R:/127.0.0.1:46634]
2022-05-18 08:08:59,647 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,647 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,647 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,648 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,648 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,648 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,648 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,648 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,649 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,649 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,649 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,650 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,650 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x5f3f051a, L:/127.0.0.1:42101 - R:/127.0.0.1:46638]
2022-05-18 08:08:59,650 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,650 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,650 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,650 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,653 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,653 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,660 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,660 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,660 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,660 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,661 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,661 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,661 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,661 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,659 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x1c6d086c, L:/127.0.0.1:42101 - R:/127.0.0.1:46640]
2022-05-18 08:08:59,659 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,662 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,658 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x3c22d9b6, L:/127.0.0.1:42717 - R:/127.0.0.1:39464]
2022-05-18 08:08:59,663 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xf7bd52c4, L:/127.0.0.1:41933 - R:/127.0.0.1:37830]
2022-05-18 08:08:59,663 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,664 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x8bba9be6, L:/127.0.0.1:41933 - R:/127.0.0.1:37832]
2022-05-18 08:08:59,664 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,668 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x19648aaa, L:/127.0.0.1:42101 - R:/127.0.0.1:46654]
2022-05-18 08:08:59,668 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,669 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,669 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,669 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,669 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,669 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,670 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,670 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,670 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,670 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,670 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,673 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,673 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x82a1190b, L:/127.0.0.1:42717 - R:/127.0.0.1:39466]
2022-05-18 08:08:59,673 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,673 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,674 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,674 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,674 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,675 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,675 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,675 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,675 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,675 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,676 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x38e4dad7, L:/127.0.0.1:42717 - R:/127.0.0.1:39468]
2022-05-18 08:08:59,678 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xc3bea6e4, L:/127.0.0.1:42101 - R:/127.0.0.1:46658]
2022-05-18 08:08:59,678 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,678 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,678 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,678 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,678 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,678 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,681 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,681 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,681 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,681 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,682 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,682 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,682 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,682 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,687 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x51ca1633, L:/127.0.0.1:42101 - R:/127.0.0.1:46662]
2022-05-18 08:08:59,687 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,688 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,688 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,688 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,688 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,688 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,691 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xe69e9e68, L:/127.0.0.1:42717 - R:/127.0.0.1:39470]
2022-05-18 08:08:59,693 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xa37117b4, L:/127.0.0.1:41933 - R:/127.0.0.1:37848]
2022-05-18 08:08:59,693 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x4e71590d, L:/127.0.0.1:42717 - R:/127.0.0.1:39478]
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x220e4447, L:/127.0.0.1:42717 - R:/127.0.0.1:39482]
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x41ebab1d, L:/127.0.0.1:42717 - R:/127.0.0.1:39486]
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x24979b69, L:/127.0.0.1:42717 - R:/127.0.0.1:39488]
2022-05-18 08:08:59,694 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,695 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,702 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,702 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,703 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,703 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x6a1d18a7, L:/127.0.0.1:42717 - R:/127.0.0.1:39492]
2022-05-18 08:08:59,703 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,703 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,708 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xf9c87d85, L:/127.0.0.1:41933 - R:/127.0.0.1:37852]
2022-05-18 08:08:59,708 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,709 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,709 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,709 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,710 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,710 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,721 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x7657de54, L:/127.0.0.1:42717 - R:/127.0.0.1:39496]
2022-05-18 08:08:59,721 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,721 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,721 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,721 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,721 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,722 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,723 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,723 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,723 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,723 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,724 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,725 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,725 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,725 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,725 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,725 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,725 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x831fda0b, L:/127.0.0.1:42717 - R:/127.0.0.1:39498]
2022-05-18 08:08:59,726 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,726 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,726 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,726 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,727 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,727 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,730 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xfc1421eb, L:/127.0.0.1:42101 - R:/127.0.0.1:46678]
2022-05-18 08:08:59,730 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,730 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,730 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,730 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,731 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,731 [s2-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,731 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x13800500, L:/127.0.0.1:41933 - R:/127.0.0.1:37860]
2022-05-18 08:08:59,732 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,734 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,734 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,734 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,734 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,734 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,735 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xef30bfe2, L:/127.0.0.1:41933 - R:/127.0.0.1:37862]
2022-05-18 08:08:59,735 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,737 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x6a18ea03, L:/127.0.0.1:42101 - R:/127.0.0.1:46684]
2022-05-18 08:08:59,737 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,738 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,738 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,738 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,737 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,738 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,741 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,741 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x02d632ee, L:/127.0.0.1:42717 - R:/127.0.0.1:39508]
2022-05-18 08:08:59,741 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,742 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,742 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,742 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,742 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,744 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,744 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,744 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,744 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,744 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,750 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x277f961f, L:/127.0.0.1:42717 - R:/127.0.0.1:39512]
2022-05-18 08:08:59,750 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,750 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,750 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,750 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,750 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,750 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,863 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0x075091e8, L:/127.0.0.1:42101 - R:/127.0.0.1:46688]
2022-05-18 08:08:59,863 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,865 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xec2849e7, L:/127.0.0.1:42717 - R:/127.0.0.1:39514]
2022-05-18 08:08:59,865 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,865 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0xacaca72e, L:/127.0.0.1:41933 - R:/127.0.0.1:37872]
2022-05-18 08:08:59,865 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,865 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,865 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,866 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,866 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,867 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,867 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,867 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,868 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,868 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,868 [s2-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,869 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xd6305c79, L:/127.0.0.1:42717 - R:/127.0.0.1:39518]
2022-05-18 08:08:59,869 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,869 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,869 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,869 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,869 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,869 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,870 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,870 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,871 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,871 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,871 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,872 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,872 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,872 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,872 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,872 [s2-NettyServerStreamRpc-workerGroup--thread3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,873 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,873 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,873 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,873 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,873 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,874 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,874 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,874 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,874 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,874 [s2-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,875 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xe495fe1f, L:/127.0.0.1:42101 - R:/127.0.0.1:46698]
2022-05-18 08:08:59,875 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ: [id: 0xc0a3a000, L:/127.0.0.1:42101 - R:/127.0.0.1:46700]
2022-05-18 08:08:59,875 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] READ COMPLETE
2022-05-18 08:08:59,897 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xa263a37b, L:/127.0.0.1:42717 - R:/127.0.0.1:39524]
2022-05-18 08:08:59,897 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,899 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x5c8ebb44, L:/127.0.0.1:42717 - R:/127.0.0.1:39526]
2022-05-18 08:08:59,899 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,902 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x0e379b1d, L:/127.0.0.1:41933 - R:/127.0.0.1:37886]
2022-05-18 08:08:59,902 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,903 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,903 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,903 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,903 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,903 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,904 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xde203785, L:/127.0.0.1:42717 - R:/127.0.0.1:39530]
2022-05-18 08:08:59,904 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,906 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0x9a26374d, L:/127.0.0.1:42717 - R:/127.0.0.1:39532]
2022-05-18 08:08:59,906 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,907 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,907 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,907 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,907 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,907 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,909 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x45d17ad8, L:/127.0.0.1:41933 - R:/127.0.0.1:37892]
2022-05-18 08:08:59,909 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:08:59,909 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,910 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,910 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,910 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,910 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,914 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ: [id: 0xda8c4ca1, L:/127.0.0.1:42717 - R:/127.0.0.1:39536]
2022-05-18 08:08:59,914 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] READ COMPLETE
2022-05-18 08:08:59,914 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2022-05-18 08:08:59,914 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2022-05-18 08:08:59,914 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2022-05-18 08:08:59,915 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2022-05-18 08:08:59,915 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2022-05-18 08:08:59,916 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ: [id: 0x1c26d94d, L:/127.0.0.1:41933 - R:/127.0.0.1:37896]
2022-05-18 08:08:59,916 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] READ COMPLETE
2022-05-18 08:09:00,245 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream370: bytesWritten=7452919
2022-05-18 08:09:00,276 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream369: bytesWritten=8083899
2022-05-18 08:09:00,306 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream371: bytesWritten=7991853
2022-05-18 08:09:00,324 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream373: bytesWritten=7743189
2022-05-18 08:09:00,377 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=370, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,379 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=370, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,380 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-87B95DD4B360->s2@group-B23F4A4B975A, cid=369, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,381 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-87B95DD4B360->s2@group-B23F4A4B975A, cid=369, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,382 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=371, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,383 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=371, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,401 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=370, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,410 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream375
2022-05-18 08:09:00,410 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-87B95DD4B360->s2@group-B23F4A4B975A, cid=369, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,410 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=371, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,409 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-67AC23D7C78F->s0@group-B23F4A4B975A, cid=373, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,410 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream374
2022-05-18 08:09:00,420 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-67AC23D7C78F->s0@group-B23F4A4B975A, cid=373, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,479 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-67AC23D7C78F->s0@group-B23F4A4B975A, cid=373, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,590 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream376
2022-05-18 08:09:00,607 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream375: bytesWritten=7057364
2022-05-18 08:09:00,616 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=375, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,618 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=375, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,646 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=375, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,648 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream377
2022-05-18 08:09:00,649 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream374: bytesWritten=8033139
2022-05-18 08:09:00,669 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=374, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,672 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream378
2022-05-18 08:09:00,682 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=374, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,740 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=374, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,868 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream376: bytesWritten=7260437
2022-05-18 08:09:00,887 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:00,899 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream379
2022-05-18 08:09:01,001 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream377: bytesWritten=7674239
2022-05-18 08:09:01,009 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,037 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream378: bytesWritten=8073714
2022-05-18 08:09:01,039 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,074 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream379: bytesWritten=7332245
2022-05-18 08:09:01,076 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,131 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,140 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream380
2022-05-18 08:09:01,177 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=376, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,370 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,370 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,398 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream381
2022-05-18 08:09:01,416 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,420 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,427 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=378, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,428 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=379, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,449 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream382
2022-05-18 08:09:01,476 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream383
2022-05-18 08:09:01,538 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream380: bytesWritten=7870801
2022-05-18 08:09:01,554 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,557 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,681 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream381: bytesWritten=6948805
2022-05-18 08:09:01,686 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,697 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,767 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream383: bytesWritten=7777162
2022-05-18 08:09:01,770 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,771 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream382: bytesWritten=7673112
2022-05-18 08:09:01,775 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,782 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,783 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,784 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,793 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream384
2022-05-18 08:09:01,830 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream385
2022-05-18 08:09:01,853 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream386
2022-05-18 08:09:01,862 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream387
2022-05-18 08:09:01,868 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=381, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,873 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=383, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,873 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-59502F9A9D13->s2@group-B23F4A4B975A, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:01,878 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream388
2022-05-18 08:09:02,105 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream384: bytesWritten=7251025
2022-05-18 08:09:02,110 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,202 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream387: bytesWritten=8171795
2022-05-18 08:09:02,211 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,226 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream386: bytesWritten=7357600
2022-05-18 08:09:02,226 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream385: bytesWritten=7576882
2022-05-18 08:09:02,227 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream388: bytesWritten=7631920
2022-05-18 08:09:02,229 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,235 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,236 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,331 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,359 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=384, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,359 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,369 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream389
2022-05-18 08:09:02,389 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=387, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,389 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,390 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,390 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:02,436 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream390
2022-05-18 08:09:03,507 [s0@group-B23F4A4B975A-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1018)) - s0@group-B23F4A4B975A-LeaderStateImpl: Lost leadership on term: 1. Election timeout: 300ms. In charge for: 4230ms. Conf: 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:03,508 [s0@group-B23F4A4B975A-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1022)) - Follower s0@group-B23F4A4B975A->s1(c28,m29,n36, attendVote=true, lastRpcSendTime=981, lastRpcResponseTime=1139)
2022-05-18 08:09:03,509 [s0@group-B23F4A4B975A-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1022)) - Follower s0@group-B23F4A4B975A->s2(c28,m30,n36, attendVote=true, lastRpcSendTime=962, lastRpcResponseTime=1075)
2022-05-18 08:09:03,509 [s0@group-B23F4A4B975A-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from    LEADER to FOLLOWER at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-05-18 08:09:03,509 [s0@group-B23F4A4B975A-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s0: shutdown s0@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:09:03,509 [s0@group-B23F4A4B975A-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s0@group-B23F4A4B975A-PendingRequests: sendNotLeaderResponses
2022-05-18 08:09:03,512 [s2@group-B23F4A4B975A-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 199ms but took extra 902641978ns (> threshold = 300ms)
2022-05-18 08:09:03,537 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=385, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:03,533 [s0@group-B23F4A4B975A->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(171)) - s0@group-B23F4A4B975A->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-05-18 08:09:03,533 [s0@group-B23F4A4B975A->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(171)) - s0@group-B23F4A4B975A->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-05-18 08:09:03,529 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@b140e97] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(124)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 964257874ns.
GC pool 'PS MarkSweep' had collection(s): count=1 time=826ms
GC pool 'PS Scavenge' had collection(s): count=1 time=113ms
2022-05-18 08:09:03,516 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@7d6e28c6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(124)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 927708702ns.
GC pool 'PS MarkSweep' had collection(s): count=1 time=826ms
GC pool 'PS Scavenge' had collection(s): count=1 time=113ms
2022-05-18 08:09:03,516 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@46ba1d75] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(124)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 925294283ns.
GC pool 'PS MarkSweep' had collection(s): count=1 time=826ms
GC pool 'PS Scavenge' had collection(s): count=1 time=113ms
2022-05-18 08:09:03,512 [s1@group-B23F4A4B975A-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 282ms but took extra 919658321ns (> threshold = 300ms)
2022-05-18 08:09:03,561 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream389: bytesWritten=7689308
2022-05-18 08:09:03,562 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=388, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:03,564 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-3EB1F4F89024->s2@group-B23F4A4B975A, cid=386, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:03,588 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream390: bytesWritten=6800110
2022-05-18 08:09:03,611 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#224-t1,previous=(t:1, i:34),leaderCommit=30,initializing? true,entries: size=1, first=(t:1, i:35), METADATAENTRY(c:30)
2022-05-18 08:09:03,612 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s0@group-B23F4A4B975A->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:03,612 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-B23F4A4B975A->s1: nextIndex: updateUnconditionally 36 -> 32
2022-05-18 08:09:03,663 [s0@group-B23F4A4B975A-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:03,672 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#234-t1,previous=(t:1, i:34),leaderCommit=30,initializing? true,entries: size=1, first=(t:1, i:35), METADATAENTRY(c:30)
2022-05-18 08:09:03,676 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s0@group-B23F4A4B975A->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:03,677 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s0@group-B23F4A4B975A->s2: nextIndex: updateUnconditionally 36 -> 35
2022-05-18 08:09:03,919 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(108)) - s0@group-B23F4A4B975A-FollowerState: Skipping leader election since it stepped down recently (elapsed = 255ms < waitTime = 10s)
2022-05-18 08:09:03,996 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-B23F4A4B975A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:322728192ns, electionTimeout:164ms
2022-05-18 08:09:03,996 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:03,996 [s1@group-B23F4A4B975A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-05-18 08:09:03,996 [s1@group-B23F4A4B975A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-05-18 08:09:03,996 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-LeaderElection5
2022-05-18 08:09:04,014 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s1@group-B23F4A4B975A: change Leader from s0 to null at term 1 for PRE_VOTE
2022-05-18 08:09:04,015 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-B23F4A4B975A-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 1 for 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,051 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s0@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s1, group-B23F4A4B975A, 1, (t:1, i:35))
2022-05-18 08:09:04,051 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-B23F4A4B975A-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,052 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s0@group-B23F4A4B975A replies to PRE_VOTE vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-B23F4A4B975A:t1, leader=s0, voted=s0, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,058 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-B23F4A4B975A-LeaderElection5: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:09:04,060 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s0#0:OK-t1
2022-05-18 08:09:04,061 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-B23F4A4B975A-LeaderElection5 PRE_VOTE round 0: result PASSED
2022-05-18 08:09:04,077 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-B23F4A4B975A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:347136070ns, electionTimeout:299ms
2022-05-18 08:09:04,084 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:04,084 [s2@group-B23F4A4B975A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-05-18 08:09:04,084 [s2@group-B23F4A4B975A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-05-18 08:09:04,085 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-LeaderElection6
2022-05-18 08:09:04,095 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-B23F4A4B975A-LeaderElection5 ELECTION round 0: submit vote requests at term 2 for 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,102 [s2@group-B23F4A4B975A-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s2@group-B23F4A4B975A: change Leader from s0 to null at term 1 for PRE_VOTE
2022-05-18 08:09:04,104 [s2@group-B23F4A4B975A-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-B23F4A4B975A-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 1 for 0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,190 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s2@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s1, group-B23F4A4B975A, 1, (t:1, i:35))
2022-05-18 08:09:04,193 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-B23F4A4B975A-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,193 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s2@group-B23F4A4B975A replies to PRE_VOTE vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-B23F4A4B975A:t1, leader=null, voted=s0, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,190 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s0@group-B23F4A4B975A: receive requestVote(ELECTION, s1, group-B23F4A4B975A, 2, (t:1, i:35))
2022-05-18 08:09:04,200 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s0@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s2, group-B23F4A4B975A, 1, (t:1, i:35))
2022-05-18 08:09:04,194 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s2@group-B23F4A4B975A: receive requestVote(ELECTION, s1, group-B23F4A4B975A, 2, (t:1, i:35))
2022-05-18 08:09:04,202 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-B23F4A4B975A-CANDIDATE: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,202 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from CANDIDATE to FOLLOWER at term 2 for candidate:s1
2022-05-18 08:09:04,200 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-B23F4A4B975A-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,202 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s0@group-B23F4A4B975A: change Leader from s0 to null at term 2 for updateCurrentTerm
2022-05-18 08:09:04,202 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s1
2022-05-18 08:09:04,202 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:04,202 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:04,202 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:09:04,204 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s0@group-B23F4A4B975A replies to ELECTION vote request: s1<-s0#0:OK-t2. Peer's state: s0@group-B23F4A4B975A:t2, leader=null, voted=s1, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,205 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-B23F4A4B975A-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,205 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s0@group-B23F4A4B975A replies to PRE_VOTE vote request: s2<-s0#0:OK-t2. Peer's state: s0@group-B23F4A4B975A:t2, leader=null, voted=s1, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,206 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-B23F4A4B975A-LeaderElection5: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:09:04,218 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s0#0:OK-t2
2022-05-18 08:09:04,218 [s2@group-B23F4A4B975A-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-B23F4A4B975A-LeaderElection6: PRE_VOTE DISCOVERED_A_NEW_TERM (term=2) received 1 response(s) and 0 exception(s):
2022-05-18 08:09:04,217 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s2, group-B23F4A4B975A, 1, (t:1, i:35))
2022-05-18 08:09:04,284 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-05-18 08:09:04,284 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to PRE_VOTE vote request: s2<-s1#0:OK-t2. Peer's state: s1@group-B23F4A4B975A:t2, leader=null, voted=s1, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,283 [s2@group-B23F4A4B975A-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t2
2022-05-18 08:09:04,284 [s2@group-B23F4A4B975A-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-B23F4A4B975A-LeaderElection6 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=2)
2022-05-18 08:09:04,235 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-B23F4A4B975A-LeaderElection6
2022-05-18 08:09:04,218 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-B23F4A4B975A-LeaderElection5 ELECTION round 0: result PASSED
2022-05-18 08:09:04,289 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-B23F4A4B975A-LeaderElection5
2022-05-18 08:09:04,289 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-05-18 08:09:04,290 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s1@group-B23F4A4B975A: change Leader from null to s1 at term 2 for becomeLeader, leader elected after 275ms
2022-05-18 08:09:04,289 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:04,292 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-05-18 08:09:04,296 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:09:04,296 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:09:04,297 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-05-18 08:09:04,297 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-05-18 08:09:04,297 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-05-18 08:09:04,297 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:09:04,314 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:09:04,315 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:09:04,316 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s2@group-B23F4A4B975A replies to ELECTION vote request: s1<-s2#0:OK-t2. Peer's state: s2@group-B23F4A4B975A:t2, leader=null, voted=s1, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c30, conf=0: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,316 [s1@group-B23F4A4B975A-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:09:04,321 [s1@group-B23F4A4B975A-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolling segment log-0_35 to index:35
2022-05-18 08:09:04,323 [s1@group-B23F4A4B975A-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s1@group-B23F4A4B975A: set configuration 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,329 [s1@group-B23F4A4B975A-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,353 [s1@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,389 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s2@group-B23F4A4B975A: change Leader from null to s1 at term 2 for appendEntries, leader elected after 286ms
2022-05-18 08:09:04,390 [s1@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s1/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36
2022-05-18 08:09:04,399 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s0@group-B23F4A4B975A: change Leader from null to s1 at term 2 for appendEntries, leader elected after 197ms
2022-05-18 08:09:04,391 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s2@group-B23F4A4B975A: set configuration 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,400 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolling segment log-0_35 to index:35
2022-05-18 08:09:04,409 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,409 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,416 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s0@group-B23F4A4B975A: set configuration 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:04,418 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolling segment log-0_35 to index:35
2022-05-18 08:09:04,420 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,503 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_0-35
2022-05-18 08:09:04,421 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36
2022-05-18 08:09:04,514 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36
2022-05-18 08:09:04,712 [s1-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-05-18 08:09:04,958 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-B23F4A4B975A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:315829632ns, electionTimeout:188ms
2022-05-18 08:09:04,958 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:04,958 [s2@group-B23F4A4B975A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2022-05-18 08:09:04,958 [s2@group-B23F4A4B975A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-05-18 08:09:04,958 [s2@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-LeaderElection7
2022-05-18 08:09:04,982 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s2@group-B23F4A4B975A: change Leader from s1 to null at term 2 for PRE_VOTE
2022-05-18 08:09:04,983 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-B23F4A4B975A-LeaderElection7 PRE_VOTE round 0: submit vote requests at term 2 for 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,031 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s0@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s2, group-B23F4A4B975A, 2, (t:2, i:37))
2022-05-18 08:09:05,031 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-B23F4A4B975A-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-05-18 08:09:05,031 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s0@group-B23F4A4B975A replies to PRE_VOTE vote request: s2<-s0#0:OK-t2. Peer's state: s0@group-B23F4A4B975A:t2, leader=s1, voted=s1, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c36, conf=36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,037 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-B23F4A4B975A-LeaderElection7: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:09:05,051 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t2
2022-05-18 08:09:05,051 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-B23F4A4B975A-LeaderElection7 PRE_VOTE round 0: result PASSED
2022-05-18 08:09:05,052 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s2, group-B23F4A4B975A, 2, (t:2, i:37))
2022-05-18 08:09:05,058 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-B23F4A4B975A-LeaderElection7 ELECTION round 0: submit vote requests at term 3 for 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,079 [grpc-default-executor-1] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1018)) - s1@group-B23F4A4B975A-LeaderStateImpl: Lost leadership on term: 2. Election timeout: 300ms. In charge for: 789ms. Conf: 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,079 [grpc-default-executor-1] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1022)) - Follower s1@group-B23F4A4B975A->s0(c36,m37,n38, attendVote=true, lastRpcSendTime=455, lastRpcResponseTime=434)
2022-05-18 08:09:05,079 [grpc-default-executor-1] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$17(1022)) - Follower s1@group-B23F4A4B975A->s2(c36,m37,n38, attendVote=true, lastRpcSendTime=454, lastRpcResponseTime=422)
2022-05-18 08:09:05,079 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from    LEADER to FOLLOWER at term 2 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2022-05-18 08:09:05,079 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s1: shutdown s1@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:09:05,084 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s0@group-B23F4A4B975A: receive requestVote(ELECTION, s2, group-B23F4A4B975A, 3, (t:2, i:37))
2022-05-18 08:09:05,086 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-B23F4A4B975A-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2022-05-18 08:09:05,087 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s0@group-B23F4A4B975A: change Leader from s1 to null at term 3 for updateCurrentTerm
2022-05-18 08:09:05,087 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s2
2022-05-18 08:09:05,087 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,087 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,087 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:09:05,084 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s1@group-B23F4A4B975A-PendingRequests: sendNotLeaderResponses
2022-05-18 08:09:05,092 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,100 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-FOLLOWER: reject PRE_VOTE from s2: this server is a follower and still has a valid leader s1
2022-05-18 08:09:05,100 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to PRE_VOTE vote request: s2<-s1#0:FAIL-t2. Peer's state: s1@group-B23F4A4B975A:t2, leader=s1, voted=s1, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,102 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s0@group-B23F4A4B975A replies to ELECTION vote request: s2<-s0#0:OK-t3. Peer's state: s0@group-B23F4A4B975A:t3, leader=null, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c36, conf=36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,131 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#6-t2,previous=(t:2, i:36),leaderCommit=36,initializing? true,entries: size=1, first=(t:2, i:37), METADATAENTRY(c:36)
2022-05-18 08:09:05,131 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(ELECTION, s2, group-B23F4A4B975A, 3, (t:2, i:37))
2022-05-18 08:09:05,139 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-FOLLOWER: reject ELECTION from s2: our last entry (t:2, i:38) > candidate's last entry (t:2, i:37)
2022-05-18 08:09:05,139 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s1@group-B23F4A4B975A: change Leader from s1 to null at term 3 for updateCurrentTerm
2022-05-18 08:09:05,139 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s1@group-B23F4A4B975A: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:s2
2022-05-18 08:09:05,140 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,140 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,140 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:09:05,131 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#8-t2,previous=(t:2, i:36),leaderCommit=36,initializing? true,entries: size=1, first=(t:2, i:37), METADATAENTRY(c:36)
2022-05-18 08:09:05,131 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-B23F4A4B975A-LeaderElection7: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-05-18 08:09:05,140 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t3
2022-05-18 08:09:05,137 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s1@group-B23F4A4B975A->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:05,140 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-B23F4A4B975A->s2: nextIndex: updateUnconditionally 38 -> 37
2022-05-18 08:09:05,142 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s1@group-B23F4A4B975A->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:05,142 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-B23F4A4B975A->s0: nextIndex: updateUnconditionally 38 -> 37
2022-05-18 08:09:05,142 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-B23F4A4B975A-LeaderElection7 ELECTION round 0: result PASSED
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-B23F4A4B975A-LeaderElection7
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s2@group-B23F4A4B975A: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s2@group-B23F4A4B975A: change Leader from null to s2 at term 3 for becomeLeader, leader elected after 160ms
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-05-18 08:09:05,143 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-05-18 08:09:05,156 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-05-18 08:09:05,156 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:09:05,156 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:09:05,157 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:09:05,157 [s2@group-B23F4A4B975A-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:09:05,158 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:09:05,158 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:09:05,158 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to ELECTION vote request: s2<-s1#0:FAIL-t3. Peer's state: s1@group-B23F4A4B975A:t3, leader=null, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,279 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-05-18 08:09:05,279 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-05-18 08:09:05,279 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-05-18 08:09:05,279 [s2@group-B23F4A4B975A-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-05-18 08:09:05,280 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-05-18 08:09:05,280 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2022-05-18 08:09:05,280 [s2@group-B23F4A4B975A-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:09:05,280 [s2@group-B23F4A4B975A-LeaderElection7] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolling segment log-36_37 to index:37
2022-05-18 08:09:05,281 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_36-37
2022-05-18 08:09:05,303 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_36-37
2022-05-18 08:09:05,294 [s2@group-B23F4A4B975A-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s2@group-B23F4A4B975A: set configuration 38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,283 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-B23F4A4B975A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:180994632ns, electionTimeout:161ms
2022-05-18 08:09:05,308 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,308 [s0@group-B23F4A4B975A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2022-05-18 08:09:05,308 [s0@group-B23F4A4B975A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-05-18 08:09:05,308 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-LeaderElection8
2022-05-18 08:09:05,311 [s0@group-B23F4A4B975A-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s0@group-B23F4A4B975A-LeaderElection8 PRE_VOTE round 0: submit vote requests at term 3 for 36: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,313 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s1@group-B23F4A4B975A: change Leader from null to s2 at term 3 for appendEntries, leader elected after 173ms
2022-05-18 08:09:05,320 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(299)) - s0@group-B23F4A4B975A: changes role from CANDIDATE to FOLLOWER at term 3 for appendEntries
2022-05-18 08:09:05,320 [s0-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-B23F4A4B975A-LeaderElection8
2022-05-18 08:09:05,336 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s1@group-B23F4A4B975A: set configuration 38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,337 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s2/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_38
2022-05-18 08:09:05,346 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:truncate(441)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: Truncating segments toTruncate: (36, 38) isOpen? true, length=256, newEndIndex=37
  toDelete: [], start index 38
2022-05-18 08:09:05,346 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker: Starting segment from index:38
2022-05-18 08:09:05,356 [s0-server-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:05,359 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(287)) - s0@group-B23F4A4B975A: change Leader from null to s2 at term 3 for appendEntries, leader elected after 272ms
2022-05-18 08:09:05,374 [s0@group-B23F4A4B975A-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s0@group-B23F4A4B975A-LeaderElection8: PRE_VOTE REJECTED received 0 response(s) and 0 exception(s):
2022-05-18 08:09:05,374 [s0@group-B23F4A4B975A-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s0@group-B23F4A4B975A-LeaderElection8 PRE_VOTE round 0: result REJECTED
2022-05-18 08:09:05,378 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(393)) - s0@group-B23F4A4B975A: set configuration 38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,378 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolling segment log-36_37 to index:37
2022-05-18 08:09:05,379 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_36-37
2022-05-18 08:09:05,379 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_36 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_36-37
2022-05-18 08:09:05,384 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s1@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s0, group-B23F4A4B975A, 3, (t:2, i:37))
2022-05-18 08:09:05,384 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-B23F4A4B975A-FOLLOWER: reject PRE_VOTE from s0: this server is a follower and still has a valid leader s2
2022-05-18 08:09:05,384 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s1@group-B23F4A4B975A replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t3. Peer's state: s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,412 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1152)) - s2@group-B23F4A4B975A: receive requestVote(PRE_VOTE, s0, group-B23F4A4B975A, 3, (t:2, i:37))
2022-05-18 08:09:05,412 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b38cb2f0/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty7ddc4ffd/s0/6357fb54-ff44-4dab-a55a-b23f4a4b975a/current/log_inprogress_38
2022-05-18 08:09:05,416 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - s2@group-B23F4A4B975A-LEADER: reject PRE_VOTE from s0: this server is the leader and still has leadership
2022-05-18 08:09:05,416 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1184)) - s2@group-B23F4A4B975A replies to PRE_VOTE vote request: s0<-s2#0:FAIL-t3. Peer's state: s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c36, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null
2022-05-18 08:09:05,504 [s2-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-05-18 08:09:05,507 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-05-18 08:09:05,507 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2022-05-18 08:09:06,606 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream372: bytesWritten=3740761
2022-05-18 08:09:06,834 [s2-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-8AC8A26A1422->s0@group-B23F4A4B975A, cid=372, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:06,835 [s0-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-8AC8A26A1422->s0@group-B23F4A4B975A, cid=372, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:06,836 [s1-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-8AC8A26A1422->s0@group-B23F4A4B975A, cid=372, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2022-05-18 08:09:07,922 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream366: bytesWritten=3758413
2022-05-18 08:09:07,930 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream367: bytesWritten=3726531
2022-05-18 08:09:08,315 [java.util.concurrent.ThreadPoolExecutor$Worker@77c7bb4b[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=1,entriesCount=1,lastEntry=(t:3, i:38)
2022-05-18 08:09:08,442 [java.util.concurrent.ThreadPoolExecutor$Worker@368091e9[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=1,lastEntry=(t:3, i:39)
2022-05-18 08:09:09,091 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(325)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:09,834 [java.util.concurrent.ThreadPoolExecutor$Worker@2ae11517[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s0-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=31,entriesCount=1,lastEntry=(t:3, i:41)
2022-05-18 08:09:09,835 [java.util.concurrent.ThreadPoolExecutor$Worker@2ae11517[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=147,entriesCount=1,lastEntry=(t:3, i:41)
2022-05-18 08:09:11,502 [java.util.concurrent.ThreadPoolExecutor$Worker@51a44ce[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=261, target=localhost:40571}}. 
2022-05-18 08:09:11,507 [java.util.concurrent.ThreadPoolExecutor$Worker@51a44ce[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s0-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=9,entriesCount=1,lastEntry=(t:3, i:40)
2022-05-18 08:09:11,507 [java.util.concurrent.ThreadPoolExecutor$Worker@51a44ce[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(239)) - s2@group-B23F4A4B975A->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=8,entriesCount=1,lastEntry=(t:3, i:40)
2022-05-18 08:09:12,840 [java.util.concurrent.ThreadPoolExecutor$Worker@2ae11517[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=275, target=localhost:40571}}. 
2022-05-18 08:09:17,542 [java.util.concurrent.ThreadPoolExecutor$Worker@f25bbc7[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=289, target=localhost:40571}}. 
2022-05-18 08:09:18,864 [java.util.concurrent.ThreadPoolExecutor$Worker@52d60aa0[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=303, target=localhost:40571}}. 
2022-05-18 08:09:19,092 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(325)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:22,227 [java.util.concurrent.ThreadPoolExecutor$Worker@1b59dea6[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=386,offset=7357600,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=386,offset=7357600,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:22,227 [java.util.concurrent.ThreadPoolExecutor$Worker@1b59dea6[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=385,offset=7576882,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=385,offset=7576882,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:22,228 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream391
2022-05-18 08:09:22,228 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream392
2022-05-18 08:09:22,228 [java.util.concurrent.ThreadPoolExecutor$Worker@1b59dea6[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=388,offset=7631920,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=388,offset=7631920,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:22,231 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream393
2022-05-18 08:09:22,246 [pool-9-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream394
2022-05-18 08:09:22,258 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=839895,length=699587
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=839895,length=699587
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=839895,length=699587
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,278 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=1539482,length=942505
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=1539482,length=942505
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=1539482,length=942505
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,290 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=2481987,length=529504
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=2481987,length=529504
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=2481987,length=529504
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,305 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3011491,length=633383
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3011491,length=633383
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3011491,length=633383
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,330 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3644874,length=606720
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3644874,length=606720
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=3644874,length=606720
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,343 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=4251594,length=803481
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=4251594,length=803481
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=4251594,length=803481
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,363 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5055075,length=550758
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5055075,length=550758
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5055075,length=550758
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,398 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5605833,length=928157
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5605833,length=928157
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=5605833,length=928157
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,402 [pool-9-thread-14] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=6533990,length=662367
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=6533990,length=662367
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=6533990,length=662367
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:22,415 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream392: bytesWritten=7832853
2022-05-18 08:09:22,418 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream393: bytesWritten=7625453
2022-05-18 08:09:22,456 [pool-9-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream394: bytesWritten=7686106
2022-05-18 08:09:23,561 [java.util.concurrent.ThreadPoolExecutor$Worker@1b59dea6[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=389,offset=7689308,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=389,offset=7689308,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:23,562 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream395
2022-05-18 08:09:23,583 [java.util.concurrent.ThreadPoolExecutor$Worker@12b97e68[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=317, target=localhost:40571}}. 
2022-05-18 08:09:23,589 [java.util.concurrent.ThreadPoolExecutor$Worker@1b59dea6[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=390,offset=6800110,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=390,offset=6800110,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:23,590 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream396
2022-05-18 08:09:23,714 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream395: bytesWritten=7259110
2022-05-18 08:09:23,720 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream396: bytesWritten=7498010
2022-05-18 08:09:24,892 [java.util.concurrent.ThreadPoolExecutor$Worker@12632735[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=331, target=localhost:40571}}. 
2022-05-18 08:09:26,607 [java.util.concurrent.ThreadPoolExecutor$Worker@51a44ce[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-8AC8A26A1422,type=STREAM_DATA,id=372,offset=3740761,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=5002,DataStreamRequestHeader:clientId=client-8AC8A26A1422,type=STREAM_DATA,id=372,offset=3740761,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:26,607 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream397
2022-05-18 08:09:26,610 [pool-9-thread-6] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream398
2022-05-18 08:09:26,724 [pool-9-thread-6] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream398: bytesWritten=7000880
2022-05-18 08:09:26,726 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream397: bytesWritten=6926009
2022-05-18 08:09:27,923 [java.util.concurrent.ThreadPoolExecutor$Worker@2ae11517[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-D5EBB9BFDD63,type=STREAM_DATA,id=366,offset=3758413,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=5002,DataStreamRequestHeader:clientId=client-D5EBB9BFDD63,type=STREAM_DATA,id=366,offset=3758413,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:27,924 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream399
2022-05-18 08:09:27,925 [pool-9-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream400
2022-05-18 08:09:27,928 [pool-9-thread-2] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream401
2022-05-18 08:09:27,930 [java.util.concurrent.ThreadPoolExecutor$Worker@2ae11517[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-D5EBB9BFDD63,type=STREAM_DATA,id=367,offset=3726531,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=5002,DataStreamRequestHeader:clientId=client-D5EBB9BFDD63,type=STREAM_DATA,id=367,offset=3726531,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:27,937 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream402
2022-05-18 08:09:28,131 [pool-9-thread-2] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream401: bytesWritten=7719180
2022-05-18 08:09:28,135 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream402: bytesWritten=7140728
2022-05-18 08:09:28,155 [pool-9-thread-4] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream400: bytesWritten=7500463
2022-05-18 08:09:28,159 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream399: bytesWritten=7202275
2022-05-18 08:09:29,091 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(325)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:29,689 [java.util.concurrent.ThreadPoolExecutor$Worker@fb5c922[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=345, target=localhost:40571}}. 
2022-05-18 08:09:30,917 [java.util.concurrent.ThreadPoolExecutor$Worker@3dfa1ce4[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=359, target=localhost:40571}}. 
2022-05-18 08:09:32,257 [java.util.concurrent.ThreadPoolExecutor$Worker@490eaf61[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=0,length=839895
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=2,DataStreamRequestHeader:clientId=client-3EB1F4F89024,type=STREAM_DATA,id=391,offset=0,length=839895
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:32,257 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream403
2022-05-18 08:09:32,324 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream403: bytesWritten=7195735
2022-05-18 08:09:35,718 [java.util.concurrent.ThreadPoolExecutor$Worker@6afe11b6[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=373, target=localhost:40571}}. 
2022-05-18 08:09:36,951 [java.util.concurrent.ThreadPoolExecutor$Worker@2767c424[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=387, target=localhost:40571}}. 
2022-05-18 08:09:39,092 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(325)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:41,740 [java.util.concurrent.ThreadPoolExecutor$Worker@7fc1534e[State = -1, empty queue]] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(216)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=401, target=localhost:40571}}. 
2022-05-18 08:09:42,415 [java.util.concurrent.ThreadPoolExecutor$Worker@490eaf61[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,416 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream404
2022-05-18 08:09:42,418 [pool-9-thread-5] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream405
2022-05-18 08:09:42,420 [pool-9-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream406
2022-05-18 08:09:42,421 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(127)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:42,421 [Time-limited test] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(128)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:113)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:783)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=392,offset=7832853,length=0
	... 12 more
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(760)) - ************************************************************** 
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(761)) - *** 
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(762)) - ***     Stopping MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(763)) - *** 
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(764)) - ************************************************************** 
2022-05-18 08:09:42,429 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(765)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s0@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-B23F4A4B975A:t3, leader=s2, voted=null, raftlog=s1@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c37, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-B23F4A4B975A:t3, leader=s2, voted=s2, raftlog=s2@group-B23F4A4B975A-SegmentedRaftLog:OPENED:c39, conf=38: [s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0, s1|rpc:localhost:35349|admin:localhost:37277|client:localhost:39633|dataStream:localhost:42717|priority:0, s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0], old=null RUNNING
2022-05-18 08:09:42,425 [java.util.concurrent.ThreadPoolExecutor$Worker@490eaf61[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=393,offset=7625453,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=393,offset=7625453,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,430 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream407
2022-05-18 08:09:42,435 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(398)) - s2: close
2022-05-18 08:09:42,435 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(434)) - s2@group-B23F4A4B975A: shutdown
2022-05-18 08:09:42,435 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s2
2022-05-18 08:09:42,436 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s2: shutdown s2@group-B23F4A4B975A-LeaderStateImpl
2022-05-18 08:09:42,436 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s2@group-B23F4A4B975A-PendingRequests: sendNotLeaderResponses
2022-05-18 08:09:42,456 [java.util.concurrent.ThreadPoolExecutor$Worker@490eaf61[State = -1, empty queue]] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=394,offset=7686106,length=0
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10000ms: Failed to send DataStreamWindowRequest:seqNum=12,DataStreamRequestHeader:clientId=client-87B95DD4B360,type=STREAM_DATA,id=394,offset=7686106,length=0
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$scheduleWithTimeout$7(OrderedStreamAsync.java:172)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:141)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:155)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:79)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,457 [pool-9-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream408
2022-05-18 08:09:42,503 [s2@group-B23F4A4B975A->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(171)) - s2@group-B23F4A4B975A->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-05-18 08:09:42,503 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(398)) - s1: close
2022-05-18 08:09:42,503 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(434)) - s1@group-B23F4A4B975A: shutdown
2022-05-18 08:09:42,503 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s1
2022-05-18 08:09:42,504 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:42,504 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s1@group-B23F4A4B975A-StateMachineUpdater: set stopIndex = 37
2022-05-18 08:09:42,504 [s2@group-B23F4A4B975A->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(171)) - s2@group-B23F4A4B975A->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-05-18 08:09:42,504 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(429)) - s1@group-B23F4A4B975A: closes. applyIndex: 37
2022-05-18 08:09:42,509 [s1@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:09:42,510 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$7(398)) - s0: close
2022-05-18 08:09:42,510 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(434)) - s0@group-B23F4A4B975A: shutdown
2022-05-18 08:09:42,510 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B23F4A4B975A,id=s0
2022-05-18 08:09:42,510 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-B23F4A4B975A-FollowerState
2022-05-18 08:09:42,510 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s0@group-B23F4A4B975A-StateMachineUpdater: set stopIndex = 39
2022-05-18 08:09:42,511 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s0: Completed APPEND_ENTRIES, lastRequest: s2->s0#31-t3,previous=(t:3, i:40),leaderCommit=39,initializing? true,entries: size=1, first=(t:3, i:41), STATEMACHINELOGENTRY, 372@client-8AC8A26A1422
2022-05-18 08:09:42,511 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s2@group-B23F4A4B975A->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:42,511 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-B23F4A4B975A->s0: nextIndex: updateUnconditionally 42 -> 40
2022-05-18 08:09:42,510 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - s1: Completed APPEND_ENTRIES, lastRequest: s2->s1#147-t3,previous=(t:3, i:40),leaderCommit=39,initializing? true,entries: size=1, first=(t:3, i:41), STATEMACHINELOGENTRY, 372@client-8AC8A26A1422
2022-05-18 08:09:42,512 [s0@group-B23F4A4B975A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-B23F4A4B975A-FollowerState was interrupted
2022-05-18 08:09:42,512 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(339)) - s2@group-B23F4A4B975A->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-05-18 08:09:42,512 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-B23F4A4B975A->s1: nextIndex: updateUnconditionally 42 -> 1
2022-05-18 08:09:42,512 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(429)) - s0@group-B23F4A4B975A: closes. applyIndex: 39
2022-05-18 08:09:42,512 [s0@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-05-18 08:09:42,551 [s1@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-05-18 08:09:42,619 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s0@group-B23F4A4B975A-SegmentedRaftLogWorker close()
2022-05-18 08:09:42,626 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s2@group-B23F4A4B975A-StateMachineUpdater: set stopIndex = 39
2022-05-18 08:09:42,630 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s1@group-B23F4A4B975A-SegmentedRaftLogWorker close()
2022-05-18 08:09:42,663 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(429)) - s2@group-B23F4A4B975A: closes. applyIndex: 39
2022-05-18 08:09:42,669 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream404: bytesWritten=6765286
2022-05-18 08:09:42,686 [s2@group-B23F4A4B975A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-05-18 08:09:42,713 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s2@group-B23F4A4B975A-SegmentedRaftLogWorker close()
2022-05-18 08:09:42,714 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s1: shutdown server with port 35349 now
2022-05-18 08:09:42,744 [pool-9-thread-5] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream405: bytesWritten=7407283
2022-05-18 08:09:42,752 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s1: shutdown server with port 35349 successfully
2022-05-18 08:09:42,752 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s1: shutdown server with port 37277 now
2022-05-18 08:09:42,752 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream407: bytesWritten=7652684
2022-05-18 08:09:42,753 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s1: shutdown server with port 37277 successfully
2022-05-18 08:09:42,753 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s1: shutdown server with port 39633 now
2022-05-18 08:09:42,757 [java.util.concurrent.ThreadPoolExecutor$Worker@55695b21[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s1: shutdown server with port 39633 successfully
2022-05-18 08:09:42,758 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:/0.0.0.0:42717] CLOSE
2022-05-18 08:09:42,758 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:0.0.0.0/0.0.0.0:42717] INACTIVE
2022-05-18 08:09:42,758 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd7380ca9, L:0.0.0.0/0.0.0.0:42717] UNREGISTERED
2022-05-18 08:09:42,768 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,769 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,769 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,769 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,769 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,771 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,771 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,770 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,776 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@7d6e28c6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s1: Stopped
2022-05-18 08:09:42,790 [s2-DataStreamManagement-request--thread13] WARN  server.DataStreamManagement (DataStreamManagement.java:sendDataStreamException(395)) - Failed to process DataStreamRequestByteBuf:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=913881
java.util.concurrent.CompletionException: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,790 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@1e84b3d1 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,812 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,820 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s2: shutdown server with port 36619 now
2022-05-18 08:09:42,826 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@6e89a07c failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,827 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,827 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@2ba8c4a9 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,827 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,828 [s2-DataStreamManagement-request--thread14] WARN  server.DataStreamManagement (DataStreamManagement.java:sendDataStreamException(395)) - Failed to process DataStreamRequestByteBuf:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=407,offset=7652684,length=0
java.util.concurrent.CompletionException: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,829 [s2-DataStreamManagement-request--thread1] WARN  server.DataStreamManagement (DataStreamManagement.java:sendDataStreamException(395)) - Failed to process DataStreamRequestByteBuf:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=406,offset=7669936,length=757643
java.util.concurrent.CompletionException: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,836 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s2: shutdown server with port 36619 successfully
2022-05-18 08:09:42,836 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s2: shutdown server with port 34149 now
2022-05-18 08:09:42,837 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s2: shutdown server with port 34149 successfully
2022-05-18 08:09:42,837 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s2: shutdown server with port 40571 now
2022-05-18 08:09:42,845 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 40531 now
2022-05-18 08:09:42,850 [java.util.concurrent.ThreadPoolExecutor$Worker@65b04bc8[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s2: shutdown server with port 40571 successfully
2022-05-18 08:09:42,850 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:/0.0.0.0:41933] CLOSE
2022-05-18 08:09:42,850 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:0.0.0.0/0.0.0.0:41933] INACTIVE
2022-05-18 08:09:42,850 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x5910cc70, L:0.0.0.0/0.0.0.0:41933] UNREGISTERED
2022-05-18 08:09:42,852 [s2-DataStreamManagement-request--thread13] WARN  server.DataStreamManagement (DataStreamManagement.java:sendDataStreamException(395)) - Failed to process DataStreamRequestByteBuf:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=5096460,length=592680
java.util.concurrent.CompletionException: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,853 [pool-9-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream409
2022-05-18 08:09:42,866 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 40531 successfully
2022-05-18 08:09:42,866 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 44289 now
2022-05-18 08:09:42,876 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 44289 successfully
2022-05-18 08:09:42,876 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(269)) - s0: shutdown server with port 35433 now
2022-05-18 08:09:42,876 [java.util.concurrent.ThreadPoolExecutor$Worker@488597be[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(278)) - s0: shutdown server with port 35433 successfully
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,879 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,878 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,881 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@1134e1a3 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,881 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,882 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream410
2022-05-18 08:09:42,884 [s2-DataStreamManagement-request--thread13] WARN  server.DataStreamManagement (DataStreamManagement.java:sendDataStreamException(395)) - Failed to process DataStreamRequestByteBuf:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=5689140,length=734150
java.util.concurrent.CompletionException: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture.uniCompose(CompletableFuture.java:975)
	at java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:940)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:456)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,889 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@613f68a2 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,889 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,890 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5838b577 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,890 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,891 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@6be0da42 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,891 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,892 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@316077b9 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,892 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,893 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@1896bdab failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,893 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,894 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5a73bbaa failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,894 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,895 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@9aed04f failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,895 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,896 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@763ef30d failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,896 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,896 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@3a0f3d3d failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,896 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,897 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@879825c failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,897 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,898 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@75a14b6b failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,898 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,899 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@3c374e6f failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,899 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,899 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5a9edf58 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,900 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,900 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@16158b8e failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,901 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,912 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:/0.0.0.0:42101] CLOSE
2022-05-18 08:09:42,920 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:0.0.0.0/0.0.0.0:42101] INACTIVE
2022-05-18 08:09:42,920 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0x789e0f18, L:0.0.0.0/0.0.0.0:42101] UNREGISTERED
2022-05-18 08:09:42,910 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5e6cfd4e failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,920 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,909 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@57204785 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,921 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,902 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@6e3fa51 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,921 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,920 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@312e3596 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,922 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,922 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@2323954c failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,922 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,926 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,926 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,926 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,927 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,927 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,927 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,926 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,932 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,932 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,926 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: channel is inactive; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,933 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@e85b0f7 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,933 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,933 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@4ba4dc86 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,934 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,932 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@6a9784d7 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,934 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,937 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=5096460,length=592680
java.util.concurrent.CompletionException: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$channelRead$0(NettyClientStreamRpc.java:273)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:327)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:299)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:271)
	... 20 more
2022-05-18 08:09:42,937 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=5689140,length=734150
java.util.concurrent.CompletionException: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$channelRead$0(NettyClientStreamRpc.java:273)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:327)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:299)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:271)
	... 20 more
2022-05-18 08:09:42,937 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=6423290,length=716406
java.util.concurrent.CompletionException: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.lambda$channelRead$0(NettyClientStreamRpc.java:273)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:273)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:327)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:299)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalStateException: org.apache.ratis.netty.client.NettyClientStreamRpc$1@3372151: an earlier request failed with DataStreamReplyByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=408,offset=4182579,length=3805,FAILED,bytesWritten=0
	at org.apache.ratis.netty.client.NettyClientStreamRpc$1.channelRead(NettyClientStreamRpc.java:271)
	... 20 more
2022-05-18 08:09:42,938 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=0,length=617819
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.safeFail(ChannelOutboundBuffer.java:723)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.remove0(ChannelOutboundBuffer.java:308)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.failFlushed(ChannelOutboundBuffer.java:660)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:735)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.handleWriteError(AbstractChannel.java:950)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:933)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	... 16 more
2022-05-18 08:09:42,939 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=0,length=617819
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=0,length=617819
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.access$600(PromiseCombiner.java:35)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete0(PromiseCombiner.java:62)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner$1.operationComplete(PromiseCombiner.java:44)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.internal.PromiseNotificationUtil.tryFailure(PromiseNotificationUtil.java:64)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.safeFail(ChannelOutboundBuffer.java:723)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.remove0(ChannelOutboundBuffer.java:308)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundBuffer.failFlushed(ChannelOutboundBuffer.java:660)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:735)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.handleWriteError(AbstractChannel.java:950)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:933)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=0,length=617819
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 39 more
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	... 16 more
2022-05-18 08:09:42,939 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=617819,length=702838
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.finish(PromiseCombiner.java:159)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.writePromiseCombiner(MessageToMessageEncoder.java:139)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:117)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:709)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:792)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:702)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:99)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:764)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.StacklessClosedChannelException
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,939 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=617819,length=702838
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=617819,length=702838
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.finish(PromiseCombiner.java:159)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.writePromiseCombiner(MessageToMessageEncoder.java:139)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:117)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:709)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:792)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:702)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:99)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:764)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=617819,length=702838
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 24 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.StacklessClosedChannelException
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,945 [NettyClientStreamRpc-workerGroup--thread1] ERROR client.NettyClientStreamRpc (NettyClientStreamRpc.java:lambda$streamAsync$2(377)) - Channel write failed
java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=1320657,length=589117
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.finish(PromiseCombiner.java:159)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.writePromiseCombiner(MessageToMessageEncoder.java:139)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:117)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:709)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:792)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:702)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:99)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:764)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.thirdparty.io.netty.channel.StacklessClosedChannelException
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,945 [NettyClientStreamRpc-workerGroup--thread1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=1320657,length=589117
java.util.concurrent.CompletionException: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=1320657,length=589117
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:378)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:117)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.tryPromise(PromiseCombiner.java:170)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.PromiseCombiner.finish(PromiseCombiner.java:159)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.writePromiseCombiner(MessageToMessageEncoder.java:139)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:117)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:709)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:792)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:702)
	at org.apache.ratis.thirdparty.io.netty.handler.codec.MessageToMessageEncoder.write(MessageToMessageEncoder.java:99)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:764)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: NettyClientStreamRpc->s2|rpc:localhost:36619|admin:localhost:34149|client:localhost:40571|dataStream:localhost:41933|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-973BAE1FCB38,type=STREAM_DATA,id=409,offset=1320657,length=589117
	at org.apache.ratis.netty.client.NettyClientStreamRpc.lambda$streamAsync$2(NettyClientStreamRpc.java:376)
	... 24 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.StacklessClosedChannelException
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)
	at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)
	at sun.nio.ch.IOUtil.write(IOUtil.java:148)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:503)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:423)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:931)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:354)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:895)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1372)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:742)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:728)
	at org.apache.ratis.thirdparty.io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:125)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:750)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:765)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1071)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:500)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,945 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: channel is inactive; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,958 [pool-9-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream411
2022-05-18 08:09:42,960 [NettyClientStreamRpc-workerGroup--thread4] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@4856223f failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,960 [NettyClientStreamRpc-workerGroup--thread4] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.StacklessClosedChannelException
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.ensureOpen(ChannelPromise)(Unknown Source)
2022-05-18 08:09:42,960 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream412
2022-05-18 08:09:42,961 [pool-9-thread-1] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream413
2022-05-18 08:09:42,962 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@55e6f4d0 failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,962 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,963 [pool-9-thread-7] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream414
2022-05-18 08:09:42,963 [pool-9-thread-8] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream415
2022-05-18 08:09:42,965 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@379bf710 failed; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,965 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42101
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,979 [pool-9-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=0,length=506292
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=0,length=506292
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=0,length=506292
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:42,982 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@57a7f5fb failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,982 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,982 [pool-9-thread-3] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream416
2022-05-18 08:09:42,984 [NettyClientStreamRpc-workerGroup--thread4] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42101: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@407e7d3d failed; schedule reconnecting to localhost/127.0.0.1:42101 in 100ms
2022-05-18 08:09:42,984 [NettyClientStreamRpc-workerGroup--thread4] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
java.lang.IllegalStateException: executor not accepting a task
	at org.apache.ratis.thirdparty.io.netty.resolver.AddressResolverGroup.getResolver(AddressResolverGroup.java:61)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap.doResolveAndConnect0(Bootstrap.java:194)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap.access$000(Bootstrap.java:46)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:180)
	at org.apache.ratis.thirdparty.io.netty.bootstrap.Bootstrap$1.operationComplete(Bootstrap.java:166)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:605)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:104)
	at org.apache.ratis.thirdparty.io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:990)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.register0(AbstractChannel.java:516)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe.access$200(AbstractChannel.java:429)
	at org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AbstractUnsafe$1.run(AbstractChannel.java:486)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:503)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,985 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@406ee174 failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,985 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,986 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@1e15514e failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,986 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,986 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@11c5f4 failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,986 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,987 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@208ba2cb failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,987 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,988 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@148ebbef failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:42,988 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,992 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@195a8743 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,992 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,992 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@10112b68 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,992 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,993 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@48771cb8 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:42,993 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,999 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=0,length=516609
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=0,length=516609
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=0,length=516609
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,008 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=516609,length=686089
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=516609,length=686089
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=516609,length=686089
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,009 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1202698,length=612771
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1202698,length=612771
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1202698,length=612771
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:42,999 [pool-9-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=506292,length=882308
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=506292,length=882308
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=506292,length=882308
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:42,999 [pool-9-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=0,length=956861
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=0,length=956861
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=0,length=956861
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,012 [pool-9-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=956861,length=602367
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=956861,length=602367
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=956861,length=602367
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,014 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1815469,length=741211
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1815469,length=741211
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=1815469,length=741211
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:42,999 [pool-9-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=0,length=950575
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=0,length=950575
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=0,length=950575
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,016 [pool-9-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=950575,length=518776
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=950575,length=518776
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=950575,length=518776
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:42,998 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@b140e97] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s0: Stopped
2022-05-18 08:09:42,995 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5ff4d464 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:43,020 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,994 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:42717: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@5e89fcc4 failed; schedule reconnecting to localhost/127.0.0.1:42717 in 100ms
2022-05-18 08:09:43,024 [NettyClientStreamRpc-workerGroup--thread1] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:42717
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,994 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@2695c0fb failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:43,024 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,993 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@77af278e failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:43,025 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:42,993 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(197)) - Connection-localhost/127.0.0.1:41933: org.apache.ratis.netty.client.NettyClientStreamRpc$Connection$1@29803e64 failed; schedule reconnecting to localhost/127.0.0.1:41933 in 100ms
2022-05-18 08:09:43,025 [NettyClientStreamRpc-workerGroup--thread3] WARN  client.NettyClientStreamRpc (NettyClientStreamRpc.java:scheduleReconnect(199)) - 
org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:41933
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:330)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:750)
2022-05-18 08:09:43,020 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$270/696363646@46ba1d75] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s2: Stopped
2022-05-18 08:09:43,025 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(783)) - MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty shutdown completed
2022-05-18 08:09:43,019 [pool-9-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=1559228,length=785466
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=1559228,length=785466
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=1559228,length=785466
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,030 [pool-9-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=1469351,length=595389
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=1469351,length=595389
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=1469351,length=595389
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,030 [pool-9-thread-8] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=2344694,length=698807
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=2344694,length=698807
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=415,offset=2344694,length=698807
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,016 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=2556680,length=859261
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=2556680,length=859261
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=2556680,length=859261
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,033 [pool-9-thread-1] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=2064740,length=948036
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=2064740,length=948036
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=413,offset=2064740,length=948036
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,034 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=3415941,length=659456
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=3415941,length=659456
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=3415941,length=659456
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,036 [pool-9-thread-3] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=4075397,length=891614
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=4075397,length=891614
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=416,offset=4075397,length=891614
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
2022-05-18 08:09:43,012 [pool-9-thread-7] ERROR impl.OrderedStreamAsync (OrderedStreamAsync.java:lambda$sendRequest$2(132)) - Failed to send request, header=DataStreamRequestHeader:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=1388600,length=625138
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=1388600,length=625138
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:628)
	at java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:1996)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:154)
	at org.apache.ratis.client.impl.OrderedStreamAsync.lambda$sendRequest$1(OrderedStreamAsync.java:129)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:271)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:259)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequest(OrderedStreamAsync.java:129)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.send(DataStreamClientImpl.java:116)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsyncImpl(DataStreamClientImpl.java:128)
	at org.apache.ratis.client.impl.DataStreamClientImpl$DataStreamOutputImpl.writeAsync(DataStreamClientImpl.java:139)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndAssertReplies(DataStreamTestUtils.java:284)
	at org.apache.ratis.datastream.DataStreamTestUtils.writeAndCloseAndAssertReplies(DataStreamTestUtils.java:312)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.lambda$runTestDataStream$5(DataStreamAsyncClusterTests.java:156)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: NettyClientStreamRpc->s0|rpc:localhost:40531|admin:localhost:44289|client:localhost:35433|dataStream:localhost:42101|priority:0: Failed to send DataStreamRequestByteBuffer:clientId=client-67AC23D7C78F,type=STREAM_DATA,id=414,offset=1388600,length=625138
	at org.apache.ratis.netty.client.NettyClientStreamRpc.streamAsync(NettyClientStreamRpc.java:370)
	at org.apache.ratis.client.impl.OrderedStreamAsync.sendRequestToNetwork(OrderedStreamAsync.java:147)
	... 14 more
]]></system-out>
  </testcase>
  <testcase name="testStreamWrites" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="19.157"/>
</testsuite>