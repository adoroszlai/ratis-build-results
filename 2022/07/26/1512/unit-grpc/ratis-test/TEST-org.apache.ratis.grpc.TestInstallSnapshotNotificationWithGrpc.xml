<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="77.896" tests="5" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.1/ratis-thirdparty-misc-1.0.1.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter6977900036862509326.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2022-07-26T18-13-50_749-jvmRun1 surefire8590111353081391795tmp surefire_257886312217094009231tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.1/ratis-thirdparty-misc-1.0.1.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.29/slf4j-api-1.7.29.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.29/slf4j-log4j12-1.7.29.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter6977900036862509326.jar"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_332-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.4.0-1086-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="1.8.0_332"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.332-b09"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testInstallSnapshotInstalledEvent" classname="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="4.671"/>
  <testcase name="testAddNewFollowers" classname="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="3.258"/>
  <testcase name="testInstallSnapshotDuringBootstrap" classname="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="2.071"/>
  <testcase name="testRestartFollower" classname="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="63.358">
    <error message="s2@group-2923AB502154-SegmentedRaftLog is expected to be opened but it is CLOSED" type="java.lang.IllegalArgumentException">java.lang.IllegalArgumentException: s2@group-2923AB502154-SegmentedRaftLog is expected to be opened but it is CLOSED
	at org.apache.ratis.util.OpenCloseState.assertOpen(OpenCloseState.java:63)
	at org.apache.ratis.server.raftlog.RaftLogBase.checkLogState(RaftLogBase.java:111)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.getLastEntryTermIndex(SegmentedRaftLog.java:340)
	at org.apache.ratis.server.raftlog.RaftLog.getNextIndex(RaftLog.java:83)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:267)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:250)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.util.OpenCloseState$CloseTrace: Close s2@group-2923AB502154-SegmentedRaftLog
	at org.apache.ratis.util.OpenCloseState.lambda$close$1(OpenCloseState.java:109)
	at java.util.concurrent.atomic.AtomicReference.getAndUpdate(AtomicReference.java:160)
	at org.apache.ratis.util.OpenCloseState.close(OpenCloseState.java:109)
	at org.apache.ratis.server.raftlog.RaftLogBase.close(RaftLogBase.java:365)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.close(SegmentedRaftLog.java:506)
	at org.apache.ratis.server.impl.ServerState.close(ServerState.java:467)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$close$4(RaftServerImpl.java:460)
	at org.apache.ratis.util.LifeCycle.lambda$checkStateAndClose$4(LifeCycle.java:299)
	at org.apache.ratis.util.LifeCycle.checkStateAndClose(LifeCycle.java:319)
	at org.apache.ratis.util.LifeCycle.checkStateAndClose(LifeCycle.java:297)
	at org.apache.ratis.server.impl.RaftServerImpl.close(RaftServerImpl.java:437)
	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:195)
	... 1 more
</error>
    <system-out><![CDATA[2022-07-26 18:23:55,942 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2022-07-26 18:23:55,942 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2022-07-26 18:23:55,942 [main] INFO  util.LogUtils (Log4jUtils.java:setLogLevel(32)) - Set org.apache.ratis.server.raftlog.RaftLog log level to DEBUG
2022-07-26 18:23:55,943 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(132)) - Running runWithNewCluster
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(303)) - new MiniRaftClusterWithGrpc with group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(336)) - .............................................................. 
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(337)) - ... 
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(338)) - ...     Starting MiniRaftClusterWithGrpc
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - ... 
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - .............................................................. 
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(315)) - servers = {}
2022-07-26 18:23:55,944 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s0, group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER], format? true
2022-07-26 18:23:55,944 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0
2022-07-26 18:23:55,944 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0 does not exist.
2022-07-26 18:23:55,945 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0
2022-07-26 18:23:55,945 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-07-26 18:23:55,945 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 40763 (custom)
2022-07-26 18:23:55,945 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 36457 (custom)
2022-07-26 18:23:55,945 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 37395 (custom)
2022-07-26 18:23:55,945 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-07-26 18:23:55,945 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,945 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-07-26 18:23:55,946 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:23:55,946 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:23:55,946 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-07-26 18:23:55,946 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-07-26 18:23:55,947 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-07-26 18:23:55,947 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-07-26 18:23:55,947 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-07-26 18:23:55,947 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,948 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,948 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0] (custom)
2022-07-26 18:23:55,948 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s0: addNew group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] returns group-2923AB502154:java.util.concurrent.CompletableFuture@a35d89f[Not completed]
2022-07-26 18:23:55,948 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s1, group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER], format? true
2022-07-26 18:23:55,948 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1
2022-07-26 18:23:55,948 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1 does not exist.
2022-07-26 18:23:55,949 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1
2022-07-26 18:23:55,949 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 34259 (custom)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 41421 (custom)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 43495 (custom)
2022-07-26 18:23:55,949 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-07-26 18:23:55,949 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,951 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1] (custom)
2022-07-26 18:23:55,952 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-07-26 18:23:55,952 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,952 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s0: new RaftServerImpl for group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] with StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s0@group-2923AB502154: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0] (custom)
2022-07-26 18:23:55,955 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-07-26 18:23:55,956 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-07-26 18:23:55,956 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-07-26 18:23:55,956 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-07-26 18:23:55,956 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-07-26 18:23:55,957 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:23:55,957 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-07-26 18:23:55,957 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-07-26 18:23:55,957 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-07-26 18:23:55,958 [pool-15-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-07-26 18:23:55,958 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s1: addNew group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] returns group-2923AB502154:java.util.concurrent.CompletableFuture@4ecfffb6[Not completed]
2022-07-26 18:23:55,958 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-07-26 18:23:55,958 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,958 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,958 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(379)) - newRaftServer: s2, group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER], format? true
2022-07-26 18:23:55,958 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(162)) - deleteFully target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2
2022-07-26 18:23:55,958 [pool-16-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s1: new RaftServerImpl for group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] with StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,958 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(178)) - deleteFully: target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2 does not exist.
2022-07-26 18:23:55,958 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(384)) - Formatted directory target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2
2022-07-26 18:23:55,958 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-07-26 18:23:55,959 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-07-26 18:23:55,959 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 42379 (custom)
2022-07-26 18:23:55,959 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 35985 (custom)
2022-07-26 18:23:55,959 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 40915 (custom)
2022-07-26 18:23:55,959 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-07-26 18:23:55,960 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-07-26 18:23:55,959 [pool-16-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s1@group-2923AB502154: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1] (custom)
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-07-26 18:23:55,960 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-07-26 18:23:55,961 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:23:55,961 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-07-26 18:23:55,961 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-07-26 18:23:55,961 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2022-07-26 18:23:55,961 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2022-07-26 18:23:55,962 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2022-07-26 18:23:55,962 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,962 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,962 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2] (custom)
2022-07-26 18:23:55,962 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-07-26 18:23:55,962 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-07-26 18:23:55,963 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(96)) - s2: addNew group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] returns group-2923AB502154:java.util.concurrent.CompletableFuture@64c8c1d5[Not completed]
2022-07-26 18:23:55,963 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154 does not exist. Creating ...
2022-07-26 18:23:55,963 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(192)) - s2: new RaftServerImpl for group-2923AB502154:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER] with StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2022-07-26 18:23:55,964 [pool-17-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(118)) - s2@group-2923AB502154: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2022-07-26 18:23:55,965 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2] (custom)
2022-07-26 18:23:55,965 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2022-07-26 18:23:55,965 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-07-26 18:23:55,965 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/in_use.lock acquired by nodename 18640@fv-az212-29.lkxvw04jkbfendtxnazko3bsjf.jx.internal.cloudapp.net
2022-07-26 18:23:55,965 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current
2022-07-26 18:23:55,965 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/sm
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2022-07-26 18:23:55,966 [pool-17-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154 has been successfully formatted.
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 8 (custom)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s0@group-2923AB502154-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-07-26 18:23:55,967 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-2923AB502154-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,968 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-2923AB502154-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,969 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s0@group-2923AB502154: start as a follower, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:55,969 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-2923AB502154: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-07-26 18:23:55,969 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-2923AB502154-FollowerState
2022-07-26 18:23:55,969 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s0
2022-07-26 18:23:55,970 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2022-07-26 18:23:55,970 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.threshold = 64 (custom)
2022-07-26 18:23:55,970 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-07-26 18:23:55,970 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-07-26 18:23:55,970 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(385)) - s0: start RPC server
2022-07-26 18:23:55,976 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s0: GrpcService started, listening on 36457
2022-07-26 18:23:55,976 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s0: GrpcService started, listening on 37395
2022-07-26 18:23:55,977 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s0: GrpcService started, listening on 40763
2022-07-26 18:23:55,977 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@55cbb0b5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s0: Started
2022-07-26 18:23:55,977 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154 does not exist. Creating ...
2022-07-26 18:23:55,978 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,979 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/in_use.lock acquired by nodename 18640@fv-az212-29.lkxvw04jkbfendtxnazko3bsjf.jx.internal.cloudapp.net
2022-07-26 18:23:55,979 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current
2022-07-26 18:23:55,979 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/sm
2022-07-26 18:23:55,980 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154 has been successfully formatted.
2022-07-26 18:23:55,980 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,980 [s1-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-07-26 18:23:55,980 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-07-26 18:23:55,980 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 8 (custom)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s1@group-2923AB502154-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-07-26 18:23:55,981 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-2923AB502154-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-2923AB502154-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s1@group-2923AB502154: start as a follower, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-2923AB502154: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-2923AB502154-FollowerState
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s1
2022-07-26 18:23:55,982 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2022-07-26 18:23:55,983 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.threshold = 64 (custom)
2022-07-26 18:23:55,983 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-07-26 18:23:55,983 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-07-26 18:23:55,983 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(385)) - s1: start RPC server
2022-07-26 18:23:55,983 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s1: GrpcService started, listening on 41421
2022-07-26 18:23:55,984 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s1: GrpcService started, listening on 43495
2022-07-26 18:23:55,985 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s1: GrpcService started, listening on 34259
2022-07-26 18:23:55,985 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(137)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154 does not exist. Creating ...
2022-07-26 18:23:55,986 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,986 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@6e54397b] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s1: Started
2022-07-26 18:23:55,987 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(231)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/in_use.lock acquired by nodename 18640@fv-az212-29.lkxvw04jkbfendtxnazko3bsjf.jx.internal.cloudapp.net
2022-07-26 18:23:55,987 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current
2022-07-26 18:23:55,987 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/sm
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154 has been successfully formatted.
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(212)) - Initializing StateMachine4InstallSnapshotNotificationTests:uninitialized
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(306)) - The snapshot file null does not exist
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 8 (custom)
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-07-26 18:23:55,988 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(187)) - new s2@group-2923AB502154-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 1024 (custom)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-2923AB502154-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,989 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-2923AB502154-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(314)) - s2@group-2923AB502154: start as a follower, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-2923AB502154: changes role from      null to FOLLOWER at term 0 for startAsFollower
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-2923AB502154-FollowerState
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s2
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.threshold = 64 (custom)
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2022-07-26 18:23:55,990 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2022-07-26 18:23:55,991 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(385)) - s2: start RPC server
2022-07-26 18:23:55,991 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s2: GrpcService started, listening on 35985
2022-07-26 18:23:55,991 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s2: GrpcService started, listening on 40915
2022-07-26 18:23:55,992 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(262)) - s2: GrpcService started, listening on 42379
2022-07-26 18:23:55,992 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@70a97e4a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-s2: Started
2022-07-26 18:23:55,993 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2022-07-26 18:23:55,993 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:23:55,993 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(172)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:577)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:611)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:604)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:166)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:152)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:256)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:250)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
2022-07-26 18:23:56,184 [s2@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-2923AB502154-FollowerState: change to CANDIDATE, lastRpcElapsedTime:193902278ns, electionTimeout:193ms
2022-07-26 18:23:56,184 [s2@group-2923AB502154-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-2923AB502154-FollowerState
2022-07-26 18:23:56,184 [s2@group-2923AB502154-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-2923AB502154: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2022-07-26 18:23:56,184 [s2@group-2923AB502154-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-07-26 18:23:56,184 [s2@group-2923AB502154-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-2923AB502154-LeaderElection10
2022-07-26 18:23:56,185 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-2923AB502154-LeaderElection10 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,186 [s2@group-2923AB502154-LeaderElection10-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-07-26 18:23:56,186 [s2@group-2923AB502154-LeaderElection10-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2022-07-26 18:23:56,194 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-2923AB502154: receive requestVote(PRE_VOTE, s2, group-2923AB502154, 0, (t:0, i:0))
2022-07-26 18:23:56,194 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-2923AB502154-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-07-26 18:23:56,194 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-2923AB502154 replies to PRE_VOTE vote request: s2<-s1#0:OK-t0. Peer's state: s1@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,199 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-2923AB502154-LeaderElection10: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-07-26 18:23:56,199 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s1#0:OK-t0
2022-07-26 18:23:56,199 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-2923AB502154-LeaderElection10 PRE_VOTE round 0: result PASSED
2022-07-26 18:23:56,200 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-2923AB502154: receive requestVote(PRE_VOTE, s2, group-2923AB502154, 0, (t:0, i:0))
2022-07-26 18:23:56,200 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-2923AB502154-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2022-07-26 18:23:56,200 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-2923AB502154 replies to PRE_VOTE vote request: s2<-s0#0:OK-t0. Peer's state: s0@group-2923AB502154:t0, leader=null, voted=, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,201 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s2@group-2923AB502154-LeaderElection10 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,214 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-2923AB502154: receive requestVote(ELECTION, s2, group-2923AB502154, 1, (t:0, i:0))
2022-07-26 18:23:56,214 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-2923AB502154-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2022-07-26 18:23:56,214 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-2923AB502154: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s2
2022-07-26 18:23:56,214 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-2923AB502154-FollowerState
2022-07-26 18:23:56,215 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-2923AB502154-FollowerState
2022-07-26 18:23:56,215 [s0@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-2923AB502154-FollowerState was interrupted
2022-07-26 18:23:56,219 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s1@group-2923AB502154: receive requestVote(ELECTION, s2, group-2923AB502154, 1, (t:0, i:0))
2022-07-26 18:23:56,219 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(48)) - s1@group-2923AB502154-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2022-07-26 18:23:56,220 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-2923AB502154: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s2
2022-07-26 18:23:56,220 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-2923AB502154-FollowerState
2022-07-26 18:23:56,220 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-2923AB502154-FollowerState
2022-07-26 18:23:56,220 [s1@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-2923AB502154-FollowerState was interrupted
2022-07-26 18:23:56,224 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-2923AB502154 replies to ELECTION vote request: s2<-s0#0:OK-t1. Peer's state: s0@group-2923AB502154:t1, leader=null, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s2@group-2923AB502154-LeaderElection10: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s2<-s0#0:OK-t1
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s2@group-2923AB502154-LeaderElection10 ELECTION round 0: result PASSED
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-2923AB502154-LeaderElection10
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s2@group-2923AB502154: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s2@group-2923AB502154: change Leader from null to s2 at term 1 for becomeLeader, leader elected after 259ms
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-07-26 18:23:56,225 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s1@group-2923AB502154 replies to ELECTION vote request: s2<-s1#0:OK-t1. Peer's state: s1@group-2923AB502154:t1, leader=null, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,225 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:23:56,226 [s2@group-2923AB502154-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-2923AB502154-LeaderStateImpl
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,227 [s2@group-2923AB502154-LeaderElection10] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s2@group-2923AB502154-SegmentedRaftLogWorker: Starting segment from index:0
2022-07-26 18:23:56,229 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0
2022-07-26 18:23:56,230 [s2@group-2923AB502154-LeaderElection10] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s2@group-2923AB502154: set configuration 0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,233 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-2923AB502154: change Leader from null to s2 at term 1 for appendEntries, leader elected after 277ms
2022-07-26 18:23:56,234 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-2923AB502154: change Leader from null to s2 at term 1 for appendEntries, leader elected after 273ms
2022-07-26 18:23:56,235 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s0@group-2923AB502154: set configuration 0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,235 [s0-server-thread1] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,235 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Starting segment from index:0
2022-07-26 18:23:56,236 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s1@group-2923AB502154: set configuration 0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:23:56,236 [s1-server-thread1] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,236 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0
2022-07-26 18:23:56,236 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(425)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Starting segment from index:0
2022-07-26 18:23:56,237 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0
2022-07-26 18:23:56,444 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:23:56,450 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,451 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,452 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 1, m0 -> (t:1, i:1), STATEMACHINELOGENTRY, 386@client-3DC40C5CE9E0
2022-07-26 18:23:56,452 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,453 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,456 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 1, m0 -> (t:1, i:1), STATEMACHINELOGENTRY, 386@client-3DC40C5CE9E0
2022-07-26 18:23:56,459 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 1, m0 -> (t:1, i:1), STATEMACHINELOGENTRY, 386@client-3DC40C5CE9E0
2022-07-26 18:23:56,460 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,460 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,466 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 3, m1 -> (t:1, i:3), STATEMACHINELOGENTRY, 387@client-3DC40C5CE9E0
2022-07-26 18:23:56,467 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,468 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,469 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 3, m1 -> (t:1, i:3), STATEMACHINELOGENTRY, 387@client-3DC40C5CE9E0
2022-07-26 18:23:56,469 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,470 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,470 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 3, m1 -> (t:1, i:3), STATEMACHINELOGENTRY, 387@client-3DC40C5CE9E0
2022-07-26 18:23:56,476 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,477 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 5, m2 -> (t:1, i:5), STATEMACHINELOGENTRY, 388@client-3DC40C5CE9E0
2022-07-26 18:23:56,477 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,478 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,479 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,483 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 5, m2 -> (t:1, i:5), STATEMACHINELOGENTRY, 388@client-3DC40C5CE9E0
2022-07-26 18:23:56,484 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 5, m2 -> (t:1, i:5), STATEMACHINELOGENTRY, 388@client-3DC40C5CE9E0
2022-07-26 18:23:56,487 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 7, m3 -> (t:1, i:7), STATEMACHINELOGENTRY, 389@client-3DC40C5CE9E0
2022-07-26 18:23:56,488 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,488 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,490 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,490 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,492 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 7, m3 -> (t:1, i:7), STATEMACHINELOGENTRY, 389@client-3DC40C5CE9E0
2022-07-26 18:23:56,492 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 7, m3 -> (t:1, i:7), STATEMACHINELOGENTRY, 389@client-3DC40C5CE9E0
2022-07-26 18:23:56,494 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 9, m4 -> (t:1, i:9), STATEMACHINELOGENTRY, 390@client-3DC40C5CE9E0
2022-07-26 18:23:56,495 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,496 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,497 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,498 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,498 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 9, m4 -> (t:1, i:9), STATEMACHINELOGENTRY, 390@client-3DC40C5CE9E0
2022-07-26 18:23:56,499 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 9, m4 -> (t:1, i:9), STATEMACHINELOGENTRY, 390@client-3DC40C5CE9E0
2022-07-26 18:23:56,503 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 11, m5 -> (t:1, i:11), STATEMACHINELOGENTRY, 391@client-3DC40C5CE9E0
2022-07-26 18:23:56,504 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,504 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,505 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,506 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,506 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 11, m5 -> (t:1, i:11), STATEMACHINELOGENTRY, 391@client-3DC40C5CE9E0
2022-07-26 18:23:56,507 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 11, m5 -> (t:1, i:11), STATEMACHINELOGENTRY, 391@client-3DC40C5CE9E0
2022-07-26 18:23:56,508 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 13, m6 -> (t:1, i:13), STATEMACHINELOGENTRY, 392@client-3DC40C5CE9E0
2022-07-26 18:23:56,511 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,511 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,512 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,512 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,514 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 13, m6 -> (t:1, i:13), STATEMACHINELOGENTRY, 392@client-3DC40C5CE9E0
2022-07-26 18:23:56,515 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 13, m6 -> (t:1, i:13), STATEMACHINELOGENTRY, 392@client-3DC40C5CE9E0
2022-07-26 18:23:56,516 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 15, m7 -> (t:1, i:15), STATEMACHINELOGENTRY, 393@client-3DC40C5CE9E0
2022-07-26 18:23:56,516 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,517 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,517 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 15, m7 -> (t:1, i:15), STATEMACHINELOGENTRY, 393@client-3DC40C5CE9E0
2022-07-26 18:23:56,518 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,518 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,519 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 15, m7 -> (t:1, i:15), STATEMACHINELOGENTRY, 393@client-3DC40C5CE9E0
2022-07-26 18:23:56,520 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 17, m8 -> (t:1, i:17), STATEMACHINELOGENTRY, 394@client-3DC40C5CE9E0
2022-07-26 18:23:56,520 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,520 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,521 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 17, m8 -> (t:1, i:17), STATEMACHINELOGENTRY, 394@client-3DC40C5CE9E0
2022-07-26 18:23:56,522 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 17, m8 -> (t:1, i:17), STATEMACHINELOGENTRY, 394@client-3DC40C5CE9E0
2022-07-26 18:23:56,526 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,527 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,528 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 19, m9 -> (t:1, i:19), STATEMACHINELOGENTRY, 395@client-3DC40C5CE9E0
2022-07-26 18:23:56,529 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,530 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,531 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,531 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,531 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 19, m9 -> (t:1, i:19), STATEMACHINELOGENTRY, 395@client-3DC40C5CE9E0
2022-07-26 18:23:56,532 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 19, m9 -> (t:1, i:19), STATEMACHINELOGENTRY, 395@client-3DC40C5CE9E0
2022-07-26 18:23:56,534 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 21, m10 -> (t:1, i:21), STATEMACHINELOGENTRY, 396@client-3DC40C5CE9E0
2022-07-26 18:23:56,535 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,535 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,536 [s2-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s2@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-0_22 to index:22
2022-07-26 18:23:56,536 [s2@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,536 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s2@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,537 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,537 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-0_22 to index:22
2022-07-26 18:23:56,537 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,537 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23
2022-07-26 18:23:56,538 [s1-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-0_22 to index:22
2022-07-26 18:23:56,547 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 21, m10 -> (t:1, i:21), STATEMACHINELOGENTRY, 396@client-3DC40C5CE9E0
2022-07-26 18:23:56,547 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,547 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,548 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 21, m10 -> (t:1, i:21), STATEMACHINELOGENTRY, 396@client-3DC40C5CE9E0
2022-07-26 18:23:56,548 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23
2022-07-26 18:23:56,548 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,548 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,550 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23
2022-07-26 18:23:56,551 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 23, m11 -> (t:1, i:23), STATEMACHINELOGENTRY, 397@client-3DC40C5CE9E0
2022-07-26 18:23:56,552 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,552 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,553 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,553 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,555 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 23, m11 -> (t:1, i:23), STATEMACHINELOGENTRY, 397@client-3DC40C5CE9E0
2022-07-26 18:23:56,555 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 23, m11 -> (t:1, i:23), STATEMACHINELOGENTRY, 397@client-3DC40C5CE9E0
2022-07-26 18:23:56,557 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 25, m12 -> (t:1, i:25), STATEMACHINELOGENTRY, 398@client-3DC40C5CE9E0
2022-07-26 18:23:56,557 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,558 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,558 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 25, m12 -> (t:1, i:25), STATEMACHINELOGENTRY, 398@client-3DC40C5CE9E0
2022-07-26 18:23:56,559 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,559 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,560 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 25, m12 -> (t:1, i:25), STATEMACHINELOGENTRY, 398@client-3DC40C5CE9E0
2022-07-26 18:23:56,563 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 27, m13 -> (t:1, i:27), STATEMACHINELOGENTRY, 399@client-3DC40C5CE9E0
2022-07-26 18:23:56,563 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,564 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,565 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,566 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,571 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 27, m13 -> (t:1, i:27), STATEMACHINELOGENTRY, 399@client-3DC40C5CE9E0
2022-07-26 18:23:56,571 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 27, m13 -> (t:1, i:27), STATEMACHINELOGENTRY, 399@client-3DC40C5CE9E0
2022-07-26 18:23:56,572 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 29, m14 -> (t:1, i:29), STATEMACHINELOGENTRY, 400@client-3DC40C5CE9E0
2022-07-26 18:23:56,573 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,574 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,575 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,575 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,576 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 29, m14 -> (t:1, i:29), STATEMACHINELOGENTRY, 400@client-3DC40C5CE9E0
2022-07-26 18:23:56,577 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 29, m14 -> (t:1, i:29), STATEMACHINELOGENTRY, 400@client-3DC40C5CE9E0
2022-07-26 18:23:56,578 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 31, m15 -> (t:1, i:31), STATEMACHINELOGENTRY, 401@client-3DC40C5CE9E0
2022-07-26 18:23:56,578 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,579 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,581 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,582 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,583 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 31, m15 -> (t:1, i:31), STATEMACHINELOGENTRY, 401@client-3DC40C5CE9E0
2022-07-26 18:23:56,585 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 31, m15 -> (t:1, i:31), STATEMACHINELOGENTRY, 401@client-3DC40C5CE9E0
2022-07-26 18:23:56,585 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 33, m16 -> (t:1, i:33), STATEMACHINELOGENTRY, 402@client-3DC40C5CE9E0
2022-07-26 18:23:56,586 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,587 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,588 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,588 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,589 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 33, m16 -> (t:1, i:33), STATEMACHINELOGENTRY, 402@client-3DC40C5CE9E0
2022-07-26 18:23:56,590 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 33, m16 -> (t:1, i:33), STATEMACHINELOGENTRY, 402@client-3DC40C5CE9E0
2022-07-26 18:23:56,595 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 35, m17 -> (t:1, i:35), STATEMACHINELOGENTRY, 403@client-3DC40C5CE9E0
2022-07-26 18:23:56,595 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,596 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,597 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,597 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,598 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 35, m17 -> (t:1, i:35), STATEMACHINELOGENTRY, 403@client-3DC40C5CE9E0
2022-07-26 18:23:56,599 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 35, m17 -> (t:1, i:35), STATEMACHINELOGENTRY, 403@client-3DC40C5CE9E0
2022-07-26 18:23:56,600 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 37, m18 -> (t:1, i:37), STATEMACHINELOGENTRY, 404@client-3DC40C5CE9E0
2022-07-26 18:23:56,601 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,601 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,604 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,604 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,607 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 37, m18 -> (t:1, i:37), STATEMACHINELOGENTRY, 404@client-3DC40C5CE9E0
2022-07-26 18:23:56,607 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 37, m18 -> (t:1, i:37), STATEMACHINELOGENTRY, 404@client-3DC40C5CE9E0
2022-07-26 18:23:56,608 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 39, m19 -> (t:1, i:39), STATEMACHINELOGENTRY, 405@client-3DC40C5CE9E0
2022-07-26 18:23:56,609 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,609 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,610 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,611 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,611 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 39, m19 -> (t:1, i:39), STATEMACHINELOGENTRY, 405@client-3DC40C5CE9E0
2022-07-26 18:23:56,613 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 41, m20 -> (t:1, i:41), STATEMACHINELOGENTRY, 406@client-3DC40C5CE9E0
2022-07-26 18:23:56,613 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,613 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,614 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 39, m19 -> (t:1, i:39), STATEMACHINELOGENTRY, 405@client-3DC40C5CE9E0
2022-07-26 18:23:56,615 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,615 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,616 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 41, m20 -> (t:1, i:41), STATEMACHINELOGENTRY, 406@client-3DC40C5CE9E0
2022-07-26 18:23:56,618 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,618 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,618 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 43, m21 -> (t:1, i:43), STATEMACHINELOGENTRY, 407@client-3DC40C5CE9E0
2022-07-26 18:23:56,623 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,623 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,623 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 41, m20 -> (t:1, i:41), STATEMACHINELOGENTRY, 406@client-3DC40C5CE9E0
2022-07-26 18:23:56,627 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 43, m21 -> (t:1, i:43), STATEMACHINELOGENTRY, 407@client-3DC40C5CE9E0
2022-07-26 18:23:56,627 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 43, m21 -> (t:1, i:43), STATEMACHINELOGENTRY, 407@client-3DC40C5CE9E0
2022-07-26 18:23:56,629 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 45, m22 -> (t:1, i:45), STATEMACHINELOGENTRY, 408@client-3DC40C5CE9E0
2022-07-26 18:23:56,629 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,630 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,631 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,631 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,631 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 45, m22 -> (t:1, i:45), STATEMACHINELOGENTRY, 408@client-3DC40C5CE9E0
2022-07-26 18:23:56,632 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 45, m22 -> (t:1, i:45), STATEMACHINELOGENTRY, 408@client-3DC40C5CE9E0
2022-07-26 18:23:56,633 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 47, m23 -> (t:1, i:47), STATEMACHINELOGENTRY, 409@client-3DC40C5CE9E0
2022-07-26 18:23:56,634 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,634 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,635 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,635 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,636 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 47, m23 -> (t:1, i:47), STATEMACHINELOGENTRY, 409@client-3DC40C5CE9E0
2022-07-26 18:23:56,637 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 47, m23 -> (t:1, i:47), STATEMACHINELOGENTRY, 409@client-3DC40C5CE9E0
2022-07-26 18:23:56,638 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 49, m24 -> (t:1, i:49), STATEMACHINELOGENTRY, 410@client-3DC40C5CE9E0
2022-07-26 18:23:56,639 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,639 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,640 [s2-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s2@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-23_50 to index:50
2022-07-26 18:23:56,640 [s2@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,640 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s2@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,640 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 49, m24 -> (t:1, i:49), STATEMACHINELOGENTRY, 410@client-3DC40C5CE9E0
2022-07-26 18:23:56,641 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,641 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-23_50 to index:50
2022-07-26 18:23:56,641 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s2@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51
2022-07-26 18:23:56,642 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,642 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,642 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,642 [s1-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-23_50 to index:50
2022-07-26 18:23:56,642 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51
2022-07-26 18:23:56,643 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,643 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_23 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,643 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 49, m24 -> (t:1, i:49), STATEMACHINELOGENTRY, 410@client-3DC40C5CE9E0
2022-07-26 18:23:56,644 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51
2022-07-26 18:23:56,644 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 51, m25 -> (t:1, i:51), STATEMACHINELOGENTRY, 411@client-3DC40C5CE9E0
2022-07-26 18:23:56,645 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,645 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,646 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 51, m25 -> (t:1, i:51), STATEMACHINELOGENTRY, 411@client-3DC40C5CE9E0
2022-07-26 18:23:56,647 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,647 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,648 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 51, m25 -> (t:1, i:51), STATEMACHINELOGENTRY, 411@client-3DC40C5CE9E0
2022-07-26 18:23:56,651 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,652 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 53, m26 -> (t:1, i:53), STATEMACHINELOGENTRY, 412@client-3DC40C5CE9E0
2022-07-26 18:23:56,652 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,653 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 53, m26 -> (t:1, i:53), STATEMACHINELOGENTRY, 412@client-3DC40C5CE9E0
2022-07-26 18:23:56,653 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 53, m26 -> (t:1, i:53), STATEMACHINELOGENTRY, 412@client-3DC40C5CE9E0
2022-07-26 18:23:56,654 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,654 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,669 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 55, m27 -> (t:1, i:55), STATEMACHINELOGENTRY, 413@client-3DC40C5CE9E0
2022-07-26 18:23:56,670 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,671 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,672 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,672 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,677 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 55, m27 -> (t:1, i:55), STATEMACHINELOGENTRY, 413@client-3DC40C5CE9E0
2022-07-26 18:23:56,681 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 55, m27 -> (t:1, i:55), STATEMACHINELOGENTRY, 413@client-3DC40C5CE9E0
2022-07-26 18:23:56,683 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 57, m28 -> (t:1, i:57), STATEMACHINELOGENTRY, 414@client-3DC40C5CE9E0
2022-07-26 18:23:56,683 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,683 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,685 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,686 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,688 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 57, m28 -> (t:1, i:57), STATEMACHINELOGENTRY, 414@client-3DC40C5CE9E0
2022-07-26 18:23:56,691 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 57, m28 -> (t:1, i:57), STATEMACHINELOGENTRY, 414@client-3DC40C5CE9E0
2022-07-26 18:23:56,691 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 59, m29 -> (t:1, i:59), STATEMACHINELOGENTRY, 415@client-3DC40C5CE9E0
2022-07-26 18:23:56,692 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,693 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,694 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,694 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,695 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 59, m29 -> (t:1, i:59), STATEMACHINELOGENTRY, 415@client-3DC40C5CE9E0
2022-07-26 18:23:56,696 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 59, m29 -> (t:1, i:59), STATEMACHINELOGENTRY, 415@client-3DC40C5CE9E0
2022-07-26 18:23:56,699 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 61, m30 -> (t:1, i:61), STATEMACHINELOGENTRY, 416@client-3DC40C5CE9E0
2022-07-26 18:23:56,700 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,700 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,702 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,702 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,703 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 61, m30 -> (t:1, i:61), STATEMACHINELOGENTRY, 416@client-3DC40C5CE9E0
2022-07-26 18:23:56,703 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 61, m30 -> (t:1, i:61), STATEMACHINELOGENTRY, 416@client-3DC40C5CE9E0
2022-07-26 18:23:56,706 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 63, m31 -> (t:1, i:63), STATEMACHINELOGENTRY, 417@client-3DC40C5CE9E0
2022-07-26 18:23:56,707 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,725 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,726 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,726 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,726 [s2@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s2@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 63
2022-07-26 18:23:56,726 [s2@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s2@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,727 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 63, m31 -> (t:1, i:63), STATEMACHINELOGENTRY, 417@client-3DC40C5CE9E0
2022-07-26 18:23:56,729 [s2@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s2@group-2923AB502154-SegmentedRaftLog: purge 61
2022-07-26 18:23:56,729 [s2@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s2@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,729 [s2@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:toTruncate: null
  toDelete: [(0, 22) isOpen? false, length=0, newEndIndex=0, (23, 50) isOpen? false, length=0, newEndIndex=0]
2022-07-26 18:23:56,729 [s2@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,729 [s2@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s2/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,729 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s2@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=50, updated? true
2022-07-26 18:23:56,739 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 63, m31 -> (t:1, i:63), STATEMACHINELOGENTRY, 417@client-3DC40C5CE9E0
2022-07-26 18:23:56,747 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 65, m32 -> (t:1, i:65), STATEMACHINELOGENTRY, 418@client-3DC40C5CE9E0
2022-07-26 18:23:56,747 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,748 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,749 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,749 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:23:56,753 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s0@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 63
2022-07-26 18:23:56,753 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s0@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,754 [s0@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s0@group-2923AB502154-SegmentedRaftLog: purge 63
2022-07-26 18:23:56,754 [s0@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s0@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,754 [s0@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:toTruncate: null
  toDelete: [(0, 22) isOpen? false, length=0, newEndIndex=0, (23, 50) isOpen? false, length=0, newEndIndex=0]
2022-07-26 18:23:56,756 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s1@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 63
2022-07-26 18:23:56,756 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s1@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,756 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s1@group-2923AB502154-SegmentedRaftLog: purge 63
2022-07-26 18:23:56,756 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 63
2022-07-26 18:23:56,756 [s1@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:toTruncate: null
  toDelete: [(0, 22) isOpen? false, length=0, newEndIndex=0, (23, 50) isOpen? false, length=0, newEndIndex=0]
2022-07-26 18:23:56,759 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,759 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,759 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=50, updated? true
2022-07-26 18:23:56,759 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 65, m32 -> (t:1, i:65), STATEMACHINELOGENTRY, 418@client-3DC40C5CE9E0
2022-07-26 18:23:56,763 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_0-22
2022-07-26 18:23:56,763 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_23-50
2022-07-26 18:23:56,763 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s0@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=50, updated? true
2022-07-26 18:23:56,764 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 65, m32 -> (t:1, i:65), STATEMACHINELOGENTRY, 418@client-3DC40C5CE9E0
2022-07-26 18:23:59,750 [java.util.concurrent.ThreadPoolExecutor$Worker@6c71573b[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(285)) - s2@group-2923AB502154->s1-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=165,entriesCount=1,lastEntry=(t:1, i:67)
2022-07-26 18:23:59,751 [java.util.concurrent.ThreadPoolExecutor$Worker@6c71573b[State = -1, empty queue]] WARN  server.GrpcLogAppender (GrpcLogAppender.java:timeoutAppendRequest(285)) - s2@group-2923AB502154->s0-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=164,entriesCount=1,lastEntry=(t:1, i:67)
2022-07-26 18:23:59,863 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:03,081 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:05,996 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:06,303 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:09,517 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:12,730 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:15,941 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:15,994 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:19,158 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:22,370 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:25,582 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:25,993 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:28,794 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:32,006 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:35,217 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:35,994 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:38,432 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:41,650 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:44,864 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:45,993 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:48,079 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s0@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s0:c65, s1:c65, s2:c66]
2022-07-26 18:24:51,294 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:54,510 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:55,994 [Timer-3] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$6(346)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c65, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:OPENED:c66, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2022-07-26 18:24:57,720 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c65, s0:c65, s2:c66]
2022-07-26 18:24:57,832 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,832 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,833 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 67, m33 -> (t:1, i:67), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,833 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,834 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,835 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,835 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 67, m33 -> (t:1, i:67), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,836 [s1-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s2: put 68, m33 -> (t:1, i:68), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] ERROR impl.StateMachineUpdater (StateMachineUpdater.java:run(194)) - s2@group-2923AB502154-StateMachineUpdater caught a Throwable.
org.apache.ratis.server.raftlog.RaftLogIOException: java.lang.IllegalStateException: retry cache entry should be pending: 419@client-3DC40C5CE9E0:done
	at org.apache.ratis.server.impl.RaftServerImpl.applyLogToStateMachine(RaftServerImpl.java:1645)
	at org.apache.ratis.server.impl.StateMachineUpdater.applyLog(StateMachineUpdater.java:239)
	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:182)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.IllegalStateException: retry cache entry should be pending: 419@client-3DC40C5CE9E0:done
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:60)
	at org.apache.ratis.server.impl.RaftServerImpl.replyPendingRequest(RaftServerImpl.java:1592)
	at org.apache.ratis.server.impl.RaftServerImpl.applyLogToStateMachine(RaftServerImpl.java:1643)
	... 3 more
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s2@group-2923AB502154: shutdown
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s2
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s2: shutdown s2@group-2923AB502154-LeaderStateImpl
2022-07-26 18:24:57,839 [s2@group-2923AB502154-StateMachineUpdater] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s2@group-2923AB502154-PendingRequests: sendNotLeaderResponses
2022-07-26 18:24:57,843 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 68, m33 -> (t:1, i:68), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,847 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2022-07-26 18:24:57,847 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: s2->s0#7339-t1,previous=(t:1, i:69),leaderCommit=68,initializing? true,entries: size=1, first=(t:1, i:70), METADATAENTRY(c:68)
2022-07-26 18:24:57,847 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-07-26 18:24:57,850 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 67, m33 -> (t:1, i:67), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,855 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 68, m33 -> (t:1, i:68), STATEMACHINELOGENTRY, 419@client-3DC40C5CE9E0
2022-07-26 18:24:57,855 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s2@group-2923AB502154->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:57,855 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-2923AB502154->s0: nextIndex: updateUnconditionally 71 -> 70
2022-07-26 18:24:57,856 [s2@group-2923AB502154-StateMachineUpdater] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s2@group-2923AB502154: closes. applyIndex: 68
2022-07-26 18:24:57,857 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s1: Completed APPEND_ENTRIES, lastRequest: s2->s1#7338-t1,previous=(t:1, i:69),leaderCommit=68,initializing? true,entries: size=1, first=(t:1, i:70), METADATAENTRY(c:68)
2022-07-26 18:24:57,857 [s2@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s2@group-2923AB502154-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-07-26 18:24:57,857 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s2@group-2923AB502154->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:57,861 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-2923AB502154->s0: nextIndex: updateUnconditionally 70 -> 69
2022-07-26 18:24:57,861 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s2@group-2923AB502154->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:57,861 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-2923AB502154->s1: nextIndex: updateUnconditionally 71 -> 70
2022-07-26 18:24:57,861 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s2@group-2923AB502154->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:57,861 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s2@group-2923AB502154->s1: nextIndex: updateUnconditionally 70 -> 69
2022-07-26 18:24:57,863 [s2@group-2923AB502154-StateMachineUpdater] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s2@group-2923AB502154-SegmentedRaftLogWorker close()
2022-07-26 18:24:57,863 [null-request--thread2] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s2@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s2@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s2@group-2923AB502154 is not the leader, logIndex=0, commits[s2:c69]
2022-07-26 18:24:57,976 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, seq=0, RW, Message:6d3333, reply=RaftClientReply:client-3DC40C5CE9E0->s1@group-2923AB502154, cid=419, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s1@group-2923AB502154 is not the leader s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER, logIndex=0, commits[s1:c68, s0:c65, s2:c68]
2022-07-26 18:24:58,015 [s1@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-2923AB502154-FollowerState: change to CANDIDATE, lastRpcElapsedTime:160576187ns, electionTimeout:154ms
2022-07-26 18:24:58,015 [s1@group-2923AB502154-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-2923AB502154-FollowerState
2022-07-26 18:24:58,015 [s1@group-2923AB502154-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-2923AB502154: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-07-26 18:24:58,015 [s1@group-2923AB502154-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2022-07-26 18:24:58,015 [s1@group-2923AB502154-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-2923AB502154-LeaderElection11
2022-07-26 18:24:58,016 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-2923AB502154: change Leader from s2 to null at term 1 for PRE_VOTE
2022-07-26 18:24:58,016 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-2923AB502154-LeaderElection11 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,017 [s1@group-2923AB502154-LeaderElection11-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2022-07-26 18:24:58,017 [s1@group-2923AB502154-LeaderElection11-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2022-07-26 18:24:58,021 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-2923AB502154: receive requestVote(PRE_VOTE, s1, group-2923AB502154, 1, (t:1, i:70))
2022-07-26 18:24:58,021 [grpc-default-executor-8] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-2923AB502154-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2022-07-26 18:24:58,021 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-2923AB502154 replies to PRE_VOTE vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c68, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,023 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-2923AB502154-LeaderElection11: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2022-07-26 18:24:58,023 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s0#0:OK-t1
2022-07-26 18:24:58,023 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-2923AB502154-LeaderElection11 PRE_VOTE round 0: result PASSED
2022-07-26 18:24:58,025 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(310)) - s1@group-2923AB502154-LeaderElection11 ELECTION round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,026 [grpc-default-executor-8] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-2923AB502154: receive requestVote(PRE_VOTE, s1, group-2923AB502154, 1, (t:1, i:70))
2022-07-26 18:24:58,027 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: Failed requestVote s1->s2#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s2@group-2923AB502154 is not in [RUNNING]: current state is CLOSED
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s0@group-2923AB502154: receive requestVote(ELECTION, s1, group-2923AB502154, 2, (t:1, i:70))
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  impl.VoteContext (VoteContext.java:log(48)) - s0@group-2923AB502154-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-2923AB502154: change Leader from s2 to null at term 2 for updateCurrentTerm
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s0@group-2923AB502154: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s1
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-2923AB502154-FollowerState
2022-07-26 18:24:58,028 [grpc-default-executor-7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-2923AB502154-FollowerState
2022-07-26 18:24:58,029 [s0@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-2923AB502154-FollowerState was interrupted
2022-07-26 18:24:58,031 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1231)) - s0@group-2923AB502154 replies to ELECTION vote request: s1<-s0#0:OK-t2. Peer's state: s0@group-2923AB502154:t2, leader=null, voted=s1, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c68, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(90)) - s1@group-2923AB502154-LeaderElection11: ELECTION PASSED received 1 response(s) and 0 exception(s):
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(94)) -   Response 0: s1<-s0#0:OK-t2
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(312)) - s1@group-2923AB502154-LeaderElection11 ELECTION round 0: result PASSED
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-2923AB502154-LeaderElection11
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(301)) - s1@group-2923AB502154: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s1@group-2923AB502154: change Leader from null to s1 at term 2 for becomeLeader, leader elected after 15ms
2022-07-26 18:24:58,031 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2022-07-26 18:24:58,032 [grpc-default-executor-7] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1198)) - s2@group-2923AB502154: receive requestVote(ELECTION, s1, group-2923AB502154, 2, (t:1, i:70))
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-07-26 18:24:58,032 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: Failed requestVote s1->s2#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s2@group-2923AB502154 is not in [RUNNING]: current state is CLOSED
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:24:58,032 [s1@group-2923AB502154-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-2923AB502154-LeaderStateImpl
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,033 [s1@group-2923AB502154-LeaderElection11] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-51_70 to index:70
2022-07-26 18:24:58,033 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_51-70
2022-07-26 18:24:58,034 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_51-70
2022-07-26 18:24:58,035 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71
2022-07-26 18:24:58,047 [s1@group-2923AB502154-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s1@group-2923AB502154: set configuration 71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,054 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(313)) - s0@group-2923AB502154: change Leader from null to s1 at term 2 for appendEntries, leader elected after 25ms
2022-07-26 18:24:58,054 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(429)) - s0@group-2923AB502154: set configuration 71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2022-07-26 18:24:58,054 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,054 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-51_70 to index:70
2022-07-26 18:24:58,054 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_51-70
2022-07-26 18:24:58,054 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_51 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_51-70
2022-07-26 18:24:58,056 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71
2022-07-26 18:24:58,056 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#1-t2,previous=(t:1, i:70),leaderCommit=68,initializing? true,entries: size=1, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,145 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@f2962d7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,150 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 72 -> 71
2022-07-26 18:24:58,151 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,152 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#4-t2,previous=(t:1, i:70),leaderCommit=71,initializing? true,entries: size=2, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,158 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6973797d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,159 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 73 -> 71
2022-07-26 18:24:58,191 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#9-t2,previous=(t:1, i:70),leaderCommit=72,initializing? true,entries: size=2, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,195 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33adfe75 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,195 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 73 -> 71
2022-07-26 18:24:58,230 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#11-t2,previous=(t:1, i:70),leaderCommit=72,initializing? true,entries: size=2, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,236 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a83abcd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,237 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 73 -> 71
2022-07-26 18:24:58,241 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#12-t2,previous=(t:1, i:70),leaderCommit=72,initializing? true,entries: size=2, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,244 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@39c61efe rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,244 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 73 -> 71
2022-07-26 18:24:58,267 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#14-t2,previous=(t:1, i:70),leaderCommit=72,initializing? true,entries: size=2, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,269 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,271 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f8c9681 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,271 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 73 -> 71
2022-07-26 18:24:58,275 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 73, m34 -> (t:2, i:73), STATEMACHINELOGENTRY, 420@client-3DC40C5CE9E0
2022-07-26 18:24:58,276 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,279 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#16-t2,previous=(t:1, i:70),leaderCommit=73,initializing? true,entries: size=4, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,280 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,283 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 73, m34 -> (t:2, i:73), STATEMACHINELOGENTRY, 420@client-3DC40C5CE9E0
2022-07-26 18:24:58,283 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76499928 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,283 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 75 -> 71
2022-07-26 18:24:58,284 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 75, m35 -> (t:2, i:75), STATEMACHINELOGENTRY, 421@client-3DC40C5CE9E0
2022-07-26 18:24:58,285 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,286 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,286 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#18-t2,previous=(t:1, i:70),leaderCommit=73,initializing? true,entries: size=5, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,289 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@788527b0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,289 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 76 -> 71
2022-07-26 18:24:58,291 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 75, m35 -> (t:2, i:75), STATEMACHINELOGENTRY, 421@client-3DC40C5CE9E0
2022-07-26 18:24:58,292 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#21-t2,previous=(t:1, i:70),leaderCommit=75,initializing? true,entries: size=7, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,294 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2ccaa07 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,294 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 78 -> 71
2022-07-26 18:24:58,297 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 77, m36 -> (t:2, i:77), STATEMACHINELOGENTRY, 422@client-3DC40C5CE9E0
2022-07-26 18:24:58,298 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,298 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#23-t2,previous=(t:1, i:70),leaderCommit=77,initializing? true,entries: size=8, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,298 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 77, m36 -> (t:2, i:77), STATEMACHINELOGENTRY, 422@client-3DC40C5CE9E0
2022-07-26 18:24:58,301 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@40e6dd1e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,302 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 79 -> 71
2022-07-26 18:24:58,303 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,303 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#26-t2,previous=(t:1, i:70),leaderCommit=78,initializing? true,entries: size=9, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,305 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b30f715 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,306 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 80 -> 71
2022-07-26 18:24:58,308 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 79, m37 -> (t:2, i:79), STATEMACHINELOGENTRY, 423@client-3DC40C5CE9E0
2022-07-26 18:24:58,308 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,308 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#27-t2,previous=(t:1, i:70),leaderCommit=78,initializing? true,entries: size=9, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,311 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29039f37 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,312 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 80 -> 71
2022-07-26 18:24:58,312 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,315 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 79, m37 -> (t:2, i:79), STATEMACHINELOGENTRY, 423@client-3DC40C5CE9E0
2022-07-26 18:24:58,315 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#30-t2,previous=(t:1, i:70),leaderCommit=79,initializing? true,entries: size=11, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,317 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1f76c481 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,327 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 82 -> 71
2022-07-26 18:24:58,327 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 81, m38 -> (t:2, i:81), STATEMACHINELOGENTRY, 424@client-3DC40C5CE9E0
2022-07-26 18:24:58,329 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#32-t2,previous=(t:1, i:70),leaderCommit=81,initializing? true,entries: size=12, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,330 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,331 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6fd9be09 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,332 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 83 -> 71
2022-07-26 18:24:58,332 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,332 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 81, m38 -> (t:2, i:81), STATEMACHINELOGENTRY, 424@client-3DC40C5CE9E0
2022-07-26 18:24:58,333 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#34-t2,previous=(t:1, i:70),leaderCommit=82,initializing? true,entries: size=13, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,336 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25ea2f30 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,337 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 84 -> 71
2022-07-26 18:24:58,337 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 83, m39 -> (t:2, i:83), STATEMACHINELOGENTRY, 425@client-3DC40C5CE9E0
2022-07-26 18:24:58,338 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,338 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#35-t2,previous=(t:1, i:70),leaderCommit=83,initializing? true,entries: size=14, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,339 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 83, m39 -> (t:2, i:83), STATEMACHINELOGENTRY, 425@client-3DC40C5CE9E0
2022-07-26 18:24:58,340 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,341 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@20974135 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,341 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 85 -> 71
2022-07-26 18:24:58,342 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 85, m40 -> (t:2, i:85), STATEMACHINELOGENTRY, 426@client-3DC40C5CE9E0
2022-07-26 18:24:58,342 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,343 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 85, m40 -> (t:2, i:85), STATEMACHINELOGENTRY, 426@client-3DC40C5CE9E0
2022-07-26 18:24:58,343 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#38-t2,previous=(t:1, i:70),leaderCommit=85,initializing? true,entries: size=15, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,344 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,345 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@46a35e1b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,346 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 86 -> 71
2022-07-26 18:24:58,346 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 87, m41 -> (t:2, i:87), STATEMACHINELOGENTRY, 427@client-3DC40C5CE9E0
2022-07-26 18:24:58,346 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,347 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 87, m41 -> (t:2, i:87), STATEMACHINELOGENTRY, 427@client-3DC40C5CE9E0
2022-07-26 18:24:58,348 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#42-t2,previous=(t:1, i:70),leaderCommit=87,initializing? true,entries: size=19, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,350 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,351 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54e3855f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,351 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 90 -> 71
2022-07-26 18:24:58,352 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 89, m42 -> (t:2, i:89), STATEMACHINELOGENTRY, 428@client-3DC40C5CE9E0
2022-07-26 18:24:58,352 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,353 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#44-t2,previous=(t:1, i:70),leaderCommit=89,initializing? true,entries: size=20, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,355 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 89, m42 -> (t:2, i:89), STATEMACHINELOGENTRY, 428@client-3DC40C5CE9E0
2022-07-26 18:24:58,355 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7570ad50 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,356 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 91 -> 71
2022-07-26 18:24:58,356 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,357 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 91, m43 -> (t:2, i:91), STATEMACHINELOGENTRY, 429@client-3DC40C5CE9E0
2022-07-26 18:24:58,358 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,359 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#48-t2,previous=(t:1, i:70),leaderCommit=91,initializing? true,entries: size=22, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,363 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,365 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4eb79a9f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,367 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 93 -> 71
2022-07-26 18:24:58,365 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 91, m43 -> (t:2, i:91), STATEMACHINELOGENTRY, 429@client-3DC40C5CE9E0
2022-07-26 18:24:58,368 [s1@group-2923AB502154-LeaderStateImpl] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-71_93 to index:93
2022-07-26 18:24:58,368 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 93, m44 -> (t:2, i:93), STATEMACHINELOGENTRY, 430@client-3DC40C5CE9E0
2022-07-26 18:24:58,369 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_71-93
2022-07-26 18:24:58,369 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_71-93
2022-07-26 18:24:58,369 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,369 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-71_93 to index:93
2022-07-26 18:24:58,369 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_71-93
2022-07-26 18:24:58,370 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_71 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_71-93
2022-07-26 18:24:58,370 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#50-t2,previous=(t:1, i:70),leaderCommit=92,initializing? true,entries: size=23, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,370 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,371 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94
2022-07-26 18:24:58,371 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94
2022-07-26 18:24:58,373 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2f8ed4a2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,373 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 94 -> 71
2022-07-26 18:24:58,380 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 93, m44 -> (t:2, i:93), STATEMACHINELOGENTRY, 430@client-3DC40C5CE9E0
2022-07-26 18:24:58,381 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#52-t2,previous=(t:1, i:70),leaderCommit=93,initializing? true,entries: size=25, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,383 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1530f321 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,383 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 96 -> 71
2022-07-26 18:24:58,387 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 95, m45 -> (t:2, i:95), STATEMACHINELOGENTRY, 431@client-3DC40C5CE9E0
2022-07-26 18:24:58,387 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,388 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#54-t2,previous=(t:1, i:70),leaderCommit=95,initializing? true,entries: size=26, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,389 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 95, m45 -> (t:2, i:95), STATEMACHINELOGENTRY, 431@client-3DC40C5CE9E0
2022-07-26 18:24:58,390 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4871dcf2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,391 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 97 -> 71
2022-07-26 18:24:58,392 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#57-t2,previous=(t:1, i:70),leaderCommit=96,initializing? true,entries: size=27, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,393 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,394 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a8f7ebf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,394 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 98 -> 71
2022-07-26 18:24:58,396 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 97, m46 -> (t:2, i:97), STATEMACHINELOGENTRY, 432@client-3DC40C5CE9E0
2022-07-26 18:24:58,396 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,397 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#58-t2,previous=(t:1, i:70),leaderCommit=97,initializing? true,entries: size=27, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,399 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51a30cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,399 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 98 -> 71
2022-07-26 18:24:58,399 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,403 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 97, m46 -> (t:2, i:97), STATEMACHINELOGENTRY, 432@client-3DC40C5CE9E0
2022-07-26 18:24:58,404 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#60-t2,previous=(t:1, i:70),leaderCommit=98,initializing? true,entries: size=29, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,406 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5851d03d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,406 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 100 -> 71
2022-07-26 18:24:58,406 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 99, m47 -> (t:2, i:99), STATEMACHINELOGENTRY, 433@client-3DC40C5CE9E0
2022-07-26 18:24:58,407 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,407 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#61-t2,previous=(t:1, i:70),leaderCommit=99,initializing? true,entries: size=30, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,408 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 99, m47 -> (t:2, i:99), STATEMACHINELOGENTRY, 433@client-3DC40C5CE9E0
2022-07-26 18:24:58,409 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7930f663 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,409 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 101 -> 71
2022-07-26 18:24:58,410 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,411 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#63-t2,previous=(t:1, i:70),leaderCommit=99,initializing? true,entries: size=31, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,413 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5f463bed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,413 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 102 -> 71
2022-07-26 18:24:58,413 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 101, m48 -> (t:2, i:101), STATEMACHINELOGENTRY, 434@client-3DC40C5CE9E0
2022-07-26 18:24:58,414 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,414 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#65-t2,previous=(t:1, i:70),leaderCommit=101,initializing? true,entries: size=32, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,415 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 101, m48 -> (t:2, i:101), STATEMACHINELOGENTRY, 434@client-3DC40C5CE9E0
2022-07-26 18:24:58,416 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57380109 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,417 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 103 -> 71
2022-07-26 18:24:58,418 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,418 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#66-t2,previous=(t:1, i:70),leaderCommit=102,initializing? true,entries: size=32, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,420 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72abd815 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,420 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 103 -> 71
2022-07-26 18:24:58,421 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 103, m49 -> (t:2, i:103), STATEMACHINELOGENTRY, 435@client-3DC40C5CE9E0
2022-07-26 18:24:58,421 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#67-t2,previous=(t:1, i:70),leaderCommit=102,initializing? true,entries: size=33, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,422 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,423 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78453bd6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,424 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 104 -> 71
2022-07-26 18:24:58,424 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 103, m49 -> (t:2, i:103), STATEMACHINELOGENTRY, 435@client-3DC40C5CE9E0
2022-07-26 18:24:58,425 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,426 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#69-t2,previous=(t:1, i:70),leaderCommit=103,initializing? true,entries: size=35, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,428 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4008695d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,428 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 106 -> 71
2022-07-26 18:24:58,428 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 105, m50 -> (t:2, i:105), STATEMACHINELOGENTRY, 436@client-3DC40C5CE9E0
2022-07-26 18:24:58,429 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,429 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#71-t2,previous=(t:1, i:70),leaderCommit=105,initializing? true,entries: size=36, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,431 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 105, m50 -> (t:2, i:105), STATEMACHINELOGENTRY, 436@client-3DC40C5CE9E0
2022-07-26 18:24:58,431 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@604b1547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,433 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 107 -> 71
2022-07-26 18:24:58,432 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,435 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 107, m51 -> (t:2, i:107), STATEMACHINELOGENTRY, 437@client-3DC40C5CE9E0
2022-07-26 18:24:58,436 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,437 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#75-t2,previous=(t:1, i:70),leaderCommit=107,initializing? true,entries: size=38, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,438 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37271bf6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,439 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 109 -> 71
2022-07-26 18:24:58,440 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,440 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#76-t2,previous=(t:1, i:70),leaderCommit=107,initializing? true,entries: size=39, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,442 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e87ac7b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,443 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 110 -> 71
2022-07-26 18:24:58,446 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 107, m51 -> (t:2, i:107), STATEMACHINELOGENTRY, 437@client-3DC40C5CE9E0
2022-07-26 18:24:58,447 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#77-t2,previous=(t:1, i:70),leaderCommit=107,initializing? true,entries: size=39, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,449 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3798d06f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,450 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 110 -> 71
2022-07-26 18:24:58,450 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 109, m52 -> (t:2, i:109), STATEMACHINELOGENTRY, 438@client-3DC40C5CE9E0
2022-07-26 18:24:58,451 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,452 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#79-t2,previous=(t:1, i:70),leaderCommit=109,initializing? true,entries: size=40, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,454 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7961a790 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,455 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 111 -> 71
2022-07-26 18:24:58,456 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,457 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#80-t2,previous=(t:1, i:70),leaderCommit=109,initializing? true,entries: size=41, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,458 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c940ee9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,459 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 112 -> 71
2022-07-26 18:24:58,459 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 109, m52 -> (t:2, i:109), STATEMACHINELOGENTRY, 438@client-3DC40C5CE9E0
2022-07-26 18:24:58,460 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#81-t2,previous=(t:1, i:70),leaderCommit=109,initializing? true,entries: size=41, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,462 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@25a19ea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,467 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 112 -> 71
2022-07-26 18:24:58,467 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 111, m53 -> (t:2, i:111), STATEMACHINELOGENTRY, 439@client-3DC40C5CE9E0
2022-07-26 18:24:58,468 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,469 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#83-t2,previous=(t:1, i:70),leaderCommit=111,initializing? true,entries: size=42, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,470 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@28e44e8e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,471 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,475 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 113 -> 71
2022-07-26 18:24:58,476 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 111, m53 -> (t:2, i:111), STATEMACHINELOGENTRY, 439@client-3DC40C5CE9E0
2022-07-26 18:24:58,477 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#85-t2,previous=(t:1, i:70),leaderCommit=112,initializing? true,entries: size=43, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,478 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 113, m54 -> (t:2, i:113), STATEMACHINELOGENTRY, 440@client-3DC40C5CE9E0
2022-07-26 18:24:58,479 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47ff770f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,479 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 114 -> 71
2022-07-26 18:24:58,480 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,480 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,481 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#87-t2,previous=(t:1, i:70),leaderCommit=113,initializing? true,entries: size=45, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,482 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@de8ed49 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,483 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 116 -> 71
2022-07-26 18:24:58,489 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 113, m54 -> (t:2, i:113), STATEMACHINELOGENTRY, 440@client-3DC40C5CE9E0
2022-07-26 18:24:58,490 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#88-t2,previous=(t:1, i:70),leaderCommit=113,initializing? true,entries: size=45, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,491 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b485c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,492 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 116 -> 71
2022-07-26 18:24:58,496 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 115, m55 -> (t:2, i:115), STATEMACHINELOGENTRY, 441@client-3DC40C5CE9E0
2022-07-26 18:24:58,497 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,497 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#90-t2,previous=(t:1, i:70),leaderCommit=115,initializing? true,entries: size=46, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,499 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d64823 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,499 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 117 -> 71
2022-07-26 18:24:58,500 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#91-t2,previous=(t:1, i:70),leaderCommit=115,initializing? true,entries: size=47, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,501 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,502 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ce661df rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,502 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 118 -> 71
2022-07-26 18:24:58,503 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 115, m55 -> (t:2, i:115), STATEMACHINELOGENTRY, 441@client-3DC40C5CE9E0
2022-07-26 18:24:58,504 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 117, m56 -> (t:2, i:117), STATEMACHINELOGENTRY, 442@client-3DC40C5CE9E0
2022-07-26 18:24:58,504 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,504 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#92-t2,previous=(t:1, i:70),leaderCommit=115,initializing? true,entries: size=47, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,505 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 117, m56 -> (t:2, i:117), STATEMACHINELOGENTRY, 442@client-3DC40C5CE9E0
2022-07-26 18:24:58,506 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b486f43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,507 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 118 -> 71
2022-07-26 18:24:58,507 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#94-t2,previous=(t:1, i:70),leaderCommit=117,initializing? true,entries: size=48, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,508 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,509 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@a8c0a16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,509 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 119 -> 71
2022-07-26 18:24:58,511 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 119, m57 -> (t:2, i:119), STATEMACHINELOGENTRY, 443@client-3DC40C5CE9E0
2022-07-26 18:24:58,511 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#96-t2,previous=(t:1, i:70),leaderCommit=118,initializing? true,entries: size=49, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,512 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,513 [grpc-default-executor-9] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4fd3e436 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,513 [grpc-default-executor-9] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 120 -> 71
2022-07-26 18:24:58,514 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,515 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#98-t2,previous=(t:1, i:70),leaderCommit=119,initializing? true,entries: size=51, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,516 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 119, m57 -> (t:2, i:119), STATEMACHINELOGENTRY, 443@client-3DC40C5CE9E0
2022-07-26 18:24:58,516 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15190e3b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,516 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 122 -> 71
2022-07-26 18:24:58,517 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#99-t2,previous=(t:1, i:70),leaderCommit=120,initializing? true,entries: size=51, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,518 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43ef6d01 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,519 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 122 -> 71
2022-07-26 18:24:58,523 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 121, m58 -> (t:2, i:121), STATEMACHINELOGENTRY, 444@client-3DC40C5CE9E0
2022-07-26 18:24:58,523 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,524 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#100-t2,previous=(t:1, i:70),leaderCommit=121,initializing? true,entries: size=52, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,526 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3b2ce44e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,526 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 123 -> 71
2022-07-26 18:24:58,527 [s1-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-94_122 to index:122
2022-07-26 18:24:58,527 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_94-122
2022-07-26 18:24:58,527 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_94-122
2022-07-26 18:24:58,528 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,528 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-94_122 to index:122
2022-07-26 18:24:58,528 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#101-t2,previous=(t:1, i:70),leaderCommit=121,initializing? true,entries: size=53, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,529 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123
2022-07-26 18:24:58,530 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c6e41ea rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,530 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 124 -> 71
2022-07-26 18:24:58,531 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_94-122
2022-07-26 18:24:58,531 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_94 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_94-122
2022-07-26 18:24:58,531 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 121, m58 -> (t:2, i:121), STATEMACHINELOGENTRY, 444@client-3DC40C5CE9E0
2022-07-26 18:24:58,532 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123
2022-07-26 18:24:58,532 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#102-t2,previous=(t:1, i:70),leaderCommit=122,initializing? true,entries: size=53, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,534 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1840b66c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,534 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 124 -> 71
2022-07-26 18:24:58,539 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 123, m59 -> (t:2, i:123), STATEMACHINELOGENTRY, 445@client-3DC40C5CE9E0
2022-07-26 18:24:58,539 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,541 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#103-t2,previous=(t:1, i:70),leaderCommit=123,initializing? true,entries: size=54, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,543 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2969fbab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,543 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,544 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 125 -> 71
2022-07-26 18:24:58,547 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 123, m59 -> (t:2, i:123), STATEMACHINELOGENTRY, 445@client-3DC40C5CE9E0
2022-07-26 18:24:58,548 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#105-t2,previous=(t:1, i:70),leaderCommit=123,initializing? true,entries: size=55, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,549 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 125, m60 -> (t:2, i:125), STATEMACHINELOGENTRY, 446@client-3DC40C5CE9E0
2022-07-26 18:24:58,549 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4f12820f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,550 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 126 -> 71
2022-07-26 18:24:58,550 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,551 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,552 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#108-t2,previous=(t:1, i:70),leaderCommit=125,initializing? true,entries: size=57, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,553 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 125, m60 -> (t:2, i:125), STATEMACHINELOGENTRY, 446@client-3DC40C5CE9E0
2022-07-26 18:24:58,553 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ec37734 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,554 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 128 -> 71
2022-07-26 18:24:58,554 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#109-t2,previous=(t:1, i:70),leaderCommit=125,initializing? true,entries: size=57, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,555 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 127, m61 -> (t:2, i:127), STATEMACHINELOGENTRY, 447@client-3DC40C5CE9E0
2022-07-26 18:24:58,556 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54b2b547 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,557 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 128 -> 71
2022-07-26 18:24:58,555 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,559 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#112-t2,previous=(t:1, i:70),leaderCommit=127,initializing? true,entries: size=59, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,559 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,561 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@750e2e3f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,561 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 130 -> 71
2022-07-26 18:24:58,561 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 127, m61 -> (t:2, i:127), STATEMACHINELOGENTRY, 447@client-3DC40C5CE9E0
2022-07-26 18:24:58,567 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#113-t2,previous=(t:1, i:70),leaderCommit=127,initializing? true,entries: size=59, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,568 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@232fb44b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,569 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 130 -> 71
2022-07-26 18:24:58,568 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,575 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#116-t2,previous=(t:1, i:70),leaderCommit=129,initializing? true,entries: size=60, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,579 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6de23ff8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,579 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 131 -> 71
2022-07-26 18:24:58,580 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s0@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 127
2022-07-26 18:24:58,580 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s0@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 63 -> 127
2022-07-26 18:24:58,581 [s0@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s0@group-2923AB502154-SegmentedRaftLog: purge 68
2022-07-26 18:24:58,581 [s0@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s0@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly 63 -> 127
2022-07-26 18:24:58,581 [s0@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:null
2022-07-26 18:24:58,581 [s0@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s0@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=68, updated? true
2022-07-26 18:24:58,581 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 129, m62 -> (t:2, i:129), STATEMACHINELOGENTRY, 448@client-3DC40C5CE9E0
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s1@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 127
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s1@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 63 -> 127
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s1@group-2923AB502154-SegmentedRaftLog: purge 68
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly 63 -> 127
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:null
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=68, updated? true
2022-07-26 18:24:58,581 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 129, m62 -> (t:2, i:129), STATEMACHINELOGENTRY, 448@client-3DC40C5CE9E0
2022-07-26 18:24:58,583 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,583 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#118-t2,previous=(t:1, i:70),leaderCommit=130,initializing? true,entries: size=61, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,585 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2a6be037 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,585 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 132 -> 71
2022-07-26 18:24:58,587 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 131, m63 -> (t:2, i:131), STATEMACHINELOGENTRY, 449@client-3DC40C5CE9E0
2022-07-26 18:24:58,588 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,588 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#119-t2,previous=(t:1, i:70),leaderCommit=131,initializing? true,entries: size=61, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,591 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a143302 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,591 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 132 -> 71
2022-07-26 18:24:58,592 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 131, m63 -> (t:2, i:131), STATEMACHINELOGENTRY, 449@client-3DC40C5CE9E0
2022-07-26 18:24:58,593 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,593 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#120-t2,previous=(t:1, i:70),leaderCommit=131,initializing? true,entries: size=63, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,595 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4694adc6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,596 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 134 -> 71
2022-07-26 18:24:58,599 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 133, m64 -> (t:2, i:133), STATEMACHINELOGENTRY, 450@client-3DC40C5CE9E0
2022-07-26 18:24:58,600 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,601 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#123-t2,previous=(t:1, i:70),leaderCommit=133,initializing? true,entries: size=64, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,602 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,603 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@477a35c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,604 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 135 -> 71
2022-07-26 18:24:58,607 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 133, m64 -> (t:2, i:133), STATEMACHINELOGENTRY, 450@client-3DC40C5CE9E0
2022-07-26 18:24:58,608 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#125-t2,previous=(t:1, i:70),leaderCommit=134,initializing? true,entries: size=65, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,610 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@32c94085 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,610 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 136 -> 71
2022-07-26 18:24:58,615 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 135, m65 -> (t:2, i:135), STATEMACHINELOGENTRY, 451@client-3DC40C5CE9E0
2022-07-26 18:24:58,616 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,616 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#126-t2,previous=(t:1, i:70),leaderCommit=135,initializing? true,entries: size=66, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,618 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22c49115 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,618 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 137 -> 71
2022-07-26 18:24:58,619 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,620 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#127-t2,previous=(t:1, i:70),leaderCommit=135,initializing? true,entries: size=67, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,622 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 135, m65 -> (t:2, i:135), STATEMACHINELOGENTRY, 451@client-3DC40C5CE9E0
2022-07-26 18:24:58,622 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@12dd88ad rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,622 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 138 -> 71
2022-07-26 18:24:58,623 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 137, m66 -> (t:2, i:137), STATEMACHINELOGENTRY, 452@client-3DC40C5CE9E0
2022-07-26 18:24:58,623 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#128-t2,previous=(t:1, i:70),leaderCommit=136,initializing? true,entries: size=67, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,624 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,624 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@498dcee1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,625 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 138 -> 71
2022-07-26 18:24:58,625 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 137, m66 -> (t:2, i:137), STATEMACHINELOGENTRY, 452@client-3DC40C5CE9E0
2022-07-26 18:24:58,626 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,627 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#130-t2,previous=(t:1, i:70),leaderCommit=137,initializing? true,entries: size=69, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,628 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@63d80489 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,628 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 140 -> 71
2022-07-26 18:24:58,630 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 139, m67 -> (t:2, i:139), STATEMACHINELOGENTRY, 453@client-3DC40C5CE9E0
2022-07-26 18:24:58,632 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,633 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#133-t2,previous=(t:1, i:70),leaderCommit=139,initializing? true,entries: size=70, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,634 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,635 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57094ce2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,635 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 141 -> 71
2022-07-26 18:24:58,637 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 139, m67 -> (t:2, i:139), STATEMACHINELOGENTRY, 453@client-3DC40C5CE9E0
2022-07-26 18:24:58,638 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 141, m68 -> (t:2, i:141), STATEMACHINELOGENTRY, 454@client-3DC40C5CE9E0
2022-07-26 18:24:58,639 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,640 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#135-t2,previous=(t:1, i:70),leaderCommit=141,initializing? true,entries: size=71, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,640 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 141, m68 -> (t:2, i:141), STATEMACHINELOGENTRY, 454@client-3DC40C5CE9E0
2022-07-26 18:24:58,641 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,641 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52b82189 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,642 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 142 -> 71
2022-07-26 18:24:58,642 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#138-t2,previous=(t:1, i:70),leaderCommit=142,initializing? true,entries: size=73, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,644 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 143, m69 -> (t:2, i:143), STATEMACHINELOGENTRY, 455@client-3DC40C5CE9E0
2022-07-26 18:24:58,644 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,645 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@399b54d9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,645 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 144 -> 71
2022-07-26 18:24:58,646 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 143, m69 -> (t:2, i:143), STATEMACHINELOGENTRY, 455@client-3DC40C5CE9E0
2022-07-26 18:24:58,647 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,647 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#140-t2,previous=(t:1, i:70),leaderCommit=143,initializing? true,entries: size=75, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,648 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 145, m70 -> (t:2, i:145), STATEMACHINELOGENTRY, 456@client-3DC40C5CE9E0
2022-07-26 18:24:58,648 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,649 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@31d963ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,649 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 146 -> 71
2022-07-26 18:24:58,651 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 145, m70 -> (t:2, i:145), STATEMACHINELOGENTRY, 456@client-3DC40C5CE9E0
2022-07-26 18:24:58,651 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#143-t2,previous=(t:1, i:70),leaderCommit=145,initializing? true,entries: size=77, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,652 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,652 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3fff3119 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,653 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 148 -> 71
2022-07-26 18:24:58,655 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 147, m71 -> (t:2, i:147), STATEMACHINELOGENTRY, 457@client-3DC40C5CE9E0
2022-07-26 18:24:58,655 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#144-t2,previous=(t:1, i:70),leaderCommit=145,initializing? true,entries: size=77, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,656 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,656 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36065be rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,657 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 148 -> 71
2022-07-26 18:24:58,658 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,658 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#147-t2,previous=(t:1, i:70),leaderCommit=147,initializing? true,entries: size=79, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,659 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 147, m71 -> (t:2, i:147), STATEMACHINELOGENTRY, 457@client-3DC40C5CE9E0
2022-07-26 18:24:58,659 [s1@group-2923AB502154-LeaderStateImpl] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-123_149 to index:149
2022-07-26 18:24:58,660 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 149, m72 -> (t:2, i:149), STATEMACHINELOGENTRY, 458@client-3DC40C5CE9E0
2022-07-26 18:24:58,660 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_123-149
2022-07-26 18:24:58,660 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_123-149
2022-07-26 18:24:58,660 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@36c99b20 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,661 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 150 -> 71
2022-07-26 18:24:58,661 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,661 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-123_149 to index:149
2022-07-26 18:24:58,661 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150
2022-07-26 18:24:58,661 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_123-149
2022-07-26 18:24:58,661 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_123 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_123-149
2022-07-26 18:24:58,662 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150
2022-07-26 18:24:58,662 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,663 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#151-t2,previous=(t:1, i:70),leaderCommit=149,initializing? true,entries: size=81, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,664 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 149, m72 -> (t:2, i:149), STATEMACHINELOGENTRY, 458@client-3DC40C5CE9E0
2022-07-26 18:24:58,664 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@51dc8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,665 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 152 -> 71
2022-07-26 18:24:58,666 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#152-t2,previous=(t:1, i:70),leaderCommit=149,initializing? true,entries: size=81, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,667 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@796e3367 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,667 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 152 -> 71
2022-07-26 18:24:58,668 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 151, m73 -> (t:2, i:151), STATEMACHINELOGENTRY, 459@client-3DC40C5CE9E0
2022-07-26 18:24:58,668 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,669 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#154-t2,previous=(t:1, i:70),leaderCommit=151,initializing? true,entries: size=82, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,670 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@67bd8580 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,670 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 153 -> 71
2022-07-26 18:24:58,671 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,671 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#155-t2,previous=(t:1, i:70),leaderCommit=151,initializing? true,entries: size=83, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,672 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@54d319c2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,672 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 154 -> 71
2022-07-26 18:24:58,675 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 151, m73 -> (t:2, i:151), STATEMACHINELOGENTRY, 459@client-3DC40C5CE9E0
2022-07-26 18:24:58,676 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#156-t2,previous=(t:1, i:70),leaderCommit=151,initializing? true,entries: size=83, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,677 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72912305 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,677 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 154 -> 71
2022-07-26 18:24:58,683 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 153, m74 -> (t:2, i:153), STATEMACHINELOGENTRY, 460@client-3DC40C5CE9E0
2022-07-26 18:24:58,684 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,684 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#158-t2,previous=(t:1, i:70),leaderCommit=153,initializing? true,entries: size=84, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,685 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,687 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3e16dcd2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,687 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 155 -> 71
2022-07-26 18:24:58,688 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 153, m74 -> (t:2, i:153), STATEMACHINELOGENTRY, 460@client-3DC40C5CE9E0
2022-07-26 18:24:58,688 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#160-t2,previous=(t:1, i:70),leaderCommit=153,initializing? true,entries: size=85, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,689 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4832f3de rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,690 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 156 -> 71
2022-07-26 18:24:58,690 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 155, m75 -> (t:2, i:155), STATEMACHINELOGENTRY, 461@client-3DC40C5CE9E0
2022-07-26 18:24:58,691 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,692 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#162-t2,previous=(t:1, i:70),leaderCommit=155,initializing? true,entries: size=86, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,694 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@53f374a9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,694 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 157 -> 71
2022-07-26 18:24:58,695 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,695 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#163-t2,previous=(t:1, i:70),leaderCommit=155,initializing? true,entries: size=87, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,696 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 155, m75 -> (t:2, i:155), STATEMACHINELOGENTRY, 461@client-3DC40C5CE9E0
2022-07-26 18:24:58,697 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4133a548 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,697 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 158 -> 71
2022-07-26 18:24:58,698 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#164-t2,previous=(t:1, i:70),leaderCommit=156,initializing? true,entries: size=87, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,700 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 157, m76 -> (t:2, i:157), STATEMACHINELOGENTRY, 462@client-3DC40C5CE9E0
2022-07-26 18:24:58,700 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,701 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,702 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76dba0dd rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,702 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 158 -> 71
2022-07-26 18:24:58,703 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 157, m76 -> (t:2, i:157), STATEMACHINELOGENTRY, 462@client-3DC40C5CE9E0
2022-07-26 18:24:58,706 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#167-t2,previous=(t:1, i:70),leaderCommit=157,initializing? true,entries: size=89, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,707 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52da509f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,707 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 160 -> 71
2022-07-26 18:24:58,707 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 159, m77 -> (t:2, i:159), STATEMACHINELOGENTRY, 463@client-3DC40C5CE9E0
2022-07-26 18:24:58,708 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,708 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#169-t2,previous=(t:1, i:70),leaderCommit=159,initializing? true,entries: size=90, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,711 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@339e2f2e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,711 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 161 -> 71
2022-07-26 18:24:58,711 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,712 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 159, m77 -> (t:2, i:159), STATEMACHINELOGENTRY, 463@client-3DC40C5CE9E0
2022-07-26 18:24:58,715 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#171-t2,previous=(t:1, i:70),leaderCommit=160,initializing? true,entries: size=91, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,717 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5673a9e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,717 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 162 -> 71
2022-07-26 18:24:58,719 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 161, m78 -> (t:2, i:161), STATEMACHINELOGENTRY, 464@client-3DC40C5CE9E0
2022-07-26 18:24:58,719 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,720 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#172-t2,previous=(t:1, i:70),leaderCommit=161,initializing? true,entries: size=92, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,720 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 161, m78 -> (t:2, i:161), STATEMACHINELOGENTRY, 464@client-3DC40C5CE9E0
2022-07-26 18:24:58,723 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@79f60ccc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,723 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 163 -> 71
2022-07-26 18:24:58,724 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,725 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#174-t2,previous=(t:1, i:70),leaderCommit=162,initializing? true,entries: size=93, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,726 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 163, m79 -> (t:2, i:163), STATEMACHINELOGENTRY, 465@client-3DC40C5CE9E0
2022-07-26 18:24:58,726 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27cea5b3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,726 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 164 -> 71
2022-07-26 18:24:58,726 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,727 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 163, m79 -> (t:2, i:163), STATEMACHINELOGENTRY, 465@client-3DC40C5CE9E0
2022-07-26 18:24:58,728 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,728 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#177-t2,previous=(t:1, i:70),leaderCommit=163,initializing? true,entries: size=95, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,729 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c41f2ff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,730 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 166 -> 71
2022-07-26 18:24:58,730 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 165, m80 -> (t:2, i:165), STATEMACHINELOGENTRY, 466@client-3DC40C5CE9E0
2022-07-26 18:24:58,730 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,731 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#179-t2,previous=(t:1, i:70),leaderCommit=165,initializing? true,entries: size=96, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,732 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14225259 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,732 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 167 -> 71
2022-07-26 18:24:58,733 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 165, m80 -> (t:2, i:165), STATEMACHINELOGENTRY, 466@client-3DC40C5CE9E0
2022-07-26 18:24:58,734 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,734 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#180-t2,previous=(t:1, i:70),leaderCommit=165,initializing? true,entries: size=97, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,736 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@d055e43 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,736 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 168 -> 71
2022-07-26 18:24:58,736 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 167, m81 -> (t:2, i:167), STATEMACHINELOGENTRY, 467@client-3DC40C5CE9E0
2022-07-26 18:24:58,737 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,737 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#182-t2,previous=(t:1, i:70),leaderCommit=167,initializing? true,entries: size=98, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,738 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 167, m81 -> (t:2, i:167), STATEMACHINELOGENTRY, 467@client-3DC40C5CE9E0
2022-07-26 18:24:58,739 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@60456f60 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,739 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 169 -> 71
2022-07-26 18:24:58,741 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,741 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#183-t2,previous=(t:1, i:70),leaderCommit=168,initializing? true,entries: size=98, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,742 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6a116f40 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,743 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 169 -> 71
2022-07-26 18:24:58,747 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 169, m82 -> (t:2, i:169), STATEMACHINELOGENTRY, 468@client-3DC40C5CE9E0
2022-07-26 18:24:58,748 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#184-t2,previous=(t:1, i:70),leaderCommit=168,initializing? true,entries: size=99, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,748 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,749 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@116e7959 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,749 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 170 -> 71
2022-07-26 18:24:58,750 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,750 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#186-t2,previous=(t:1, i:70),leaderCommit=169,initializing? true,entries: size=101, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,751 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@71cbae0b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,751 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 172 -> 71
2022-07-26 18:24:58,755 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 169, m82 -> (t:2, i:169), STATEMACHINELOGENTRY, 468@client-3DC40C5CE9E0
2022-07-26 18:24:58,756 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#187-t2,previous=(t:1, i:70),leaderCommit=169,initializing? true,entries: size=101, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,757 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@16fdd52f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,757 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 172 -> 71
2022-07-26 18:24:58,758 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 171, m83 -> (t:2, i:171), STATEMACHINELOGENTRY, 469@client-3DC40C5CE9E0
2022-07-26 18:24:58,759 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,759 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#189-t2,previous=(t:1, i:70),leaderCommit=171,initializing? true,entries: size=102, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,763 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e40f82b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,763 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 173 -> 71
2022-07-26 18:24:58,766 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,769 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 171, m83 -> (t:2, i:171), STATEMACHINELOGENTRY, 469@client-3DC40C5CE9E0
2022-07-26 18:24:58,770 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#191-t2,previous=(t:1, i:70),leaderCommit=172,initializing? true,entries: size=103, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,771 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@47fe0a93 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,771 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 174 -> 71
2022-07-26 18:24:58,775 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 173, m84 -> (t:2, i:173), STATEMACHINELOGENTRY, 470@client-3DC40C5CE9E0
2022-07-26 18:24:58,776 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,776 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#192-t2,previous=(t:1, i:70),leaderCommit=173,initializing? true,entries: size=104, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,777 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a13103 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,778 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 175 -> 71
2022-07-26 18:24:58,779 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,779 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#193-t2,previous=(t:1, i:70),leaderCommit=173,initializing? true,entries: size=105, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,780 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1212ac23 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,780 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 176 -> 71
2022-07-26 18:24:58,782 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 173, m84 -> (t:2, i:173), STATEMACHINELOGENTRY, 470@client-3DC40C5CE9E0
2022-07-26 18:24:58,783 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#194-t2,previous=(t:1, i:70),leaderCommit=173,initializing? true,entries: size=105, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,785 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c551d06 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,785 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 176 -> 71
2022-07-26 18:24:58,787 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 175, m85 -> (t:2, i:175), STATEMACHINELOGENTRY, 471@client-3DC40C5CE9E0
2022-07-26 18:24:58,787 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,788 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#196-t2,previous=(t:1, i:70),leaderCommit=175,initializing? true,entries: size=106, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,789 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@37ecfa53 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,789 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 177 -> 71
2022-07-26 18:24:58,789 [s1-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-150_176 to index:176
2022-07-26 18:24:58,790 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_150-176
2022-07-26 18:24:58,790 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_150-176
2022-07-26 18:24:58,790 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,790 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-150_176 to index:176
2022-07-26 18:24:58,790 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#197-t2,previous=(t:1, i:70),leaderCommit=175,initializing? true,entries: size=107, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,791 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177
2022-07-26 18:24:58,792 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7a8f027b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,792 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 178 -> 71
2022-07-26 18:24:58,793 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_150-176
2022-07-26 18:24:58,793 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_150 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_150-176
2022-07-26 18:24:58,793 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 175, m85 -> (t:2, i:175), STATEMACHINELOGENTRY, 471@client-3DC40C5CE9E0
2022-07-26 18:24:58,794 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#198-t2,previous=(t:1, i:70),leaderCommit=175,initializing? true,entries: size=107, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,794 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177
2022-07-26 18:24:58,795 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@22343712 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,795 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 178 -> 71
2022-07-26 18:24:58,799 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 177, m86 -> (t:2, i:177), STATEMACHINELOGENTRY, 472@client-3DC40C5CE9E0
2022-07-26 18:24:58,799 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,800 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#200-t2,previous=(t:1, i:70),leaderCommit=177,initializing? true,entries: size=108, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,801 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,802 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c51956e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,802 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 179 -> 71
2022-07-26 18:24:58,806 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 177, m86 -> (t:2, i:177), STATEMACHINELOGENTRY, 472@client-3DC40C5CE9E0
2022-07-26 18:24:58,807 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#202-t2,previous=(t:1, i:70),leaderCommit=178,initializing? true,entries: size=109, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,809 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@619153fc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,809 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 180 -> 71
2022-07-26 18:24:58,811 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 179, m87 -> (t:2, i:179), STATEMACHINELOGENTRY, 473@client-3DC40C5CE9E0
2022-07-26 18:24:58,811 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,812 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#203-t2,previous=(t:1, i:70),leaderCommit=179,initializing? true,entries: size=110, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,813 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3972ab77 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,813 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 181 -> 71
2022-07-26 18:24:58,814 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,814 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#204-t2,previous=(t:1, i:70),leaderCommit=179,initializing? true,entries: size=111, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,816 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2124e2eb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,816 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 182 -> 71
2022-07-26 18:24:58,817 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 179, m87 -> (t:2, i:179), STATEMACHINELOGENTRY, 473@client-3DC40C5CE9E0
2022-07-26 18:24:58,823 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 181, m88 -> (t:2, i:181), STATEMACHINELOGENTRY, 474@client-3DC40C5CE9E0
2022-07-26 18:24:58,823 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,824 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 181, m88 -> (t:2, i:181), STATEMACHINELOGENTRY, 474@client-3DC40C5CE9E0
2022-07-26 18:24:58,824 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#205-t2,previous=(t:1, i:70),leaderCommit=181,initializing? true,entries: size=112, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,826 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@66fa6c2a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,826 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 183 -> 71
2022-07-26 18:24:58,827 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,827 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#207-t2,previous=(t:1, i:70),leaderCommit=182,initializing? true,entries: size=112, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,828 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@916d68b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,829 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 183 -> 71
2022-07-26 18:24:58,831 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 183, m89 -> (t:2, i:183), STATEMACHINELOGENTRY, 475@client-3DC40C5CE9E0
2022-07-26 18:24:58,832 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,832 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#209-t2,previous=(t:1, i:70),leaderCommit=183,initializing? true,entries: size=113, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,833 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,833 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@29da6c52 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,834 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 184 -> 71
2022-07-26 18:24:58,834 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#210-t2,previous=(t:1, i:70),leaderCommit=183,initializing? true,entries: size=115, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,835 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f167c12 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,836 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 186 -> 71
2022-07-26 18:24:58,838 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 183, m89 -> (t:2, i:183), STATEMACHINELOGENTRY, 475@client-3DC40C5CE9E0
2022-07-26 18:24:58,840 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#211-t2,previous=(t:1, i:70),leaderCommit=184,initializing? true,entries: size=115, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,841 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@ef8b938 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,841 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 186 -> 71
2022-07-26 18:24:58,842 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 185, m90 -> (t:2, i:185), STATEMACHINELOGENTRY, 476@client-3DC40C5CE9E0
2022-07-26 18:24:58,842 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,843 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#212-t2,previous=(t:1, i:70),leaderCommit=185,initializing? true,entries: size=116, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,844 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75a314e1 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,844 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 187 -> 71
2022-07-26 18:24:58,845 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,846 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#213-t2,previous=(t:1, i:70),leaderCommit=185,initializing? true,entries: size=117, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,847 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@256c997 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,847 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 188 -> 71
2022-07-26 18:24:58,849 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 185, m90 -> (t:2, i:185), STATEMACHINELOGENTRY, 476@client-3DC40C5CE9E0
2022-07-26 18:24:58,851 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 187, m91 -> (t:2, i:187), STATEMACHINELOGENTRY, 477@client-3DC40C5CE9E0
2022-07-26 18:24:58,852 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,852 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#214-t2,previous=(t:1, i:70),leaderCommit=187,initializing? true,entries: size=117, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,854 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@337272d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,854 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 188 -> 71
2022-07-26 18:24:58,855 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,855 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#215-t2,previous=(t:1, i:70),leaderCommit=187,initializing? true,entries: size=119, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,856 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ae7090b rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,856 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 190 -> 71
2022-07-26 18:24:58,858 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 187, m91 -> (t:2, i:187), STATEMACHINELOGENTRY, 477@client-3DC40C5CE9E0
2022-07-26 18:24:58,860 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#216-t2,previous=(t:1, i:70),leaderCommit=188,initializing? true,entries: size=119, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,861 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5e0c4e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,861 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 190 -> 71
2022-07-26 18:24:58,863 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 189, m92 -> (t:2, i:189), STATEMACHINELOGENTRY, 478@client-3DC40C5CE9E0
2022-07-26 18:24:58,864 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,865 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#217-t2,previous=(t:1, i:70),leaderCommit=189,initializing? true,entries: size=120, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,866 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,866 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@64d9cfff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,866 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 191 -> 71
2022-07-26 18:24:58,871 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 189, m92 -> (t:2, i:189), STATEMACHINELOGENTRY, 478@client-3DC40C5CE9E0
2022-07-26 18:24:58,872 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 191, m93 -> (t:2, i:191), STATEMACHINELOGENTRY, 479@client-3DC40C5CE9E0
2022-07-26 18:24:58,872 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#220-t2,previous=(t:1, i:70),leaderCommit=190,initializing? true,entries: size=121, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,874 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2409f662 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,875 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 192 -> 71
2022-07-26 18:24:58,875 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,876 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,877 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#221-t2,previous=(t:1, i:70),leaderCommit=191,initializing? true,entries: size=122, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,878 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5a9e6af7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,878 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 193 -> 71
2022-07-26 18:24:58,879 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 191, m93 -> (t:2, i:191), STATEMACHINELOGENTRY, 479@client-3DC40C5CE9E0
2022-07-26 18:24:58,884 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#223-t2,previous=(t:1, i:70),leaderCommit=192,initializing? true,entries: size=123, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,886 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@52dd15e9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,886 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 194 -> 71
2022-07-26 18:24:58,888 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,889 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#224-t2,previous=(t:1, i:70),leaderCommit=193,initializing? true,entries: size=124, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,891 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@43f4a7e3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,891 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 195 -> 71
2022-07-26 18:24:58,894 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s1@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 191
2022-07-26 18:24:58,894 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s1@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 127 -> 191
2022-07-26 18:24:58,894 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 193, m94 -> (t:2, i:193), STATEMACHINELOGENTRY, 480@client-3DC40C5CE9E0
2022-07-26 18:24:58,896 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,896 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#225-t2,previous=(t:1, i:70),leaderCommit=193,initializing? true,entries: size=125, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,898 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@26c76c5e rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,898 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 196 -> 71
2022-07-26 18:24:58,899 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s0@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 191
2022-07-26 18:24:58,899 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s0@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 127 -> 191
2022-07-26 18:24:58,899 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 193, m94 -> (t:2, i:193), STATEMACHINELOGENTRY, 480@client-3DC40C5CE9E0
2022-07-26 18:24:58,903 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 195, m95 -> (t:2, i:195), STATEMACHINELOGENTRY, 481@client-3DC40C5CE9E0
2022-07-26 18:24:58,904 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,906 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#227-t2,previous=(t:1, i:70),leaderCommit=195,initializing? true,entries: size=126, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,909 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,909 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@8e4d226 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,910 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 197 -> 71
2022-07-26 18:24:58,911 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 195, m95 -> (t:2, i:195), STATEMACHINELOGENTRY, 481@client-3DC40C5CE9E0
2022-07-26 18:24:58,912 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#229-t2,previous=(t:1, i:70),leaderCommit=195,initializing? true,entries: size=127, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,912 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 197, m96 -> (t:2, i:197), STATEMACHINELOGENTRY, 482@client-3DC40C5CE9E0
2022-07-26 18:24:58,917 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@61d29fa7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,917 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 198 -> 71
2022-07-26 18:24:58,917 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,918 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,920 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#232-t2,previous=(t:1, i:70),leaderCommit=197,initializing? true,entries: size=129, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,921 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@72bc9304 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,921 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 200 -> 71
2022-07-26 18:24:58,923 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 197, m96 -> (t:2, i:197), STATEMACHINELOGENTRY, 482@client-3DC40C5CE9E0
2022-07-26 18:24:58,924 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#233-t2,previous=(t:1, i:70),leaderCommit=198,initializing? true,entries: size=129, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,925 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27af8299 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,925 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 200 -> 71
2022-07-26 18:24:58,927 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 199, m97 -> (t:2, i:199), STATEMACHINELOGENTRY, 483@client-3DC40C5CE9E0
2022-07-26 18:24:58,928 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,928 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#234-t2,previous=(t:1, i:70),leaderCommit=199,initializing? true,entries: size=130, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,929 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@342d6d36 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,930 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 201 -> 71
2022-07-26 18:24:58,930 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,935 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 199, m97 -> (t:2, i:199), STATEMACHINELOGENTRY, 483@client-3DC40C5CE9E0
2022-07-26 18:24:58,936 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 201, m98 -> (t:2, i:201), STATEMACHINELOGENTRY, 484@client-3DC40C5CE9E0
2022-07-26 18:24:58,936 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,936 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#236-t2,previous=(t:1, i:70),leaderCommit=200,initializing? true,entries: size=131, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,937 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57dbf0f4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,938 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 202 -> 71
2022-07-26 18:24:58,938 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,939 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#238-t2,previous=(t:1, i:70),leaderCommit=201,initializing? true,entries: size=133, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,940 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3584a390 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,940 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 204 -> 71
2022-07-26 18:24:58,942 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 201, m98 -> (t:2, i:201), STATEMACHINELOGENTRY, 484@client-3DC40C5CE9E0
2022-07-26 18:24:58,942 [s1@group-2923AB502154-LeaderStateImpl] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-177_203 to index:203
2022-07-26 18:24:58,943 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 203, m99 -> (t:2, i:203), STATEMACHINELOGENTRY, 485@client-3DC40C5CE9E0
2022-07-26 18:24:58,943 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_177-203
2022-07-26 18:24:58,943 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_177-203
2022-07-26 18:24:58,944 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#239-t2,previous=(t:1, i:70),leaderCommit=201,initializing? true,entries: size=133, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,944 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,944 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-177_203 to index:203
2022-07-26 18:24:58,945 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_177-203
2022-07-26 18:24:58,945 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_177 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_177-203
2022-07-26 18:24:58,945 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,945 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@581e1a7a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,946 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 204 -> 71
2022-07-26 18:24:58,946 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204
2022-07-26 18:24:58,947 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204
2022-07-26 18:24:58,947 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 203, m99 -> (t:2, i:203), STATEMACHINELOGENTRY, 485@client-3DC40C5CE9E0
2022-07-26 18:24:58,948 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#242-t2,previous=(t:1, i:70),leaderCommit=203,initializing? true,entries: size=135, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,949 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 205, m100 -> (t:2, i:205), STATEMACHINELOGENTRY, 486@client-3DC40C5CE9E0
2022-07-26 18:24:58,949 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2384aed4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,950 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 206 -> 71
2022-07-26 18:24:58,950 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,951 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,951 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 205, m100 -> (t:2, i:205), STATEMACHINELOGENTRY, 486@client-3DC40C5CE9E0
2022-07-26 18:24:58,951 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#244-t2,previous=(t:1, i:70),leaderCommit=205,initializing? true,entries: size=137, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,952 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d8f4d8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,952 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 208 -> 71
2022-07-26 18:24:58,953 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#245-t2,previous=(t:1, i:70),leaderCommit=205,initializing? true,entries: size=137, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,954 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27e6b9b2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,954 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 208 -> 71
2022-07-26 18:24:58,955 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 207, m101 -> (t:2, i:207), STATEMACHINELOGENTRY, 487@client-3DC40C5CE9E0
2022-07-26 18:24:58,956 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,956 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#247-t2,previous=(t:1, i:70),leaderCommit=207,initializing? true,entries: size=138, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,957 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 207, m101 -> (t:2, i:207), STATEMACHINELOGENTRY, 487@client-3DC40C5CE9E0
2022-07-26 18:24:58,957 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,958 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1ff20e16 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,958 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 209 -> 71
2022-07-26 18:24:58,959 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 209, m102 -> (t:2, i:209), STATEMACHINELOGENTRY, 488@client-3DC40C5CE9E0
2022-07-26 18:24:58,959 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,960 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#250-t2,previous=(t:1, i:70),leaderCommit=209,initializing? true,entries: size=140, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,960 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 209, m102 -> (t:2, i:209), STATEMACHINELOGENTRY, 488@client-3DC40C5CE9E0
2022-07-26 18:24:58,961 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@76365475 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,962 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 211 -> 71
2022-07-26 18:24:58,962 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,963 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#252-t2,previous=(t:1, i:70),leaderCommit=210,initializing? true,entries: size=141, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,964 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,964 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 211, m103 -> (t:2, i:211), STATEMACHINELOGENTRY, 489@client-3DC40C5CE9E0
2022-07-26 18:24:58,965 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@75e858e2 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,965 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 212 -> 71
2022-07-26 18:24:58,971 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 211, m103 -> (t:2, i:211), STATEMACHINELOGENTRY, 489@client-3DC40C5CE9E0
2022-07-26 18:24:58,972 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#254-t2,previous=(t:1, i:70),leaderCommit=211,initializing? true,entries: size=142, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,973 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3d499da0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,974 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 213 -> 71
2022-07-26 18:24:58,974 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,977 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 213, m104 -> (t:2, i:213), STATEMACHINELOGENTRY, 490@client-3DC40C5CE9E0
2022-07-26 18:24:58,977 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,978 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#257-t2,previous=(t:1, i:70),leaderCommit=213,initializing? true,entries: size=144, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,979 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c6c9fa4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,979 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 215 -> 71
2022-07-26 18:24:58,981 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,981 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#258-t2,previous=(t:1, i:70),leaderCommit=213,initializing? true,entries: size=145, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,982 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 213, m104 -> (t:2, i:213), STATEMACHINELOGENTRY, 490@client-3DC40C5CE9E0
2022-07-26 18:24:58,982 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@42e34d18 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,983 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 216 -> 71
2022-07-26 18:24:58,984 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#259-t2,previous=(t:1, i:70),leaderCommit=214,initializing? true,entries: size=145, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,986 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@792de5ca rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,986 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,986 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 215, m105 -> (t:2, i:215), STATEMACHINELOGENTRY, 491@client-3DC40C5CE9E0
2022-07-26 18:24:58,986 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 216 -> 71
2022-07-26 18:24:58,988 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 215, m105 -> (t:2, i:215), STATEMACHINELOGENTRY, 491@client-3DC40C5CE9E0
2022-07-26 18:24:58,989 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#261-t2,previous=(t:1, i:70),leaderCommit=216,initializing? true,entries: size=146, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,990 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@305686cf rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,990 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 217 -> 71
2022-07-26 18:24:58,991 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,992 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#263-t2,previous=(t:1, i:70),leaderCommit=216,initializing? true,entries: size=147, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,993 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 217, m106 -> (t:2, i:217), STATEMACHINELOGENTRY, 492@client-3DC40C5CE9E0
2022-07-26 18:24:58,994 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@57677f96 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,994 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 218 -> 71
2022-07-26 18:24:58,994 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,995 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 217, m106 -> (t:2, i:217), STATEMACHINELOGENTRY, 492@client-3DC40C5CE9E0
2022-07-26 18:24:58,996 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#264-t2,previous=(t:1, i:70),leaderCommit=217,initializing? true,entries: size=148, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:58,997 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:58,998 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@21ff9eab rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:58,998 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 219 -> 71
2022-07-26 18:24:59,003 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 219, m107 -> (t:2, i:219), STATEMACHINELOGENTRY, 493@client-3DC40C5CE9E0
2022-07-26 18:24:59,003 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#267-t2,previous=(t:1, i:70),leaderCommit=218,initializing? true,entries: size=149, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,004 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,005 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4928c16a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,006 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 220 -> 71
2022-07-26 18:24:59,007 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,007 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 219, m107 -> (t:2, i:219), STATEMACHINELOGENTRY, 493@client-3DC40C5CE9E0
2022-07-26 18:24:59,008 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#270-t2,previous=(t:1, i:70),leaderCommit=219,initializing? true,entries: size=151, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,009 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@426a3ad4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,009 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 222 -> 71
2022-07-26 18:24:59,011 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 221, m108 -> (t:2, i:221), STATEMACHINELOGENTRY, 494@client-3DC40C5CE9E0
2022-07-26 18:24:59,012 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,012 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#272-t2,previous=(t:1, i:70),leaderCommit=221,initializing? true,entries: size=152, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,013 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2937b0d4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,013 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 223 -> 71
2022-07-26 18:24:59,014 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,015 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#273-t2,previous=(t:1, i:70),leaderCommit=221,initializing? true,entries: size=153, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,016 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5449c827 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,016 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 224 -> 71
2022-07-26 18:24:59,019 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 221, m108 -> (t:2, i:221), STATEMACHINELOGENTRY, 494@client-3DC40C5CE9E0
2022-07-26 18:24:59,020 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#274-t2,previous=(t:1, i:70),leaderCommit=222,initializing? true,entries: size=153, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,034 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4a9dcb15 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,034 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 224 -> 71
2022-07-26 18:24:59,034 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 223, m109 -> (t:2, i:223), STATEMACHINELOGENTRY, 495@client-3DC40C5CE9E0
2022-07-26 18:24:59,035 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,036 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#275-t2,previous=(t:1, i:70),leaderCommit=223,initializing? true,entries: size=154, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,037 [grpc-default-executor-10] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@15a493bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,037 [grpc-default-executor-10] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 225 -> 71
2022-07-26 18:24:59,038 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#276-t2,previous=(t:1, i:70),leaderCommit=223,initializing? true,entries: size=155, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,039 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,039 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1b24c7c9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,040 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 226 -> 71
2022-07-26 18:24:59,040 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 223, m109 -> (t:2, i:223), STATEMACHINELOGENTRY, 495@client-3DC40C5CE9E0
2022-07-26 18:24:59,041 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#277-t2,previous=(t:1, i:70),leaderCommit=223,initializing? true,entries: size=155, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,042 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@55394344 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,042 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 226 -> 71
2022-07-26 18:24:59,044 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 225, m110 -> (t:2, i:225), STATEMACHINELOGENTRY, 496@client-3DC40C5CE9E0
2022-07-26 18:24:59,045 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,045 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#279-t2,previous=(t:1, i:70),leaderCommit=225,initializing? true,entries: size=156, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,046 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@68da4c7d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,047 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 227 -> 71
2022-07-26 18:24:59,048 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,048 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#280-t2,previous=(t:1, i:70),leaderCommit=225,initializing? true,entries: size=157, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,049 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2e3d2442 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,049 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 228 -> 71
2022-07-26 18:24:59,051 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 225, m110 -> (t:2, i:225), STATEMACHINELOGENTRY, 496@client-3DC40C5CE9E0
2022-07-26 18:24:59,052 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#281-t2,previous=(t:1, i:70),leaderCommit=225,initializing? true,entries: size=157, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,053 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1aa905 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,053 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 228 -> 71
2022-07-26 18:24:59,053 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 227, m111 -> (t:2, i:227), STATEMACHINELOGENTRY, 497@client-3DC40C5CE9E0
2022-07-26 18:24:59,054 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,055 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#283-t2,previous=(t:1, i:70),leaderCommit=227,initializing? true,entries: size=158, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,056 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2548ba1c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,056 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 229 -> 71
2022-07-26 18:24:59,056 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,059 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 227, m111 -> (t:2, i:227), STATEMACHINELOGENTRY, 497@client-3DC40C5CE9E0
2022-07-26 18:24:59,060 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#285-t2,previous=(t:1, i:70),leaderCommit=228,initializing? true,entries: size=159, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,061 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c2eb23f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,061 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 230 -> 71
2022-07-26 18:24:59,063 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 229, m112 -> (t:2, i:229), STATEMACHINELOGENTRY, 498@client-3DC40C5CE9E0
2022-07-26 18:24:59,063 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,064 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#286-t2,previous=(t:1, i:70),leaderCommit=229,initializing? true,entries: size=160, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,065 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3399e376 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,065 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 231 -> 71
2022-07-26 18:24:59,065 [s1-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-204_230 to index:230
2022-07-26 18:24:59,067 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_204-230
2022-07-26 18:24:59,067 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_204-230
2022-07-26 18:24:59,068 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,068 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-204_230 to index:230
2022-07-26 18:24:59,069 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#287-t2,previous=(t:1, i:70),leaderCommit=229,initializing? true,entries: size=161, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,070 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 229, m112 -> (t:2, i:229), STATEMACHINELOGENTRY, 498@client-3DC40C5CE9E0
2022-07-26 18:24:59,070 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231
2022-07-26 18:24:59,070 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_204-230
2022-07-26 18:24:59,070 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_204 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_204-230
2022-07-26 18:24:59,071 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@78f8b3c8 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,071 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 232 -> 71
2022-07-26 18:24:59,072 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231
2022-07-26 18:24:59,072 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 231, m113 -> (t:2, i:231), STATEMACHINELOGENTRY, 499@client-3DC40C5CE9E0
2022-07-26 18:24:59,073 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,074 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#289-t2,previous=(t:1, i:70),leaderCommit=231,initializing? true,entries: size=162, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,075 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,076 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7e810ed rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,076 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 233 -> 71
2022-07-26 18:24:59,079 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 231, m113 -> (t:2, i:231), STATEMACHINELOGENTRY, 499@client-3DC40C5CE9E0
2022-07-26 18:24:59,079 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#291-t2,previous=(t:1, i:70),leaderCommit=231,initializing? true,entries: size=163, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,080 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@fd40a6d rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,081 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 234 -> 71
2022-07-26 18:24:59,081 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 233, m114 -> (t:2, i:233), STATEMACHINELOGENTRY, 500@client-3DC40C5CE9E0
2022-07-26 18:24:59,082 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#293-t2,previous=(t:1, i:70),leaderCommit=233,initializing? true,entries: size=164, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,083 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@44984e9c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,083 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 235 -> 71
2022-07-26 18:24:59,084 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,085 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#294-t2,previous=(t:1, i:70),leaderCommit=233,initializing? true,entries: size=165, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,085 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,086 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1d0d4f85 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,086 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 236 -> 71
2022-07-26 18:24:59,087 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 233, m114 -> (t:2, i:233), STATEMACHINELOGENTRY, 500@client-3DC40C5CE9E0
2022-07-26 18:24:59,087 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#295-t2,previous=(t:1, i:70),leaderCommit=233,initializing? true,entries: size=165, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,088 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3f9b6bff rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,089 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 236 -> 71
2022-07-26 18:24:59,091 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 235, m115 -> (t:2, i:235), STATEMACHINELOGENTRY, 501@client-3DC40C5CE9E0
2022-07-26 18:24:59,092 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,092 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#297-t2,previous=(t:1, i:70),leaderCommit=235,initializing? true,entries: size=166, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,093 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,094 [grpc-default-executor-5] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@33b039bb rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,094 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 237 -> 71
2022-07-26 18:24:59,095 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 235, m115 -> (t:2, i:235), STATEMACHINELOGENTRY, 501@client-3DC40C5CE9E0
2022-07-26 18:24:59,096 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#299-t2,previous=(t:1, i:70),leaderCommit=236,initializing? true,entries: size=167, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,096 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38f66f4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,097 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 238 -> 71
2022-07-26 18:24:59,099 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 237, m116 -> (t:2, i:237), STATEMACHINELOGENTRY, 502@client-3DC40C5CE9E0
2022-07-26 18:24:59,100 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#300-t2,previous=(t:1, i:70),leaderCommit=237,initializing? true,entries: size=168, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,100 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,101 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7368c45 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,101 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 239 -> 71
2022-07-26 18:24:59,102 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,103 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#301-t2,previous=(t:1, i:70),leaderCommit=237,initializing? true,entries: size=169, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,104 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1c5bd471 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,104 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 240 -> 71
2022-07-26 18:24:59,107 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 237, m116 -> (t:2, i:237), STATEMACHINELOGENTRY, 502@client-3DC40C5CE9E0
2022-07-26 18:24:59,108 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#302-t2,previous=(t:1, i:70),leaderCommit=238,initializing? true,entries: size=169, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,108 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@731043fa rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,109 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 240 -> 71
2022-07-26 18:24:59,111 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 239, m117 -> (t:2, i:239), STATEMACHINELOGENTRY, 503@client-3DC40C5CE9E0
2022-07-26 18:24:59,112 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,112 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#303-t2,previous=(t:1, i:70),leaderCommit=239,initializing? true,entries: size=170, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,113 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@124c4d4a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,113 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 241 -> 71
2022-07-26 18:24:59,114 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#304-t2,previous=(t:1, i:70),leaderCommit=239,initializing? true,entries: size=171, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,115 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,115 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2eb21768 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,115 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 242 -> 71
2022-07-26 18:24:59,119 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 239, m117 -> (t:2, i:239), STATEMACHINELOGENTRY, 503@client-3DC40C5CE9E0
2022-07-26 18:24:59,120 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#305-t2,previous=(t:1, i:70),leaderCommit=240,initializing? true,entries: size=171, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,121 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@14d22f6f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,121 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 242 -> 71
2022-07-26 18:24:59,122 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 241, m118 -> (t:2, i:241), STATEMACHINELOGENTRY, 504@client-3DC40C5CE9E0
2022-07-26 18:24:59,123 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,124 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#306-t2,previous=(t:1, i:70),leaderCommit=241,initializing? true,entries: size=172, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,125 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@13e52ad0 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,125 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 243 -> 71
2022-07-26 18:24:59,126 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,126 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 241, m118 -> (t:2, i:241), STATEMACHINELOGENTRY, 504@client-3DC40C5CE9E0
2022-07-26 18:24:59,128 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#308-t2,previous=(t:1, i:70),leaderCommit=242,initializing? true,entries: size=173, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,129 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@381b66a6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,129 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 244 -> 71
2022-07-26 18:24:59,130 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 243, m119 -> (t:2, i:243), STATEMACHINELOGENTRY, 505@client-3DC40C5CE9E0
2022-07-26 18:24:59,131 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,132 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#309-t2,previous=(t:1, i:70),leaderCommit=243,initializing? true,entries: size=174, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,133 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6ca615b9 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,133 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 245 -> 71
2022-07-26 18:24:59,134 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,135 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#310-t2,previous=(t:1, i:70),leaderCommit=243,initializing? true,entries: size=175, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,136 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@728d1079 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,136 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 246 -> 71
2022-07-26 18:24:59,137 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 243, m119 -> (t:2, i:243), STATEMACHINELOGENTRY, 505@client-3DC40C5CE9E0
2022-07-26 18:24:59,138 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#311-t2,previous=(t:1, i:70),leaderCommit=243,initializing? true,entries: size=175, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,139 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@27ca122 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,140 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 246 -> 71
2022-07-26 18:24:59,140 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 245, m120 -> (t:2, i:245), STATEMACHINELOGENTRY, 506@client-3DC40C5CE9E0
2022-07-26 18:24:59,141 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,142 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#313-t2,previous=(t:1, i:70),leaderCommit=245,initializing? true,entries: size=176, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,143 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@41c78b48 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,144 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 247 -> 71
2022-07-26 18:24:59,145 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,145 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#314-t2,previous=(t:1, i:70),leaderCommit=245,initializing? true,entries: size=177, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,146 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@6438745f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,147 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 245, m120 -> (t:2, i:245), STATEMACHINELOGENTRY, 506@client-3DC40C5CE9E0
2022-07-26 18:24:59,147 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 248 -> 71
2022-07-26 18:24:59,148 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#315-t2,previous=(t:1, i:70),leaderCommit=245,initializing? true,entries: size=177, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,149 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@149a4882 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,150 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 248 -> 71
2022-07-26 18:24:59,150 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 247, m121 -> (t:2, i:247), STATEMACHINELOGENTRY, 507@client-3DC40C5CE9E0
2022-07-26 18:24:59,151 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,152 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#317-t2,previous=(t:1, i:70),leaderCommit=247,initializing? true,entries: size=178, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,154 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@e7d391a rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,154 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 249 -> 71
2022-07-26 18:24:59,155 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,156 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#318-t2,previous=(t:1, i:70),leaderCommit=247,initializing? true,entries: size=179, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,157 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@5b678df6 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,157 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 250 -> 71
2022-07-26 18:24:59,158 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 247, m121 -> (t:2, i:247), STATEMACHINELOGENTRY, 507@client-3DC40C5CE9E0
2022-07-26 18:24:59,159 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#319-t2,previous=(t:1, i:70),leaderCommit=247,initializing? true,entries: size=179, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,160 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@30a35ebc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,161 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 250 -> 71
2022-07-26 18:24:59,161 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 249, m122 -> (t:2, i:249), STATEMACHINELOGENTRY, 508@client-3DC40C5CE9E0
2022-07-26 18:24:59,162 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,163 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#321-t2,previous=(t:1, i:70),leaderCommit=249,initializing? true,entries: size=180, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,164 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@3c1e6c64 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,165 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 251 -> 71
2022-07-26 18:24:59,166 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,167 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#322-t2,previous=(t:1, i:70),leaderCommit=249,initializing? true,entries: size=181, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,168 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@23d2b6a3 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,168 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 252 -> 71
2022-07-26 18:24:59,168 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 249, m122 -> (t:2, i:249), STATEMACHINELOGENTRY, 508@client-3DC40C5CE9E0
2022-07-26 18:24:59,170 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#323-t2,previous=(t:1, i:70),leaderCommit=249,initializing? true,entries: size=181, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,171 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2b0e4817 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,171 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 252 -> 71
2022-07-26 18:24:59,172 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 251, m123 -> (t:2, i:251), STATEMACHINELOGENTRY, 509@client-3DC40C5CE9E0
2022-07-26 18:24:59,173 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,174 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#325-t2,previous=(t:1, i:70),leaderCommit=251,initializing? true,entries: size=182, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,175 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@38cc397f rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,175 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 253 -> 71
2022-07-26 18:24:59,177 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,177 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#326-t2,previous=(t:1, i:70),leaderCommit=251,initializing? true,entries: size=183, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,178 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@4ff20965 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,179 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 254 -> 71
2022-07-26 18:24:59,179 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 251, m123 -> (t:2, i:251), STATEMACHINELOGENTRY, 509@client-3DC40C5CE9E0
2022-07-26 18:24:59,181 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#327-t2,previous=(t:1, i:70),leaderCommit=251,initializing? true,entries: size=183, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,182 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@2c1e9cc rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,182 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 254 -> 71
2022-07-26 18:24:59,183 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 253, m124 -> (t:2, i:253), STATEMACHINELOGENTRY, 510@client-3DC40C5CE9E0
2022-07-26 18:24:59,184 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,185 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#329-t2,previous=(t:1, i:70),leaderCommit=253,initializing? true,entries: size=184, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,186 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f42d00c rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,186 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 255 -> 71
2022-07-26 18:24:59,188 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,189 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#330-t2,previous=(t:1, i:70),leaderCommit=253,initializing? true,entries: size=185, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,190 [grpc-default-executor-7] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@7f7d8eec rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,190 [grpc-default-executor-7] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 256 -> 71
2022-07-26 18:24:59,190 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 253, m124 -> (t:2, i:253), STATEMACHINELOGENTRY, 510@client-3DC40C5CE9E0
2022-07-26 18:24:59,191 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#331-t2,previous=(t:1, i:70),leaderCommit=253,initializing? true,entries: size=185, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,193 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@649a0cc7 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,193 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 256 -> 71
2022-07-26 18:24:59,194 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 255, m125 -> (t:2, i:255), STATEMACHINELOGENTRY, 511@client-3DC40C5CE9E0
2022-07-26 18:24:59,198 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,199 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#333-t2,previous=(t:1, i:70),leaderCommit=255,initializing? true,entries: size=186, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,201 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@1a732077 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,201 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 257 -> 71
2022-07-26 18:24:59,202 [s1-client-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-231_256 to index:256
2022-07-26 18:24:59,205 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_231-256
2022-07-26 18:24:59,205 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s1@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_231-256
2022-07-26 18:24:59,208 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,208 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(430)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolling segment log-231_256 to index:256
2022-07-26 18:24:59,208 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s1@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_257
2022-07-26 18:24:59,210 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#334-t2,previous=(t:1, i:70),leaderCommit=255,initializing? true,entries: size=187, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,211 [s0@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s0: put 255, m125 -> (t:2, i:255), STATEMACHINELOGENTRY, 511@client-3DC40C5CE9E0
2022-07-26 18:24:59,211 [s0@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_231-256
2022-07-26 18:24:59,211 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(586)) - s0@group-2923AB502154-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_231 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_231-256
2022-07-26 18:24:59,212 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s1@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 255
2022-07-26 18:24:59,212 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s1@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 191 -> 255
2022-07-26 18:24:59,212 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(629)) - s0@group-2923AB502154-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s0/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_inprogress_257
2022-07-26 18:24:59,213 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@790acea4 rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,213 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 258 -> 71
2022-07-26 18:24:59,217 [s1@group-2923AB502154-StateMachineUpdater] INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(204)) - s1: put 257, m126 -> (t:2, i:257), STATEMACHINELOGENTRY, 512@client-3DC40C5CE9E0
2022-07-26 18:24:59,217 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s1->s2#335-t2,previous=(t:1, i:70),leaderCommit=255,initializing? true,entries: size=187, first=(t:2, i:71), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:37395"
dataStreamAddress: "localhost:46467"
clientAddress: "localhost:36457"
adminAddress: "localhost:40763"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43495"
dataStreamAddress: "localhost:44349"
clientAddress: "localhost:41421"
adminAddress: "localhost:34259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:40915"
dataStreamAddress: "localhost:34537"
clientAddress: "localhost:35985"
adminAddress: "localhost:42379"
startupRole: FOLLOWER
, old:)
java.util.concurrent.CompletionException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:1005)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	... 15 more
2022-07-26 18:24:59,218 [s0-server-thread2] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:appendImpl(447)) - truncateIndex=-1, arrayIndex=0
2022-07-26 18:24:59,219 [grpc-default-executor-11] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s1@group-2923AB502154->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:121)
	at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
	at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:479)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:562)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:743)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:722)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at sun.reflect.GeneratedConstructorAccessor9.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.ratis.util.ReflectionUtils.instantiateException(ReflectionUtils.java:259)
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:120)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:535)
	... 10 more
	Suppressed: java.lang.IllegalStateException: Failed to cast to class java.io.IOException, object=java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.CompletableFuture$AsyncSupply@344dd8db rejected from java.util.concurrent.ThreadPoolExecutor@17a5b07c[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)
	at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)
	at java.util.concurrent.CompletableFuture.asyncSupplyStage(CompletableFuture.java:1618)
	at java.util.concurrent.CompletableFuture.supplyAsync(CompletableFuture.java:1843)
	at org.apache.ratis.server.impl.RaftServerImpl.executeSubmitServerRequestAsync(RaftServerImpl.java:788)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:622)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:622)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:207)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:204)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:126)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:318)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:301)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)

		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:237)
		at org.apache.ratis.util.IOUtils.bytes2Object(IOUtils.java:214)
		at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:109)
		at org.apache.ratis.grpc.GrpcUtil.unwrapThrowable(GrpcUtil.java:82)
		at org.apache.ratis.grpc.GrpcUtil.warn(GrpcUtil.java:178)
		at org.apache.ratis.grpc.server.GrpcLogAppender$AppendLogResponseHandler.onError(GrpcLogAppender.java:378)
		... 10 more
	Caused by: java.lang.ClassCastException: Cannot cast java.util.concurrent.RejectedExecutionException to java.io.IOException
		at java.lang.Class.cast(Class.java:3369)
		at org.apache.ratis.util.IOUtils.readObject(IOUtils.java:234)
		... 15 more
2022-07-26 18:24:59,219 [grpc-default-executor-11] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s2: nextIndex: updateUnconditionally 258 -> 71
2022-07-26 18:24:59,221 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(140)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t2, leader=s1, voted=s1, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c255, conf=71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-2923AB502154:t2, leader=s1, voted=s1, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c257, conf=71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:CLOSED:c69, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null CLOSED
2022-07-26 18:24:59,221 [Time-limited test] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(141)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
java.lang.IllegalArgumentException: s2@group-2923AB502154-SegmentedRaftLog is expected to be opened but it is CLOSED
	at org.apache.ratis.util.OpenCloseState.assertOpen(OpenCloseState.java:63)
	at org.apache.ratis.server.raftlog.RaftLogBase.checkLogState(RaftLogBase.java:111)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.getLastEntryTermIndex(SegmentedRaftLog.java:340)
	at org.apache.ratis.server.raftlog.RaftLog.getNextIndex(RaftLog.java:83)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:267)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:138)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:118)
	at org.apache.ratis.InstallSnapshotNotificationTests.testRestartFollower(InstallSnapshotNotificationTests.java:250)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.util.OpenCloseState$CloseTrace: Close s2@group-2923AB502154-SegmentedRaftLog
	at org.apache.ratis.util.OpenCloseState.lambda$close$1(OpenCloseState.java:109)
	at java.util.concurrent.atomic.AtomicReference.getAndUpdate(AtomicReference.java:160)
	at org.apache.ratis.util.OpenCloseState.close(OpenCloseState.java:109)
	at org.apache.ratis.server.raftlog.RaftLogBase.close(RaftLogBase.java:365)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.close(SegmentedRaftLog.java:506)
	at org.apache.ratis.server.impl.ServerState.close(ServerState.java:467)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$close$4(RaftServerImpl.java:460)
	at org.apache.ratis.util.LifeCycle.lambda$checkStateAndClose$4(LifeCycle.java:299)
	at org.apache.ratis.util.LifeCycle.checkStateAndClose(LifeCycle.java:319)
	at org.apache.ratis.util.LifeCycle.checkStateAndClose(LifeCycle.java:297)
	at org.apache.ratis.server.impl.RaftServerImpl.close(RaftServerImpl.java:437)
	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:195)
	... 1 more
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(827)) - ************************************************************** 
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(828)) - *** 
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(829)) - ***     Stopping MiniRaftClusterWithGrpc
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(830)) - *** 
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2022-07-26 18:24:59,222 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-2923AB502154:t2, leader=s1, voted=s1, raftlog=Memoized:s0@group-2923AB502154-SegmentedRaftLog:OPENED:c255, conf=71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-2923AB502154:t2, leader=s1, voted=s1, raftlog=Memoized:s1@group-2923AB502154-SegmentedRaftLog:OPENED:c257, conf=71: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-2923AB502154:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-2923AB502154-SegmentedRaftLog:CLOSED:c69, conf=0: peers:[s0|rpc:localhost:37395|admin:localhost:40763|client:localhost:36457|dataStream:localhost:46467|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:43495|admin:localhost:34259|client:localhost:41421|dataStream:localhost:44349|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:40915|admin:localhost:42379|client:localhost:35985|dataStream:localhost:34537|priority:0|startupRole:FOLLOWER]|listeners:[], old=null CLOSED
2022-07-26 18:24:59,226 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(401)) - s0: close
2022-07-26 18:24:59,226 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s0@group-2923AB502154: shutdown
2022-07-26 18:24:59,227 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s0@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 255
2022-07-26 18:24:59,227 [s0@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s0@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 191 -> 255
2022-07-26 18:24:59,227 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s0
2022-07-26 18:24:59,227 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-2923AB502154-FollowerState
2022-07-26 18:24:59,227 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s0@group-2923AB502154-StateMachineUpdater: set stopIndex = 255
2022-07-26 18:24:59,227 [s0@group-2923AB502154-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-2923AB502154-FollowerState was interrupted
2022-07-26 18:24:59,228 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(401)) - s1: close
2022-07-26 18:24:59,228 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(438)) - s1@group-2923AB502154: shutdown
2022-07-26 18:24:59,228 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2923AB502154,id=s1
2022-07-26 18:24:59,228 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s1: shutdown s1@group-2923AB502154-LeaderStateImpl
2022-07-26 18:24:59,229 [s1@group-2923AB502154->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(183)) - s1@group-2923AB502154->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-07-26 18:24:59,229 [grpc-default-executor-11] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#328-t2,previous=(t:2, i:257),leaderCommit=257,initializing? true,entries: size=1, first=(t:2, i:258), METADATAENTRY(c:257)
2022-07-26 18:24:59,229 [grpc-default-executor-7] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(145)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2022-07-26 18:24:59,229 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s1@group-2923AB502154->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:59,229 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s0: nextIndex: updateUnconditionally 259 -> 258
2022-07-26 18:24:59,230 [s1@group-2923AB502154->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(183)) - s1@group-2923AB502154->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2022-07-26 18:24:59,230 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s1@group-2923AB502154-PendingRequests: sendNotLeaderResponses
2022-07-26 18:24:59,230 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(401)) - s2: close
2022-07-26 18:24:59,230 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-07-26 18:24:59,231 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(386)) - s1@group-2923AB502154->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2022-07-26 18:24:59,231 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(48)) - s1@group-2923AB502154->s0: nextIndex: updateUnconditionally 258 -> 257
2022-07-26 18:24:59,234 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(153)) - s1@group-2923AB502154-StateMachineUpdater: set stopIndex = 257
2022-07-26 18:24:59,235 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s0@group-2923AB502154: closes. applyIndex: 255
2022-07-26 18:24:59,235 [s0@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s0@group-2923AB502154-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-07-26 18:24:59,237 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s0 Close channels
2022-07-26 18:24:59,238 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s0@group-2923AB502154-SegmentedRaftLogWorker close()
2022-07-26 18:24:59,238 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s1 Close channels
2022-07-26 18:24:59,240 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-07-26 18:24:59,240 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-07-26 18:24:59,240 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-07-26 18:24:59,240 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s0: shutdown server GrpcServerProtocolService now
2022-07-26 18:24:59,240 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s2: shutdown server GrpcServerProtocolService now
2022-07-26 18:24:59,241 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s0: shutdown server GrpcServerProtocolService successfully
2022-07-26 18:24:59,241 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-07-26 18:24:59,241 [java.util.concurrent.ThreadPoolExecutor$Worker@727b4427[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-07-26 18:24:59,244 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@55cbb0b5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s0: Stopped
2022-07-26 18:24:59,244 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,246 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,247 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,248 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,249 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,250 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,250 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(287)) - s1@group-2923AB502154-StateMachineUpdater: Took a snapshot at index 257
2022-07-26 18:24:59,250 [s1@group-2923AB502154-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(92)) - s1@group-2923AB502154-StateMachineUpdater: snapshotIndex: updateIncreasingly 255 -> 257
2022-07-26 18:24:59,250 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(314)) - s1@group-2923AB502154-SegmentedRaftLog: purge 257
2022-07-26 18:24:59,250 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: snapshotIndex: updateIncreasingly 127 -> 257
2022-07-26 18:24:59,250 [s1@group-2923AB502154-StateMachineUpdater] DEBUG raftlog.RaftLog (SegmentedRaftLog.java:purgeImpl(365)) - purging segments:toTruncate: null
  toDelete: [(51, 70) isOpen? false, length=0, newEndIndex=0, (71, 93) isOpen? false, length=0, newEndIndex=0, (94, 122) isOpen? false, length=0, newEndIndex=0, (123, 149) isOpen? false, length=0, newEndIndex=0, (150, 176) isOpen? false, length=0, newEndIndex=0, (177, 203) isOpen? false, length=0, newEndIndex=0, (204, 230) isOpen? false, length=0, newEndIndex=0, (231, 256) isOpen? false, length=0, newEndIndex=0]
2022-07-26 18:24:59,250 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,250 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,251 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,252 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,252 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,252 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,252 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_51-70
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_71-93
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_94-122
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_123-149
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_150-176
2022-07-26 18:24:59,252 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_177-203
2022-07-26 18:24:59,253 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_204-230
2022-07-26 18:24:59,253 [s1@group-2923AB502154-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.delete /home/runner/work/ratis/ratis/ratis-test/target/test/data/ad7cb53f/MiniRaftClusterWithGrpcee336be6/s1/0206d15a-9e75-4e75-9f27-2923ab502154/current/log_231-256
2022-07-26 18:24:59,253 [s1@group-2923AB502154-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - s1@group-2923AB502154-SegmentedRaftLog: purgeIndex: updateToMax old=68, new=256, updated? true
2022-07-26 18:24:59,253 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,253 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,253 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,253 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,253 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,254 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,254 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,254 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.RaftServer$Division (ServerState.java:close(465)) - s1@group-2923AB502154: closes. applyIndex: 257
2022-07-26 18:24:59,254 [s1@group-2923AB502154-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(336)) - s1@group-2923AB502154-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2022-07-26 18:24:59,254 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(246)) - s1@group-2923AB502154-SegmentedRaftLogWorker close()
2022-07-26 18:24:59,255 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2022-07-26 18:24:59,256 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s0 Close channels
2022-07-26 18:24:59,256 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(110)) - s2 Close channels
2022-07-26 18:24:59,256 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,256 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,257 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,258 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,259 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,260 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-11] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,261 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,262 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,263 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,264 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,265 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,266 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,267 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,268 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,269 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - s2: installSnapshot onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2022-07-26 18:24:59,270 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s2: shutdown server GrpcServerProtocolService successfully
2022-07-26 18:24:59,270 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-07-26 18:24:59,270 [java.util.concurrent.ThreadPoolExecutor$Worker@131dac9[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-07-26 18:24:59,270 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@70a97e4a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s2: Stopped
2022-07-26 18:24:59,276 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,276 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,276 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,277 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,278 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,279 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,280 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,281 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,282 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,283 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,284 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,285 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,286 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,287 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,288 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,289 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,290 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,291 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,292 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(375)) - s1@group-2923AB502154->s2-GrpcLogAppender is already stopped
2022-07-26 18:24:59,293 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2022-07-26 18:24:59,293 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s1: shutdown server GrpcServerProtocolService now
2022-07-26 18:24:59,294 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s1: shutdown server GrpcServerProtocolService successfully
2022-07-26 18:24:59,294 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2022-07-26 18:24:59,294 [java.util.concurrent.ThreadPoolExecutor$Worker@3b9a44c4[State = -1, empty queue]] INFO  server.GrpcService (GrpcService.java:closeImpl(280)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2022-07-26 18:24:59,294 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$275/1658195669@6e54397b] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-s1: Stopped
2022-07-26 18:24:59,294 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(850)) - MiniRaftClusterWithGrpc shutdown completed
]]></system-out>
  </testcase>
  <testcase name="testInstallSnapshotNotificationCount" classname="org.apache.ratis.grpc.TestInstallSnapshotNotificationWithGrpc" time="4.466"/>
</testsuite>